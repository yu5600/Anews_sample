var Vo=Object.defineProperty;var jo=(s,e,t)=>e in s?Vo(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var ge=(s,e,t)=>(jo(s,typeof e!="symbol"?e+"":e,t),t);import{e as Ko,s as Yo,g as Qo,d as D,c as l,n as T,a as Q,l as Ne,i as as,V as qe,b as _s,r as g,w as Z,o as ne,f as oe,_ as Wo,h as ta,j as zo,k as Xe,m as ze,p as Je,t as $e,q as Fe,u as Be,v as sa,C as Dn,A as Jo,x as Vs,y as Xo,z as Bn,E as Zo,B as ei,D as ti,P as si,F as Sn,G as In,H as ai,I as ni,J as ri,U as oi,K as ii,L as ui,M as ci,N as Mn,O as li,Q as di,R as mi,S as aa,T as _i,W as $n,X as js,Y as pi,Z as Pn,$ as vi,a0 as fi,a1 as gi,a2 as Nn,a3 as hi,a4 as yi,a5 as Ci,a6 as bi,a7 as Ai,a8 as ki,a9 as xi,aa as wi,ab as Ei,ac as Fi,ad as ps,ae as Ln,af as Ti,ag as Di,ah as Bi,ai as Si,aj as Ii,ak as Mi,al as $i,am as Pi,an as Un,ao as Ni,ap as Li}from"./vendor-d045c76d.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function t(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function a(n){if(n.ep)return;n.ep=!0;const r=t(n);fetch(n.href,r)}})();function Ht(){const s=Qo();if(s===null)throw new Error("no vue instance");return s}function ie(){const s=Ht().proxy.$root;if(!s._$route&&s.$router){const e=Ko(!0).run(()=>Yo(Object.assign({},s.$router.currentRoute)));s._$route=e,s.$router.afterEach(t=>{Object.assign(e,t)})}return s._$route}function Te(){return Ht().proxy.$router}function se(){return Ht().proxy.$store}function Ye(){return Ht().proxy.$gtag}function fe(){return Ht().proxy.$root}const Ui=D({setup(){const s=se(),e=l(()=>s.getters["groups/memberGroupIds"]),t=l(()=>s.getters["themeList/personalThemeIds"]);return{memberGroupIds:e,personalThemeIds:t}}});var Ri=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"p-pc-app"},[t("router-view",{attrs:{memberGroupIds:e.memberGroupIds,personalThemeIds:e.personalThemeIds}})],1)},Oi=[],Gi=T(Ui,Ri,Oi,!1,null,"920ffb1c",null,null);const qi=Gi.exports;function Ka(s){return s.id!==void 0}function ot(s){return s!==void 0&&s.doc_type==="article"}function Gt(s){return s!==void 0&&s.doc_type==="research_paper"}function ns(s){return s!==void 0&&s.doc_type==="patent"}const Ks=["recommended","latest"];function Hi(s){return Ks.includes(s)}const Ie="UserSession",N={getUserId(){const s=localStorage.getItem(`${Ie}.UserId`);return s!=null?Number(s):null},getTeamId(){const s=localStorage.getItem(`${Ie}.TeamId`);return s!=null?Number(s):null},getTeamIdAsString(){const s=this.getTeamId();return s===null?null:s.toString()},getFeedType(){const s=t=>["all","domestic","foreign"].includes(t),e=localStorage.getItem(`${Ie}.FeedType`);return e===null||!s(e)?"domestic":e},setFeedType(s){localStorage.setItem(`${Ie}.FeedType`,s)},getIndustryId(){return localStorage.getItem(`${Ie}.IndustryId`)},setIndustryId(s){localStorage.setItem(`${Ie}.IndustryId`,s.toString())},getIsShownTranslateNotification(){return!!parseInt(localStorage.getItem(`${Ie}.IsShownTranslateNotification`)??"0")},setIsShownTranslateNotification(){localStorage.setItem(`${Ie}.IsShownTranslateNotification`,"1")},getMarkNewsSelectedUserNames(){return JSON.parse(localStorage.getItem(`${Ie}.MarkNewsSelectedUserNames`)??"[]")},setMarkNewsSelectedUserNames(s){localStorage.setItem(`${Ie}.MarkNewsSelectedUserNames`,JSON.stringify(s))},start(s,e,t){localStorage.setItem(`${Ie}.UserId`,s.toString()),localStorage.setItem(`${Ie}.TeamId`,e.toString()),Ge.config_user_id(t,s)},isActive(){const s=localStorage.getItem(`${Ie}.UserId`),e=localStorage.getItem(`${Ie}.TeamId`);return s!=null&&e!=null},clear(s){localStorage.removeItem(`${Ie}.UserId`),localStorage.removeItem(`${Ie}.TeamId`),Ge.config_user_id(s,null)},setThemeListState(s,e,t){localStorage.setItem(`${s}${e?`-${e}`:""}`,t.toString())},getThemeListState(s,e){const t=localStorage.getItem(`${s}${e?`-${e}`:""}`);return t?t==="true":!0},setLeftMenuIsExpanded(s){localStorage.setItem(`${Ie}.LeftMenuIsExpanded`,s.toString())},getLeftMenuIsExpanded(){const s=localStorage.getItem(`${Ie}.LeftMenuIsExpanded`);return s?s==="true":!0},setLeftReportMenuIsExpanded(s){localStorage.setItem(`${Ie}.LeftReportMenuIsExpanded`,s.toString())},getLeftReportMenuIsExpanded(){const s=localStorage.getItem(`${Ie}.LeftReportMenuIsExpanded`);return s?s==="true":!0},setLeftLabsMenuIsExpanded(s){localStorage.setItem(`${Ie}.LeftLabsMenuIsExpanded`,s.toString())},getLeftLabsMenuIsExpanded(){const s=localStorage.getItem(`${Ie}.LeftLabsMenuIsExpanded`);return s?s==="true":!0},setSelectedThemeTopic(s){localStorage.setItem(`${Ie}.SelectedThemeTopic`,JSON.stringify(s))},getSelectedThemeTopic(){const s=localStorage.getItem(`${Ie}.SelectedThemeTopic`);return s?JSON.parse(s):void 0},deleteSelectedThemeTopic(){localStorage.removeItem(`${Ie}.SelectedThemeTopic`)},setShowThemeSupportContent(s){localStorage.setItem(`${Ie}.ShowThemeSupportContent`,JSON.stringify(s))},getShowThemeSupportContent(){const s=localStorage.getItem(`${Ie}.ShowThemeSupportContent`);return s?s==="true":!0},setTeamMarkSort(s){localStorage.setItem(`${Ie}.TeamMarkSort`,s)},getTeamMarkSort(){const s=localStorage.getItem(`${Ie}.TeamMarkSort`);return s&&Hi(s)?s:null},setLabsReportSetting(s){const e=this.getUserId();e!==null&&localStorage.setItem(`${Ie}.LabsReportSetting-user${e}`,JSON.stringify(s))},getLabsReportSetting(){const s=this.getUserId(),e=localStorage.getItem(`${Ie}.LabsReportSetting-user${s}`);return e?JSON.parse(e):null}},Ge={getTrackingId:function(){return"UA-88818854-14"},config:function(s){const e=N.getUserId(),t=N.getTeamId();this.config_user_id(s,e),s.config({custom_map:{dimension1:"team_id"},team_id:t})},config_user_id:function(s,e){s.set({user_id:e})},trackArticleView:function(s){const e=N.getTeamIdAsString();s.event("click",{event_category:"link",event_label:"外部URL",team_id:e})},trackCreateComment:function(s){const e=N.getTeamIdAsString();s.event("create",{event_category:"comment",event_label:"コメント投稿",team_id:e})},trackEditComment:function(s){const e=N.getTeamIdAsString();s.event("update",{event_category:"comment",event_label:"コメント編集",team_id:e})},trackDeleteComment:function(s){const e=N.getTeamIdAsString();s.event("delete",{event_category:"comment",event_label:"コメント削除",team_id:e})},trackCreateTheme:function(s,e){const t=N.getTeamIdAsString();s.event("create",{event_category:"theme",event_label:"テーマ作成",team_id:t})},trackUpdateTheme:function(s,e){const t=N.getTeamIdAsString();s.event("update",{event_category:"theme",event_label:"テーマ編集",team_id:t})},trackDeleteTheme:function(s,e){const t=N.getTeamId();s.event("delete",{event_category:"theme",event_label:"テーマ削除",team_id:t})},trackShowMoreFeed:function(s){const e=N.getTeamId();s.event("click",{event_category:"show more",event_label:"もっと記事を表示",team_id:e})},trackToggleFavorite:function(s){const e=N.getTeamId();s.event("toggle",{event_category:"favorite",event_label:"お気に入り切り替え",team_id:e})},trackCreateTemplate:function(s,e){const t=N.getTeamId();s.event("create",{event_category:"labs.aiagent.template",event_label:e,team_id:t})},trackCreateTemplateKeyword:function(s,e,t){const a=N.getTeamId();s.event("create",{event_category:`labs.aiagent.template_${e}`,event_label:t,team_id:a})},trackAskAi:function(s,e){const t=N.getTeamId();s.event("askai",{event_category:"labs.aiagent.editoroption",event_label:e.slice(0,100),team_id:t})},trackSearchWithAi:function(s,e){const t=N.getTeamId();s.event("search",{event_category:"labs.aiagent.editoroption",event_label:e.slice(0,100),team_id:t})},trackSummarize:function(s,e){const t=N.getTeamId();s.event("summarize",{event_category:"labs.aiagent.editoroption",event_label:e.slice(0,100),team_id:t})}},Vi=15,ji=50,Rn=500,Ya=50,Ki=50,ts=30,Ft=2e3,Yi=100,rs=20,os=500,Qi=7,Wi=1e3,On="https://apps.apple.com/jp/app/id1530143368",Gn="https://play.google.com/store/apps/details?id=ai.stockmark.anews",qn=6,ct=10,zi=16,Ji=`詳しいキーワード設定の方法は
<a class="help-link" href="https://anews-stockmark.zendesk.com/hc/ja/articles/360051832574" target="_blank">サポートページ</a>をご覧ください`,Ys=`こちらは過去7日間のマークや全グループに投稿されたコメント・グループマーク件数を集計し作成しています。
参加グループの状況によりコメント・グループマーク数が少ない記事でも上位に表示される場合があります。`,Hn=`こちらは過去30日間のマークや全グループに投稿されたコメント・グループマーク件数を集計し作成しています。
参加グループの状況によりコメント・グループマーク数が少ない記事でも上位に表示される場合があります。`,Xi='<a class="help-link" href="https://anews-stockmark.zendesk.com/hc/ja/articles/13717202977689-%E8%AB%96%E6%96%87%E6%A9%9F%E8%83%BD%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6" target="_blank">SJRスコア</a>の上位に入る影響度の高い学術雑誌です',Zi=["日","月","火","水","木","金","土"],lt=/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#/%?=~_|!:,.;]*[-A-Z0-9+&@#/%=~_|])/gi,Qa=/(\b(https?):\/\/[-A-Z0-9+&@#/%?=~_|!:,.;]*[-A-Z0-9+&@#/%=~_|])/gi,Wa={id:1,category:"",question:"目的を限定せずに幅広く情報を取りたい",name:"",query_ja:"",query_en:""},eu=3,Qs=10,za=20,tu=12,Vn=500,Ja=500,su=300,Ws="response content-type is not JSON",au="マーク：情報を蓄積する",nu="グループマーク：グループに情報を共有する",ru="コメントする",ou="ログインが必要な記事",iu="Anewsで読める有料記事",na="新着ニュースはありませんでした。",vs=50,uu="https://stockmark.notion.site/Stockmark-Labs-Help-0165fd3ed87c4bf2b0d0141d7b4fdedc",Xa=15,zs=7,jn=100,cu=50,lu="mailto:stockmark_labs@stockmark.co.jp?subject=【Stockmark Labs/調査AIエージェント】お問い合わせ&body=*内容を追記し、ご送付ください。%0D%0Aご質問内容：%0D%0Aこちらに質問を記載ください。%0D%0Aできるだけ詳細に頂けますと幸いです。",yt=({groupId:s,adpDocument:e,themeId:t,pageName:a,pageUrl:n,pageGroupId:r,feature:o,feedType:i,rankInWholeFeed:u,searchData:c,industryData:p,siteType:m,description:d})=>{let _={page:{name:a,url:n},feature:o,ui_feed_type:i};if(s&&(_={..._,group:{id:s}}),e&&(_={..._,article:{id:e.id,hit_keywords:e.hit_keywords,synonym_keywords:e.synonym_keywords},rank:u??e.rank},_.article&&(_.article.type=e.doc_type??"article"),e.feed_date||e.isPastArticle)){const h=e;_={..._,feed:{job_code:h.feed_job_code,date:h.feed_date,rank:h.rank,feed_type:e.lang==="ja"?"domestic":"foreign",lang:e.lang}}}return t&&(_={..._,theme:{id:t}}),a==="search"&&c&&(_={..._,search:c}),p&&d&&(_={..._,industry:p,description:d}),m&&(_={..._,site_type:m}),r&&(_={..._,page:{..._.page,group:{id:r}}}),_};Q.defaults.baseURL="/api/v1/";Q.defaults.timeout=35e3;Q.interceptors.response.use(function(s){const e=s.headers["content-type"];return s.status===200&&!/(text|application)\/json/.test(e)?Promise.reject(new Error(Ws)):s},function(s){return Promise.reject(s)});const F={async fetchUsers(){const s=N.getTeamId(),{data:e}=await Q.get(`/teams/${s}/users`);return e.users},async fetchTeamInfo(){const s=N.getTeamId(),{data:e}=await Q.get(`/teams/${s}`);return e},async fetchMyInfo(){const s=N.getUserId();return this.fetchUserInfo(s)},async fetchGroupActivityComments(s,e,t=1,a,n,r){const o={page:e,limit:t,order:"desc",is_activity_feed:!0,exists_memo:r,tags:a.length>0?a:void 0};try{const{data:i}=await Q.get(`/groups/${s}/activity_comments?${Ne.stringify(o,{arrayFormat:"brackets"})}`,{signal:n.signal});return i.group_comments}catch(i){if(Q.isCancel(i))return[];throw i}},async fetchGroupMarks(s,e,t=1,a,n,r){const o={page:e,limit:t,order:"desc",memo_exists:r,include_research_paper:!0,tags:a.length>0?a:void 0,filter_target_group_comment:!0};try{const{data:i}=await Q.get(`/groups/${s}/marked_articles?${Ne.stringify(o,{arrayFormat:"brackets"})}`,{signal:n.signal});return i.marked_articles}catch(i){if(Q.isCancel(i))return[];throw i}},async fetchUserInfo(s){const{data:e}=await Q.get(`/users/${s}`);return e},async fetchThemes(){const s=N.getUserId(),{data:e}=await Q.get(`/users/${s}/themes`);return e.themes},async fetchThemeList(s="domestic"){const e=N.getUserId(),{data:t}=await Q.get(`/users/${e}/themes?feed_type=${s}`);return t.themes},async fetchTheme(s){const{data:e}=await Q.get(`/themes/${s}`);return e.themes},async getThemeKeywordFeeds(s,e,t,a=1,n=10){const r={feed_type:e,date:t.format("YYYY-MM-DD"),page:a,limit:n},{data:o}=await Q.get(`/themes/${s}/keyword_feeds?${Ne.stringify(r)}`);return{articles:o.keyword_feeds}},async getThemeRelatedFeeds(s,e,t,a=1,n=10){const r={feed_type:e,date:t.format("YYYY-MM-DD"),page:a,limit:n},{data:o}=await Q.get(`/themes/${s}/related_feeds?${Ne.stringify(r)}`);return{articles:o.related_feeds}},async getPersonalNews(s,e,t=1,a=10){const n=N.getUserId(),r={feed_type:s,date:e.format("YYYY-MM-DD"),page:t,limit:a},{data:o}=await Q.get(`/users/${n}/personal_feeds?${Ne.stringify(r)}`);return{articles:o.personal_feeds,count:o.count}},async fetchMyComments(s=10,e=1){const t=Number(N.getUserId());return await this.fetchUserComments(t,s,e)},async fetchUserComments(s,e=10,t=1){const{data:a}=await Q.get(`/users/${s}/comments?limit=${e}&page=${t}&order=desc&include_research_paper=true`);return a.user_comments},async fetchUserMarkArticles(s,e=10,t=1,a=void 0,n=[]){n.length>0&&n.forEach(i=>{});const r={page:t,limit:e,order:"desc",tags:n.length>0?n:void 0,memo_exists:a,include_technical_literature:!0},{data:o}=await Q.get(`/users/${s}/marked_articles`,{params:r});return o.marked_articles},async fetchDocument(s,e){const{data:t}=await Q.get(`/${e}s/${s}`);return t},async sendMark(s,e,t,a,n,r,o,i){const{data:u}=await Q.post("/marks",{article_id:s.id,doc_type:s.doc_type??"article",theme_id:e??void 0,source:t,tracking_data:yt({adpDocument:s,themeId:e??void 0,rankInWholeFeed:n,...a,searchData:r,industryData:o,description:i})});return u},async updateMark(s){const{data:e}=await Q.patch(`/marks/${s}`,{});return e},async sendComment({groupId:s,adpDocument:e,themeId:t,content:a,mention:n={all:!1,target_user_ids:[],target_group_ids:[]},parentCommentId:r,trackingBaseData:o,rankInWholeFeed:i,searchData:u,industryData:c,description:p}){const{data:m}=await Q.post("/comments",{group_id:s,article_id:e==null?void 0:e.id,doc_type:e==null?void 0:e.doc_type,theme_id:t??void 0,content:a,mention:n,parent_comment_id:r,tracking_data:yt({groupId:s,adpDocument:e,themeId:t,rankInWholeFeed:i,...o,searchData:u,industryData:c,description:p})});return m},async updateComment(s,e){const{data:t}=await Q.put(`/comments/${s}`,{content:e});return t},async trackAccess(){await Q.post("/accesses")},async trackPageView({pageName:s,pageUrl:e,theme:t,group:a,adpDocument:n,feedType:r,fromUrl:o,fromSnackbarLink:i}){await Q.post("/page_views",{page:{name:s,url:e},theme:t,group:a,article:n,feed_type:r,from_url:o,from_snackbar_link:i})},async sendView({adpDocument:s,themeId:e,groupId:t,trackingBaseData:a,rankInWholeFeed:n,searchData:r,industryData:o,siteType:i,description:u}){await Q.post("/views",{article_id:s==null?void 0:s.id,doc_type:(s==null?void 0:s.doc_type)??"article",theme_id:e??void 0,tracking_data:yt({adpDocument:s,themeId:e,groupId:t,rankInWholeFeed:n,...a,searchData:r,industryData:o,siteType:i,description:u})})},async signout(){await Q.post("/users/signout")},async deleteMark(s){await Q.delete(`/marks/${s}`)},async deleteComment(s){await Q.delete(`/comments/${s}`)},async sendUserAction(...s){throw new Error("not implemented")},async deleteUser(s){const{data:e}=await Q.delete(`/users/${s}`);return e},async updateUser(s,e,t,a,n,r){const{data:o}=await Q.put(`/users/${s}`,{user_name:t,role:a,org_department:n,email:e,product_contract_id:r});return o},async createUser(s,e,t,a,n){const{data:r}=await Q.post("/users",{email:s,user_name:e,role:t,org_department:a,product_contract_id:n});return r},async signin(s,e){const{data:t}=await Q.post("/users/signin",{email:s,password:e});return t},async set_new_password(s,e,t){const{data:a}=await Q.post("/users/set_new_password",{email:s,password:e,session:t});return a},async changePassword(s,e,t){const a=N.getUserId();await Q.post(`/users/${a}/change_password`,{old_password:s,new_password:e,tracking_data:{page:{name:t.pageName,url:t.pageUrl}}})},async forgotPassword(s){const{data:e}=await Q.post("/users/forgot_password",{email:s});return e},async confirmForgotPassword(s,e,t){const{data:a}=await Q.post("/users/confirm_forgot_password",{email:s,password:e,confirmation_code:t});return a},async createTheme(s,e,t,a,n,r,o,i,u,c,p,m,d,_,h=void 0,v,f){const C=N.getUserId(),y={name:s,description:e,keywords:t,topics:a,perspectives:n,is_foreign_media_enabled:r,is_research_paper_enabled:o,is_patent_enabled:i,is_chinese:u,is_entertainment_sites_filtered:c,is_initial_theme:p,site_exclusion_ids:m,access_scope:d,skip_email:v,by_onboarding:f};d==="personal"&&(y.user_id=h??C),d==="group"&&(y.group_id=_);const{data:A}=await Q.post("/themes",y);return A},async updateTheme(s,e){const t=N.getUserId(),{id:a,...n}=s;n.access_scope==="personal"&&(n.user_id=s.user_id??t),await Q.put(`/themes/${a}`,{...n,skip_email:(e==null?void 0:e.skipEmail)??!1})},async deleteTheme(s){await Q.delete(`/themes/${s}`)},async fetchNotification(s=10,e=1,t="desc"){const a=N.getUserId(),{data:n}=await Q.get(`/users/${a}/notifications/${qn}?limit=${s}&page=${e}&order=${t}`);return n.notification},async sendLastNotificationViewedAt(){const s=N.getUserId();await Q.post(`/users/${s}/notifications`)},async excludeArticle(s,e,t,a){const{data:n}=await Q.post("/article_exclusions",{theme_id:s,article_id:e.id,doc_type:e.doc_type,tracking_data:yt({adpDocument:e,themeId:s??void 0,rankInWholeFeed:a,...t})});return n},async deleteExcludeArticle(s){await Q.delete(`/article_exclusions/${s}`)},async postFavoriteTheme(s){const e=N.getUserId(),{data:t}=await Q.post(`/users/${e}/themes/${s}/favorites`);return t},async updateFavoriteTheme(s,e){const t=N.getUserId();await Q.put(`/users/${t}/themes/${s}/favorites`,{order:e})},async deleteFavoriteTheme(s){const e=N.getUserId();await Q.delete(`/users/${e}/themes/${s}/favorites`)},async getUserSettings(s=null){s===null&&(s=N.getUserId());const{data:e}=await Q.get(`/users/${s}/settings`);return e},async updateUserSettings(s,e){const t=N.getUserId();await Q.put(`/users/${t}/settings`,{...s,tracking_data:{page:{name:e.pageName,url:e.pageUrl}}})},async search({query:s,lang:e,period:t,sort:a,entertainment_filter:n,original_query:r,query_keywords:o,doc_types:i},u,c){const{data:p}=await Q.get("/search",{params:{query:s,lang:e,period:t,sort:a,page:u,limit:c,entertainment_filter:n,original_query:r,query_keywords:o,doc_types:i}});return{result_count:p.search_result_count,articles:p.search_articles}},async searchPastArticles({keywords:s,lang:e,to_date:t,sort:a,entertainment_filter:n,page:r,limit:o,offset:i,exclude_site_ids:u}){const{data:c}=await Q.get("/search/past_articles",{params:{keywords:s,lang:e,to_date:t,sort:a,page:r,limit:o,entertainment_filter:n,offset:i,exclude_site_ids:u}});return{result_count:c.search_result_count,articles:c.search_articles}},async getNaturalSentenceQueryKeywords(s){return(await Q.post("/natural_sentence/query_keywords",{query:s})).data},async resendPasswordEmail(s){await Q.get(`/users/${s}/admin_reset_password`)},async fetchUsersForAdmin(){const s=N.getTeamId(),{data:e}=await Q.get(`/admin/teams/${s}/users`);return e.users},async fetchGroupsForAdmin(){const s=N.getTeamId(),{data:e}=await Q.get(`/admin/teams/${s}/groups`);return e.groups},async updateMSTeamsSettings(s){const e=N.getTeamId(),{data:t}=await Q.put(`/admin/teams/${e}/ms_teams_settings`,s);return t},async fetchMSTeamsSettings(){const s=N.getTeamId(),{data:e}=await Q.get(`/admin/teams/${s}/ms_teams_settings`);return e},async updateGroupMSTeamsSettings(s,e){await Q.put(`/groups/${s}/ms_teams_settings`,e)},async fetchGroupMSTeamsSettings(s){const{data:e}=await Q.get(`/groups/${s}/ms_teams_settings`);return e},async fetchUrlPreview(s){const{data:e}=await Q.get(`/article_shares/preview?url=${encodeURIComponent(s)}`);return e.article_preview},async createArticleShare(s,e){const{data:t}=await Q.post("/article_shares",{url:s,tracking_data:{page:{name:e.pageName,url:e.pageUrl}}});return await this.fetchDocument(t.article_id,"article")},async postEmojiReaction(s,e){const{data:t}=await Q.post(`/comments/${s}/comment_reactions`,{reaction:e});return t},async deleteReaction(s,e){await Q.delete(`/comments/${s}/comment_reactions/${e}`)},async trackIntegration(s,e,t={}){const a=e.query,n=a.from,r=a.eventSourceName,o=a.userId?Number(a.userId):null,i=a.themeId?Number(a.themeId):null,u=a.groupId?Number(a.groupId):null,c=a.feature||void 0;if(n&&r){const p={...t,from:n,event_source:{name:r}};let m;if(r==="comment"&&o!==null?(m="comment_view",p.event_source.comment={user_id:o}):r==="mark"&&o!==null?(m="article_view",p.event_source.mark={user_id:o}):r==="group_mark"||r==="last_week_highlight"?m="article_view":(r==="latest_news"||r==="weekly_highlight"||r==="overlooked_news")&&(s==="article"&&a.modal==="group_mark"?m="group_article_mark_dialog":s==="article"&&a.modal==="mark"?m="article_mark_dialog":s==="article"&&a.modal==="comment"&&(m="comment_dialog"),i&&(p.theme={id:i}),u&&(p.group={id:u}),typeof c=="string"&&(p.event_source.feature=c)),!m)return;await Q.post(`/integration_trackings?event_type=${m}`,p)}},async createGroup(s,e){await Q.post("/groups",{name:s,description:e})},async fetchGroup(s){const{data:e}=await Q.get(`/groups/${s}`);return e},async fetchGroups(s){const{data:e}=await Q.get(`/users/${s}/groups`);return e.groups},async updateGroup(s,e,t,a){await Q.put(`/groups/${s}`,{name:e,description:t,enabled_overlooked_mail:a})},async deleteGroup(s){await Q.delete(`/groups/${s}`)},async fetchGroupMembers(s){const{data:e}=await Q.get(`/groups/${s}/users`);return e.group_users},async joinGroup(s){const e=N.getUserId();await Q.post(`/groups/${s}/users/${e}`)},async leaveGroup(s,e){const t=e??N.getUserId();await Q.delete(`/groups/${s}/users/${t}`)},async sendGroupView(s){const e=N.getUserId();await Q.put(`/users/${e}/groups/${s}/view`)},async getSites(s=!1,e=null,t=null){const a={is_entertainment:s};e&&(a.page=e),t&&(a.limit=t);const{data:n}=await Q.get("/sites",{params:a});return n.sites},async createGroupInvitation(s,e){await Q.post(`/groups/${s}/invitations`,{user_ids:e})},async getThemePreviewArticle(s,e,t="ja",a=!1,n=[]){return await Q.post("/search/theme_preview",{keywords:s,limit:e,lang:t,entertainment_filter:a,site_exclusion_ids:n}).then(r=>({hasError:!1,articles:r.data.search_articles,count:r.data.search_result_count,failedKeywords:[]})).catch(r=>{var o;return{hasError:!0,articles:[],count:0,failedKeywords:((o=r.response)==null?void 0:o.data.failed_keywords)??[]}})},async updateUserArticleMemo(s,e,t){const a=N.getUserId();await Q.put(`/users/${a}/articles/${s}/memos`,{content:t,doc_type:e??"article"})},async deleteUserArticleMemo(s,e){const t=N.getUserId(),a=e?`?doc_type=${e}`:"";await Q.delete(`/users/${t}/articles/${s}/memos${a}`)},async updateUserArticleTags(s,e,t){const a=N.getUserId();await Q.put(`/users/${a}/articles/${s}/tags`,{tags:t,doc_type:e??"article"})},async fetchUserArticleTags(s){const{data:e}=await Q.get(`/users/${s}/tags`);return e.user_tags},async deleteGroupMark(s){await Q.delete(`/group_marks/${s}`)},async postGroupMark(s,e,t,a,n,r,o,i,u,c,p){const m={...yt({adpDocument:e,groupId:s,themeId:t??void 0,rankInWholeFeed:r,...n,searchData:u,industryData:c,description:p}),article_memo:o,article_tags:i},{data:d}=await Q.post("/group_marks",{group_id:s,article_id:e.id,doc_type:e.doc_type??"article",theme_id:t||void 0,source:a,tracking_data:m});return d},async updateGroupArticleMemo(s,e,t,a){await Q.put(`/groups/${s}/articles/${e}/memos`,{content:a,doc_type:t??"article"})},async deleteGroupArticleMemo(s,e,t){const a=t?`?doc_type=${t}`:"";await Q.delete(`/groups/${s}/articles/${e}/memos${a}`)},async fetchGroupTags(s,e,t){const a=e?`?all_article_count=${e}`:"",n=t!==void 0?{signal:t.signal}:{};try{const{data:r}=await Q.get(`/groups/${s}/tags${a}`,n);return r.tags}catch(r){if(Q.isCancel(r))return[];throw r}},async updateGroupArticleTags(s,e,t,a){await Q.put(`/groups/${s}/articles/${e}/tags`,{tags:a,doc_type:t??"article"})},async trackEvent(s,e,t,a,n){const r={...yt({...e,adpDocument:t?{id:t}:void 0,groupId:a}),...n};await Q.post("/tracking_events",{name:s,...r})},async addUserTheme(s){const e=N.getUserId();await Q.post(`/users/${e}/themes/${s}`)},async deleteUserTheme(s){const e=N.getUserId();await Q.delete(`/users/${e}/themes/${s}`)},async fetchTeamFeaturedArticles(){const s=N.getTeamId(),{data:e}=await Q.get(`/teams/${s}/featured_articles`);return e.featured_articles},async fetchThemeFeaturedArticles(s){const{data:e}=await Q.get(`/themes/${s}/featured_articles`);return e.featured_articles},async updateMailDeliverySchedules(s){const e=N.getTeamId();await Q.put(`/admin/teams/${e}/mail_delivery_schedules`,{mail_delivery_schedules:s})},async createThemeInvitation(s,e){await Q.post(`/themes/${s}/invitations`,{user_ids:e})},async updateUserJobType(s){const e=N.getUserId();await Q.put(`/users/${e}/job_types`,{id:s})},async updateUserNeedOnboarding(s){const e=N.getUserId();await Q.put(`/users/${e}/need_onboarding`,{value:s})},async trackThemeEvent(s,{pageName:e,pageUrl:t,keywords:a,from:n,rank:r,topics:o,theme:i,perspectives:u}){await Q.post("/tracking_theme_events",{name:s,page:{name:e,url:t},theme:{id:i==null?void 0:i.id},keywords:a,from:n,rank:r,topics:o,perspectives:u})},async fetchKeywordsRecommend(s,e){const{data:t}=await Q.post("/keyword_recommendation",{queries:s,minScore:e});return t},async excludeSiteAndArticle(s,e,t){await Q.put(`/themes/${s.theme_id}/exclude_site_and_article`,{url:s.url,article_id:s.id,tracking_data:yt({adpDocument:s,themeId:s.theme_id,rankInWholeFeed:t,...e})})},async trackAutocompleteEvent(s){await Q.post("/tracking_theme_events",{name:"add_keywords",from:"auto_completion",page:{name:s.pageName,url:s.pageUrl},theme:{id:s.themeId??null},keywords:s.keywords,input_text:s.input_text,rank:s.rank})},async deleteManagementContractManagingUser(s,e){await Q.delete(`/admin/management_contracts/${s}/managing_users/${e}`)},async addManagementContractManagingUsers(s,e){await Q.put(`/admin/management_contracts/${s}/managing_users`,{user_ids:e})},async*reportStreamChat(s){var a;const e=await fetch("api/v1/labs/report/stream_chat",{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify({prompts:s})}),t=(a=e.body)==null?void 0:a.pipeThrough(new TextDecoderStream).getReader();if(e.status!==200||!t)throw new Error("Request failed");for(;;){const{done:n,value:r}=await t.read();if(n)break;yield r}t.releaseLock()},async reportChat(s){return(await Q.post("labs/report/chat",{prompts:s})).data},async getUserSolutions(s,e,t){const a={langs:s,limit:e,company_name:t},n=Ne.stringify(a,{arrayFormat:"brackets"});return(await Q.get(`labs/report/user_solutions?${n}`)).data},async getKeywordSolutionSearch(s,e,t){const a={keyword:s,langs:e,limit:t},n=Ne.stringify(a,{arrayFormat:"brackets"});return(await Q.get(`labs/report/keyword_solution_search?${n}`)).data}};function Kn(s){return!s.matched.some(e=>e.meta.type==="account"||e.meta.type==="mobile_app_download")&&!N.isActive()}const Yn={isShown:!1,message:"",type:"success",timeout:1e4,showUndo:!1,undoFunc:()=>{},messageTemplates:[]},du={namespaced:!0,state:()=>Yn,mutations:{addMessages(s,e){var t;s.isShown=!1,setTimeout(()=>s.isShown=!0,0),s.message=e.message,s.messageTemplates=((t=e.messageTemplates)==null?void 0:t.slice())??[],s.type=e.type?e.type:"success",s.showUndo=e.showUndo?e.showUndo:!1,e.undoFunc?s.undoFunc=e.undoFunc:s.undoFunc=()=>{}},removeMessage(s){s.isShown=!1}}},mu={teamInfo:void 0},_u={namespaced:!0,state:{teamInfo:void 0},actions:{async fetchTeamInfo({commit:s,state:e}){const t=await F.fetchTeamInfo();e.teamInfo=t,s("setTeamInfo",t)}},mutations:{setTeamInfo(s,e){s.teamInfo=e}}},Qn={teamUsers:[],teamUsersForAdmin:[]},pu={namespaced:!0,state:()=>Qn,actions:{async fetchTeamUsers({commit:s}){const e=await F.fetchUsers();s("setTeamUsers",e)},async fetchTeamUsersForAdmin({commit:s}){const e=await F.fetchUsersForAdmin();s("setTeamUsersForAdmin",e)}},getters:{activeTeamUsers(s){return s.teamUsers.filter(e=>!e.is_deleted)},activeTeamUsersForAdmin(s){return s.teamUsersForAdmin.filter(e=>!e.is_deleted)}},mutations:{setTeamUsers(s,e){s.teamUsers=e},setTeamUsersForAdmin(s,e){s.teamUsersForAdmin=e}}},Wn=s=>{const e=s.map(t=>t.id);return s.filter((t,a)=>e.indexOf(t.id)===a)};class dt{constructor(e,t,a=600,n=document.body,r,o=Qi){ge(this,"page");ge(this,"limit");ge(this,"date");ge(this,"action");ge(this,"executing");ge(this,"isEnd");ge(this,"lastDate");ge(this,"func");ge(this,"listener");this.page=1,this.date=r,this.limit=t,this.action=e,this.executing=!1,this.isEnd=!1,this.lastDate=this.date?this.date.subtract(o,"day"):void 0,this.func=async(u=!1)=>{const c=n.scrollHeight,p=window.pageYOffset+window.innerHeight;(u||c<=p+a&&!this.executing&&!this.isEnd)&&(this.executing=!0,await this.fetch(),this.executing=!1)},this.listener=()=>this.func(),(async()=>{await this.func(!0),window.addEventListener("scroll",this.listener)})()}async fetch(){try{await this.action(this.page,this.limit,this.date),this.page++}catch(e){console.log(e)}}removeEvent(){window.removeEventListener("scroll",this.listener)}}const Vt=()=>as().phone,zn=()=>as().tablet,vu=s=>s==null?[]:s.reduce((e,t)=>{const a=e.find(n=>n.reaction===t.reaction);return a?(a.count++,a.users.push({id:t.user_id,name:t.user_name})):e.push({reaction:t.reaction,count:1,users:[{id:t.user_id,name:t.user_name}]}),e},[]),Jn=(s,e)=>{if(!s)return"";const t={themeId:s.theme_id,commentId:e},a=Ne.stringify(t,{arrayFormat:"brackets"});return`/${s.doc_type??"article"}s/${s.id}${a?`?${a}`:""}`},Xn=s=>Object.keys(s).length===0;function fu(s){return s.slice().sort((e,t)=>{const a=e.marks,n=t.marks;if(a.length===0||n.length===0)return 1;const r=a[a.length-1].created_at,o=n[n.length-1].created_at;return Date.parse(o)-Date.parse(r)})}function Dt(s,e,t){const a=t==="asc"?1:-1,r=s.map(o=>e==="share_count"?[o,o.user_comment_count+o.user_group_mark_count]:[o,o[e]]).sort((o,i)=>{const u=a*String(o[1]).localeCompare(String(i[1]),void 0,{numeric:!0});return u===0?o[0].id-i[0].id:u}).map(o=>o[0]);return[...r.filter(o=>o.group_type==="all_user_group"),...r.filter(o=>o.group_type!=="all_user_group")]}const ra={userMarkArticles:[],fetchingUserMarkArticles:!1,userComments:[],targetUserInfo:{},isLastPage:!1,hasFetchedMyActionCount:!1,hasFetchedUserActionCount:!1,actionCounts:{domestic:{commented_articles:0,marked_articles:0},foreign:{commented_articles:0,marked_articles:0}},userActionCount:{mark:0,comment:0}},Zn={namespaced:!0,state:()=>ra,actions:{async fetchUserMarkArticles({commit:s,state:e},t){try{if(e.isLastPage)return;e.fetchingUserMarkArticles=!0;const a=await F.fetchUserMarkArticles(t.userId,t.limit,t.page,t.memoExists,t.tags);e.fetchingUserMarkArticles=!1,a.length===0&&s("setIsLastPage",!0),t.reset&&s("resetUserMarkArticles"),a.forEach(n=>{var r,o;n.theme_id=((o=(r=n.marks)==null?void 0:r[0])==null?void 0:o.theme_id)??0}),s("setUserMarkArticles",a)}catch(a){console.log(a)}},async fetchUserComments({commit:s,state:e},t){try{if(e.isLastPage)return;const a=await F.fetchUserComments(t.userId,t.limit,t.page);a.length===0&&s("setIsLastPage",!0),t.reset&&s("resetUserComments"),s("setUserComments",a)}catch(a){console.log(a)}},async fetchMyActionCount({commit:s,state:e}){const t=await F.fetchMyInfo();s("setMyActionCount",t),e.hasFetchedMyActionCount=!0},async fetchUserActionCount({commit:s,state:e},t){const a=await F.fetchUserInfo(t);s("setUserActionCount",a),e.hasFetchedUserActionCount=!0},async fetchTargetUserInfo({commit:s,state:e},t){const a=await F.fetchUserInfo(t);s("setTargetUserInfo",a),s("setUserActionCount",a),e.hasFetchedUserActionCount=!0},async updateUserMarkArticleLocally({state:s},{article:e}){const t=s.userMarkArticles.map(n=>n.id).indexOf(e.id);if(t===-1)return;const a=s.userMarkArticles.slice();a[t]=e,s.userMarkArticles=a},async updateUserMarkArticle({state:s},{userId:e,themeId:t,articleId:a,docType:n}){var p;const r=await F.fetchDocument(a,n);r.theme_id=t;const o=s.userMarkArticles.map(m=>m.id).indexOf(a),i=s.userMarkArticles.slice();o!==-1?i[o]=r:i.unshift(r);const u=i.filter(m=>m.marks.some(d=>d.user_id===e));N.getUserId()===((p=s.targetUserInfo)==null?void 0:p.id)?s.userMarkArticles=fu(u):s.userMarkArticles=i},async updateUserComment({state:s},{comment:e}){const t=s.userComments.findIndex(a=>a.id===e.id);t>=0?s.userComments[t].content=e.content:s.userComments.forEach(a=>{var r;const n=(r=a.children)==null?void 0:r.findIndex(o=>o.id===e.id);n>=0&&(a.children[n].content=e.content)})},async deleteUserComment({state:s},{id:e}){const t=s.userComments.findIndex(a=>a.id===e);t>=0?s.userComments.splice(t,1):s.userComments.forEach(a=>{var r;const n=(r=a.children)==null?void 0:r.findIndex(o=>o.id===e);n>=0&&a.children.splice(n,1)})},addUserComment({state:s},{comment:e}){s.userComments.unshift(e)}},mutations:{setIsLastPage(s,e){s.isLastPage=e},setUserMarkArticles(s,e){s.userMarkArticles=Wn(s.userMarkArticles.concat(e))},addUserMarkArticles(s,e){s.userMarkArticles.unshift(e)},resetUserMarkArticles(s){s.userMarkArticles=[],s.isLastPage=!1},setUserComments(s,e){s.userComments=[...s.userComments,...e]},resetUserComments(s){s.userComments=[],s.isLastPage=!1},setMyActionCount(s,e){s.actionCounts=e.action_counts},setUserActionCount(s,e){s.userActionCount.mark=e.marked_article_count,s.userActionCount.comment=e.comment_count},setTargetUserInfo(s,e){s.targetUserInfo=e}}},gu={headerText:"",bodyText:"",confirmationType:"",btnText:"",action:()=>Promise.resolve(),confirmationModalOpen:!1},hu={namespaced:!0,state:{headerText:"",bodyText:"",confirmationType:"",btnText:"",action:Object(),confirmationModalOpen:!1},actions:{async executeAction(s){await s.state.action()}},mutations:{setTextAndAction(s,e){s.headerText=e.headerText,s.bodyText=e.bodyText,s.confirmationType=e.confirmationType,s.btnText=e.btnText??"削除",s.action=e.action},showConfirmationModal(s){s.confirmationModalOpen=!0},hideConfirmationModal(s){s.confirmationModalOpen=!1}}},Js={isDownloadingMyActivity:!1,isDownloadingTeamActivity:!1},yu={namespaced:!0,state:{isDownloadingMyActivity:Js.isDownloadingMyActivity,isDownloadingTeamActivity:Js.isDownloadingTeamActivity},mutations:{setIsDownloadingMyActivity(s,e){s.isDownloadingMyActivity=e},setIsDownloadingTeamActivity(s,e){s.isDownloadingTeamActivity=e}}},Cu={feedType:N.getFeedType()},bu={namespaced:!0,state:{feedType:N.getFeedType()},mutations:{setFeedType(s,e){s.feedType=e}},actions:{async updateFeedType({commit:s},e){N.setFeedType(e),await s("setFeedType",e)}}},Au={groups:[]},ku={namespaced:!0,state:{groups:[]},mutations:{setGroups(s,e){s.groups=e}},actions:{async fetchGroups({commit:s},e){const t=await F.fetchGroups(e);s("setGroups",t)}},getters:{memberGroupIds(s){return s.groups.filter(e=>e.is_member).map(e=>e.id)}}},Xs={modalType:void 0,modalOpen:!1,article:void 0,theme:void 0,comment:void 0,pageName:void 0,feature:void 0,feedType:void 0,markSource:void 0,rankInWholeFeed:void 0,group:void 0,isSharing:!1,currentAdmins:void 0,searchData:void 0,industryData:void 0,description:"",withoutArticleComment:void 0},xu={namespaced:!0,state:{...Xs},mutations:{showModal(s,e){s.modalType=e,s.modalOpen=!0},setArticle(s,e){s.article=e},setTheme(s,e){s.theme=e},setComment(s,e){s.comment=e},setPageName(s,e){s.pageName=e},setFeature(s,e){s.feature=e},setFeedType(s,e){s.feedType=e},setMarkSource(s,e){s.markSource=e},setRankInWholeFeed(s,e){s.rankInWholeFeed=e},setGroup(s,e){s.group=e},setIsSharing(s,e){s.isSharing=e},setCurrentAdmins(s,e){s.currentAdmins=e},setSearchData(s,e){s.searchData=e},setIndustryData(s,e){s.industryData=e},setDescription(s,e){s.description=e},hideModal(s){s.modalType=void 0,s.modalOpen=!1,s={...Xs}},setWithoutArticleComment(s,e){s.withoutArticleComment=e}}},er={previousRoute:void 0},wu={namespaced:!0,state:()=>er,mutations:{setPreviousRoute(s,e){s.previousRoute=e}}},tr={resultCount:0,resultArticles:[],isLastPage:!1},Eu={namespaced:!0,state:()=>tr,actions:{async search({state:s,commit:e},t){try{const a=await F.search(t.searchData,t.page,t.pageLimit);e("setResultCount",a.result_count),e("setResultArticles",Wn(s.resultArticles.concat(a.articles))),e("setIsLastPage",s.resultArticles.length===s.resultCount)}catch(a){console.log(a)}},async updateArticleLocally({state:s,commit:e},{article:t}){const a=s.resultArticles.findIndex(r=>r.id===t.id);if(a===-1)return;const n=s.resultArticles.slice();n[a]=t,e("setResultArticles",n)},async updateArticle({state:s,commit:e},{articleId:t,docType:a}){const n=s.resultArticles.findIndex(r=>r.id==t);if(n!==-1){const r=s.resultArticles.slice(),o=await F.fetchDocument(t,a),i=r[n];o.hit_keywords=i.hit_keywords,o.synonym_keywords=i.synonym_keywords,r[n]=o,e("setResultArticles",r)}},reset({commit:s}){s("setResultCount",0),s("setResultArticles",[]),s("setIsLastPage",!1)}},mutations:{setResultCount(s,e){s.resultCount=e},setResultArticles(s,e){s.resultArticles=e},setIsLastPage(s,e){s.isLastPage=e}}},sr={themes:[],hasFetchedThemes:!1},Fu={namespaced:!0,state:()=>sr,actions:{async fetchThemeList({commit:s},e){const t=await F.fetchThemeList(e);s("setThemes",t)}},mutations:{setThemes(s,e){s.themes=e,s.hasFetchedThemes=!0},updateThemes(s,e){Object.assign(s.themes,e)},updateTheme(s,e){const t=s.themes.slice(),a=t.map(n=>n.id).indexOf(e.id);t[a]=e,s.themes=t}},getters:{activeThemes(s){return s.themes.filter(e=>!e.is_deleted)},favoriteThemes(s){return s.themes.filter(e=>!e.is_deleted&&e.is_favorite)},notFavoriteThemes(s){return s.themes.filter(e=>!e.is_deleted&&!e.is_favorite)},memberThemes(s){return s.themes.filter(e=>!e.is_deleted&&e.is_member)},personalThemeIds(s){return s.themes.filter(e=>!e.is_deleted&&e.is_member&&e.access_scope==="personal").map(e=>e.id)}}},ar={userEditModalOpen:!1,type:"create",targetUserInfo:void 0},Tu={namespaced:!0,state:()=>ar,mutations:{showUserEditModal(s,e){s.userEditModalOpen=!0,s.type=e.type,s.targetUserInfo=e.user},hideUserEditModal(s){s.userEditModalOpen=!1}}},Du={userInfo:void 0},Bu={namespaced:!0,state:{userInfo:void 0},mutations:{setUserInfo(s,e){s.userInfo=e}}};qe.use(_s);const Su={themeList:Object.assign({},sr),userActions:Object.assign({},ra),userInfo:Object.assign({},Du),snackbar:Object.assign({},Yn),confirmationModal:Object.assign({},gu),userEditModal:Object.assign({},ar),teamUsers:Object.assign({},Qn),teamInfo:Object.assign({},mu),searchResults:Object.assign({},tr),modal:Object.assign({},Xs),groups:Object.assign({},Au),feedType:Object.assign({},Cu),route:Object.assign({},er),downloadActionData:Object.assign({},Js)},Rt=new _s.Store({modules:{themeList:Fu,userActions:Zn,userInfo:Bu,snackbar:du,confirmationModal:hu,userEditModal:Tu,teamUsers:pu,teamInfo:_u,searchResults:Eu,modal:xu,groups:ku,feedType:bu,route:wu,downloadActionData:yu},mutations:{resetState(s){Object.keys(s).forEach(e=>{Object.assign(s[e],Su[e])})}}}),Iu=D({props:{password:{type:String,default:""},hasError:{type:Boolean,default:!1}},model:{prop:"password",event:"update-password"},setup({password:s},{emit:e}){const t=g(s),a=g(!1),n=()=>{a.value=!a.value},r=o=>{e("keydown",o)};return Z(()=>t.value,()=>{e("update-password",t.value)}),{passwordValue:t,isPasswordVisible:a,togglePasswordVisible:n,keyDown:r}}});var Mu=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"password-input"},[(e.isPasswordVisible?"text":"password")=="checkbox"?t("input",{directives:[{name:"model",rawName:"v-model",value:e.passwordValue,expression:"passwordValue"}],staticClass:"password c-textInput",class:{"c-formInput--error":e.hasError},attrs:{name:"password",placeholder:"",type:"checkbox"},domProps:{checked:Array.isArray(e.passwordValue)?e._i(e.passwordValue,null)>-1:e.passwordValue},on:{keydown:e.keyDown,change:function(a){var n=e.passwordValue,r=a.target,o=!!r.checked;if(Array.isArray(n)){var i=null,u=e._i(n,i);r.checked?u<0&&(e.passwordValue=n.concat([i])):u>-1&&(e.passwordValue=n.slice(0,u).concat(n.slice(u+1)))}else e.passwordValue=o}}}):(e.isPasswordVisible?"text":"password")=="radio"?t("input",{directives:[{name:"model",rawName:"v-model",value:e.passwordValue,expression:"passwordValue"}],staticClass:"password c-textInput",class:{"c-formInput--error":e.hasError},attrs:{name:"password",placeholder:"",type:"radio"},domProps:{checked:e._q(e.passwordValue,null)},on:{keydown:e.keyDown,change:function(a){e.passwordValue=null}}}):t("input",{directives:[{name:"model",rawName:"v-model",value:e.passwordValue,expression:"passwordValue"}],staticClass:"password c-textInput",class:{"c-formInput--error":e.hasError},attrs:{name:"password",placeholder:"",type:e.isPasswordVisible?"text":"password"},domProps:{value:e.passwordValue},on:{keydown:e.keyDown,input:function(a){a.target.composing||(e.passwordValue=a.target.value)}}}),t("div",{staticClass:"eye-switch"},[t("div",{staticClass:"eye-icon",on:{click:e.togglePasswordVisible}},[t("sm-icons",{key:e.isPasswordVisible},[e._v(e._s(e.isPasswordVisible?"eye":"eye-alt"))])],1)])])},$u=[],Pu=T(Iu,Mu,$u,!1,null,"3505b9d5",null,null);const oa=Pu.exports,Nu=D({components:{PasswordInput:oa},setup(s,e){const t=g(""),a=g(""),n=l(()=>t.value!==""&&a.value!==""&&!r.value&&!c.value),r=l(()=>o.value||u.value||i.value),o=l(()=>t.value===""?!1:t.value.length<=7),i=l(()=>{if(t.value==="")return!1;const p=RegExp(".*[a-z].*"),m=RegExp(".*[A-Z].*"),d=RegExp(".*[0-9].*");return!(p.test(t.value)&&m.test(t.value)&&d.test(t.value))}),u=l(()=>t.value===""?!1:RegExp(".*[^a-zA-Z0-9].*").test(t.value)),c=l(()=>t.value===""||a.value===""?!1:t.value!==a.value);return Z(()=>[t.value,n.value],p=>{e.emit("password-changed",{password:p[0],isValid:p[1]})}),{password:t,passwordForValidation:a,isValid:n,invalidPassword:r,tooShortPassword:o,notUsingRequiredTypeCharactors:i,usingInvalidCharactor:u,twoPasswordUnmatched:c}}});var Lu=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"o-password-form c-formBlock"},[t("div",{staticClass:"o-form-label c-formBlock__label"},[e._v("新しいパスワード")]),t("div",{staticClass:"spacing-04"}),t("div",{staticClass:"c-formBlock__text c-text c-text--m"},[e._v(" 大文字・小文字・数字をそれぞれ1文字以上含みかつ8文字以上 ")]),t("div",{staticClass:"o-error-messages c-formBlock__text c-formBlock__text--error",attrs:{"data-testid":"password-error-message"}},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.notUsingRequiredTypeCharactors,expression:"notUsingRequiredTypeCharactors"}],staticClass:"c-text--s"},[e._v(" 小文字の英字、大文字の英字、数字をそれぞれ１文字以上使用してください。 ")]),t("div",{directives:[{name:"show",rawName:"v-show",value:e.usingInvalidCharactor,expression:"usingInvalidCharactor"}],staticClass:"c-text--s"},[e._v(" 使用できない文字が含まれています。 ")]),t("div",{directives:[{name:"show",rawName:"v-show",value:e.tooShortPassword,expression:"tooShortPassword"}],staticClass:"c-text--s"},[e._v(" 8文字以上入力してください。 ")])]),t("PasswordInput",{attrs:{hasError:e.invalidPassword},model:{value:e.password,callback:function(a){e.password=a},expression:"password"}}),t("div",{staticClass:"spacing-16"}),t("div",{staticClass:"o-form-label c-formBlock__label"},[e._v("パスワード再入力")]),t("div",{directives:[{name:"show",rawName:"v-show",value:e.twoPasswordUnmatched,expression:"twoPasswordUnmatched"}],staticClass:"c-formBlock__text c-formBlock__text--error",attrs:{"data-testid":"password-for-validation-error-message"}},[t("div",{staticClass:"c-text--s"},[e._v("パスワードが一致していません。")])]),t("PasswordInput",{attrs:{hasError:e.twoPasswordUnmatched},model:{value:e.passwordForValidation,callback:function(a){e.passwordForValidation=a},expression:"passwordForValidation"}})],1)},Uu=[],Ru=T(Nu,Lu,Uu,!1,null,"4f7c569f",null,null);const ia=Ru.exports;async function ua(s,e,t,a,n,r){N.start(n,r,a);const o=await F.fetchMyInfo();await t.commit("userInfo/setUserInfo",o),await t.dispatch("userActions/fetchMyActionCount"),o!=null&&o.need_onboarding?s.push("/onboarding/job_select"):e.query.redirect?s.push({path:e.query.redirect}):s.push({name:"anewsHome"})}const Ou=D({components:{PasswordForm:ia},props:{mailAddress:{type:String,required:!0}},setup({mailAddress:s}){const e=g(""),t=g(""),a=g(!1),n=g(""),r=g(""),o=Te(),i=ie(),u=se(),c=Ye();return{password:e,confirmationCode:t,errorMessage:n,errorMessageForCode:r,enableToPost:a,submit:async()=>{if(!a.value)return;n.value="",r.value="";let d;try{d=await F.confirmForgotPassword(s,e.value,t.value)}catch{n.value="予期せぬエラーが発生しました。";return}if(d.type==="success"){const _=await F.signin(s,e.value);_.type==="success"?await ua(o,i,u,c,_.user_id,_.team_id):n.value="予期せぬエラーが発生しました。"}else d.type==="expired_code"?r.value=`検証コードの有効期限が切れました。
はじめからパスワードの再設定を行ってください。`:d.type==="code_mismatch"?r.value="メールで送付した検証コードと入力が異なります。":d.type==="limit_exceeded"?n.value=`連続で認証に失敗したため、一時的にログイン操作をロックしました。
お手数ですが、しばらく時間を置いてからお試しください。`:n.value=d.error_message},newPasswordUpdated:({password:d,isValid:_})=>{e.value=d,a.value=_}}}});var Gu=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"o-confirm-forgot-password"},[t("div",{staticClass:"o-password-reset-title c-title c-title--l"},[e._v(" 新しいパスワードを設定 ")]),t("div",{staticClass:"spacing-24"}),t("div",{staticClass:"o-confirm-forgot-password-description"},[t("span",{staticClass:"o-mail-address c-text c-text--m"},[e._v(e._s(e.mailAddress)+" ")]),t("span",{staticClass:"c-text c-text--m"},[e._v("に検証コードを送信しました。検証コードと新しいパスワードを入力してください。もしメールが届かない場合は迷惑メールフォルダをご確認ください。")])]),t("div",{staticClass:"spacing-32"}),t("div",{staticClass:"o-form-label c-formBlock__label c-title c-title--m"},[e._v(" 検証コード "),t("div",{staticClass:"c-formBlock__text c-formBlock__text--error"},[t("div",{staticClass:"m-error c-text--s"},[e._v(e._s(e.errorMessageForCode))])])]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.confirmationCode,expression:"confirmationCode"}],staticClass:"c-textInput o-confirmation-code",attrs:{type:"text",size:"6",maxLength:"6"},domProps:{value:e.confirmationCode},on:{input:function(a){a.target.composing||(e.confirmationCode=a.target.value)}}}),t("div",{staticClass:"spacing-16"}),t("PasswordForm",{on:{"password-changed":e.newPasswordUpdated}}),t("div",{staticClass:"spacing-32"}),t("div",{staticClass:"c-formBlock__text c-formBlock__text--error",attrs:{"data-testid":"password-submit-error-message"}},[t("div",{staticClass:"m-error c-text--s"},[e._v(e._s(e.errorMessage))])]),e.errorMessage?t("div",{staticClass:"spacing-32"}):e._e(),t("div",{staticClass:"forgot-buttons"},[t("router-link",{staticClass:"c-btn c-btn--auto c-btnOutline o-back-button",attrs:{to:"/login",tag:"button"}},[e._v("戻る")]),t("button",{staticClass:"c-btn c-btn--AnewsPrimary o-submit-button",class:{disabled:!e.enableToPost},attrs:{disabled:!e.enableToPost},on:{click:e.submit}},[e._v(" 送信 ")])],1)],1)},qu=[],Hu=T(Ou,Gu,qu,!1,null,"2e80c352",null,null);const nr=Hu.exports,Vu=D({setup(){const s=Te(),e=g(""),t=g(""),a=async()=>{t.value="";let o;try{o=await F.forgotPassword(e.value)}catch{t.value="予期せぬエラーが発生しました。";return}o.type==="success"?s.push({name:"confirmForgotPassword",params:{mailAddress:e.value}}):t.value="予期せぬエラーが発生しました。"},n=l(()=>e.value&&!r.value),r=l(()=>e.value===""?!1:!RegExp(".*@.+").test(e.value));return{mailAddress:e,errorMessage:t,notIncludingAt:r,enableToPost:n,submit:a}}});var ju=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"o-password-reset"},[t("div",{staticClass:"o-password-reset-title c-title c-title--l"},[e._v(" パスワードを忘れてしまった場合 ")]),t("div",{staticClass:"spacing-24"}),t("div",{staticClass:"o-password-reset-description c-text c-text--m"},[e._v(" パスワードの再設定用コードを送信するために登録しているメールアドレスを入力してください。 ")]),t("div",{staticClass:"spacing-32"}),t("div",{staticClass:"c-formBlock__label"},[e._v(" メールアドレス "),e.notIncludingAt?t("div",{staticClass:"c-formBlock__text c-formBlock__text--error"},[t("pre",{staticClass:"c-text--s"},[e._v("メールアドレスを入力してください。")])]):e._e()]),t("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.mailAddress,expression:"mailAddress",modifiers:{trim:!0}}],staticClass:"c-textInput",class:{"c-formInput--error":e.notIncludingAt},attrs:{name:"email",type:"email",autocomplete:"email",placeholder:""},domProps:{value:e.mailAddress},on:{input:function(a){a.target.composing||(e.mailAddress=a.target.value.trim())},blur:function(a){return e.$forceUpdate()}}}),t("div",{staticClass:"spacing-32"}),t("div",{staticClass:"c-formBlock__text c-formBlock__text--error"},[t("div",{staticClass:"m-error c-text--s"},[e._v(e._s(e.errorMessage))])]),e.errorMessage?t("div",{staticClass:"spacing-32"}):e._e(),t("div",{staticClass:"forgot-buttons"},[t("router-link",{staticClass:"c-btn c-btn--auto c-btnOutline o-back-button",attrs:{to:"/login",tag:"button"}},[e._v("戻る")]),t("button",{staticClass:"c-btn c-btn--AnewsPrimary o-submit-button",class:{disabled:!e.enableToPost},attrs:{disabled:!e.enableToPost},on:{click:e.submit}},[e._v(" 送信 ")])],1)])},Ku=[],Yu=T(Vu,ju,Ku,!1,null,"437e97dc",null,null);const rr=Yu.exports,Qu=D({components:{PasswordInput:oa},setup(){const s=g(""),e=g(""),t=g(""),a=g(!1),n=g();ne(()=>{var d;(d=n.value)==null||d.focus()});const r=Te(),o=ie(),i=se(),u=Ye(),c=async(d,_)=>{a.value=!0,t.value="";let h;try{h=await F.signin(d,_)}catch(v){throw t.value="予期せぬエラーが発生しました。",a.value=!1,v}if(h.type==="success")await ua(r,o,i,u,h.user_id,h.team_id);else if(h.type==="new_password_required")r.push({name:"newPassword",params:{mailAddress:d},query:{session:h.session}});else if(h.type==="incorrect_email_or_password")t.value="メールアドレスもしくはパスワードが間違っています。";else if(h.type==="invalid_team")t.value="チームが利用停止状態なので、ご利用できません。";else if(h.type==="initial_password_has_expired")t.value=`初期パスワードの有効期限が切れています。
管理者に問い合わせてください。`;else if(h.type==="password_attempts_exceeded")t.value=`連続でログインに失敗したため、一時的にログインをロックしました。
しばらく時間を置いてから、ログインをお試しください。`;else if(h.type==="invalid_contract")t.value="契約が無効状態なので、ご利用できません。";else throw t.value="予期せぬエラーが発生しました。","any error";a.value=!1},p=()=>{m.value&&c(s.value,e.value).catch(d=>console.log(d))},m=l(()=>s.value&&e.value&&!a.value);return{loginid:s,password:e,errorMessage:t,emailInputRef:n,submit:p,isEnableToPost:m}}}),or=""+new URL("login_visual-951ae0af.jpg",import.meta.url).href;var Wu=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"o-login"},[e._m(0),t("div",{staticClass:"o-right-container"},[t("form",{staticClass:"o-signin-form",on:{submit:function(a){return a.preventDefault(),e.submit.apply(null,arguments)}}},[t("div",{staticClass:"c-title--l"},[e._v("ログイン")]),t("div",{staticClass:"spacing-24"}),t("div",{staticClass:"c-formBlock"},[t("div",{staticClass:"c-formBlock__label"},[e._v("メールアドレス")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.loginid,expression:"loginid"}],ref:"emailInputRef",staticClass:"c-textInput",attrs:{name:"email",type:"email",autocomplete:"email",placeholder:""},domProps:{value:e.loginid},on:{input:function(a){a.target.composing||(e.loginid=a.target.value)}}})]),t("div",{staticClass:"spacing-12"}),t("div",{staticClass:"c-formBlock"},[t("div",{staticClass:"c-formBlock__label"},[e._v("パスワード")]),t("PasswordInput",{model:{value:e.password,callback:function(a){e.password=a},expression:"password"}})],1),e.errorMessage?t("div",{staticClass:"c-formBlock__text c-formBlock__text--error"},[t("div",{staticClass:"spacing-16"}),t("div",{staticClass:"o-error-message m-error c-text--s"},[e._v(" "+e._s(e.errorMessage)+" ")]),t("div",{staticClass:"spacing-16"})]):t("div",{staticClass:"spacing-32"}),t("button",{staticClass:"c-btn c-btn--AnewsPrimary o-submit-btn",class:{disabled:!e.isEnableToPost},attrs:{disabled:!e.isEnableToPost}},[e._v(" ログイン ")]),t("div",{staticClass:"o-info c-text--m"},[t("router-link",{attrs:{to:{name:"forgotPassword"}}},[t("a",{staticClass:"o-fogget-oassword"},[e._v("パスワードを忘れてしまった場合")])])],1)])])])},zu=[function(){var s=this,e=s._self._c;return s._self._setupProxy,e("div",{staticClass:"o-left-container"},[e("img",{staticClass:"o-image-anews",attrs:{src:or}})])}],Ju=T(Qu,Wu,zu,!1,null,"e00fd1ea",null,null);const ir=Ju.exports,Xu=D({components:{PasswordForm:ia},props:{mailAddress:{type:String,default:""}},setup(s){const e=g(""),t=g(!1),a=g(""),n=Te(),r=ie(),o=se(),i=Ye(),u=({password:p,isValid:m})=>{e.value=p,t.value=m},c=async()=>{if(!t.value)return;a.value="";const p=r.query.session;let m;if(p)if(m=await F.set_new_password(s.mailAddress,e.value,p.toString()),m.type==="success"){N.start(m.user_id,m.team_id,i);const d=await F.fetchMyInfo();await o.commit("userInfo/setUserInfo",d),d.need_onboarding?n.push("/onboarding/job_select"):n.push({name:"anewsHome"})}else if(m.type==="session_is_expired")a.value=`セッションの有効期限が切れました。
お手数ですが、はじめから操作を行ってください。`;else throw a.value="予期せぬエラーが発生しました。",m};return ne(async()=>{await F.trackPageView({pageName:"new_password",pageUrl:r.path})}),{newPasswordUpdated:u,errorMessage:a,enableToPost:t,submit:c}}});var Zu=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"o-password-reset"},[t("div",{staticClass:"o-password-reset-title c-title c-title--l"},[e._v(" パスワードの設定 ")]),t("div",{staticClass:"spacing-24"}),t("div",{staticClass:"o-password-reset-description"},[t("span",{staticClass:"o-mail-address c-text c-text--m"},[e._v(e._s(e.mailAddress)+" ")]),t("span",{staticClass:"c-text c-text--m"},[e._v("の新しいパスワードを入力してください。")])]),t("div",{staticClass:"spacing-32"}),t("PasswordForm",{on:{"password-changed":e.newPasswordUpdated}}),t("div",{staticClass:"spacing-32"}),e.errorMessage?t("div",{staticClass:"c-formBlock__text c-formBlock__text--error"},[t("div",{staticClass:"o-error-message c-text--s"},[e._v(e._s(e.errorMessage))])]):e._e(),t("button",{staticClass:"c-btn c-btn--AnewsPrimary o-submit-button",class:{disabled:!e.enableToPost},attrs:{disabled:!e.enableToPost},on:{click:e.submit}},[e._v(" 送信 ")])],1)},ec=[],tc=T(Xu,Zu,ec,!1,null,"3c54f324",null,null);const ur=tc.exports,sc=D({props:{fields:{type:Array,required:!0},items:{type:Array,required:!0},initialSortField:{type:Object},initialSortOrder:{type:String,default:"asc"}},setup(s){const e=(o,i)=>{const u=i==="asc"?1:-1;return[...s.items].sort((c,p)=>o.type==="string"?u*c[o.name].toLowerCase().localeCompare(p[o.name].toLowerCase()):o.type==="date"?(c[o.name]>p[o.name]?1:-1)*u:u*(c[o.name]-p[o.name]))},t=g(s.initialSortField??s.fields[0]),a=g(s.initialSortOrder),n=o=>{const i=s.fields.find(u=>u.name===o);!i||!i.isSortable||(i===t.value?a.value=a.value==="asc"?"desc":"asc":(t.value=i,a.value="asc"))},r=l(()=>e(t.value,a.value));return{sort:n,sortField:t,sortOrder:a,sortedData:r}}});var ac=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"admin-table"},[t("table",{staticClass:"admin-table-body",attrs:{cellspacing:"0"}},[t("thead",[t("tr",e._l(e.fields,function(a){return t("th",{key:a.name,staticClass:"c-text c-text--s",class:{sortable:a.isSortable},style:{minWidth:a.minWidth,textAlign:a.fieldPosition},on:{click:function(n){return e.sort(a.name)}}},[e._v(" "+e._s(a.displayName)+" "),e.sortField===a&&e.sortOrder==="asc"?t("span",{staticClass:"sort-icon"},[e._v("↑")]):e.sortField===a&&e.sortOrder==="desc"?t("span",{staticClass:"sort-icon"},[e._v("↓")]):e._e()])}),0)]),t("tbody",e._l(e.sortedData,function(a){return t("tr",{key:a.id},e._l(e.fields,function(n,r){return t("td",{key:n.name,style:{textAlign:n.cellPosition}},[e._t(`cell-${r}`,function(){return[t("div",[e._v(" "+e._s(a[n.name])+" ")])]},{item:a})],2)}),0)}),0)])])},nc=[],rc=T(sc,ac,nc,!1,null,"f2c5d8b8",null,null);const ca=rc.exports,oc=D({});var ic=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"content"},[t("div",{staticClass:"content-body"},[e._t("default")],2)])},uc=[],cc=T(oc,ic,uc,!1,null,"36529ddc",null,null);const St=cc.exports,It="data:image/jpeg;base64,/9j/4AAQSkZJRgABAgAAZABkAAD/7AARRHVja3kAAQAEAAAAZAAA/+4ADkFkb2JlAGTAAAAAAf/bAIQAAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQICAgICAgICAgICAwMDAwMDAwMDAwEBAQEBAQECAQECAgIBAgIDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMD/8AAEQgAeAB4AwERAAIRAQMRAf/EAHgAAAMAAwEBAQAAAAAAAAAAAAAFBgMEBwIBCgEBAAAAAAAAAAAAAAAAAAAAABAAAQQBAgMFBwEGBgMAAAAAAQIDBAURACExEgZBYSITFFFxgTIjJBVSQmJEVRYmkbFyM0NTkmM1EQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwD9rSenGYCUvdST0VYICk1zATLuHgRkfbJWGoiVDgp5Sd+zQCupEQEqY6cgt1KCkoVPdKZVy+k7EqmLSERQsAHlZSgA9p0GCnr0T1ybe4edFVBUHZz6llUidIV4moEdS1czsqUric+BGVEjbQOK+0fny72/fSllFZRyWK9lsYZges5auvixwAlKUNolK7BzHJxknQQmgNBSxuppPkoh28Zi9goHKhqfzeqYSeIiWCCJcckbDdSR7NBn/DVNt4qGxDMlXCmuFtx5JWf2Ic8csSXzK2SlXlrwN99BOzIUuvfVGmxnor6PmafbU2rHAKHMMKQcbEZB7NBq6A0BoDQGgNB6WtTilLWpS1rJUpayVKUonJUpRJJJPboGNTVv28xMVlSWkJSp6VKc2YhxGhzPyn1EgJbaT3jmOANzoN28tGJPkVtaFtUtbzIiNq2clPHZ+xlYA55MlW4z8iMJAG+Q2EfadIvq+Vy5uWmBniqJVRy8sj931UxI96fdoJfQGgNBRUlUw8h62tSpqlgKAeKTyuz5JHM1XRNjzOunBWR/tt5JI2OgrOqepnmLddY/Agy6yLEgsuVcloFtl4xGnHvSSUBuVFeaLpbCkqHy7g6Cd/GUdvvSzjXTFb/iblxCW1qP/HCtEhLLm5wlLyW1H26BBPrZ9Y96ewiPRHcZSl5BSFp/W0sZbdR+8kkaDS0BoDQGgzR478t9mLGbU9IfcS0y0gZUtxZCUpGcAZJ4nYdugp7aQxTw1dOVzqXXFLQu+ntHwy5Te6YDCsBRgwV7fvuZOANBJaCn6g+3hdOVg/hqhM10HiJFu8uYpKh2FMfyh7ezs0ExoDQOaaoXavuFx0RK+Gj1FlPWCW4sYHBx/wBkh0+FtA3WruBwDlEtN/fUlXEaMWmjzI0aDDzkojl5CpMl/BIcmSEJKnFe3AzgZ0E/cy/X21lN5uZMmdKeQezy1vLLQHclvAHcNAt0D6D1FPiM+jf8qzrT81dZI9THTtjMdSiHojiQThTSk4O+DoN70XT1zvXSxQzVbmvtXS5XrV7ItoE8zXDZL6RknHNoEljVWNS6GbCK7HUoZbWoBTLydjzsPoKmX0YPFCiNAu0BoLMf2pAz8vUlpH8P/ZS1r6cZ4fSsZyD/AKm2j2E7hGaDagxVTZsOGjPPLlMRk44hT7qGgfgVaBp1RKTLv7R1v/aRKVFZxw8iElMNnlxtyltgEaBDoGFZWybaY1CipBWvmW44shLMdhscz0h9w4S2yyjck+4bkDQNbmyjJYbo6gn8VEX5j0gpCXbacByrnPYyQynJSyjJ5UbnfgHrpX6M2dY/yqmtJqM8POVGMOOM+0vy040ExoDQGgYVdbJtprUKKE87mVOOuHlZjsIHM9JkOHZtllG6ifcMkgaDp101VudFt19b5jgr0C2juugh2VHbsF1ciZykkttyHHluJTnAbA29gch0BoM8qS/MkPSpTqnpEhxTrrqzlS1qOSfYB2ADYDYbaDBoKbpIBu2M9QBbqIM+1WCM+KLFc9Px2yZTjfv0E0SVEqUclRJJPEknJJ950GaNGfmPsxYzS3pD7iWmWkDKlrWcJSOAHeTsBudBUWclijhu9P1rqHZL2Bf2LRyH3Un/AOZFWACIUZXzni6vIPhGCEhoKeB9t0xeyTsqfMrKppQ4kIU7YyU5/SRHbz78dugmNAaDI004+62yyhTrrq0ttNoBUtxxaglCEpG5UpRwBoKyxcboYK+n4Sg5Zy+X8/MawrlPFFNHWMnymVHLxHzubcBgA+5kjqpHT+U+T/T46WKs4HmrrS6VYJxn8qrPv30HMiCCQQQQSCCMEEbEEHcEHQfNAaA0FRW/adNX80jC5r1dTML7cKcXYTEjuLUVAPcrQTABUQlIKlKICUgEkknAAA3JJ0Fm4R0nDLDZ/uWewPUuAkKpITyciM2RjlsZKFDzFcWk+EbnOgi9AaCosftumOn4o2VNkWls8nbOPMar4yvbgoirI9+gl9AaCyjAdLQEWDgH9QWTCjWsqAKqqC6Ck2LiT8suSkkMg/KnKj7NAq6bjCd1BVtOnKDMRJkKUScsxeaXIKjud2mVZOgwKtXDdm68Qd/KfkgM7hXqvUhGeG3D2aDY6nipiX9q0jHlLlKlM44eRNCZjPLjbHlPjQIdAaA0FRafa9O9OwR4VyjPupCN8n1DwgxFkcN2IRx79Bswmm+m4TVzLQldzMQV0cJ1IUIjJyn8zJbUeOciOlQ3UOfcDYJJ11x91x55anXXVqcdcWSpbji1FS1qUdypSjknQY9AaCo6t+jYRK7+U1FXXqxw81MZMmQcDgfUSVZ79BL6CppYUaFFV1FatB2Iw4pusgr2FrYIGQlQ4mFFOFOngT4d9xoEE2bJsZT82W4XZEhZccWdtzsEpA2ShCQAkDYAY0D7p37aN1DZnb0dM7FaVtzJlWrrcBop7chpxw7ezQS+gqOofuYfTlmP4qoTCdPaZFQ85DWVH2mOGj8c9ugl9AaD0lKlqShAKlLUEpSOJUo4AHeSdB021hw4E9dnaIS9X0rEOmp69Shm2m10Ztt4KGCfQRpXOXlkYUo8u5JGg55PnSrKW9NmOl2Q+vmWogADsShCR4UNoSAEpGwAxoNPQGgZ0sT19vWQynmTJnRWnBufpKeR5pON8JbyT3DQF1L9fb2cwK5kyZ0p1s7n6Snl+UBnfCW8Adw0GzSVKbF16RLcMapr0CRZS8boazhEdkHZcuUrwNp45OezQY7m2XbSUqS2I0KK2I1dCQfpxIjfyIH6nV/M4s7qUfZgAE+gqD9p0ggfK5c3S1964lTGCB349VNP/joJfQVCPu+kX0/M5TXLT3eiJbRy0oD931UJPxV7tBL6A0Fn0XRuWNi1YvkNVlU8mXJeWPC65FSZSYrWcJWtSWuZe/hbyTxAIJb27l39g7OlHlSSUx46SS3GY5ipLaOGVEnK1YBUok92gTaA0BoKfpT6U+ZY/wApp7SenI284RlRY4O4wfUSk479AnrK2TazWYUVILjpJUtR5WmGkDmdfeXwQy0gEqJ/zxoGt3YxvKZpKkn8TAUVKeI5XLScRyvWDw/QflaSc8iPfgBN6A0FR1J9u3RVYHL6CljOvIxuiXZqXYvhXeEPoHw0EvoKjpr7gXdWd/yVLLLKN/HLruSyj4A4qxFV/joJfQN6apctpK0lxMaFGbMixnOA+TDipPjcV+txXBCB4lq2HaQFc3bIdr752C2qLT1NT+Kq4x+dci5kojuzZCgSFzX46HVKOcJTsO8OdaA0BoDQVdU0tHTl6622pb1lLqaaKlCeZxa1POT320JAKiVJjIGBxzoMti4jp2A5QxVpVaS0p/qCW2QryU7KTSsOJJBS2d5BGyl+HOARoI/QGg3qyGbCxgQU5zLmR45xnZLrqEKUcb4SkknuGg3Oopgn3trKSQW1zHkMkHI8hhXkR8d3ktJ0CXQOOnpggXlXLUQG2prAezw8h1YakA52wWXFaDWtYZr7OwgkEekmSI6cnOUNOqShWe3mQAfjoHFxYxWIyaCnXzV0dwOTJgASu4nIACpCsZIiMqBDCMkAeI5J2D699p0jCb4LuLiTLJGQVRqxhMVtKvan1Elw+8aCX0BoDQGg6WianpjpSsBZULywem2MIOgYgtyEIiIsSgjd8xW8MZ2HmKUeGNBzVSiolSiVKUSpSlEkqJOSSTuSToPmgNBT9J/RsJVkeFPVWNinOw85MdUaKM/q9VJRjvGgmNAaA0FR1X9edDs+P5iprp6yNx6jyRElDOT4hJiqJHHfQS+gqOqPt3Kmrzj8XSwWnUA7JlzEqsZR95XLAP8Ap0EvoDQGgqKWDGixl9Q2zQchRnC1Xwl7G2sUjKWsH+CjHxPL4bcoySRoNjreZIlXDLcpfPIh1ddHkKACUmQ5HE2RyoHhQkPS1AAcAMdmgj9AaA0FRCzE6VuZXBVnYV9S0R83JHC7KUAePKShkH378dBL6A0BoKeX930pUSP2quyn1bm2/lS0t2MYk+wL84D46BXTQvyNtWwcZEqbHaX3NKdT5pOx2S3k/DQe72b+QubOaDlD82QpruYDikMDPA8rKUj4aBToDQO6SpTZPOuynTFqoCBIs5mB9JnOEMtZ2XKlLHI2ncknOCAdBvmUrqS/qobbAj1yZUWBAgJ3biQC+gL5uPO6tGVurOStWe4aBVeS/X3NpMB5kyJ8pxs/+ovKDQ+DQA0CrQGgNBUXP2tJ01X8FuRpdw+McTYSSzGJPtEWGn4K92gl9AaDKww9Jeajx21PPvuJaaaQMrccWQlKUj2knQU9y5HqoKemoim33kSES7qYkhaF2Dbam0Q4x4JZghxSVKG61k8AMEMfSv0JNlZ8PxNNYSm1HHKJTzXoIoOdsl2WCPdoJfQGg3q2uk2sxmDESFOvKPiUeVtptIKnX3l8EMsoBUo+wbZO2gb3djGSy1RVCiaqC4VuSMcq7Wfjkdnugf8AGPlZSSeVvvOwe+ksNWUmwPCpqbSxHe4iKuOwPf6iSjHfjQS+gNAaDI00t51tlsczjriGkJ9q3FBKRtk7qOgoOrXEKvZcdo5YrURqpkDglFbHbiKSBk4HmtKPx0E3oDQWaP7VgB07dSWbH0E7c9LXPJIL6u1uxmoJCB8zbZzsTghGaCojD0nSVk/+3bWsKvSCMfQr21z31A9qS840D3jQS+g9ttrdWhptCnHHFpbbbQkqWtayEoQlIyVKUo4AHE6CunuI6cgO0kZSVW81CfzsttQPpmtlJpmHEk7A4Mgg+JXh3AwAjtBUVuY3TPUMs7GY9WVDKu3xOuT5KR72oiR7joJfQGgNBR9JsocvoLro+hBLtm+TwS3WsOTcnjsVsgfHQIX3lyH3pDp5nH3XHnD7VurK1n4qVoMWgq6eLHrIY6js2kupS4pukgO8LCc380h1HFUCCogq4Ba8Iz2EJyXKkTpL0uU6p6RIcU686s5Upajv3JSBsAMAAYG2g19B/9k=",Za="l",lc=D({props:{imageUrl:String,size:{type:String,default:Za}},components:{},setup(s){const e=l(()=>s.imageUrl??It),t=["xs","s","m","l","xl"],a=l(()=>`avatar-size--${t.includes(s.size)?s.size:Za}`);return{imageSrc:e,sizeClass:a}}});var dc=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"avatar"},[t("img",{staticClass:"avatar-image",class:e.sizeClass,attrs:{src:e.imageSrc}})])},mc=[],_c=T(lc,dc,mc,!1,null,"7a37a121",null,null);const at=_c.exports,pc=D({props:{text:{type:String,default:""},count:{type:Number,default:void 0},isSelected:{type:Boolean}},setup(s,e){return{clickTab:()=>{e.emit("click-tab")}}}});var vc=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"m-text-tab-item",on:{click:e.clickTab}},[t("div",{staticClass:"m-text-tab-item-body c-title c-title--m",class:{"m-selected-tab-item":e.isSelected}},[e._v(" "+e._s(e.text)+" "),e.count!==void 0?t("span",{staticClass:"count c-text c-text--xs"},[e._v(e._s(e.count))]):e._e()])])},fc=[],gc=T(pc,vc,fc,!1,null,null,null,null);const cr=gc.exports;function De(s){return oe(s).isValid()?oe(s).format("YYYY/M/D"):""}const lr=s=>s.format("YYYY/MM/DD H:mm"),hc=s=>s.format("MM/DD H:mm"),yc=s=>s.format("M/D");function la(s){return s?lr(oe(s)):""}function Cc(s){return s?lr(oe(s)):""}function dr(s){if(!s)return"";const e=oe(s),t=e.day();return yc(e)+" ("+Zi[t]+")"}function mr(s){const e=oe().subtract(4,"day");return s.isAfter(e)&&s.isSameOrBefore(oe())}function bc(s){const e=oe(s);return mr(e)?e.fromNow():oe().year()===e.year()?hc(e):la(s)}const Ac=(s,e)=>{const t=["日","月","火","水","木","金","土"][s==null?void 0:s.day()],a=e.year();return a&&(s==null?void 0:s.year())<a?s.format(`YYYY/M/D(${t})`):s==null?void 0:s.format(`M/D(${t})`)};function kc(s,e=!1,t=8){if(!s)return;let a=s;return s.length>t&&(a=s.slice(0,t)+"⋯"),e&&(a+=" (削除済み)"),a}function _r(s){const e=s.map(r=>({id:r.user_id,name:r.user_name,commentId:r.id,commentDate:r.created_at})),t=xc(e);let a=[];return t.length<=ct?a=t:(a=t.slice(0,ct),a.push({id:-1,name:"他"+Number(t.length-ct)+"名",commentId:void 0})),a.map(r=>r.id!==-1?`<a href="/#/comments/${r.commentId}">・${r.name}</a>`:r.name).join(`
`)}function da(s,e="marks"){const t=s.map(o=>({id:o.user_id??o.id,name:o.user_name??o.name})),a=vr(t);let n=[];return a.length<=ct?n=a:(n=a.slice(0,ct),n.push({id:-1,name:"他"+Number(a.length-ct)+"名"})),n.map(o=>o.id!==-1?`<a href="/#/users/${o.id}/${e}">・${o.name}</a>`:o.name).join(`
`)}function pr(s){const e=(s??[]).map(r=>({id:r.group_id,name:r.group_name})),t=vr(e);let a=[];return t.length<=ct?a=t:(a=t.slice(0,ct),a.push({id:-1,name:"他"+Number(t.length-ct)+"名"})),a.map(r=>r.id!==-1?`<a href="/#/groups/${r.id}/marks">・${r.name}</a>`:r.name).join(`
`)}function vr(s){const e=[],t=[];return s.forEach(a=>{e.includes(a.id)||(t.push({id:a.id,name:a.name}),e.push(a.id))}),t}function xc(s){const e=[];return s.forEach(t=>{const a=e.find(n=>n.id===t.id);a?t.commentDate>a.commentDate&&(a.commentId=t.commentId,a.commentDate=t.commentDate):e.push({id:t.id,name:t.name,commentId:t.commentId,commentDate:t.commentDate})}),e}const ft=s=>`<a href="/#/users/${s.user_id}" class="c-title c-title--m">${s.user_name}</a>`,ma=s=>`<a href="${s.url}" target="_blank" class="c-title c-title--m">${s.title}</a>`,wc=s=>`<a href="/#/groups/${s.group_id}" class="c-title c-title--m">${s.group_name}</a>`,fr=s=>`<a href="/#/themes/${s.theme_id}" class="c-title c-title--m">#${s.theme_name}</a>`,Ec=s=>{const e=s.type==="comment_followed_up_comment"?"コメント":"マーク",t=s.article,a=t.comments.slice(-1)[0];return`あなたが${e}した「${ma(t)}」に
            ${ft(a)}さんがコメントしました。`},Fc=s=>{var r;const e=s.comment,t=s.article??((r=s.comment)==null?void 0:r.article),a=(t==null?void 0:t.doc_type)==="research_paper"?"論文":"記事",n=t?`で${a}を共有しました`:"しました";return`${ft(e)}さんが＠メンション${n}。`},Tc=s=>{const e=s.group_invitation;return`${ft(e)}さんがあなたを
            ${wc(e)}に追加しました。`},Dc=s=>{var n;const e=s.parent_comment,t=e.article,a=(n=e.children)==null?void 0:n.slice(-1)[0];return t?`${ft(a)}さんが
    「${ma(t)}」のあなたのコメントに返信しました。`:`${ft(a)}さんがあなたのコメントに返信しました。`},Bc=s=>{const e=s.comment_reaction,t=s.article;return e?t?`${ft(e)}さんが「${ma(t)}」のあなたのコメントに<span class="emoji-reaction">${e.reaction}</span>しました。`:`${ft(e)}さんがあなたのコメントに<span class="emoji-reaction">${e.reaction}</span>しました。`:""},Sc=s=>{const e=s.theme_invitation;return`${ft(e)}さんがあなたにおすすめのテーマを紹介してくれました。
          早速、${fr(e)}を見てみましょう`},Ic=s=>{var t,a;const e={theme_id:(t=s.theme)==null?void 0:t.id,theme_name:(a=s.theme)==null?void 0:a.name};return`${fr(e)}のフィード更新が完了しました。`},Mc=D({components:{Avatar:at,TextTabItem:cr},props:{title:String,detail:String,section:String,avatarImageUrl:String,emptyDetailMessage:String,icon:String,detailIcon:{type:String,required:!1},clickable:Boolean,tabs:Array,alignLeft:Boolean,settingsLink:{type:Object},sectionLink:{type:Object},isOneLine:Boolean,contentWidth:String,headerWidth:{type:String,default:"948px"},isIconDirectionReverse:{type:Boolean,default:!1},iconTooltipContent:{type:String,default:""}},setup(){const s=l(()=>ie()),e=(a,n)=>{const r=a??{},o=n??{},i=Object.keys(r);return i.filter(u=>String(r[u])===String(o[u])).length===i.length};return{formatDate:De,isSelected:a=>typeof a=="string"?s.value.path==a:s.value.name===a.name&&e(s.value.params,a.params)}}});var $c=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"header-wrap"},[t("div",{staticClass:"header",class:{"no-tab":!e.tabs},style:{"--header-width":e.headerWidth}},[t("div",{staticClass:"header-content-wrap",class:{"align-center":!e.alignLeft}},[t("div",{staticClass:"header-content",style:{"--header-content-width":e.contentWidth}},[t("div",{staticClass:"info-wrapper"},[e.avatarImageUrl?t("Avatar",{staticClass:"avatar-image",attrs:{imageUrl:e.avatarImageUrl,size:"l"}}):e._e(),t("div",{staticClass:"info"},[e.section?t("div",{staticClass:"section"},[e.sectionLink?t("router-link",{staticClass:"section-content link c-text c-text--m",attrs:{to:e.sectionLink}},[e._v(e._s(e.section))]):t("div",{staticClass:"section-content c-text c-text--m"},[e._v(" "+e._s(e.section)+" ")])],1):e._e(),t("div",{staticClass:"title"},[t("div",{staticClass:"title-content",class:{clickable:e.clickable,"title-icon-direction-reverse":e.isIconDirectionReverse}},[e.icon?t("sm-icons",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:e.iconTooltipContent!==""?{content:e.iconTooltipContent,delay:{show:300},offset:8,autoHide:!1}:void 0,expression:`
                      iconTooltipContent !== ''
                        ? {
                            content: iconTooltipContent,
                            delay: { show: 300 },
                            offset: 8,
                            autoHide: false
                          }
                        : undefined
                    `,modifiers:{top:!0}}]},[e._v(e._s(e.icon))]):e._e(),t("div",{staticClass:"text c-title c-title--l",on:{click:function(a){return e.$emit("click-info")}}},[e._v(" "+e._s(e.title)+" ")]),e.isOneLine?t("div",{staticClass:"detail c-text c-text--m"},[e.detail?t("div",{staticClass:"detail-content"},[e._v(" ・"+e._s(e.detail)+" ")]):e._e()]):e._e()],1),e._t("titleMenu")],2),e.isOneLine?e._e():t("div",{staticClass:"detail c-text c-text--s",class:{clickable:e.clickable},on:{click:function(a){return e.$emit("click-info")}}},[e.detail?t("div",{staticClass:"detail-content"},[e.detailIcon?t("sm-icons",{staticClass:"detail-icon small"},[e._v(e._s(e.detailIcon))]):e._e(),e._v(e._s(e.detail)+" "),e.settingsLink?t("div",{staticClass:"settings-link"},[t("router-link",{attrs:{to:e.settingsLink}},[e._v("設定")])],1):e._e()],1):t("div",{staticClass:"empty-detail"},[e._v(e._s(e.emptyDetailMessage))])])])],1),e._t("button")],2)])]),e.tabs?t("div",{staticClass:"tab-list-wrap"},[t("div",{staticClass:"m-type-tab-list"},e._l(e.tabs,function(a){return t("div",{key:a.name,style:{"margin-top":"-4px"}},[t("router-link",{attrs:{to:a.linkTo}},[t("TextTabItem",{attrs:{text:a.name,count:a.count,isSelected:e.isSelected(a.linkTo)}})],1)],1)}),0)]):e._e()])},Pc=[],Nc=T(Mc,$c,Pc,!1,null,"8051b959",null,null);const Se=Nc.exports,be={VALIDATING:"VALIDATING",PENDING:"PENDING",SUCCESS:"SUCCESS",ERROR:"ERROR",STALE_IF_ERROR:"STALE_IF_ERROR"},gr=(s,e,t)=>{const a=g("idle");return zo(()=>{if(s.value&&t.value){a.value=be.VALIDATING;return}if(s.value&&e.value){a.value=be.STALE_IF_ERROR;return}if(s.value===void 0&&!e.value){a.value=be.PENDING;return}if(s.value&&!e.value){a.value=be.SUCCESS;return}if(s.value===void 0&&e){a.value=be.ERROR;return}}),{state:a}},_a={refreshInterval:0,ttl:0,shouldRetryOnError:!1,revalidateOnFocus:!1},Ze=10,hr=async s=>{const{data:e}=await Q.get(s);return e},he=s=>{const e=ta(s,hr,_a),t=gr(e.data,e.error,e.isValidating);return{...e,...t}},Lc=(s,e)=>{const n=ta(()=>Q.getUri({url:s,params:e.value}),async()=>{const{data:o}=await Q.post(s,e.value);return o},_a),r=gr(n.data,n.error,n.isValidating);return{...n,...r}},en=new Wo,Uc=s=>{const{data:e,error:t,isValidating:a,mutate:n}=ta(s,hr,{..._a,cache:en});return{data:typeof s=="function"?l(()=>{const o=e.value,i=s();if(!(!i||typeof i=="string"&&!en.get(i)))return o}):e,error:t,isValidating:a,mutate:n}},xe=s=>{const e=(s==null?void 0:s.value)??N.getUserId();return he(()=>`/users/${e}`)},yr=(s,e=Ze)=>{const t=N.getUserId();return he(()=>{const n={page:s.value,limit:e,order:"desc",include_research_paper:!0};return`/users/${t}/notifications/${qn}?${Ne.stringify(n,{arrayFormat:"brackets"})}`})},nt=s=>{const e=N.getUserId();return he(()=>`/users/${e}/themes${s?`?feed_type=${s.value}`:""}`)},Pe=()=>{const s=N.getUserId();return he(()=>`/users/${s}/groups`)},Qe=()=>{const s=N.getTeamId();return he(()=>`/teams/${s}/users`)},et=()=>{const s=N.getTeamId();return he(()=>`/teams/${s}`)},Rc=s=>he(()=>`/groups/${s.value}/users`),Oc=(s,e,t=Ze)=>he(()=>{if(s.value===void 0)return;const n={page:e.value,limit:t,order:"desc",include_research_paper:!0};return`/groups/${s.value}/comments?${Ne.stringify(n,{arrayFormat:"brackets"})}`}),tn=(s,e,t=Ze,a,n)=>he(()=>{const o={page:e.value,limit:t,order:"desc",memo_exists:a.value!=="all"?a.value:void 0,tags:n.value.items.length>0?n.value.items:void 0,include_research_paper:!0};return`/groups/${s.value}/marked_articles?${Ne.stringify(o,{arrayFormat:"brackets"})}`}),Gc=s=>he(()=>`/comments/${s.value}`),Cr=(s,e)=>he(()=>`/${e}s/${s}`),qc=s=>he(()=>`/groups/${s}/tags`),br=(s,e=Ze)=>{const t=N.getTeamId();return he(()=>`/teams/${t}/featured_articles?limit=${e}&page=${s.value}&order=desc`)},Hc=(s,e,t=Ze)=>he(()=>`/themes/${s}/featured_articles?limit=${t}&page=${e.value}&order=desc`),Ar=s=>{const e=N.getTeamId();return he(()=>{if(s.value===void 0)return null;const a={industry_id:s.value};return`/teams/${e}/industry_articles?${Ne.stringify(a)}`})},kr=()=>he(()=>"/industries"),Vc=()=>{const s=N.getUserId();return he(()=>`/users/${s}/tags`)},jc=()=>{const s=N.getTeamId();return he(()=>`/admin/teams/${s}/mail_delivery_schedules`)},xr=(s,e=Ze,t=void 0,a=void 0,n=[])=>{const r=N.getTeamId();return he(()=>{const i={page:s.value,limit:e,order:"desc",filter_scope:t,feed_type:a,user_ids:n.length>0?n:void 0,include_technical_literature:!0};return`/teams/${r}/marked_articles?${Ne.stringify(i,{arrayFormat:"brackets"})}`})},Kc=(s,e)=>{const t=N.getTeamId();return he(()=>{if(s.value===0)return null;const n={page:0,limit:s.value,order:"desc",filter_scope:!0,feed_type:e.value==="all"?void 0:e.value,user_ids:void 0,include_technical_literature:!0,sort:"recommended"};return`/teams/${t}/marked_articles?${Ne.stringify(n,{arrayFormat:"brackets"})}`})},Yc=s=>he(()=>`/themes/${s}/users`),Ms=(s,e=g(Ze),t)=>{const a=N.getUserId();return he(()=>{const r={page:s.value,limit:e.value,feed_type:t.value};return`/users/${a}/personal_feeds?${Ne.stringify(r)}`})},$s=(s,e,t,a,n=Ze)=>{const r={feed_type:e.value,date:t?oe(t.value).format("YYYY-MM-DD"):void 0,page:a?a.value:void 0,limit:n};return he(()=>`/themes/${s}/keyword_feeds?${Ne.stringify(r)}`)},Ps=(s,e,t,a,n=Ze)=>{const r={feed_type:e.value,date:t?oe(t.value).format("YYYY-MM-DD"):void 0,page:a?a.value:void 0,limit:n};return he(()=>`/themes/${s}/related_feeds?${Ne.stringify(r)}`)},sn=(s,e,t,a,n=Ze)=>{const r={feed_type:t,page:a?a.value:void 0,limit:n};return he(()=>s.value==="all"||s.value===t?`/themes/${e}/research_paper_feeds?${Ne.stringify(r)}`:void 0)},Qc=(s,e,t,a,n=Ze)=>{const r={feed_type:t,page:a?a.value:void 0,limit:n};return he(()=>s.value==="all"||s.value===t?`/themes/${e}/patent_feeds?${Ne.stringify(r)}`:void 0)},pa=s=>he(()=>`/themes/${s}`),Wc=()=>{const s=N.getTeamId();return he(()=>`/admin/teams/${s}/groups`)},zc=()=>{const s=N.getTeamId();return he(()=>`/teams/${s}/user_mark_counts`)},jt=()=>{const s=N.getTeamId();return he(()=>`/admin/teams/${s}/users`)},bt=()=>he(()=>"/admin/management_contracts"),Jc=s=>he(()=>s.value?`/admin/management_contracts/${s.value}`:null),wr=s=>he(()=>s.value?`/admin/management_contracts/${s.value}/managing_users`:null),Xc=(s,e=Ze)=>{const t=N.getUserId();return he(()=>{const n={page:s.value,limit:e,include_technical_literature:!0};return`/users/${t}/views?${Ne.stringify(n,{arrayFormat:"brackets"})}`})},va=()=>{const s=N.getUserId();return he(()=>`/users/${s}/settings`)},Zc=()=>{const s=N.getTeamId();return he(()=>`/admin/teams/${s}/themes`)},Er=()=>he(()=>"/job_types"),el=()=>he(()=>"/theme_topic_categories"),tl=()=>he(()=>"/theme_perspectives"),an=(s,e,t,a,n=Ze)=>{const r={feed_type:t,page:a?a.value:void 0,limit:n};return he(()=>s.value==="all"||s.value===t?`/users/${e}/personal_research_paper_feeds?${Ne.stringify(r)}`:void 0)},sl=(s,e)=>Uc(()=>{if(s.value.trim()==="")return null;const a=new URLSearchParams;return a.set("query",s.value),e&&a.set("min_score",String(e)),`/keyword_recommendation?${a}`}),al=s=>Lc("/keyword_completion",s),nl=D({components:{Header:Se,AdminContent:St,AdminBaseTable:ca},setup(){const s=Te(),{data:e,state:t}=bt(),a=l(()=>{var o;return((o=e.value)==null?void 0:o.management_contracts)??[]});Z(a,o=>{t.value==="SUCCESS"&&o.length===0&&s.push({name:"themeAdmin"})},{immediate:!0});const n=[{name:"contractName",displayName:"契約名",isSortable:!0,type:"string",minWidth:300,fieldPosition:"left",cellPosition:"left"},{name:"currentAccountCount",displayName:"アカウント数",isSortable:!0,type:"number",fieldPosition:"center",cellPosition:"right"},{name:"managingUsersCount",displayName:"契約管理者数",isSortable:!0,type:"number",fieldPosition:"center",cellPosition:"right"},{name:"endDate",displayName:"期限",isSortable:!0,type:"date",fieldPosition:"left",cellPosition:"left"}];return{items:l(()=>a.value.map(o=>({contractName:o.contract_name,maxAccount:o.max_account,currentAccountCount:o.current_account_count,managingUsersCount:o.managing_users_count,formattedEndDate:De(o.end_date),endDate:new Date(o.end_date),id:o.id}))),fields:n}}});var rl=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"contract-admin"},[t("Header",{attrs:{title:"契約管理",headerWidth:"100%"}}),t("AdminContent",[t("div",[t("div",{staticClass:"title"},[t("span",{staticClass:"c-title c-title--m"},[e._v("契約一覧")]),t("span",{staticClass:"count c-text c-text--s"},[e._v("・"+e._s(e.items.length)+"件")])]),t("div",{staticClass:"spacing-16"}),t("AdminBaseTable",{attrs:{items:e.items,fields:e.fields},scopedSlots:e._u([{key:"cell-0",fn:function({item:a}){return[t("div",{directives:[{name:"tooltip",rawName:"v-tooltip",value:a.contractName,expression:"item.contractName"}],staticClass:"contract-name-cell"},[e._v(" "+e._s(a.contractName)+" ")])]}},{key:"cell-1",fn:function({item:a}){return[e._v(" "+e._s(a.currentAccountCount)+" / "+e._s(a.maxAccount)+" ")]}},{key:"cell-2",fn:function({item:a}){return[t("router-link",{staticClass:"member-page-link",attrs:{to:`contracts/${a.id}/members`}},[e._v(e._s(a.managingUsersCount))])]}},{key:"cell-3",fn:function({item:a}){return[e._v(" "+e._s(a.formattedEndDate)+" ")]}}])})],1)])],1)},ol=[],il=T(nl,rl,ol,!1,null,"5495a7ac",null,null);const ul=il.exports,is=s=>{if(s!=null&&s.id)return[{name:"マーク",linkTo:{name:"userMarks",params:{userId:s.id}}},{name:"コメント",linkTo:{name:"userComments",params:{userId:s.id}}},{name:"閲覧",linkTo:{name:"userViews",params:{userId:s.id}}}]},Mt=async()=>{let s=Rt.state.userInfo.userInfo;if(!s||!s.role){const e=N.getUserId();s=await F.fetchUserInfo(e),Rt.commit("userInfo/setUserInfo",s)}(!s||s.role!=="admin")&&(Et.push({name:"anewsHome"}),Rt.commit("snackbar/addMessages",{message:"権限がありません",type:"error"}))},cl=D({components:{Header:Se,AdminContent:St,AdminBaseTable:ca,Avatar:at},setup(){const s=ie(),e=se(),t=fe(),a=l(()=>Number(s.params.contractId)),{data:n}=Jc(a),r=l(()=>{var v,f;return((f=(v=n.value)==null?void 0:v.management_contract)==null?void 0:f.contract_name)??""}),{data:o,mutate:i}=wr(a),u=l(()=>{var v;return((v=o.value)==null?void 0:v.users)??[]}),c=[{name:"name",displayName:"名前",isSortable:!0,type:"string",minWidth:300,fieldPosition:"left",cellPosition:"left"},{name:"action",displayName:"",isSortable:!1,type:"string",fieldPosition:"center",cellPosition:"center"}],p=l(()=>u.value.map(v=>({imageUrl:v.image_url,name:v.user_name,email:v.email,id:v.id}))),m=g(void 0),d=()=>m.value=void 0;Xe(()=>document.removeEventListener("click",d)),ne(()=>{Mt(),document.addEventListener("click",d)});const _=async v=>{try{await F.deleteManagementContractManagingUser(a.value,v.id),i(),e.commit("snackbar/addMessages",{message:"メンバーを解除しました",type:""})}catch(f){throw e.commit("snackbar/addMessages",{message:"解除できませんでした",type:"error"}),f}},h=()=>{e.commit("modal/showModal","addContractUser")};return t.$on("contract-member-added",()=>{i()}),{users:u,fields:c,items:p,actionMenuItem:m,contractName:r,deleteManagingUser:_,openAddUserModal:h}}});var ll=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"contract-admin"},[t("Header",{attrs:{title:"契約管理",headerWidth:"100%"}}),t("AdminContent",[t("div",{staticClass:"contract-content"},[t("div",{staticClass:"members"},[t("div",{staticClass:"header"},[t("div",[t("span",{staticClass:"c-title c-title--m"},[e._v(e._s(e.contractName))]),t("span",{staticClass:"contract-managing-user-count c-text c-text--s"},[e._v(" ・"+e._s(e.users.length)+"名 ")])]),t("button",{staticClass:"add-member-button c-btn--small c-btn--auto c-btn--AnewsPrimary c-text c-text--m",on:{click:e.openAddUserModal}},[e._v(" メンバー追加 ")])]),t("div",{staticClass:"spacing-16"}),t("AdminBaseTable",{staticClass:"contract-managing-user-table",attrs:{fields:e.fields,items:e.items},scopedSlots:e._u([{key:"cell-0",fn:function({item:a}){return[t("div",{staticClass:"contract-managing-user-name"},[t("Avatar",{staticClass:"user-avatar",attrs:{imageUrl:a.imageUrl,size:"xs"}}),t("div",[t("div",{staticClass:"name"},[t("span",{staticClass:"c-text c-text--m"},[e._v(e._s(a.name))])]),t("div",{staticClass:"email"},[t("span",{staticClass:"c-text c-text--s"},[e._v(e._s(a.email))])])])],1)]}},{key:"cell-1",fn:function({item:a}){return[t("div",{staticClass:"actions"},[t("div",{staticClass:"action-icon",on:{click:function(n){n.stopPropagation(),e.actionMenuItem=a}}},[t("sm-icons",[e._v("ellipsis-h")])],1),e.actionMenuItem===a?t("div",{staticClass:"action-menu"},[t("div",{staticClass:"item-container"},[t("div",{staticClass:"item c-text c-text--m",on:{click:function(n){return e.deleteManagingUser(a)}}},[e._v(" 解除 ")])])]):e._e()])]}}])})],1)])])],1)},dl=[],ml=T(cl,ll,dl,!1,null,"e94cbc18",null,null);const _l=ml.exports,pl="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGwAAABsCAYAAACPZlfNAAAACXBIWXMAACE4AAAhOAFFljFgAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAjvSURBVHgB7d0NcBTlGQfw/7O3d4R8IAEUhNLAiEW+CxxWqGLKDJY6HQoUtFPrR5AZwCl2WlqUr3JaqdDaqSUW22hIaAEZU4RShkIVaBVkKAQa1Di0jVEriCTkg5Dvu336XJy2Vkmyt3t32Te+v5njjux7e3v733333X33dgFN0zRN0zRN0zRN0zRN6xKEbuTuu/en1VK/60zDmmYZGAHGYAL1APiyPL9hRfgVGOE3dxVOfhuK6haBzZx/OMPHgRyQsQjMIzoqy+CwlNlDEXPFzt9OfBOKUT6w2TnHpgHGNnnZHzEzClqbeNme54KVUISygWVnHzIzh6aH5OVKuPOOwZHpOwpv+gcUYEBRmUPSHmPGCriXZZFxcPaC4hFQgJJr2Jz5f13KTE8gruht83LK8KKi0S3wMOXWsJn3vDoeTPFYsz6Gh4TTmjbB45Rbw2blHN8uE30nEsQwMGFH/qRTsbzn81O3Xm/6wrNg8VeYMF6mL0P+LA0Zeo1hHbCMyHOnDi54B3GgVGBzco5OsGAek4k2kSCyXdyxqzA4T2YN2yhOE7M3L5M3PUSEzHbHCaonWKvO1rXkvV+8sAEuKFUlMvsWJTKsKIMwY85dxwZ1Vm74F/Mzgtm/KSLwuo7CipIyafLvzwel99iMefN8cDN9UIlB45Bgslqlkd8MdlauV8BcD1hfRywIc4OVXy2AC8oEln1feYo0NjqdkfHAbN3Y0fCJU/NvY+bFcDbybwSnFtwOh5QJrK+vUvaTOCnTK58yrMMChvETOOeXmmItHFImsHDESEeyMPVpb9AXsp/5jBxIdls1jxs/PX8gHFBnG0YtyduhNRBpb1Cr5Z8C98hsNafBAWUCY+rxLySLhffaG2QaNBTx+AjmwXBAmcB2b5pwTp5qkBR0vL0h0tiIzzwjtuCAWs16xkEkgY98p9HuJPB7iAfGW3BAqcDIwF4kHJWV+yPtrmGtPiO60Ng5CtKhsK/pVTigVGCXTPqdPMXlmFx7ZB8stzgv2Nre8JKD956Vtew03PlbycHFZ+FATId5xkx5dqplhadKszahh4fac/50MRp79600/YGsjw8z5Khtj57p6NkzDY4xX/DXT3qqs2JkST8cYZc8/HCCeRkcsnXwd8zNGzMR8efLJ82Gx6WmZWDAwCEwfLEvUwaMGTsKJu63UzZ4a+FmmXv3IEZyNP/p4kP3PQCHbFWJFPZ9X4Wwohrq61BT7eAUDQNr7YYVdeKa1PmyIStCLJhfuNwSeQgu2ArMAt0FhdRWV8RQWio4xk935k9ahVgU3REJNFfdK2/+riRR3/FHoIosXn7iLzlzzxy5vw4u2Ko3pN78LBQSiYRtlZNuj1ZZZJeMHRx8Zidid/To9xrl6ckpU57d2eI375QRTpfwxsiY+8naVEcwTkoH5j6fhV3HXs6Jy0k+9rZhk/NcN2OTbdgN4zsaHE10rwnf8qKCCaVQSJe09roES9UHS7rs6eUwUeGeguBJKKjbBtbqb8ryhwODLMs0TW6syqBBZYWFQ5uguG4b2J68W96Vp3fRzSh7IumnlQ5MMQmrEocNzURmZgrcqqpuQll5NbQPJSywxfdPxPRp7vv6XjxUjqUrX4L2IV0lKqbbthKXPMJx3dmXnmY0NzejtrYal2rdV9FEZFnMZ2TEuyOtTY+/VBSstfO+hAV2/NQ5tIavfC5L9s1ZSE39X8/ExapGHDtx5e6h0r9fhBfIDEZKSoo8roXfNFFVVdkWolPRUw3kMNMIGfEIM9Dz1ttml3ztTzvHXejsfQkLbPuO0rbHFYcVzMbI4f3++/8LFfV4OHQIqujT92o0NDagsaEecXKTr6e5QJ5/3FlBvQ1zKD29F+LJIl5op5wOzKFAoAfiiZhsnfamA/MKstdzogNTjA5MMTowxejAFKMDU4wOTDE6MMXowBSjA1OMDkwxOjDF6MAUowNTjA5MMV1yTsej6175v1MEGhpbodnTJYGVnlHmmsieo6tEj2C2d2UCHZhHEMHWLzN1YB5BxLYuZ6ED8whmKrFTTgfmFRYO2ynWTQNT62Lh0t6oMcL1v7dT1m5gH0AhKW6uhtMFiLFpb9GN5+2UtRUYE+VCIf0HXg+FVEcs82d2C9sKzAyYv5TlYB8UcHX/oRg8ZCwSjZ1d7vCT4yEsfXH7Defslo+psh8zJX8yrPAtsoeXijgikXXdhNVEzjc+RAZ69xmAqzKvRTJculSDD87bns9XxMTr928Z/XAs7/HM1nnJI237Icpccedi5YW2nxy5sG7f1lHLESPvtBIZSl3opKmp2emPw+rku97xxy0jHd3wxzOBSXX4GtTBGb17zZD66Ql5ae/nmIxqabz9wjR49L5to4pkK+AocM9Uid95lCdZjOhlVVX4GW8ZMjEq90Fqvn3e6wMsP2bKEifb9uiFwYwhYKuXBBK9cFi5zOHDsPhkqmH84YUtI9+HS54JLBTiQCXhiExQUm7X4YYcWX/8qVAi7mHWOc9UiaEQRW8ksBsKMHxwdcMbV58NDyE/fiUVu6v7ayXBiQ2rqctucOqpwHJXUIU0PtbDw6TKjmm/Kd48d/A3koI8eXK9cU6QIxvW0AF0Ic8FtnEZnYcPP4DXECrCHPtVtOPNk90ruatoq+y3PA8Pkb2mtU+HyNHtN+LJs/1hPmChNJ//CQ+Q7eq2DWuwAR7g2cCeDFGN7EFPl1ajrX6iRJGw9siEPGjzrrMJ5/mu2SUhHildEHtlQrOQZLKG/7mlEbPy1pOtC3clg+dPEcgNUanJyJbFO9nbj19zAHO9FFaUMic/PBDidNOHjZaFb1ECp1tGXCcLx49y10QP7HqjGvwo5W5t/+0Qf1O2K9Eu9QGIN8IBtGBh7mNUBo9SLrCo+es5I7UJ82X5/6F8gz5wS3oJZFVaLQd0k3IHQDeUDOw/5Ai/UWnhy+zDYtkYf0n+ZOvWwdx2KgXeksfz0pmzbcNKeh2KUDqwj1oU4msCJoaxhc+RhbESymD5cldJMtGGVYOkVCGvyhFGSdjAG2YfnI32Z0HTNE3TNE3TNE3TNE3TNDv+DeJtrP2KYPoeAAAAAElFTkSuQmCC",vl=D({props:{title:{type:String,default:""},description:{type:String,default:""},enabled:{type:Boolean,default:!1},logoImageName:{type:String,default:""},alignToTop:{type:Boolean,default:!1}},setup(){return{logoSrc:pl}}});var fl=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"m-setting-toggle-card",class:{"align-top":e.alignToTop}},[t("sm-checkbox-label",{staticClass:"o-checkbox-label",attrs:{value:e.enabled},on:{change:()=>e.$emit("toggle")}},[t("div",{staticClass:"m-setting-content"},[e.logoImageName?t("img",{staticClass:"m-logo",attrs:{src:e.logoSrc}}):e._e(),t("div",{staticClass:"m-setting-text"},[t("div",{staticClass:"m-setting-title c-text c-text--m"},[e._v(e._s(e.title))]),t("div",{staticClass:"m-setting-description c-text c-text--s",domProps:{innerHTML:e._s(e.description)}})])])])],1)},gl=[],hl=T(vl,fl,gl,!1,null,"7b329e7f",null,null);const fa=hl.exports,yl=D({components:{SettingToggleCard:fa},model:{prop:"settings",event:"update-settings"},props:{settings:{type:Object},title:{type:String},desc:{type:String},helpLink:{type:String},hasBorder:{type:Boolean,default:!0}},setup(s,e){const t=fe(),a=g(!1),n=g(!1),r=g(""),o=g(!1),i=g(!1),u=g(!1),c=g(!1),p=g(!1),m=/^(https:\/\/.*\.office.com\/).+/,d=l(()=>m.test(r.value)),_=l(()=>{var w,x;return((w=s.settings)==null?void 0:w.type)==="team"&&(o.value||i.value||c.value||u.value)||((x=s.settings)==null?void 0:x.type)==="group"&&(u.value||c.value)}),h=l(()=>d.value&&_.value||!n.value),v=l(()=>{var w;return(w=s.settings)==null?void 0:w.settings}),f=()=>{p.value=!1};ne(()=>{var w;C(),((w=v.value)==null?void 0:w.enabled_ms_teams_notification)!==void 0&&(a.value=!0),t.$el.addEventListener("click",f)}),Xe(()=>{t.$el.removeEventListener("click",f)}),Z(()=>s.settings,()=>{C(),a.value=!0});const C=()=>{var w,x,B,$,P,M;r.value=((w=v.value)==null?void 0:w.webhook_url)??"",n.value=((x=v.value)==null?void 0:x.enabled_ms_teams_notification)??!1,o.value=((B=v.value)==null?void 0:B.enabled_team_activity_content)??!1,i.value=(($=v.value)==null?void 0:$.enabled_mark_content)??!1,u.value=((P=v.value)==null?void 0:P.enabled_comment_content)??!1,c.value=((M=v.value)==null?void 0:M.enabled_group_mark_content)??!1},y=g(null);Z(()=>n.value,()=>{n.value&&ze(()=>{y.value.focus()})});const A=()=>{n.value=!n.value,I()},k=()=>{o.value=!o.value,I()},S=()=>{i.value=!i.value,I()},b=()=>{u.value=!u.value,I()},U=()=>{c.value=!c.value,I()},I=()=>{var w,x,B;e.emit("update-settings",{submittable:h,type:(w=s.settings)==null?void 0:w.type,settings:{webhook_url:r.value,enabled_ms_teams_notification:n.value,enabled_team_activity_content:((x=s.settings)==null?void 0:x.type)==="team"?o.value:void 0,enabled_mark_content:((B=s.settings)==null?void 0:B.type)==="team"?i.value:void 0,enabled_group_mark_content:c.value,enabled_comment_content:u.value}})};return{initialized:a,isEnabledTeamsNotification:n,isEnabledWeeklyHighlight:o,isEnabledMarkedArticle:i,isEnabledComment:u,isEnabledGroupMark:c,isSubmittable:h,webhookUrl:r,isValidWebhookUrl:d,isValidCheckStatus:_,webhookUrlInput:y,toggleEnabledTeamsNotification:A,toggleEnabledWeeklyHighlight:k,toggleEnabledMarkedArticle:S,toggleEnabledComment:b,toggleEnabledGroupMark:U,updateSettings:I,isTooltipVisible:p,tooltipContent:`Web hook URLに関しては
<a href="${s.helpLink}" target="_blank">Webhook URLの取得方法</a>をご覧ください。`}}});var Cl=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"ms-teams-settings-card",class:{border:e.hasBorder}},[t("SettingToggleCard",{staticClass:"o-teams-toggle-card",attrs:{title:e.title,description:e.desc,enabled:e.isEnabledTeamsNotification,logoImageName:"ms-teams-logo.png"},on:{toggle:e.toggleEnabledTeamsNotification}}),t("div",{staticClass:"o-teams-detail-settings"},[t("div",{staticClass:"o-teams-webhook"},[t("div",{staticClass:"o-teams-webhook-title c-formBlock__label c-title c-title--m",class:{disabled:!e.isEnabledTeamsNotification}},[e._v(" Web hook URL（接続するチャネル）"),t("span",{staticClass:"icon",on:{click:function(a){a.stopPropagation(),e.isTooltipVisible=!e.isTooltipVisible}}},[t("sm-icons",{directives:[{name:"tooltip",rawName:"v-tooltip.bottom",value:{content:e.tooltipContent,trigger:"manual",autoHide:!1,show:e.isTooltipVisible},expression:`{
                content: tooltipContent,
                trigger: 'manual',
                autoHide: false,
                show: isTooltipVisible
              }`,modifiers:{bottom:!0}}],staticClass:"small"},[e._v("question-circle")])],1)]),e.isEnabledTeamsNotification&&!e.isValidWebhookUrl?t("div",{staticClass:"o-teams-webhook-error c-formBlock__text c-formBlock__text--error"},[e._v(" Web Hook URLを入力してください。 ")]):e._e(),t("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.webhookUrl,expression:"webhookUrl",modifiers:{trim:!0}}],ref:"webhookUrlInput",staticClass:"o-teams-webhook-input c-textInput",attrs:{type:"text",placeholder:"https://outlook.office.com/webhook/...",disabled:!e.isEnabledTeamsNotification},domProps:{value:e.webhookUrl},on:{input:[function(a){a.target.composing||(e.webhookUrl=a.target.value.trim())},e.updateSettings],blur:function(a){return e.$forceUpdate()}}})]),t("div",{staticClass:"o-teams-contents"},[t("div",{staticClass:"o-temas-contents-title c-formBlock__label c-title c-title--m",class:{disabled:!e.isEnabledTeamsNotification}},[e._v(" 配信するコンテンツ ")]),e.isEnabledTeamsNotification&&!e.isValidCheckStatus?t("div",{staticClass:"o-teams-checkbox-error c-formBlock__text c-formBlock__text--error"},[e._v(" 1つ以上選択してください。 ")]):e._e(),e.settings&&e.settings.type==="team"?t("div",[t("sm-checkbox-label",{staticClass:"o-checkbox-label",attrs:{value:e.isEnabledWeeklyHighlight,disabled:!e.isEnabledTeamsNotification},on:{change:e.toggleEnabledWeeklyHighlight}},[e._v("先週のハイライト（毎週1回）")]),t("div",{staticClass:"o-checkbox-desc c-text c-text--s"},[e._v(" コメントやマーク・グループマークされたニュースをランキング形式で配信します。 ")]),t("sm-checkbox-label",{staticClass:"o-checkbox-label",attrs:{value:e.isEnabledMarkedArticle,disabled:!e.isEnabledTeamsNotification},on:{change:e.toggleEnabledMarkedArticle}},[e._v("マークした記事（随時）")]),t("div",{staticClass:"o-checkbox-desc c-text c-text--s"},[e._v(" マークした記事を配信します。 ")]),t("sm-checkbox-label",{staticClass:"o-checkbox-label",attrs:{value:e.isEnabledGroupMark,disabled:!e.isEnabledTeamsNotification},on:{change:e.toggleEnabledGroupMark}},[e._v("グループマークした記事（随時）")]),t("div",{staticClass:"o-checkbox-desc c-text c-text--s"},[e._v(" 「全体・つぶやき」にグループマークした記事を配信します。 ")]),t("sm-checkbox-label",{staticClass:"o-checkbox-label",attrs:{value:e.isEnabledComment,disabled:!e.isEnabledTeamsNotification},on:{change:e.toggleEnabledComment}},[e._v("コメントした記事（随時）")]),t("div",{staticClass:"o-checkbox-desc c-text c-text--s"},[e._v(" 「全体・つぶやき」にコメントした記事とコメント内容を配信します。 ")])],1):e.settings&&e.settings.type==="group"?t("div",[t("sm-checkbox-label",{staticClass:"o-checkbox-label",attrs:{value:e.isEnabledComment,disabled:!e.isEnabledTeamsNotification},on:{change:e.toggleEnabledComment}},[e._v("コメント（随時）")]),t("div",{staticClass:"o-checkbox-desc c-text c-text--s"},[e._v(" 投稿されたコメントを配信します。 ")]),t("sm-checkbox-label",{staticClass:"o-checkbox-label",attrs:{value:e.isEnabledGroupMark,disabled:!e.isEnabledTeamsNotification},on:{change:e.toggleEnabledGroupMark}},[e._v("グループマーク（随時）")]),t("div",{staticClass:"o-checkbox-desc c-text c-text--s"},[e._v(" グループマークした記事を配信します。 ")])],1):e._e()])])],1)},bl=[],Al=T(yl,Cl,bl,!1,null,"7a4119ac",null,null);const Fr=Al.exports,kl=D({props:{},components:{},setup(){}});var xl=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"content"},[t("div",{staticClass:"content-body"},[e._t("default")],2)])},wl=[],El=T(kl,xl,wl,!1,null,"ca45103f",null,null);const Ue=El.exports,Fl=D({components:{Header:Se,Content:Ue,MSTeamsSettingsCard:Fr},setup(){const s=se(),e=g(!1),t=g({}),{data:a}=et(),{data:n,state:r}=jc(),o=l(()=>{var d;return(d=a.value)==null?void 0:d.enable_technical_literature}),i=l(()=>[{scheduledNotificationType:"favorite_theme_mail",name:o.value?"新着ニュース ・新着論文":"新着ニュース",labels:["7時","8時","9時","10時"],values:["07:00","08:00","09:00","10:00"],selectedValue:"08:00"},{scheduledNotificationType:"team_activity_mail",name:"先週のハイライト",labels:["7時","8時","9時","10時"],values:["07:00","08:00","09:00","10:00"],selectedValue:"08:00"},{scheduledNotificationType:"overlooked_mail",name:"本日の読み逃しニュース",labels:["16時","17時","18時"],values:["16:00","17:00","18:00"],selectedValue:"17:00"}]),u=d=>{if(n.value){const _=n.value.mail_delivery_schedules.find(h=>h.scheduled_notification_type===d.scheduledNotificationType);if(_){d.selectedValue=_.deliver_at;const h=d.values.findIndex(v=>v===_.deliver_at)??0;return d.labels[h]}}};ne(async()=>{Mt(),await c(),e.value=!0});const c=async()=>{var d;try{const _=await F.fetchMSTeamsSettings();t.value={settings:_,submittable:!0,type:"team"}}catch(_){if(Je(_)&&((d=_.response)==null?void 0:d.status)===404){t.value={settings:{webhook_url:"",enabled_ms_teams_notification:!1,enabled_team_activity_content:!1,enabled_mark_content:!1,enabled_comment_content:!1,enabled_group_mark_content:!1},type:"team",submittable:!0};return}throw _}};return{initialized:e,submit:async()=>{var _,h;const d=i.value.map(v=>({scheduled_notification_type:v.scheduledNotificationType,deliver_at:v.selectedValue}));if(o.value){const v={scheduled_notification_type:"new_technical_literature_mail",deliver_at:((_=i.value.find(f=>f.scheduledNotificationType==="favorite_theme_mail"))==null?void 0:_.selectedValue)??"08:00"};d.push(v)}if(t.value.submittable)try{(h=a.value)!=null&&h.enable_ms_teams_integration&&await F.updateMSTeamsSettings(t.value.settings),await F.updateMailDeliverySchedules(d),s.commit("snackbar/addMessages",{message:"環境設定を更新しました",type:""})}catch{s.commit("snackbar/addMessages",{message:"環境設定を更新できませんでした",type:"error"})}},settings:t,mailDeliveryDisplayItems:i,selectMailSelectbox:(d,_)=>{_.selectedValue=d.value},mailDeliveryScheduleState:r,STATES:be,mailDeliveryScheduleDefaultLabel:u,teamInfo:a}}});var Tl=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"o-service-integrations"},[t("Header",{attrs:{title:"環境設定"}}),t("Content",[t("div",{staticClass:"environment-settings-body"},[e.teamInfo&&e.teamInfo.enable_ms_teams_integration?t("div",{staticClass:"o-integration"},[t("div",{staticClass:"teams-integration"},[t("div",{staticClass:"ennvironment-setting-category-title c-title c-title--s"},[e._v(" Teams連携 ")]),t("MSTeamsSettingsCard",{staticClass:"environment-settings-content",attrs:{title:"Anews全体の情報をTeamsに配信",desc:'Microsoft TeamsのチャネルにAnewsの情報を配信します。<br/>グループ毎に設定する場合は、<a class="doc-link" href="https://anews-stockmark.zendesk.com/hc/ja/articles/4402116895897" target="_blank">こちら</a>をご覧ください。',helpLink:"https://anews-stockmark.zendesk.com/hc/ja/articles/1500000888001",hasBorder:!1},model:{value:e.settings,callback:function(a){e.settings=a},expression:"settings"}})],1),t("div",{staticClass:"spacing-12"})]):e._e(),t("div",{staticClass:"mail-delivery"},[t("div",{staticClass:"ennvironment-setting-category-title c-title c-title--s"},[e._v(" 定期配信メール設定 ")]),t("div",{staticClass:"spacing-12"}),t("div",{staticClass:"c-text c-text--m"},[e._v(" メール配信時間設定を行うことができます ")]),t("div",{staticClass:"spacing-12"}),e.mailDeliveryScheduleState===e.STATES.SUCCESS?t("div",{staticClass:"mail-delivery-content-wap"},e._l(e.mailDeliveryDisplayItems,function(a){return t("div",{key:a.scheduledNotificationType,staticClass:"mail-delivery-content environment-settings-content"},[t("div",{staticClass:"mail-delivery-item"},[t("div",{staticClass:"c-formBlock__label"},[e._v(e._s(a.name))]),t("sm-selectbox",{staticClass:"small mail-delivery-selectbox",attrs:{placeholder:e.mailDeliveryScheduleDefaultLabel(a),labels:a.labels,values:a.values},on:{selected:function(n){return e.selectMailSelectbox(n,a)}}}),t("div",{staticClass:"spacing-12"})],1)])}),0):e._e()]),t("div",{staticClass:"spacing-24"}),t("button",{staticClass:"o-submit-button c-btn c-btn--small c-btn--AnewsPrimary",class:{disabled:!e.settings.submittable},attrs:{disabled:!e.settings.submittable},on:{click:function(a){return a.stopPropagation(),e.submit.apply(null,arguments)}}},[e._v(" 保存 ")])])])],1)},Dl=[],Bl=T(Fl,Tl,Dl,!1,null,"45e73a49",null,null);const Sl=Bl.exports,Il=D({setup(s,e){const t=g("");return Z(()=>t.value,a=>e.emit("onChangeQuery",a)),{query:t}}});var Ml=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"m-search-bar"},[t("sm-icons",{staticClass:"small m-search-icon"},[e._v("search")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.query,expression:"query"}],staticClass:"m-query",attrs:{placeholder:"検索…"},domProps:{value:e.query},on:{input:function(a){a.target.composing||(e.query=a.target.value)}}})],1)},$l=[],Pl=T(Il,Ml,$l,!1,null,"a2b7fd83",null,null);const At=Pl.exports,Nl=D({props:{},components:{Header:Se,AdminContent:St,SearchBar:At,AdminBaseTable:ca},methods:{},setup(){const{data:s}=Wc(),e=se(),t=fe(),a=g(""),n=g(void 0),r=()=>n.value=void 0;Xe(()=>document.removeEventListener("click",r)),ne(async()=>{Mt(),document.addEventListener("click",r)});const o=_=>{a.value=_.toLowerCase()},i=l(()=>{var _;return[...((_=s.value)==null?void 0:_.groups)??[]].filter(h=>h.name.toLowerCase().includes(a.value)||h.description.toLowerCase().includes(a.value)||h.admins.filter(v=>v.user_name.toLowerCase().includes(a.value)).length>0).map(h=>{var v,f;return{id:h.id,name:h.name,description:(h.description??"").length>50?((v=h.description)==null?void 0:v.slice(0,50))+"…":((f=h.description)==null?void 0:f.length)===0?"-":h.description,memberCount:h.member_count,createdAt:new Date(h.created_at),formattedCreatedAt:De(h.created_at),admins:h.admins.map(C=>C.user_name).join(", ")}})}),u=[{name:"name",displayName:"グループ名",isSortable:!0,type:"string",fieldPosition:"left",cellPosition:"left"},{name:"description",displayName:"説明",isSortable:!0,type:"string",fieldPosition:"left",cellPosition:"left"},{name:"memberCount",displayName:"メンバー数",isSortable:!0,type:"number",fieldPosition:"left",cellPosition:"center"},{name:"createdAt",displayName:"作成日",isSortable:!0,type:"date",fieldPosition:"left",cellPosition:"left"},{name:"admins",displayName:"グループ管理者",isSortable:!1,type:"string",fieldPosition:"left",cellPosition:"left"},{name:"actions",displayName:"",isSortable:!1,type:"string",fieldPosition:"center",cellPosition:"center"}],c=async _=>{const h=async()=>{try{await F.deleteGroup(_.id);const C=s.value??{groups:[]};C.groups=[...C.groups.filter(y=>y.id!==_.id)],e.commit("snackbar/addMessages",{message:"グループを削除しました",type:""})}catch{e.commit("snackbar/addMessages",{message:"グループを削除できませんでした",type:"error"})}};let v=`削除したグループは元に戻すことはできません。
本当にグループを削除しますか？`;_.has_theme&&(v=`削除したグループは元に戻すことはできません。
また、このグループを削除するとこのグループで公開範囲を指定しているテーマも一緒に削除されます。
削除したくないテーマは公開範囲設定を変更してください。一度削除したテーマは復元できません。
本当にグループを削除しますか？`);const f={headerText:"グループを削除しますか？",bodyText:v,action:h};e.commit("confirmationModal/showConfirmationModal"),e.commit("confirmationModal/setTextAndAction",f)},p=_=>{var v;const h=(v=s.value)==null?void 0:v.groups.find(f=>f.id===_.id);e.commit("modal/setGroup",h),e.commit("modal/setCurrentAdmins",h==null?void 0:h.admins),e.commit("modal/showModal","groupAdminUserEdit")};t.$on("group-admins-updated",({groupId:_,admins:h})=>{var f;const v=(f=s.value)==null?void 0:f.groups.find(C=>C.id===_);v&&(v.admins=h.map(C=>({id:C.id,user_name:C.user_name})))});const m=Te();return{fields:u,filteredItems:i,actions:[{name:"グループ管理者編集",func:p},{name:"メンバー設定",func:_=>m.push({name:"groupMembers",params:{groupId:_.id.toString()}})},{name:"設定",func:_=>m.push({name:"groupEdit",params:{groupId:_.id.toString()}})},{isSeparator:!0},{name:"削除",func:c,icon:"trash"}],onChangeQuery:o,actionMenuItem:n}}});var Ll=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"group-admin"},[t("Header",{attrs:{title:"グループ管理",headerWidth:"100%"}}),t("AdminContent",[t("div",{staticClass:"o-group-admin__content"},[t("SearchBar",{on:{onChangeQuery:e.onChangeQuery}}),t("div",{staticClass:"spacing-16"}),t("div",{staticClass:"title"},[t("span",{staticClass:"c-title c-title--m"},[e._v("グループ")]),t("span",{staticClass:"count c-text c-text--s"},[e._v("・"+e._s(e.filteredItems.length)+"件")])]),t("div",{staticClass:"spacing-16"}),t("AdminBaseTable",{attrs:{fields:e.fields,items:e.filteredItems},scopedSlots:e._u([{key:"cell-0",fn:function({item:a}){return[t("router-link",{attrs:{to:`/groups/${a.id}`}},[e._v(e._s(a.name))])]}},{key:"cell-3",fn:function({item:a}){return[e._v(" "+e._s(a.formattedCreatedAt)+" ")]}},{key:"cell-5",fn:function({item:a}){return[t("div",{staticClass:"actions"},[t("div",{staticClass:"action-icon",on:{click:function(n){n.stopPropagation(),e.actionMenuItem=a}}},[t("sm-icons",[e._v("ellipsis-h")])],1),e.actionMenuItem===a?t("div",{staticClass:"action-menu"},e._l(e.actions,function(n){return t("div",{key:n.name,staticClass:"item-container"},[n.isSeparator?t("div",{staticClass:"separator"}):t("div",{staticClass:"item c-text c-text--m",on:{click:()=>n.func?n.func(a):void 0}},[n.icon?t("sm-icons",{staticClass:"icon small"},[e._v(e._s(n.icon))]):e._e(),e._v(e._s(n.name)+" ")],1)])}),0):e._e()])]}}])})],1)])],1)},Ul=[],Rl=T(Nl,Ll,Ul,!1,null,"f99edc6f",null,null);const Ol=Rl.exports,Gl=D({components:{SearchBar:At},props:{optionName:{type:String,required:!0},options:{type:Array,required:!0},selectedOptions:{type:Array,default:()=>[]}},setup(s,e){const{optionName:t}=s,{options:a,selectedOptions:n}=$e(s),r=Fe({items:[]}),o=()=>r.items=[...n.value],i=g(!1),u=g(),c=y=>{const A=(y==null?void 0:y.composedPath())??[];u.value&&(!y||!A.includes(u.value))&&(i.value=!1),o()};ne(async()=>{document.addEventListener("click",c)}),Be(()=>{document.removeEventListener("click",c)});const p=l(()=>n.value.length===0||n.value.length===a.value.length?`すべての${t}`:`${n.value.length}${t}`),m=g(""),d=y=>m.value=y,_=l(()=>m.value?a.value.filter(y=>y.name.toLowerCase().includes(m.value.toLowerCase())):a.value),h=(y,A)=>{A?r.items.push(y):r.items=r.items.filter(k=>k!==y)},v=()=>{r.items=a.value.map(y=>y.name)},f=()=>{r.items=[]},C=()=>{e.emit("selectionUpdated",[...r.items]),c()};return Z(()=>n.value,()=>r.items=[...n.value]),Z(i,y=>e.emit(y?"open":"close")),{internalSelectedOptions:r,isSelectionOpen:i,title:p,filterQuery:m,setFilterQuery:d,filteredOptions:_,toggleOptionSelection:h,selectAll:v,deselectAll:f,confirmSelection:C,multiselectRef:u}}});var ql=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"multi-select"},[t("div",{ref:"multiselectRef",staticClass:"multi-select-box",on:{click:function(a){e.isSelectionOpen=!e.isSelectionOpen}}},[t("div",{staticClass:"c-selectBox c-selectBox--small"},[t("span",{staticClass:"c-selectBox__placeholder c-text--m"},[e._v(" "+e._s(e.title)+" ")]),t("sm-icons",{staticClass:"c-selectBox__arrow small"},[e._v("angle-down")])],1)]),e.isSelectionOpen?t("div",{staticClass:"option-select dashboard-card",on:{click:function(a){return a.stopPropagation(),(()=>{}).apply(null,arguments)}}},[t("div",{staticClass:"option-search-bar"},[t("SearchBar",{on:{onChangeQuery:e.setFilterQuery}})],1),t("div",{staticClass:"option-list"},[e.options.length===0&&e.filterQuery.length===0?t("div",{staticClass:"options-empty c-text c-text--m"},[e._v(" 未設定 ")]):e._e(),e.filteredOptions.length===0&&e.filterQuery.length>0?t("div",{staticClass:"options-empty c-text c-text--m"},[e._v(" 指定した"+e._s(e.optionName)+"は存在しません。 ")]):e._e(),e._l(e.filteredOptions,function(a){return t("div",{key:a.name,staticClass:"option"},[t("sm-checkbox-label",{staticClass:"checkbox-label",attrs:{value:e.internalSelectedOptions.items.includes(a.name)},on:{change:function(n){return e.toggleOptionSelection(a.name,n)}}},[t("span",{class:{empty:a.name===""}},[e._v(" "+e._s(a.name===""?"未記入":a.name)+" ")]),a.count!==void 0?t("span",[e._v(" ("+e._s(a.count)+") ")]):e._e()])],1)})],2),t("div",{staticClass:"option-buttons"},[t("button",{staticClass:"dashboard-button--borderless",on:{click:e.selectAll}},[e._v(" すべて選択 ")]),t("button",{staticClass:"dashboard-button--borderless",on:{click:e.deselectAll}},[e._v(" 選択解除 ")]),t("button",{staticClass:"dashboard-button--primary",on:{click:e.confirmSelection}},[e._v(" 適用 ")])])]):e._e()])},Hl=[],Vl=T(Gl,ql,Hl,!1,null,"57383444",null,null);const Tr=Vl.exports,jl=D({components:{MultiSelect:Tr},props:{value:{type:Array,required:!0},isRightAligned:{type:Boolean,default:!1}},setup(s,e){const t=g([]),a=l(()=>{const c=t.value.map(p=>p.selectedOptions.length>0?String(p.selectedOptions.length)+p.label:null).filter(Boolean).join("・");return c===""?"メンバーの絞り込み":c});Z(()=>s.value,()=>t.value=JSON.parse(JSON.stringify(s.value)),{deep:!0,immediate:!0});const n=g(!1),r=()=>{n.value=!1,e.emit("input",t.value)},o=()=>{t.value.forEach(c=>c.selectedOptions=[]),n.value=!1,e.emit("input",t.value)},i=g(),u=c=>{const p=(c==null?void 0:c.composedPath())??[];i.value&&(!c||!p.includes(i.value))&&(n.value=!1)};return ne(()=>{document.addEventListener("click",u,{capture:!0})}),Be(()=>{document.removeEventListener("click",u,{capture:!0})}),{searchSettingsRef:i,isSelectionOpen:n,clickApply:r,clickReset:o,filters:t,displayText:a}}});var Kl=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{ref:"searchSettingsRef",staticClass:"search-settings"},[t("div",{staticClass:"setting-box",on:{click:function(a){e.isSelectionOpen=!e.isSelectionOpen}}},[t("div",{staticClass:"c-selectBox c-selectBox--small"},[t("span",{staticClass:"c-selectBox__placeholder c-text--m"},[e._v(" "+e._s(e.displayText)+" ")]),t("sm-icons",{staticClass:"c-selectBox__arrow small"},[e._v("angle-down")])],1)]),e.isSelectionOpen?t("div",{staticClass:"option-select dashboard-card",class:{"right-aligned":e.isRightAligned}},[e._l(e.filters,function(a){return[t("div",{key:a.label,staticClass:"filter-line"},[t("div",[e._v(e._s(a.label))]),t("div",[t("MultiSelect",{attrs:{optionName:a.label,options:a.options,selectedOptions:a.selectedOptions},on:{selectionUpdated:n=>a.selectedOptions=n}})],1),t("div",{staticClass:"spacing-16"})])]}),t("div",{staticClass:"option-buttons"},[t("button",{staticClass:"dashboard-button--borderless",on:{click:e.clickReset}},[e._v(" リセット ")]),t("div",{staticClass:"right-buttons"},[t("button",{staticClass:"dashboard-button",on:{click:function(a){e.isSelectionOpen=!1}}},[e._v(" キャンセル ")]),t("div",{staticClass:"spacing-16"}),t("button",{staticClass:"dashboard-button--primary",on:{click:e.clickApply}},[e._v(" 適用 ")])])])],2):e._e()])},Yl=[],Ql=T(jl,Kl,Yl,!1,null,"48e9dee2",null,null);const fs=Ql.exports,Oe={heavy:"ヘビー",active:"アクティブ",light:"ライト",dormant:"休眠",inactive:"未使用"},Ct=["#009572","#4EB59D","#9CD6C7","#EAF6F2","#E6E6E6"],Dr=(s,e,t)=>{const a=sa(`#${s}`).append("div").attr("class","dashboard-chart-tooltip c-text c-text--s").style("display","none");e.on("mouseover",function(){a.style("display",null)}).on("mouseout",function(){a.style("display","none")}).on("mousemove",function(n,r){var c;a.html(t(r));const o=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,i=((c=a.node())==null?void 0:c.getBoundingClientRect().width)??0,u=n.pageX+i>o?-(i+6):12;a.style("left",`${n.pageX+u}px`).style("top",`${n.pageY+12}px`)})},Wl=D({setup(s,e){const t=g(),a=g(!1);Be(()=>{document.removeEventListener("click",r,{capture:!0})});const n=i=>{if(a.value){o(i);return}document.addEventListener("click",r),a.value=!0,e.emit("clickMenu",i)},r=i=>{!a.value||!t.value||((i==null?void 0:i.composedPath())??[]).includes(t.value)||o(i)},o=i=>{document.removeEventListener("click",r),a.value=!1,e.emit("closeMenu",i)};return{actionMenuRef:t,clickMenu:n,closeMenu:o,isOpen:a}}});var zl=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"m-action-menu"},[t("button",{ref:"actionMenuRef",staticClass:"action-menu-button",class:{opened:e.isOpen},attrs:{"data-testid":"member-table-action-menu"},on:{click:e.clickMenu,keydown:function(a){return!a.type.indexOf("key")&&e._k(a.keyCode,"esc",27,a.key,["Esc","Escape"])?null:e.closeMenu.apply(null,arguments)}}},[t("sm-icons",[e._v("ellipsis-h")])],1),e.isOpen?t("div",{staticClass:"action-menu-popup"},[e._t("default")],2):e._e()])},Jl=[],Xl=T(Wl,zl,Jl,!1,null,"159ba98c",null,null);const Zl=Xl.exports,ed=D({components:{Header:Se,SearchBar:At,Avatar:at,AdminContent:St,ActionMenuForMembersTable:Zl,Filters:fs},setup(){const s=se(),e=Te(),t=nt(),{data:a,mutate:n}=jt(),r=l(()=>{var H;return((H=a.value)==null?void 0:H.users.filter(ue=>!ue.is_deleted))??[]}),{data:o}=bt(),i=l(()=>{var H;return(H=o.value)==null?void 0:H.management_contracts});Z(()=>i.value,H=>{H!=null&&(H==null?void 0:H.length)>0||e.push({name:"themeAdmin"})});const u=H=>{var ue,_e;return((_e=(ue=i.value)==null?void 0:ue.find(me=>me.product_contract_id===H.product_contract_id))==null?void 0:_e.contract_name)??"未設定"},c=g({user_name:"",authority:"",access_status:"desc",product_contract_id:"",last_accessed_at:"",org_department:"",created_at:""}),p=Fe({activityStatus:[],orgDepartments:[],roles:[],contractNames:[]}),m=g(""),d=Ct;ne(async()=>{Mt(),v()});const _=H=>c.value[H],h=H=>{switch(c.value[H]){case"asc":c.value[H]="desc";break;case"desc":c.value[H]="asc";break;default:Object.keys(c.value).forEach(ue=>{c.value[ue]=""}),c.value[H]="asc";break}},v=()=>{c.value={user_name:"",authority:"",access_status:"desc",product_contract_id:"",last_accessed_at:"",org_department:"",created_at:""},f("access_status")},f=H=>{h(H)},C=H=>{if(!H)return"unused";const ue=oe().subtract(4,"week");return oe(H)>=ue?"active":"inactive"},y=l(()=>{const H=Object.keys(c.value).filter(me=>c.value[me]!=="")[0];if(H==="last_accessed_at")return[...b.value].sort((me,de)=>$(me[H],de[H],c.value[H]));if(H==="access_status")return[...b.value].sort((me,de)=>(c.value[H]==="asc"?1:-1)*(Object.keys(Oe).indexOf(me.activity_status)-Object.keys(Oe).indexOf(de.activity_status)));if(H==="authority")return[...b.value].sort((me,de)=>(c.value[H]==="asc"?1:-1)*x(me).localeCompare(x(de),"ja"));if(H==="product_contract_id")return[...b.value].sort((me,de)=>{const ee=c.value[H]==="asc"?1:-1,J=u(me),ce=u(de);return(J>ce?1:-1)*ee});const ue=b.value.filter(me=>me[H]!==""),_e=b.value.filter(me=>me[H]==="");return c.value[H]==="asc"?ue.sort((me,de)=>me[H].localeCompare(de[H],"ja")):ue.sort((me,de)=>-me[H].localeCompare(de[H],"ja")),ue.concat(_e)}),A=(H,ue)=>{const _e=H==="edit"?ue:void 0;s.commit("userEditModal/showUserEditModal",{type:H,user:_e})},k=l(()=>b.value.length),S=H=>{m.value=H},b=l(()=>r.value.filter(H=>{let ue=[H.email,H.user_name,H.org_department].join().toLowerCase();ue+=x(H);let _e=!0;return p.activityStatus.length>0&&(_e=_e&&p.activityStatus.includes(Oe[H.activity_status])),p.orgDepartments.length>0&&(_e=_e&&p.orgDepartments.includes(H.org_department)),p.roles.length>0&&(_e=_e&&p.roles.some(me=>x(H)===me)),p.contractNames.length>0&&(_e=_e&&p.contractNames.some(me=>u(H)===me)),ue.includes(m.value.toLowerCase())&&_e})),U=async H=>{if(H)try{await F.resendPasswordEmail(H.id),s.commit("snackbar/addMessages",{message:"招待メールを再送しました",type:""})}catch(ue){throw s.commit("snackbar/addMessages",{message:"招待メールを再送できませんでした",type:"error"}),ue}},I=async H=>{const ue=async()=>{if(H)try{await F.deleteUser(H.id),s.commit("snackbar/addMessages",{message:"メンバーを削除しました",type:""}),await s.dispatch("teamUsers/fetchTeamUsersForAdmin"),n()}catch(de){throw s.commit("snackbar/addMessages",{message:"メンバーを削除できませんでした",type:"error"}),de}},_e=()=>{e.push({name:"groupAdmin"})},me=await w(H??void 0);if(me.length>0){const de=me.map(ce=>ce.name),J={headerText:"メンバーを削除できません",bodyText:`${me[0].admins[0].user_name}は${de.join(",")}の管理者で、他にこのグループの管理者がいないので、削除できません。
 グループ管理者の権限委譲してから、削除してください。`,confirmationType:"submit",btnText:"グループ画面",action:_e};s.commit("confirmationModal/showConfirmationModal"),s.commit("confirmationModal/setTextAndAction",J)}else{let de=`${H.user_name}を削除します。`;t.data.value&&t.data.value.themes.filter(J=>J.access_scope==="personal"&&J.user_id===H.id).length>0&&(de+=`また、このユーザーを削除するとこのユーザーで公開範囲を指定しているテーマも一緒に削除されます。
削除したくないテーマは、このユーザーでログインし、公開範囲設定を変更してください。一度削除したテーマは復元できません。`);const ee={headerText:"メンバーを削除しますか？",bodyText:de,action:ue};s.commit("confirmationModal/showConfirmationModal"),s.commit("confirmationModal/setTextAndAction",ee)}},w=async H=>{const ue=[];return(await F.fetchGroupsForAdmin()).forEach(me=>{me.admins.length===1&&me.admins[0].id===(H==null?void 0:H.id)&&ue.push(me)}),ue},x=H=>({admin:"管理者",group_admin:"グループ管理者",editor:"編集者",viewer:"閲覧者"})[H.role],B=H=>H?De(H):void 0,$=(H,ue,_e)=>{const[me,de]=_e==="asc"?[H,ue]:[ue,H];return Date.parse(me??"1970-01-01")-Date.parse(de??"1970-01-01")},P=H=>{const ue=H.reduce((_e,me)=>(_e[me]=(_e[me]??0)+1,_e),{});return Object.entries(ue).map(([_e,me])=>({name:_e,count:me}))},M=H=>Object.keys(Oe).indexOf(H)<3?"#ffffff":"#4a4a4a",O=H=>d[Object.keys(Oe).indexOf(H)],Y=l(()=>P(r.value.map(H=>Oe[H.activity_status]))),W=l(()=>P(r.value.map(H=>H.org_department))),j=l(()=>P(r.value.map(H=>x(H)))),K=l(()=>P(r.value.map(H=>u(H)))),le=g([{label:"契約",options:K.value,selectedOptions:[]},{label:"権限",options:j.value,selectedOptions:[]},{label:"属性",options:Y.value,selectedOptions:[]},{label:"組織",options:W.value,selectedOptions:[]}]);return Z(y,()=>{le.value[0].options=K.value,le.value[1].options=j.value,le.value[2].options=Y.value,le.value[3].options=W.value}),{activityStatusMap:Oe,filterUsers:S,filteredMemberCount:k,openUserEditModal:A,sortByArgumentProperty:f,SortedBy:_,sortedUsers:y,colorForActivityStatus:M,bgColorForActivityStatus:O,authority:x,formatDate:B,resendPasswordEmail:U,deleteUser:I,userAccessStatus:C,contractName:u,searchFilters:le,applyFilter:()=>{p.contractNames=le.value[0].selectedOptions,p.roles=le.value[1].selectedOptions,p.activityStatus=le.value[2].selectedOptions,p.orgDepartments=le.value[3].selectedOptions}}}});var td=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"container"},[t("Header",{attrs:{title:"メンバー管理",headerWidth:"100%"}}),t("AdminContent",[t("div",{staticClass:"o-members"},[t("div",{staticClass:"search-bar"},[t("SearchBar",{on:{onChangeQuery:e.filterUsers}})],1),t("div",{staticClass:"spacing-16"}),t("div",{staticClass:"o-header"},[t("div",{staticClass:"o-search-info"},[t("div",{staticClass:"c-text c-text--m"},[e._v("メンバー")]),t("div",{staticClass:"o-member-count c-text c-text--s"},[e._v(" ・"+e._s(e.filteredMemberCount)+"名 ")])]),t("div",{staticClass:"o-header-buttons"},[t("div",[t("Filters",{staticClass:"m-search-settings",attrs:{isRightAligned:""},on:{input:e.applyFilter},model:{value:e.searchFilters,callback:function(a){e.searchFilters=a},expression:"searchFilters"}})],1),t("div",{staticClass:"spacing-12"}),t("div",{staticClass:"o-create-member-button"},[t("button",{staticClass:"m-create-button c-btn--auto c-btn--AnewsPrimary c-text c-text--m",on:{click:function(a){return e.openUserEditModal("create")}}},[e._v(" メンバー追加 ")])])])]),t("div",{staticClass:"o-member-table"},[t("table",{staticClass:"o-member-body",attrs:{cellspacing:"0"}},[t("tr",{staticClass:"o-column-description",attrs:{"data-locator":"member-header"}},[t("th",{staticClass:"m-user-name c-text c-text--s",class:{"o-sort-icon-spacing":!e.SortedBy("user_name")},on:{click:function(a){return e.sortByArgumentProperty("user_name")}}},[e._v(" 名前"),e.SortedBy("user_name")==="asc"?t("span",{staticClass:"o-sort-icon"},[e._v("↑")]):e._e(),e.SortedBy("user_name")==="desc"?t("span",{staticClass:"o-sort-icon"},[e._v("↓")]):e._e()]),t("th",{staticClass:"m-contract c-text c-text--s",class:{"o-sort-icon-spacing":!e.SortedBy("product_contract_id")},on:{click:function(a){return e.sortByArgumentProperty("product_contract_id")}}},[e._v(" 契約"),e.SortedBy("product_contract_id")==="asc"?t("span",{staticClass:"o-sort-icon"},[e._v("↑")]):e._e(),e.SortedBy("product_contract_id")==="desc"?t("span",{staticClass:"o-sort-icon"},[e._v("↓")]):e._e()]),t("th",{staticClass:"m-access-status c-text c-text--s",class:{"o-sort-icon-spacing":!e.SortedBy("access_status")},on:{click:function(a){return e.sortByArgumentProperty("access_status")}}},[e._v(" 属性"),e.SortedBy("access_status")==="asc"?t("span",{staticClass:"o-sort-icon"},[e._v("↑")]):e._e(),e.SortedBy("access_status")==="desc"?t("span",{staticClass:"o-sort-icon"},[e._v("↓")]):e._e()]),t("th",{staticClass:"m-authority c-text c-text--s",class:{"o-sort-icon-spacing":!e.SortedBy("authority")},on:{click:function(a){return e.sortByArgumentProperty("authority")}}},[e._v(" 権限"),e.SortedBy("authority")==="asc"?t("span",{staticClass:"o-sort-icon"},[e._v("↑")]):e._e(),e.SortedBy("authority")==="desc"?t("span",{staticClass:"o-sort-icon"},[e._v("↓")]):e._e()]),t("th",{staticClass:"m-org-department c-text c-text--s",class:{"o-sort-icon-spacing":!e.SortedBy("org_department")},on:{click:function(a){return e.sortByArgumentProperty("org_department")}}},[e._v(" 所属部署"),e.SortedBy("org_department")==="asc"?t("span",{staticClass:"o-sort-icon"},[e._v("↑")]):e._e(),e.SortedBy("org_department")==="desc"?t("span",{staticClass:"o-sort-icon"},[e._v("↓")]):e._e()]),t("th",{staticClass:"m-created-at c-text c-text--s",class:{"o-sort-icon-spacing":!e.SortedBy("created_at")},on:{click:function(a){return e.sortByArgumentProperty("created_at")}}},[e._v(" 作成日"),e.SortedBy("created_at")==="asc"?t("span",{staticClass:"o-sort-icon"},[e._v("↑")]):e._e(),e.SortedBy("created_at")==="desc"?t("span",{staticClass:"o-sort-icon"},[e._v("↓")]):e._e()]),t("th",{staticClass:"m-last-accessed-at c-text c-text--s",class:{"o-sort-icon-spacing":!e.SortedBy("last_accessed_at")},on:{click:function(a){return e.sortByArgumentProperty("last_accessed_at")}}},[e._v(" 最終アクセス"),e.SortedBy("last_accessed_at")==="asc"?t("span",{staticClass:"o-sort-icon"},[e._v("↑")]):e._e(),e.SortedBy("last_accessed_at")==="desc"?t("span",{staticClass:"o-sort-icon"},[e._v("↓")]):e._e()])]),e._l(e.sortedUsers,function(a){return t("tr",{key:a.id,staticClass:"o-member-list-row",attrs:{"data-locator":a.email}},[t("td",{staticClass:"m-user-name"},[t("router-link",{attrs:{to:`/users/${a.id}`}},[t("Avatar",{attrs:{imageUrl:a.image_url,size:"xs"}})],1),t("div",{staticClass:"name-and-email"},[t("router-link",{attrs:{to:`/users/${a.id}`}},[t("div",{staticClass:"name c-text c-text--m"},[e._v(" "+e._s(a.user_name)+" ")])]),t("div",{staticClass:"email c-text c-text--xs"},[e._v(e._s(a.email))])],1)],1),t("td",{staticClass:"m-authority c-text c-text--m"},[e._v(" "+e._s(e.contractName(a))+" ")]),t("td",{staticClass:"m-access-status"},[t("div",{staticClass:"user-activity-status c-tag c-tag--small",style:{color:e.colorForActivityStatus(a.activity_status),backgroundColor:e.bgColorForActivityStatus(a.activity_status)}},[e._v(" "+e._s(e.activityStatusMap[a.activity_status])+" ")])]),t("td",{staticClass:"m-authority c-text c-text--m"},[e._v(" "+e._s(e.authority(a))+" ")]),t("td",{staticClass:"m-org-department c-text c-text--m"},[e._v(" "+e._s(a.org_department)+" ")]),t("td",{staticClass:"m-created-at c-text c-text--m"},[e._v(" "+e._s(e.formatDate(a.created_at))+" ")]),t("td",{staticClass:"m-last-accessed-at c-text c-text--m"},[e._v(" "+e._s(e.formatDate(a.last_accessed_at))+" ")]),t("td",{staticClass:"m-edit-icon"},[t("ActionMenuForMembersTable",{staticClass:"m-edit-menu-ellipsis"},[t("div",{staticClass:"o-user-edit-menu c-text c-text--m"},[t("button",{staticClass:"o-user-edit c-text c-text--m",on:{click:function(n){return e.openUserEditModal("edit",a)}}},[t("sm-icons",{staticClass:"small item-icon"},[e._v("pencil")]),e._v("編集 ")],1),a.last_accessed_at?e._e():t("button",{staticClass:"o-user-resend-password c-text c-text--m",on:{click:function(n){return e.resendPasswordEmail(a)}}},[t("sm-icons",{staticClass:"small item-icon"},[e._v("envelop")]),e._v("招待メールを再送 ")],1),t("div",{staticClass:"divider"}),t("button",{staticClass:"o-user-remove c-text c-text--m",on:{click:function(n){return e.deleteUser(a)}}},[t("sm-icons",{staticClass:"small item-icon"},[e._v("trash")]),e._v("削除 ")],1)])])],1)])})],2)])])])],1)},sd=[],ad=T(ed,td,sd,!1,null,"e59e8a98",null,null);const nd=ad.exports,rd=D({props:{data:{type:Array,required:!0}},setup(s,e){const{data:t}=$e(s),{data:a}=Pe(),n=l(()=>{var v;return new Map(((v=a.value)==null?void 0:v.groups.map(f=>[f.id,f.name]))??[])}),r=[{name:"name",displayName:"テーマ名",type:"string",linkTo:v=>({name:"themeEdit",params:{themeId:String(v.id)}}),hasTooltip:!0},{name:"access_scope",displayName:"公開範囲",type:"string"},{name:"group_name",displayName:"グループ名",type:"string",hasTooltip:!0},{name:"member_count",displayName:"メンバー数",type:"number",linkTo:v=>({name:"themeAdminMembers",params:{themeId:String(v.id)}})},{name:"description",displayName:"説明",type:"string",hasTooltip:!0},{name:"feed_count_average_domestic",displayName:"配信数（国内）",type:"number",feedType:"domestic"},{name:"feed_count_average_foreign",displayName:"配信数（海外）",type:"number",feedType:"foreign"},{name:"view_count",displayName:"閲覧数",type:"number"},{name:"mark_count",displayName:"マーク数",type:"number"},{name:"creator_name",displayName:"作成者",type:"string"},{name:"created_at",displayName:"作成日",type:"date"}],o=(v,f)=>{const C=v.name;return v.type==="date"?De(f[C]):v.name==="description"?f.description===""?"-":f[v.name]:v.name==="access_scope"?{public:"全体",group:"グループ",personal:"個人"}[f.access_scope]:v.name==="group_name"?n.value.get(f.group_id??-1)??"":v.name.startsWith("feed_count_average")&&f.feed_count_average?v.feedType?f.feed_count_average[v.feedType]:void 0:v.type==="number"&&f[C]>=1e5?"99,999+":v.type==="number"?f[C].toLocaleString():f[C]},i=(v,f)=>{const C=v.name,y=f==="asc"?1:-1;return[...t.value].sort((A,k)=>{const S=v.name in A?A[C]:o(v,A),b=v.name in k?k[C]:o(v,k);return["string","date","link"].includes(v.type)?y*S.localeCompare(b):y*(S-b)})},u=g(r[0]),c=g("asc"),p=v=>{const f=r.find(C=>C.name===v);f&&(f===u.value?c.value=c.value==="asc"?"desc":"asc":(u.value=f,c.value="asc"))},m=l(()=>i(u.value,c.value)),d=g([]);return{headerFields:r,formatField:o,sort:p,sortField:u,sortOrder:c,sortedData:m,selectedThemes:d,toggleSelectAll:v=>{v?d.value=t.value.map(f=>f.id)??[]:d.value=[],e.emit("theme-selected",d.value)},selectTheme:v=>{d.value.includes(v)?d.value=d.value.filter(f=>f!==v):d.value.push(v),e.emit("theme-selected",d.value)}}}});var od=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"theme-table-wrapper"},[t("table",{staticClass:"theme-table",attrs:{cellspacing:"0"}},[t("thead",[t("tr",[t("th",[t("span",{staticClass:"c-text c-text--xs"},[e._v("すべて")]),t("sm-checkbox",{on:{change:e.toggleSelectAll}})],1),e._l(e.headerFields,function(a){return t("th",{key:a.name,staticClass:"c-text c-text--s",class:{default:a.displayName===""},style:{width:a.width?`${a.width}px`:"auto"},on:{click:function(n){return e.sort(a.name)}}},[e._v(" "+e._s(a.displayName)),e.sortField===a&&e.sortOrder=="asc"?t("span",{staticClass:"sort-icon"},[e._v("↑")]):e.sortField===a&&e.sortOrder=="desc"?t("span",{staticClass:"sort-icon"},[e._v("↓")]):e._e()])})],2)]),t("tbody",e._l(e.sortedData,function(a){return t("tr",{key:a.id},[t("td",[t("sm-checkbox",{attrs:{value:e.selectedThemes.includes(a.id)},on:{change:()=>e.selectTheme(a.id)}})],1),e._l(e.headerFields,function(n){return t("td",{key:n.name},[t("div",{directives:[{name:"tooltip",rawName:"v-tooltip.bottom",value:n.hasTooltip&&e.formatField(n,a)!=="-"?{content:e.formatField(n,a),delay:{show:300},offset:8,autoHide:!1}:void 0,expression:`
                field.hasTooltip && formatField(field, theme) !== '-'
                  ? {
                      content: formatField(field, theme),
                      delay: { show: 300 },
                      offset: 8,
                      autoHide: false
                    }
                  : undefined
              `,modifiers:{bottom:!0}}]},[n.linkTo||n.name==="name"&&n.type==="link"?t("router-link",{class:`link c-text c-text--m ${n.name} ${n.type}`,attrs:{to:n.linkTo?n.linkTo(a):{path:`/admin/themes/${a.id}/members`}}},[e._v(" "+e._s(e.formatField(n,a))+" ")]):e._e(),a.is_initial_theme&&n.name==="name"?t("span",{staticClass:"tag c-outlineTag c-outlineTag--small"},[e._v("初期表示")]):e._e(),n.name==="move_to_detail"&&n.type==="link"?t("router-link",{staticClass:"primary-link c-text c-text--s",attrs:{to:{path:`/themes/${a.id}/edit`}}},[e._v(" 設定 ")]):e._e(),n.type!=="link"&&!n.linkTo?t("div",{class:`c-text c-text--m ${n.name} ${n.type}`},[e._v(" "+e._s(e.formatField(n,a))+" ")]):e._e()],1)])})],2)}),0)])])},id=[],ud=T(rd,od,id,!1,null,"31d9b439",null,null);const cd=ud.exports,ld=D({props:{},components:{Header:Se,AdminContent:St,SearchBar:At,ThemeTable:cd},methods:{},setup(){var A;const s=se(),{data:e}=Qe(),{data:t}=Zc(),a=g(""),n=k=>{a.value=k},r=l(()=>{var k;return new Map(((k=e.value)==null?void 0:k.users.map(S=>[S.id,S.user_name]))??[])}),o=g(((A=t.value)==null?void 0:A.themes)??[]);Z(()=>t.value,()=>{var k;return o.value=((k=t.value)==null?void 0:k.themes)??[]});const i=l(()=>o.value.map(k=>{const S=c.value==="all"||c.value==="initial_theme"&&k.is_initial_theme||c.value==="not_initial_theme"&&!k.is_initial_theme,b=m.value==="all"||m.value===k.access_scope;if(S&&b)return{...k,creator_name:r.value.get(k.creator_id??-1)??""}}).filter(k=>k!==void 0)),u=l(()=>i.value.filter(k=>(k.name+k.description+k.creator_name).toLowerCase().includes(a.value.toLowerCase()))),c=g("all"),p={all:"すべての設定",initial_theme:"初期表示設定中",not_initial_theme:"未設定"},m=g("all"),d={all:"すべての公開範囲",public:"全体",group:"グループ",personal:"個人"},_=g([]),h=g(!1),v=l(()=>!h.value&&_.value.length>0);return{filteredThemes:u,onChangeQuery:n,viewSettingFilter:c,viewSettingOptions:p,scopeFilter:m,scopeFilterOptions:d,isButtonEnabled:v,selectedThemeIds:_,updateInitialThemes:async k=>{h.value=!0;for(let S of _.value){const b=o.value.find(U=>U.id===S);if(b&&b.is_initial_theme!==k){b.is_initial_theme=k;const U=await F.fetchTheme(S);U.is_initial_theme=k,F.updateTheme(U)}}h.value=!1},deleteThemes:async()=>{const S={headerText:"テーマを削除しますか？",bodyText:`削除したテーマは元に戻すことはできません。
本当にテーマを削除しますか？`,action:async()=>{h.value=!0;for(let b of _.value)o.value.find(I=>I.id===b)&&(await F.deleteTheme(b),o.value=o.value.filter(I=>I.id!==b));h.value=!1}};s.commit("confirmationModal/showConfirmationModal"),s.commit("confirmationModal/setTextAndAction",S)},explanationText:`配信数：直近1週間の1日あたりの配信数（平均）
閲覧数：直近4週間の閲覧数合計
マーク数：直近4週間のマーク数合計`}}});var dd=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"theme-admin"},[t("Header",{attrs:{title:"テーマ管理",headerWidth:"100%"}}),t("AdminContent",[t("div",{staticClass:"o-theme-admin__content"},[t("SearchBar",{on:{onChangeQuery:e.onChangeQuery}}),t("div",{staticClass:"spacing-16"}),t("div",{staticClass:"title"},[t("span",{staticClass:"c-title c-title--m"},[e._v("テーマ")]),t("span",{staticClass:"count c-text c-text--s"},[e._v("・"+e._s(e.filteredThemes.length)+"件")]),t("span",{directives:[{name:"tooltip",rawName:"v-tooltip.bottom",value:{content:e.explanationText,delay:{show:300},offset:8,autoHide:!1},expression:`{
              content: explanationText,
              delay: { show: 300 },
              offset: 8,
              autoHide: false
            }`,modifiers:{bottom:!0}}],staticClass:"explanation c-text c-text--s"},[t("sm-icons",{staticClass:"small"},[e._v("question-circle")]),e._v(" 配信数などの算出方法 ")],1)]),t("div",{staticClass:"spacing-16"}),t("div",{staticClass:"controls"},[t("div",{staticClass:"filters"},[t("sm-selectbox",{staticClass:"small",attrs:{placeholder:e.viewSettingOptions.all,labels:Object.values(e.viewSettingOptions),values:Object.keys(e.viewSettingOptions)},on:{selected:function(a){e.viewSettingFilter=a.value}}}),t("sm-selectbox",{staticClass:"small",attrs:{placeholder:e.scopeFilterOptions.all,labels:Object.values(e.scopeFilterOptions),values:Object.keys(e.scopeFilterOptions)},on:{selected:function(a){e.scopeFilter=a.value}}})],1),t("div",{staticClass:"actions"},[t("button",{staticClass:"c-outlineBtn c-btn--auto c-btn--small c-outlineBtn--secondary",class:{disabled:!e.isButtonEnabled},attrs:{disabled:!e.isButtonEnabled},on:{click:()=>e.updateInitialThemes(!0)}},[e._v(" 初期設定にする ")]),t("button",{staticClass:"c-outlineBtn c-btn--auto c-btn--small c-outlineBtn--secondary",class:{disabled:!e.isButtonEnabled},attrs:{disabled:!e.isButtonEnabled},on:{click:()=>e.updateInitialThemes(!1)}},[e._v(" 初期設定から外す ")]),t("button",{staticClass:"c-outlineBtn c-btn--auto c-btn--small c-outlineBtn--secondary",class:{disabled:!e.isButtonEnabled},attrs:{disabled:!e.isButtonEnabled},on:{click:()=>e.deleteThemes()}},[e._v(" テーマを削除する ")])])]),t("div",{staticClass:"spacing-16"}),t("ThemeTable",{attrs:{data:e.filteredThemes},on:{"theme-selected":a=>e.selectedThemeIds=a}})],1)])],1)},md=[],_d=T(ld,dd,md,!1,null,"76d461a5",null,null);const pd=_d.exports,vd=D({props:{fields:{type:Array,required:!0},data:{type:Array,required:!0},initialSortField:{type:Object},initialSortOrder:{type:String,default:"asc"},actions:{type:Array}},setup(s){const e=[{name:"user_name",displayName:"名前",type:"string"},...s.fields],t=m=>({admin:"管理者",group_admin:"グループ管理者",editor:"編集者",viewer:"閲覧者"})[m],a=(m,d)=>{const _=m.name;switch(m.type){case"boolean":return d[_]===!0?"○":"";case"role":return t(d[_]);default:return d[_]}},n=(m,d)=>{const _=m.name,h=d==="asc"?1:-1;return[...s.data].sort((v,f)=>{if(m.type==="string")return h*v[_].localeCompare(f[_]);if(m.type==="role"){const C=y=>["admin","group_admin","editor","viewer"].indexOf(y);return h*(C(v[_])-C(f[_]))}else return m.type==="boolean"?-1*h*(v[_]-f[_]):h*(v[_]-f[_])})},r=g(s.initialSortField??e[0]),o=g(s.initialSortOrder),i=m=>{const d=e.find(_=>_.name===m);d&&(d===r.value?o.value=o.value==="asc"?"desc":"asc":(r.value=d,o.value="asc"))},u=l(()=>n(r.value,o.value)),c=g(void 0),p=()=>c.value=void 0;return ne(()=>document.addEventListener("click",p)),Xe(()=>document.removeEventListener("click",p)),{headerFields:e,formatField:a,sort:i,sortField:r,sortOrder:o,sortedData:u,actionMenuUser:c}}});var fd=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("table",{staticClass:"user-table",attrs:{cellspacing:"0"}},[t("thead",[t("tr",[e._l(e.headerFields,function(a){return t("th",{key:a.name,staticClass:"c-text c-text--s",on:{click:function(n){return e.sort(a.name)}}},[e._v(" "+e._s(a.displayName)),e.sortField===a&&e.sortOrder=="asc"?t("span",{staticClass:"sort-icon"},[e._v("↑")]):e.sortField===a&&e.sortOrder=="desc"?t("span",{staticClass:"sort-icon"},[e._v("↓")]):e._e()])}),e.actions?t("th"):e._e()],2)]),t("tbody",e._l(e.sortedData,function(a){return t("tr",{key:a.email},[t("td",{staticClass:"user-info"},[t("img",{staticClass:"avatar",attrs:{src:a.image_url}}),t("div",{staticClass:"user-detail"},[t("span",{staticClass:"c-text c-text--m"},[e._v(e._s(a.user_name))]),t("span",{staticClass:"email c-text c-text--xs"},[e._v(e._s(a.email))])])]),e._l(e.fields,function(n){return t("td",{key:n.name},[t("span",{staticClass:"c-text c-text--m"},[e._v(e._s(e.formatField(n,a)))])])}),e.actions?t("td",{staticClass:"actions"},[t("div",{staticClass:"action-icon",on:{click:function(n){n.stopPropagation(),e.actionMenuUser=a}}},[t("sm-icons",[e._v("ellipsis-h")])],1),e.actionMenuUser===a?t("div",{staticClass:"action-menu"},e._l(e.actions,function(n){return t("div",{key:n.name,staticClass:"item c-text c-text--m",class:{disabled:!n.enabled(a)},on:{click:()=>n.enabled(a)?n.func(a):void 0}},[e._v(" "+e._s(n.name)+" ")])}),0):e._e()]):e._e()],2)}),0)])},gd=[],hd=T(vd,fd,gd,!1,null,"7f501ea8",null,null);const yd=hd.exports,Ot={ANDEV_2822_REMOVE_THEME_FEATURED_ARTICLES:!0,ANDEV_2633_RECOMMENDED_NEW_MARKS:!1},Cd=s=>s in Ot;Object.keys(Ot).forEach(s=>{Cd(s)&&(Ot[s]=Ot[s])});const st=Ot,bd=(s,e,t)=>{const a={feed:void 0,related:void 0,technical_literature:void 0,featured_articles:void 0};if(e.feed_last_updated_at){const n=s==="all"&&((t==null?void 0:t.enable_foreign_lang_media)??!1)&&!e.is_chinese,r=s==="foreign"||s==="all"&&e.is_chinese?"foreign":"domestic",o=oe(e.feed_last_updated_at).format("YYYY-MM-DD"),i=e.keyword_feed_counts[o]??{domestic:0,foreign:0},u=n?i.domestic+i.foreign:i[r];a.feed=u;const c={domestic:Math.min(Qs,e.related_feed_counts.domestic),foreign:Math.min(Qs,e.related_feed_counts.foreign)},p=n?c.domestic+c.foreign:c[r];a.related=p;const m=n?e.research_paper_feed_counts.domestic+e.research_paper_feed_counts.foreign:e.research_paper_feed_counts[r],d=n?e.patent_feed_counts.domestic+e.patent_feed_counts.foreign:e.patent_feed_counts[r];a.technical_literature=(e.is_research_paper_enabled?m:0)+(e.is_patent_enabled?d:0);const _=e.featured_article_feed_count;a.featured_articles=_}return a},Zs=(s,e,t)=>{const a=bd(s,e,t),n={name:"フィード",count:a.feed,linkTo:{name:"themeFeed",params:{themeId:e.id}}},r={name:"関連ニュース",count:a.related,linkTo:{name:"themeRelatedNews",params:{themeId:e.id,type:"related_articles"}}},o={name:"論文・特許",count:a.technical_literature,linkTo:{name:"themeTechnicalLiterature",params:{themeId:e.id}}},i={name:"注目記事",count:a.featured_articles,linkTo:{name:"themeFeaturedArticles",params:{themeId:e.id,type:"featured_articles"}}};let u=st.ANDEV_2822_REMOVE_THEME_FEATURED_ARTICLES?[r]:[r,i];const c=t==null?void 0:t.enable_technical_literature,p=e.is_research_paper_enabled||e.is_patent_enabled;c&&p&&(st.ANDEV_2822_REMOVE_THEME_FEATURED_ARTICLES?u=[r,o]:u=[r,o,i]);const m={name:"設定",linkTo:{name:"themeEdit",params:{themeId:e.id}}};return!e.is_chinese?[n,...u,m]:[n,m]},ga=(s,e,t,a=!1)=>{var i,u;if(!s||!s.access_scope)return"";const n=s.access_scope==="group"?(i=e.find(c=>c.id===s.group_id))==null?void 0:i.name:s.access_scope==="personal"?"個人":"全体",r=s.creator_id?`作成者：${(u=t.find(c=>c.id===s.creator_id))==null?void 0:u.user_name}`:"",o=a?`作成日：${De(s.created_at)}`:"";return[n,s.description,o,r].filter(c=>c&&c.length>0).join("・")},Br=(s,e,t)=>{if(!s)return[];const a=e?e.query_ja:"",n=e?e.query_en:"";return s.flatMap(r=>a!==""&&n!==""&&r.query_ja!==""&&r.query_en!==""?t?[`(${r.query_ja}) (${a})`,`(${r.query_en}) (${n})`]:[`(${r.query_ja}) (${a})`]:a!==""&&r.query_ja!==""?t?[`(${r.query_ja}) (${a})`,r.query_en]:[`(${r.query_ja}) (${a})`]:n!==""&&r.query_en!==""?t?[r.query_ja,`(${r.query_en}) (${n})`]:[r.query_ja]:t?[r.query_ja,r.query_en]:[r.query_ja]).filter(r=>!!r)},Ad=D({components:{Header:Se,AdminContent:St,UserTable:yd},methods:{getThemeHeaderDetail:ga},setup(){const{data:s}=nt(),{data:e}=Pe(),{data:t}=Qe(),a=ie(),n=se(),r=fe(),o=Number(a.params.themeId),i=l(()=>{var d;return(d=s.value)==null?void 0:d.themes.find(_=>_.id===o)}),u=[{name:"is_favorite",displayName:"お気に入り",type:"boolean"},{name:"role",displayName:"権限",type:"role"}],{data:c,mutate:p}=Yc(o);ne(()=>Mt());const m=()=>{n.commit("modal/showModal","userInvite")};return r.$on("theme-member-added",()=>{p()}),{theme:i,groups:e,teamUsers:t,fields:u,themeUsers:c,showThemeInvite:m}}});var kd=function(){var e=this,t=e._self._c;return e._self._setupProxy,e.theme&&e.groups&&e.teamUsers&&e.themeUsers?t("div",{staticClass:"theme-memeber-admin"},[t("Header",{attrs:{title:`${e.theme.name}`,detail:e.getThemeHeaderDetail(e.theme,e.groups.groups,e.teamUsers.users,!0),section:"テーマ管理",sectionLink:{name:"themeAdmin"},settingsLink:{name:"themeEdit",params:{themeId:e.theme.id}},icon:"hashtag",headerWidth:"100%"}}),t("AdminContent",[t("div",{staticClass:"content"},[t("div",{staticClass:"members"},[t("div",{staticClass:"header"},[t("span",[t("span",{staticClass:"c-title c-title--m"},[e._v("メンバー")]),t("span",{staticClass:"favorite-count c-text c-text--s"},[e._v("・メンバー"+e._s(e.themeUsers.theme_users.length)+"（お気に入り："+e._s(e.themeUsers.theme_users.filter(a=>a.is_favorite).length)+"名）")])]),t("div",{staticClass:"add-member-button"},[t("button",{staticClass:"m-create-button c-btn c-btn--auto c-btn--AnewsPrimary c-text c-text--m",on:{click:e.showThemeInvite}},[e._v(" メンバー追加 ")])])]),t("div",[t("UserTable",{staticClass:"table",attrs:{fields:e.fields,data:e.themeUsers.theme_users}})],1)])])])],1):e._e()},xd=[],wd=T(Ad,kd,xd,!1,null,"053b83bb",null,null);const Ed=wd.exports;const Fd={};var Td=function(){var e=this;return e._self._c,e._m(0)},Dd=[function(){var s=this,e=s._self._c;return e("div",{staticClass:"adp-document-card-skeleton loading"},[e("div",{staticClass:"m-sentences-skeleton"},[e("div",{staticClass:"m-line1"}),e("div",{staticClass:"m-line1"}),e("div",{staticClass:"m-line2"}),e("div",{staticClass:"spacing-16"}),e("div",{staticClass:"m-line3"}),e("div",{staticClass:"m-line2"})])])}],Bd=T(Fd,Td,Dd,!1,null,"9cc2ed20",null,null);const Sd=Bd.exports,Id=D({components:{AdpDocumentAllianceMediaSkeleton:Sd},props:{adpDocument:{type:Object,required:!0},teamInfo:Object},setup(s){const e=l(()=>s.adpDocument.content?s.adpDocument.content.split(`
`):[]),t=l(()=>{var n;return(n=s.adpDocument)!=null&&n.image_url?s.adpDocument.image_url:"https://www.nikkan.co.jp/images/hd_logo.png"}),a=l(()=>{var n;return(n=s.adpDocument)!=null&&n.published_at?De(s.adpDocument.published_at):void 0});return{content:e,isMobileUser:Vt(),imageUrl:t,publishedAt:a}}});var Md=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"document-basic-info"},[t("img",{staticClass:"lazyload alliance-image",class:{"mobile-alliance-image":e.isMobileUser},attrs:{loading:"lazy",src:e.imageUrl,"data-src":e.imageUrl}}),t("div",{staticClass:"spacing-24"}),t("div",{staticClass:"document-info-box"},[t("div",{staticClass:"document-title c-text c-text--xm"},[e._v(" "+e._s(e.adpDocument.title)+" ")]),t("div",{staticClass:"spacing-08"}),e.publishedAt?t("div",{staticClass:"document-date c-text c-text--s"},[e._v(" "+e._s(e.publishedAt)+" ")]):e._e(),e.teamInfo?t("div",[e.teamInfo.enable_alliance_media?t("div",{attrs:{role:"article"}},e._l(e.content,function(a){return t("p",{key:a,staticClass:"content-line c-text c-text--m"},[e._v(" "+e._s(a)+" ")])}),0):t("div",{staticClass:"uncontracted-alliance c-text c-text--m"},[e._v(" 本文を読むには、有料記事オプションを契約ください。"),t("br"),e._v(" （管理者またはサポートにお問い合わせください） ")])]):t("AdpDocumentAllianceMediaSkeleton")],1)])},$d=[],Pd=T(Id,Md,$d,!1,null,"760079f5",null,null);const Sr=Pd.exports,Ir={article:"記事",research_paper:"論文",patent:"特許"},Mr=s=>s?Ir[s.doc_type]:"",$r=s=>ot(s)?s.media_name:Gt(s)?s.journal_name:ns(s)?s.applicant:"",Nd=D({props:{adpDocument:{type:Object,required:!0},marginTop:{type:String,default:"0px"},marginLeft:{type:String,default:"-150px"},isActionMenuShown:{type:Boolean},showUndisplayMenu:{type:Boolean,default:!0},isUndisplayButtonShown:{type:Boolean,required:!0},isSiteExclusionButtonShown:{type:Boolean,required:!0},isNotInterested:{type:Boolean,default:!1},articleExclusionId:{type:Number,default:null},isRemoveGroupMarkButtonShown:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},setup(s,e){const t=g(),a=g();let n=null;const r=()=>{s.disabled||e.emit("click-ellipsis")},o=h=>{!s.isActionMenuShown||!t.value||((h==null?void 0:h.composedPath())??[]).includes(t.value)||e.emit("close-menu")};ne(()=>{document.addEventListener("click",o,{capture:!0})}),Be(()=>{document.removeEventListener("click",o,{capture:!0})}),Z(a,()=>{a.value&&(n&&n.destroy(),n=new Dn(a.value),n.on("success",()=>{e.emit("click-copy",!0)}),n.on("error",()=>{e.emit("click-copy",!1)}))});const i=()=>{e.emit("click-undisplay")},u=()=>{e.emit("click-site-exclusion")},c=()=>{e.emit("click-not-interested")},p=()=>{e.emit("click-remove-not-interested")},m=()=>{e.emit("click-remove-group-mark")},d=l(()=>Mr(s.adpDocument)),_=l(()=>s.adpDocument.doc_type==="research_paper"&&s.adpDocument.pdf_url?s.adpDocument.pdf_url:s.adpDocument.url);return{actionMenuRef:t,clipboardButtonRef:a,onClickEllipsis:r,closeMenu:o,onClickUndisplay:i,onClickNotInterested:c,onClickRemoveNotInterested:p,onClickRemoveGroupMark:m,onClickSiteExclusion:u,docTypeDisplayName:d,copyLinkUrl:_}}});var Ld=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{ref:"actionMenuRef",staticClass:"m-action-menu",class:{"non-disabled":!e.disabled},on:{click:function(a){a.stopPropagation()}}},[t("button",{staticClass:"m-menu-button",on:{click:function(a){return a.preventDefault(),e.onClickEllipsis.apply(null,arguments)}}},[t("sm-icons",{staticClass:"small",class:{disabled:e.disabled}},[e._v("ellipsis-h")])],1),e.isActionMenuShown?t("div",{staticClass:"m-menu-list",class:{medium:e.isRemoveGroupMarkButtonShown,large:e.isNotInterested&&e.articleExclusionId!==null}},[t("ul",[t("li",[t("button",{ref:"clipboardButtonRef",staticClass:"m-item-button",attrs:{"data-clipboard-text":e.copyLinkUrl,"data-testid":"list-item-copy"}},[t("sm-icons",{staticClass:"small m-icon"},[e._v("chain")]),t("span",{staticClass:"c-text c-text--m"},[e._v("リンクをコピー")])],1)]),e.isUndisplayButtonShown&&e.showUndisplayMenu?t("li",[t("button",{staticClass:"m-item-button m-item",attrs:{"data-testid":"list-item-undisplay"},on:{click:e.onClickUndisplay}},[t("sm-icons",{staticClass:"m-item-icon small m-icon"},[e._v("eye-alt")]),t("div",{staticClass:"m-item-text"},[t("span",{staticClass:"c-text c-text--m"},[e._v("記事を非表示")]),e.adpDocument.lang!=="zh"?t("div",{staticClass:"m-item-explanation c-text c-text--xs"},[e._v(" AIが学習し、このような記事の"),t("br"),e._v("配信が少なくなります ")]):e._e()])],1)]):e._e(),e.isSiteExclusionButtonShown?t("li",[t("button",{staticClass:"m-item-button m-item",attrs:{"data-testid":"list-item-site-exclusion"},on:{click:e.onClickSiteExclusion}},[t("sm-icons",{staticClass:"m-item-icon small m-icon"},[e._v("ban")]),e._m(0)],1)]):e._e(),e.isNotInterested&&e.articleExclusionId===null?t("li",[t("button",{staticClass:"m-item-button",attrs:{"data-testid":"list-item-not-interested"},on:{click:e.onClickNotInterested}},[t("sm-icons",{staticClass:"small m-icon"},[e._v("thumbs-down")]),t("span",{staticClass:"c-text c-text--m"},[e._v("この"+e._s(e.docTypeDisplayName)+"に興味がない")])],1)]):e._e(),e.isNotInterested&&e.articleExclusionId!==null?t("li",[t("button",{staticClass:"m-item-button",attrs:{"data-testid":"list-item-remove-not-interested"},on:{click:e.onClickRemoveNotInterested}},[t("sm-icons",{staticClass:"small m-icon"},[e._v("thumbs-down")]),t("span",{staticClass:"c-text c-text--m"},[e._v("「この"+e._s(e.docTypeDisplayName)+"に興味がない」を取り消し")])],1)]):e._e(),e.isRemoveGroupMarkButtonShown?t("li",[t("button",{staticClass:"m-item-button",attrs:{"data-testid":"list-item-remove-group-mark"},on:{click:e.onClickRemoveGroupMark}},[t("sm-icons",{staticClass:"small m-icon"},[e._v("users")]),t("span",{staticClass:"c-text c-text--m"},[e._v("このグループからグループマークを外す")])],1)]):e._e()])]):e._e()])},Ud=[function(){var s=this,e=s._self._c;return s._self._setupProxy,e("div",{staticClass:"m-item-text"},[e("span",{staticClass:"c-text c-text--m"},[s._v("このメディアを除外")]),e("div",{staticClass:"m-item-explanation c-text c-text--xs"},[s._v(" このメディアが配信されないように"),e("br"),s._v("設定タブからも編集できます ")])])}],Rd=T(Nd,Ld,Ud,!1,null,"c9df3143",null,null);const Od=Rd.exports,Gd=D({props:{adpDocument:{type:Object,required:!0},small:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},setup(s,{emit:e}){const t=Number(N.getUserId()),a=l(()=>s.adpDocument.marks),n=l(()=>s.disabled?void 0:{content:o.value===0?au:da(a.value??[],"marks"),delay:{show:300},offset:8,autoHide:!1}),r=l(()=>(a.value??[]).length>0),o=l(()=>{var f;return(f=a.value)==null?void 0:f.length}),i=l(()=>{var f;return(f=a.value)==null?void 0:f.some(C=>C.user_id===t)}),u=g(!1),c=g(!1),p=()=>{s.disabled||i.value||(u.value=!0)},m=()=>{c.value||(u.value=!1)},d=()=>{s.disabled||(c.value=!0,u.value=!0)},_=()=>{c.value=!1,u.value=!1},h=()=>{_(),e("clickOpenMarkModalButton")},v=()=>{s.disabled||(_(),e("clickMarkButton"))};return ne(()=>{document.addEventListener("click",_)}),Be(()=>{document.removeEventListener("click",_)}),{markUsersTooltip:n,marked:r,markCount:o,hasMyMark:i,showMarkAction:p,hideMarkAction:m,isMarkActionVisible:u,openMarkAction:d,clickMarkButton:v,clickOpenModal:h}}});var qd=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"mark-button",class:{"non-disabled":!e.disabled},on:{mouseleave:e.hideMarkAction}},[t("div",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:e.markUsersTooltip,expression:"markUsersTooltip",modifiers:{top:!0}}],staticClass:"content",class:{small:e.small,marked:e.hasMyMark},on:{click:function(a){return a.stopPropagation(),e.clickMarkButton.apply(null,arguments)},mouseleave:e.hideMarkAction}},[t("sm-icons",{key:`icon-${e.hasMyMark}`,staticClass:"mark-icon small",class:{primary:e.hasMyMark,disabled:e.disabled}},[e._v(e._s(e.hasMyMark?"check-circle-fill":"check-circle"))]),t("div",{staticClass:"mark-text c-title c-title--s",class:{active:e.hasMyMark}},[e._v(" "+e._s(e.markCount>0?e.markCount:"")+" ")])],1),e.hasMyMark?e._e():t("div",{key:`open-${e.isMarkActionVisible}`,staticClass:"action-toggle",class:{"small-button":e.small},on:{click:function(a){return a.stopPropagation(),a.preventDefault(),e.openMarkAction.apply(null,arguments)},mouseover:e.showMarkAction}},[t("sm-icons",{staticClass:"small",class:{disabled:e.disabled}},[e._v(e._s(e.isMarkActionVisible?"angle-up":"angle-down"))])],1),e.isMarkActionVisible?t("div",{staticClass:"mark-action"},[t("div",{staticClass:"modal-button c-text c-text--m",on:{click:function(a){return a.stopPropagation(),a.preventDefault(),e.clickOpenModal.apply(null,arguments)}}},[e._v(" タグ・メモをしてマーク ")])]):e._e()])},Hd=[],Vd=T(Gd,qd,Hd,!1,null,"e7d18656",null,null);const Pr=Vd.exports,jd=D({components:{ActionMenu:Od,MarkButton:Pr},props:{adpDocument:{type:Object,required:!0},comments:{type:Array,default:()=>[]},hasActionMenu:{type:Boolean},hasShortUserName:{type:Boolean},isUndisplayButtonShown:{type:Boolean,required:!0},isSiteExclusionButtonShown:{type:Boolean,required:!0},isRemoveGroupMarkButtonShown:{type:Boolean},isMarkingArticle:{type:Boolean,required:!0},isNotInterested:{type:Boolean},articleExclusionId:{type:Number,default:null},disabled:{type:Boolean,default:!1}},setup(s,e){const t=se(),a=g(!1),n=l(()=>s.disabled?void 0:{content:A.value===0?nu:pr(s.adpDocument.group_marks),delay:{show:300},offset:8,autoHide:!1}),r=l(()=>s.disabled?void 0:{content:k.value===0?ru:_r(s.comments),delay:{show:300},offset:8,autoHide:!1}),o=b=>{b?t.commit("snackbar/addMessages",{message:"リンクをコピーしました",type:""}):t.commit("snackbar/addMessages",{message:"リンクをコピーできませんでした",type:"error"}),u()},i=()=>{a.value=!a.value},u=()=>{a.value=!1},c=()=>{u(),e.emit("click-undisplay")},p=()=>{u(),e.emit("click-site-exclusion")},m=()=>{u(),e.emit("click-not-interested")},d=()=>{u(),e.emit("click-remove-not-interested")},_=l(()=>s.adpDocument.doc_type==="patent"),h=()=>{s.isMarkingArticle||e.emit("click-mark-icon")},v=()=>{s.isMarkingArticle||e.emit("click-open-mark-modal")},f=()=>{s.disabled||_.value||e.emit("click-comment-icon")},C=()=>{u(),e.emit("click-remove-group-mark")},y=l(()=>(s.adpDocument.group_marks??[]).length>0),A=l(()=>(s.adpDocument.group_marks??[]).length),k=l(()=>s.comments.length);return{clickMarkIcon:h,clickOpenMarkModal:v,clickGroupMarkIcon:()=>{s.disabled||_.value||e.emit("click-group-mark-icon")},markGroupsTooltip:n,groupMarked:y,groupMarkCount:A,commentUsersTooltip:r,clickCommentIcon:f,commentCount:k,isActionMenuShown:a,closeActionMenu:u,toggleActionMenu:i,onClickCopyButton:o,undisplayArticle:c,siteExclusionArticle:p,notInterestedArticle:m,removeNotInterestedArticle:d,onClickRemoveGroupMark:C,isPatent:_}}});var Kd=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"m-article-card-user-action"},[t("div",{staticClass:"m-mark-and-comment"},[t("MarkButton",{attrs:{adpDocument:e.adpDocument,disabled:e.disabled},on:{clickMarkButton:e.clickMarkIcon,clickOpenMarkModalButton:e.clickOpenMarkModal}}),e.isPatent?e._e():t("div",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:e.markGroupsTooltip,expression:"markGroupsTooltip",modifiers:{top:!0}}],staticClass:"m-article-card-mark",on:{click:function(a){return a.stopPropagation(),e.clickGroupMarkIcon.apply(null,arguments)}}},[e.groupMarked?t("div",{staticClass:"m-mark-info-wrap"},[t("div",{staticClass:"m-mark-info m-action-button",class:{"non-disabled":!e.disabled}},[t("sm-icons",{staticClass:"small icon m-icon__outer",class:{disabled:e.disabled}},[e._v("group-mark")]),t("div",{staticClass:"m-article-card-mark-count c-title c-title--s"},[e._v(" "+e._s(e.groupMarkCount)+" ")])],1)]):t("div",{staticClass:"m-no-mark m-action-button c-title c-title--s",class:{"non-disabled":!e.disabled}},[t("div",{staticClass:"m-no-mark-icon-wrap"},[t("sm-icons",{staticClass:"small m-icon__outer",class:{disabled:e.disabled}},[e._v("group-mark")])],1)])]),e.isPatent?e._e():t("div",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:e.commentUsersTooltip,expression:"commentUsersTooltip",modifiers:{top:!0}}],staticClass:"m-article-card-comment-wrap"},[t("div",{staticClass:"m-article-card-comment",on:{click:function(a){return a.stopPropagation(),e.clickCommentIcon.apply(null,arguments)}}},[e.commentCount>0?t("div",{staticClass:"m-has-comment m-action-button",class:{"non-disabled":!e.disabled}},[t("sm-icons",{staticClass:"small o-icon m-icon__outer",class:{disabled:e.disabled}},[e._v("comment")]),t("div",{staticClass:"m-article-card-media-comment-count c-title c-title--s"},[e._v(" "+e._s(e.commentCount)+" ")])],1):t("div",{staticClass:"m-has-not-comment m-action-button",class:{"non-disabled":!e.disabled}},[t("sm-icons",{staticClass:"small o-icon m-icon__outer",class:{disabled:e.disabled}},[e._v("comment")]),t("div",{staticClass:"m-comment-text c-title c-title--s"})],1)])])],1),e.hasActionMenu?t("div",{staticClass:"m-article-card-action-icon-list"},[t("ActionMenu",{attrs:{adpDocument:e.adpDocument,isActionMenuShown:e.isActionMenuShown,isUndisplayButtonShown:e.isUndisplayButtonShown,isSiteExclusionButtonShown:e.isSiteExclusionButtonShown,isNotInterested:e.isNotInterested,articleExclusionId:e.articleExclusionId,isRemoveGroupMarkButtonShown:e.isRemoveGroupMarkButtonShown,disabled:e.disabled},on:{"close-menu":e.closeActionMenu,"click-ellipsis":e.toggleActionMenu,"click-copy":e.onClickCopyButton,"click-undisplay":e.undisplayArticle,"click-site-exclusion":e.siteExclusionArticle,"click-not-interested":e.notInterestedArticle,"click-remove-not-interested":e.removeNotInterestedArticle,"click-remove-group-mark":e.onClickRemoveGroupMark}})],1):e._e()])},Yd=[],Qd=T(jd,Kd,Yd,!1,null,"e0c6c098",null,null);const Nr=Qd.exports,Lr=""+new URL("noimage-3to1-fc0656c3.jpg",import.meta.url).href,Ur=(s,e)=>{const t=s.currentTarget,a=t.href,n=e;localStorage.setItem("redirectSendViewParams",JSON.stringify(n)),t.href=`/#/redirect?url=${a}`},Rr=s=>{const e=s.target,t=e.href,a="/#/redirect?url=",n=t.indexOf(a);if(n===-1)return;const r=t.substring(n+a.length);e.href=r},Wd=D({props:{adpDocument:{type:Object,required:!0},themeId:{type:Number},groupId:{type:Number},rankInWholeFeed:{type:Number},pageName:{type:String,required:!0},feature:{type:String},feedType:{type:String},searchData:{type:Object},industryData:{type:Object},trendCompanyText:{type:String,default:""},usePdfUrl:{type:Boolean,default:!0}},setup(s){const e=ie(),t=fe(),a=Ye(),n=l(()=>s.adpDocument.doc_type==="research_paper"&&s.adpDocument.pdf_url!==void 0&&s.adpDocument.pdf_url!==null),r=l(()=>n.value&&s.usePdfUrl&&s.adpDocument.pdf_url?s.adpDocument.pdf_url:s.adpDocument.url),o=l(()=>({adpDocument:s.adpDocument,themeId:s.themeId,groupId:s.groupId,rankInWholeFeed:s.rankInWholeFeed,trackingBaseData:{pageName:s.pageName,pageUrl:e.fullPath,feature:s.feature,feedType:s.feedType},searchData:s.searchData,industryData:s.industryData,siteType:n.value?s.usePdfUrl?"pdf_direct":"provider":void 0,description:s.trendCompanyText}));return{href:r,formatDate:De,tapArticle:async()=>{s.adpDocument&&Ka(s.adpDocument)&&(t.$emit("article-updated",{...s.adpDocument,is_read:!0}),Ge.trackArticleView(a),F.sendView(o.value))},setRightClickRedirectUrl:c=>{Ka(s.adpDocument)&&Ur(c,o.value)},unsetRedirectUrl:Rr}}});var zd=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("a",{attrs:{href:e.href,target:"_blank"},on:{click:function(a){return a.stopPropagation(),e.tapArticle()},mouseup:function(a){return"button"in a&&a.button!==1?null:e.tapArticle()},contextmenu:e.setRightClickRedirectUrl,mouseleave:e.unsetRedirectUrl}},[e._t("default")],2)},Jd=[],Xd=T(Wd,zd,Jd,!1,null,"4d2bf883",null,null);const Zd=Xd.exports,Kt=""+new URL("noimage-4to3-d54e119e.jpg",import.meta.url).href,em=""+new URL("noimage-16to9-693af7e3.jpg",import.meta.url).href,tm=(s,e)=>{var t,a,n,r;if(Je(s)&&((t=s.response)==null?void 0:t.status)===401){e.$router.push({name:"login"});return}if(Je(s)&&s.code===Jo.ECONNABORTED){Vs(`timeout occurs at the request to ${(((n=(a=s.config)==null?void 0:a.baseURL)==null?void 0:n.slice(0,-1))??"")+(((r=s.config)==null?void 0:r.url)??"")}`,"error");return}if(s.message===Ws){e.$store.commit("snackbar/addMessages",{message:"予期しない通信エラーが発生しました。<br>お使いのネットワークの設定などをご確認ください。",type:"error"}),Vs(Ws,"warning");return}throw s},sm={"1to1":It,"3to1":Lr,"4to3":Kt,"16to9":em},am=(s,e)=>{s.target instanceof HTMLImageElement&&(s.target.src=sm[e])},nm=D({components:{AdpDocumentCardLink:Zd},methods:{isArticle:ot,isResearchPaper:Gt,imageErrorHandler:am},props:{adpDocument:{type:Object,required:!0},isNewArticle:{type:Boolean,default:!1},trendCompanyText:{type:String},size:{type:String,default:"m"},userEnableTranslateTitle:{type:Boolean},themeId:{type:Number},groupId:{type:Number},rankInWholeFeed:{type:Number},pageName:{type:String,required:!0},feature:{type:String},feedType:{type:String},searchData:{type:Object},industryData:{type:Object}},setup(s){const e=l(()=>$r(s.adpDocument)),t=l(()=>{var d,_;return s.userEnableTranslateTitle&&((d=s.adpDocument)==null?void 0:d.lang)!=="ja"&&!!((_=s.adpDocument)!=null&&_.translated_title)}),a=l(()=>{var d,_;return t.value?(d=s.adpDocument)==null?void 0:d.translated_title:(_=s.adpDocument)==null?void 0:_.title}),n=l(()=>{var d;return(d=s.adpDocument)!=null&&d.published_at?De(s.adpDocument.published_at):void 0}),r=l(()=>ot(s.adpDocument)?s.adpDocument.login_required??!1:!1),o=l(()=>{var d;return(d=s.adpDocument)!=null&&d.image_url?s.adpDocument.image_url:s.size==="l"?Lr:It}),i=l(()=>{var d;return(d=s.adpDocument)==null?void 0:d.pdf_url}),u=l(()=>Gt(s.adpDocument)&&s.adpDocument.is_priority_journal),c=l(()=>{if(ns(s.adpDocument))return s.adpDocument.patent_identifier}),p=l(()=>{if(ns(s.adpDocument))return s.adpDocument.issue}),m={adpDocument:s.adpDocument,themeId:s.themeId,groupId:s.groupId,pageName:s.pageName,feature:s.feature,feedType:s.feedType,rankInWholeFeed:s.rankInWholeFeed,searchData:s.searchData,industryData:s.industryData,trendCompanyText:s.trendCompanyText};return{documentPublisher:e,enableTranslateTitle:t,adpDocumentTitle:a,publishedAt:n,articleLoginRequired:r,imageUrl:o,isPdf:i,isPriorityJournal:u,patentIdentifier:c,patentIssue:p,TOOLTIP_FOR_PRIORITY_JOURNAL:Xi,linkProps:m,TOOLTIP_FOR_LOGIN_REQUIRED:ou,TOOLTIP_FOR_ALLIANCE_MEDIA:iu}}});var rm=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"document-basic-info",class:{"document-basic-info-m":e.size==="m","document-basic-info-l":e.size==="l"}},[t("div",{staticClass:"document-info-image"},[e.size==="l"?t("div",{staticClass:"document-img-l"},[t("AdpDocumentCardLink",e._b({},"AdpDocumentCardLink",e.linkProps,!1),[t("img",{staticClass:"lazyload",attrs:{loading:"lazy",src:e.imageUrl,"data-src":e.imageUrl},on:{error:function(a){return e.imageErrorHandler(a,"3to1")}}})])],1):e._e(),t("div",{staticClass:"document-info-box"},[t("div",{staticClass:"document-sub-info"},[t("div",{directives:[{name:"tooltip",rawName:"v-tooltip.bottom",value:e.isPriorityJournal?{content:e.TOOLTIP_FOR_PRIORITY_JOURNAL,delay:{show:300},offset:0,autoHide:!1}:void 0,expression:`
              isPriorityJournal
                ? {
                    content: TOOLTIP_FOR_PRIORITY_JOURNAL,
                    delay: { show: 300 },
                    offset: 0,
                    autoHide: false
                  }
                : undefined
            `,modifiers:{bottom:!0}}],staticClass:"document-media-name c-text c-text--s"},[t("span",{staticClass:"text-content"},[e._v(" "+e._s(e.documentPublisher)+" ")]),e.isPriorityJournal?t("span",{staticClass:"priority-journal c-text c-text--xs"},[e._v("SJR")]):e._e(),e.articleLoginRequired?t("div",{directives:[{name:"tooltip",rawName:"v-tooltip.bottom",value:{content:e.TOOLTIP_FOR_LOGIN_REQUIRED,delay:{show:300},offset:8,autoHide:!1},expression:`{
                content: TOOLTIP_FOR_LOGIN_REQUIRED,
                delay: { show: 300 },
                offset: 8,
                autoHide: false
              }`,modifiers:{bottom:!0}}],staticClass:"m-login-required"},[t("sm-icons",{staticClass:"small"},[e._v("lock-fill")])],1):e.adpDocument.is_alliance_media?t("div",{directives:[{name:"tooltip",rawName:"v-tooltip.bottom",value:{content:e.TOOLTIP_FOR_ALLIANCE_MEDIA,delay:{show:300},offset:8,autoHide:!1},expression:`{
                content: TOOLTIP_FOR_ALLIANCE_MEDIA,
                delay: { show: 300 },
                offset: 8,
                autoHide: false
              }`,modifiers:{bottom:!0}}],staticClass:"m-alliance-media"},[t("sm-icons",{staticClass:"small"},[e._v("unlock-fill")])],1):e._e()])]),t("div",{staticClass:"title-link"},[t("div",{staticClass:"document-title",class:{"c-text c-text--xm":e.size==="m","c-title c-title--l":e.size==="l"}},[t("AdpDocumentCardLink",e._b({class:{read:e.adpDocument.is_read,"is-pdf":e.isPdf}},"AdpDocumentCardLink",e.linkProps,!1),[e._v(" "+e._s(e.adpDocumentTitle)+" ")])],1),e.enableTranslateTitle?t("div",{staticClass:"document-original-title c-text c-text--s"},[t("AdpDocumentCardLink",e._b({},"AdpDocumentCardLink",e.linkProps,!1),[e._v(" 元タイトル："+e._s(e.adpDocument.title)+" ")])],1):e._e()]),e.isPdf&&e.isResearchPaper(e.adpDocument)?t("div",{staticClass:"document-original-site c-text c-text--s"},[t("AdpDocumentCardLink",e._b({},"AdpDocumentCardLink",{...e.linkProps,usePdfUrl:!1},!1),[e._v(" 提供サイトで見る ")])],1):e._e(),t("div",{staticClass:"document-sub-info"},[e.publishedAt?t("div",{staticClass:"document-date c-text c-text--s"},[e._v(" "+e._s(e.publishedAt)+" ")]):e._e(),e.isNewArticle?t("div",{staticClass:"new-tag"},[e._v("新着")]):e._e(),e.patentIdentifier?t("div",{staticClass:"c-text c-text--s"},[e._v(" ・"+e._s(e.patentIdentifier)+" ")]):e._e()]),t("div",{staticClass:"spacing-08"}),e.trendCompanyText?t("div",{staticClass:"trend-company c-text c-text--s"},[e._v(" "+e._s(e.trendCompanyText)+" ")]):e._e()]),e.size==="m"?t("div",{staticClass:"document-image-wrap"},[t("AdpDocumentCardLink",e._b({staticClass:"image-link"},"AdpDocumentCardLink",e.linkProps,!1),[t("img",{staticClass:"document-image o-article-image lazyload",class:{"o-alliance-image":e.adpDocument.is_alliance_media},attrs:{loading:"lazy",src:e.imageUrl,"data-src":e.imageUrl},on:{error:function(a){return e.imageErrorHandler(a,"1to1")}}})])],1):e._e()]),e.patentIssue?t("div",{staticClass:"patent-issue c-text c-text--s"},[e._v(" "+e._s(e.patentIssue)+" ")]):e._e()])},om=[],im=T(nm,rm,om,!1,null,"e9bbf876",null,null);const Or=im.exports;const um=D({props:{comment:{type:Object,required:!0}},setup(s){const e=se(),t=fe(),{data:a}=xe();ne(()=>{document.addEventListener("click",i)}),Be(()=>{document.removeEventListener("click",i)});const n=l(()=>{var p,m;return((p=a.value)==null?void 0:p.role)==="admin"||((m=a.value)==null?void 0:m.id)===s.comment.user_id}),r=g(!1),o=()=>{r.value=!0},i=()=>{r.value=!1};return{hasPermission:n,isCommentMenuOpen:r,openCommentMenu:o,closeCommentMenu:i,userInfo:a,openCommentEditModal:()=>{e.commit("modal/setComment",s.comment),e.commit("modal/showModal","commentEdit")},deleteComment:async()=>{const m={headerText:"コメントを削除しますか？",bodyText:"",action:async()=>{var d,_,h;if(await F.deleteComment((d=s.comment)==null?void 0:d.id).catch(v=>{throw e.commit("snackbar/addMessages",{message:"コメントを削除できませんでした",type:"error"}),v}),e.commit("snackbar/addMessages",{message:"コメントを削除しました",type:""}),t.$emit("comment-deleted",(_=s.comment)==null?void 0:_.id),(h=s.comment)!=null&&h.article){const v=s.comment.article;v.comments=s.comment.article.comments.filter(f=>{var C;return f.id!==((C=s.comment)==null?void 0:C.id)}),t.$emit("article-updated",v)}}};e.commit("confirmationModal/showConfirmationModal"),e.commit("confirmationModal/setTextAndAction",m)}}}});var cm=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"article-comment-menu"},[e.hasPermission?t("div",{staticClass:"ellipsis-button",on:{click:function(a){return a.preventDefault(),a.stopPropagation(),e.openCommentMenu.apply(null,arguments)}}},[t("sm-icons",{staticClass:"small"},[e._v("ellipsis-h")])],1):t("div",{staticClass:"spacing-24"}),e.hasPermission&&e.isCommentMenuOpen?t("div",{staticClass:"comment-menu-body comment-menu-small c-text c-text--m"},[e.hasPermission?t("div",{staticClass:"comment-edit",on:{click:function(a){a.preventDefault(),e.openCommentEditModal(),e.closeCommentMenu()}}},[e._v(" コメントを編集 ")]):e._e(),e.hasPermission?t("div",{staticClass:"comment-delete",on:{click:function(a){return a.preventDefault(),e.deleteComment.apply(null,arguments)}}},[e._v(" コメントを削除 ")]):e._e()]):e._e()])},lm=[],dm=T(um,cm,lm,!1,null,"d1424f8b",null,null);const mm=dm.exports,_m=D({props:{tooltipText:{type:String},count:{type:Number},isReactedByMe:{type:Boolean},reaction:{type:String}},components:{},methods:{},setup(s){return{validImage:l(()=>s.reaction!==void 0)}}});var pm=function(){var e=this,t=e._self._c;return e._self._setupProxy,e.validImage?t("div",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:{content:e.tooltipText,delay:{show:300},offset:8,autoHide:!1},expression:`{
      content: tooltipText,
      delay: { show: 300 },
      offset: 8,
      autoHide: false
    }`,modifiers:{top:!0}}],staticClass:"m-comment-reaction",class:{"m-reacted":e.isReactedByMe}},[t("div",{staticClass:"reaction-emoji"},[e._v(" "+e._s(e.reaction)+" ")]),t("div",{staticClass:"m-reaction-count",class:e.isReactedByMe?["c-title","c-title--s"]:["c-text","c-text--s"]},[e._v(" "+e._s(e.count)+" ")])]):e._e()},vm=[],fm=T(_m,pm,vm,!1,null,"64be205e",null,null);const gm=fm.exports,hm=D({components:{CommentReaction:gm},props:{comment:{type:Object,required:!0}},setup(s,e){const t=se(),a=l(()=>t.state.userInfo.userInfo),n=u=>{e.emit("click",{comment:s.comment,reaction:u})},r=u=>da(u),o=l(()=>vu(s.comment.emoji_reactions));return{onClickEmojiReaction:n,formatTooltipUsersText:r,processEmojiReactions:o,containsMyReaction:u=>u.map(p=>p.id).some(p=>{var m;return p===((m=a.value)==null?void 0:m.id)})}}});var ym=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"m-comment-reaction-list"},e._l(e.processEmojiReactions,function(a){return t("div",{key:a.reaction,staticClass:"m-comment-reaction-wrap",on:{click:function(n){return n.preventDefault(),e.onClickEmojiReaction(a.reaction)}}},[t("CommentReaction",{attrs:{tooltipText:e.formatTooltipUsersText(a.users),isReactedByMe:e.containsMyReaction(a.users),count:a.users.length,reaction:a.reaction}})],1)}),0)},Cm=[],bm=T(hm,ym,Cm,!1,null,"edaba404",null,null);const Am=bm.exports,km=D({setup(s,e){const t=se(),a=l(()=>t.state.userInfo.userInfo),n=g(!1),r=(c,p,m)=>c.emoji_reactions.find(d=>d.reaction===p&&d.user_id===m),o=async(c,p)=>{const m=c.emoji_reactions.slice();c.emoji_reactions=c.emoji_reactions.filter(d=>{var _;return!(d.user_id===((_=a.value)==null?void 0:_.id)&&d.reaction===p.reaction)});try{await F.deleteReaction(c.id,p.id)}catch(d){throw c.emoji_reactions=m,d}},i=async(c,p)=>{var d,_,h,v;if(!a.value)return;const m=c.emoji_reactions.slice();c.emoji_reactions.push({id:0,user_id:(d=a.value)==null?void 0:d.id,user_name:(_=a.value)==null?void 0:_.user_name,reaction:p,created_at:oe().format()});try{const f=await F.postEmojiReaction(c.id,p);c.emoji_reactions[c.emoji_reactions.length-1].id=f.id}catch(f){throw c.emoji_reactions=m,Je(f)&&((h=f.response)==null?void 0:h.data.type)==="too_many_reaction_types"&&t.commit("snackbar/addMessages",{message:(v=f.response)==null?void 0:v.data.message,type:"error"}),f}};return{toggleEmojiReaction:async(c,p,m)=>{if(n.value||!a.value)return;n.value=!0;const d=r(p,m,a.value.id);if(d?await o(p,d).catch(()=>{}):await i(p,m).catch(()=>{}),c&&c.comments){const _=c.comments.findIndex(h=>h.id===p.id);c.comments[_]=p,e.emit("article-updated",c)}n.value=!1}}}});var xm=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"m-comment-box"},[e._t("default",null,{toggleEmojiReaction:e.toggleEmojiReaction})],2)},wm=[],Em=T(km,xm,wm,!1,null,"70fce5c1",null,null);const Fm=Em.exports,Tm=D({props:{loading:{type:Boolean,default:!1}},setup(){return{}}});var Dm=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"adp-document-card-skeleton",class:{loading:e.loading}},[e._m(0),t("div",{staticClass:"m-image-skeleton"})])},Bm=[function(){var s=this,e=s._self._c;return s._self._setupProxy,e("div",{staticClass:"m-sentences-skeleton"},[e("div",{staticClass:"m-line1"}),e("div",{staticClass:"m-line2"}),e("div",{staticClass:"m-line3"})])}],Sm=T(Tm,Dm,Bm,!1,null,"0786f30f",null,null);const Yt=Sm.exports,Im=""+new URL("icon-user-primary-a7c1ee4e.svg",import.meta.url).href,Mm=""+new URL("icon-user-1f2cc36b.svg",import.meta.url).href,$m=""+new URL("icon-users-primary-3e2b34b5.svg",import.meta.url).href,Pm=""+new URL("icon-users-d3292b30.svg",import.meta.url).href,Nm=(s,e)=>s===""?e:e.filter(t=>t.textInCandidateList.includes(s)),Lm=(s,e)=>`${e}${s.textInComment} `.replace("＠","@"),Um=(s,e)=>(s.sort((t,a)=>t.textInCandidateList.indexOf(e)-a.textInCandidateList.indexOf(e)),s);class Gr{constructor(e,t,a,n,r,o={isOpen:!1,disableTextInput:!1}){ge(this,"textArea");ge(this,"listMountTarget");ge(this,"options");ge(this,"left");ge(this,"top");ge(this,"triggerIdx");ge(this,"active");ge(this,"groupList");ge(this,"userList");ge(this,"mentionList");ge(this,"offset");ge(this,"topOffset");ge(this,"onComposition");ge(this,"touchStart");ge(this,"isOpen");ge(this,"disableTextInput");ge(this,"mentionIconList");ge(this,"iconMap",{user:{true:Im,false:Mm},users:{true:$m,false:Pm}});ge(this,"onBlur",()=>{setTimeout(()=>this.closeList(),30)});ge(this,"setActiveItemIndex",e=>{var t;this.active=Number(e.target.id),(t=e.target)==null||t.removeEventListener("mouseenter",this.setActiveItemIndex),this.renderList(!0)});ge(this,"getMentionIcon",(e,t)=>{const a=document.createElement("img");return a.src=this.iconMap[e][t?"true":"false"],a});this.textArea=e,this.listMountTarget=t,this.options=[],this.onComposition=!1,this.groupList=a,this.userList=n,this.mentionList=a==null?void 0:a.concat(n).map((i,u)=>({...i,index:u})),this.offset=0,this.topOffset=r,this.isOpen=o.isOpen,this.disableTextInput=o.disableTextInput,this.filterOptions=this.filterOptions.bind(this),this.closeList=this.closeList.bind(this),this.onItemSelected=this.onItemSelected.bind(this),this.onInput=this.onInput.bind(this),this.onKeyDown=this.onKeyDown.bind(this),this.onFocus=this.onFocus.bind(this),this.renderList=this.renderList.bind(this),this.textArea.addEventListener("input",this.onInput),this.textArea.addEventListener("keydown",this.onKeyDown),this.textArea.addEventListener("focus",this.onFocus),this.textArea.addEventListener("blur",this.onBlur),this.textArea.addEventListener("compositionstart",()=>{this.onComposition=!0},{passive:!0}),this.textArea.addEventListener("compositionend",()=>{this.onComposition=!1},{passive:!0}),this.listMountTarget.hidden=!0,this.mentionIconList=this.mentionList.map(i=>this.getMentionIcon(i.iconName,!1))}async filterOptions(e){let t=await Nm(e,this.mentionList);t.length!==0?(t=Um(t,e),this.options=t,this.renderList()):this.closeList()}onItemSelected(e){return this.disableTextInput?()=>{const t=this.options[e];let a;const n={...t};try{a=new CustomEvent("select-item",{detail:n})}catch{a=document.createEvent("CustomEvent"),a.initCustomEvent("select-item",!1,!1,n)}this.textArea.dispatchEvent(a)}:()=>{const t=this.textArea.value.substr(0,this.triggerIdx),a=this.options[e];if(!a)return;const n=this.triggerIdx===void 0?"":Lm(a,this.textArea.value[this.triggerIdx]),r=this.textArea.value.substr(this.textArea.selectionStart??0),o=`${t}${n}${r}`;this.textArea.value=o;const i=this.textArea.value.length-r.length;this.textArea.setSelectionRange(i,i),this.closeList();const u=document.createEvent("HTMLEvents");u.initEvent("input",!0,!0),this.textArea.dispatchEvent(u),setTimeout(()=>this.textArea.focus(),0)}}onInput(){const e=this.textArea.selectionStart??0,t=this.textArea.value.slice(0,e),a=t.split(/\s/),n=a[a.length-1],r=t.endsWith(n)?t.length-n.length:-1,o=t[r];if(!(o==="@"||o==="＠")&&!this.isOpen){this.closeList();return}const u=this.isOpen?r:r+1,c=t.slice(u);this.filterOptions(c);const p=Xo(this.textArea,this.textArea.selectionEnd??0),{top:m,left:d}=this.textArea.getBoundingClientRect();setTimeout(()=>{this.active=0;const _=this.isOpen?-12:-18;this.left=Math.min(d+p.left+_,window.innerWidth-316),this.top=m+p.top+22,this.triggerIdx=r,this.renderList()},0)}onKeyDown(e){let t=!1;if(!this.onComposition){if(this.triggerIdx!==void 0)switch(e.key){case"ArrowDown":case"Down":this.active=Math.min(this.active+1,this.options.length-1),this.renderList(!1,!0),this.removeMouseEnterEvents(),t=!0;break;case"ArrowUp":case"Up":this.active=Math.max(this.active-1,0),this.renderList(!1,!0),this.removeMouseEnterEvents(),t=!0;break;case"Enter":case"Tab":this.onItemSelected(this.active)(),t=!0;break}t&&e.preventDefault()}}onFocus(){setTimeout(()=>this.onInput(),50)}renderList(e=!1,t=!1){if(this.top===void 0){this.listMountTarget.hidden=!0;return}this.listMountTarget.style.left=this.left+"px",this.listMountTarget.style.top=this.top+"px",this.listMountTarget.innerHTML="";const a=this.options.length;this.options.slice(0,this.offset+a).forEach((n,r)=>{this.listMountTarget.appendChild(this.createItem(n,this.onItemSelected(r+this.offset),this.active===r+this.offset,r,e))}),this.listMountTarget.hidden=!1,t&&(this.listMountTarget.scrollTop=(this.active-1)*35-100)}closeList(){setTimeout(()=>{this.options=[],this.left=void 0,this.top=void 0,this.triggerIdx=void 0,this.renderList()},0)}removeMouseEnterEvents(){[...document.getElementsByClassName("mention-list-item")].forEach(t=>{t.removeEventListener("mouseenter",this.setActiveItemIndex),t.addEventListener("mousemove",()=>{this.renderList()},{once:!0,passive:!0})})}createItem(e,t,a,n,r){const o=document.createElement("div");o.addEventListener("click",()=>{this.onItemSelected(this.active)()},{passive:!0}),o.addEventListener("touchstart",c=>{this.touchStart=new Date().getTime(),this.active=Number(c.target.id)},{passive:!0}),o.addEventListener("touchend",async()=>{new Date().getTime()-this.touchStart<100&&this.onItemSelected(this.active)()},{passive:!0}),(!r||this.active!==n)&&o.addEventListener("mouseenter",this.setActiveItemIndex,{once:!0,passive:!0}),o.className="mention-list-item",o.id=`${n}`,a&&(o.classList.add("selected"),o.setAttribute("aria-selected",""));const i=e.textInCandidateList.replace(e.textInComment+" ",""),u=document.createElement("span");return u.innerText=e.textInComment,a?o.appendChild(this.getMentionIcon(e.iconName,!0)):o.appendChild(this.mentionIconList[e.index??n]),o.appendChild(u),o.insertAdjacentHTML("beforeend",i),o.addEventListener("mousedown",c=>{c.preventDefault()}),o.addEventListener("mouseup",c=>{c.preventDefault(),t(),this.textArea.blur()}),o.append,o}}const qr=(s,e)=>s.slice().filter(t=>t.group_type!=="all_user_group").sort((t,a)=>{const n=t.user_name?t.user_name:t.name;return(a.user_name?a.user_name:a.name).length-n.length}).map(t=>({target:t,type:t.user_name?"user":"group",name:t.user_name??t.name,link:t.user_name?`/#/users/${t.id}`:`/#/groups/${t.id}`,mentionToUser:t.user_name?t.id===e.id:s.filter(a=>a.is_member&&a.group_type!=="all_user_group").includes(t)})),Rm=(s,e,t)=>{let a=t;const n=qr(e,s);for(const r of n){const o=RegExp(`@${ea(r.name)}`,"g");r.mentionToUser&&o.test(a)?a=a.replace(o,`<a class="mention-name mention-to-user">${r.type}${r.target.id}</a>`):o.test(a)&&(a=a.replace(o,`<a class="mention-name">${r.type}${r.target.id}</a>`))}for(const r of n){let o=RegExp(`<a class="mention-name mention-to-user">${r.type}${r.target.id}</a>`,"g");a=a.replace(o,`<a href="${r.link}" class="mention-name mention-to-user">@${r.name}</a>`),o=RegExp(`<a class="mention-name">${r.type}${r.target.id}</a>`,"g"),a=a.replace(o,`<a href="${r.link}" class="mention-name">@${r.name}</a>`)}return a},Om=(s,e,t,a)=>{let n=s;const r=RegExp("@全員","g");r.test(n)&&(n=n.replace(r,i=>`<a class="mention-name mention-to-user">${i}</a>`));const o=[...e,...t];return n=Rm(a,o,n),n},ea=s=>s.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),Hr=s=>(lt.test(s)&&(s=s.replace(lt,e=>`<a href="${e}" class="url-link" target="_blank">${e}</a>`)),s),Gm=s=>{if(lt.test(s)){const e=s.match(lt);return s.split(new RegExp(`(${e==null?void 0:e.join("|")})`)).map((t,a)=>a%2===0?{text:t,type:"plaintext"}:{text:t,type:"url"})}return[{text:s,type:"plaintext"}]},nn=s=>`<a href="${s}" class="url-link" target="_blank">${s}</a>`,qm=(s,e,t,a,n)=>e?s===n?nn(s):(s=Gm(s).filter(u=>!u.text||u.text!==n).map(u=>u.type==="url"?nn(u.text):u.text).join(""),/.*@.*/.test(s)&&(s=Om(s,e,t,a)),s):s,Hm=D({props:{autoFocus:{type:Boolean,default:!0},placeholder:{type:String,default:""},mentionListOffset:{type:Number,default:void 0},disabled:{type:Boolean,default:!1},initialComment:{type:String},minHeight:{type:Number,default:82},rows:{type:Number,default:2},elId:{type:String,default:"mention-list-mount-point"},showUrlPreview:{type:Boolean,default:!1}},model:{prop:"disabledButton",event:"update-button-status"},setup(s,e){const t=se(),{autoFocus:a,initialComment:n,showUrlPreview:r,mentionListOffset:o,elId:i,minHeight:u}=$e(s),c=g(0),p=l(()=>t.getters["teamUsers/activeTeamUsers"]),m=l(()=>t.state.groups.groups),d=l(()=>t.state.userInfo.userInfo),_=g(0),h=g(""),v=g({all:!1,target_user_ids:[],target_group_ids:[]}),f=g(void 0),C=g(!1),y=g(),A=g(),k=g();ne(()=>{if(A.value&&(c.value=A.value.scrollHeight),K(),ye(),O(),j(),n!=null&&n.value){A.value&&(A.value.value=n.value),h.value=n.value;var R=new Event("input",{bubbles:!0,cancelable:!0});A.value&&A.value.dispatchEvent(R)}A.value&&a&&!Vt()&&A.value.focus(),y.value=new qe({render:ve=>ve(Yt,{props:{loading:!0}})}).$mount().$el});const S=l(()=>h.value.length>Rn),b=l(()=>{const R=h.value.match(lt);return!!(R&&/^https?/.test(R[0])&&R[0]===h.value)}),U=l(()=>{let R=[];return S.value&&R.push("コメントは500文字以内で入力してください。"),R}),I=l(()=>U.value.length>0),w=l(()=>{if(!d.value)return[];const R=[...p.value,...m.value];return qr(R,d.value)}),x=()=>{const R=h.value.match(lt);if(R&&/^https?/.test(R[0]))return R[0]},B=R=>R.replace(lt,ve=>`<span class="textarea-url">${ve}</span>`),$=R=>{var ve;return!f.value&&C.value?R.concat(`<div id="article-preview" class="article-preview preview-skelton">
            ${(ve=y.value)==null?void 0:ve.outerHTML}
          </div>`):f.value?R.concat(`<a href="${f.value.url}"  target="_blank" class="preview-link">
                <div id="article-preview" class="article-preview">
                  <div class="preview-info">
                    <div class="media-name c-title c-title--s">${f.value.media_name}</div>
                    <div class="title">${f.value.title}</div>
                  </div>
                  <img class="preview-image" src="${f.value.image_url}" onerror="this.src = '${Kt}'" />
                </div>
              </a>`):(K(),R)},P=async()=>{var ve;const R=x();if(!R){f.value=void 0,K();return}if(r.value&&(!f.value||((ve=f.value)==null?void 0:ve.url)!==R)&&!C.value){f.value=void 0,C.value=!0,k.value&&A.value&&(k.value.innerHTML=ue(A.value.value)),K();const X=await F.fetchUrlPreview(R).catch(()=>{C.value=!1,k.value&&A.value&&(k.value.innerHTML=ue(A.value.value)),K()});X&&(f.value={...X,url:R},k.value&&A.value&&(k.value.innerHTML=ue(A.value.value)),K()),C.value=!1}},M=async()=>{K(),ee(),J(),await P()},O=()=>{o.value!==void 0?_.value=o.value:as().phone||as().tablet?_.value=10:_.value=-70},Y=l(()=>{const R=p.value.map(ve=>({textInCandidateList:`${ve.user_name} ${ve.email}`,textInComment:ve.user_name,iconName:"user"}));return R.unshift({textInCandidateList:"全員 all",textInComment:"全員",iconName:"users"}),R}),W=l(()=>m.value.filter(R=>R.group_type!=="all_user_group").map(R=>({textInCandidateList:`${R.name} ${R.member_count}人のメンバー`,textInComment:R.name,iconName:"users"})));Z(m,()=>j()),Z(p,()=>j());const j=async()=>{if(p.value.length===0)return;const R=document.getElementById(i.value);R&&A.value&&new Gr(A.value,R,W.value,Y.value,_.value)},K=()=>{const R=A.value;R&&le(R)},le=R=>{var ve,X;if(R){R.style.height="auto";const te=24,E=((ve=document.getElementById("article-preview"))==null?void 0:ve.getBoundingClientRect().height)??0;let L=0;const re=document.getElementsByClassName("textarea-url")[0];re&&(L=re.getBoundingClientRect().height),(f.value||C.value)&&R.scrollHeight===c.value?R.style.height=(X=A.value)!=null&&X.value.includes(`
`)?`${u.value+4+L+E}px`:`${42+L+E}px`:f.value||C.value?R.style.height=R.style.height=`${Math.max(R.scrollHeight+2+E+te,u.value+E+te)}px`:R.scrollHeight>c.value?R.style.height=`${Math.max(R.scrollHeight+2,u.value)}px`:R.style.height=String(u.value),R.parentElement&&(R.parentElement.style.height="auto",R.parentElement.style.height=`${Math.max(R.scrollHeight+2,u.value)}px`)}},ye=()=>{const R=A.value;R==null||R.addEventListener("input",()=>{const ve=k;ve.value&&A.value&&(ve.value.innerHTML=ue(A.value.value))},{passive:!0})},H=R=>{v.value={all:!1,target_user_ids:[],target_group_ids:[]},R=R.replace(/\n$/g,`

`);const ve=RegExp("@全員","g");ve.test(R)&&(v.value.all=!0,R=R.replace(ve,""));for(const X of w.value){const te=RegExp(`@${ea(X.name)}`,"g");te.test(R)&&(X.type==="user"?v.value.target_user_ids.push(X.target.id):X.type==="group"&&v.value.target_group_ids.push(X.target.id),R=R.replace(te,""))}},ue=R=>{R=R.replace(/\n$/g,`

`),R=B(R),R=$(R);const ve=RegExp("@全員","g");ve.test(R)&&(R=R.replace(ve,X=>`<mark class="mention-to-user">${X}</mark>`));for(const X of w.value){const te=RegExp(`@${ea(X.name)}`,"g");X.mentionToUser&&te.test(R)?R=R.replace(te,E=>`<mark class="mention-to-user">${X.type}${X.target.id}</mark>`):te.test(R)&&(R=R.replace(te,E=>`<mark>${X.type}${X.target.id}</mark>`))}for(const X of w.value){let te=RegExp(`<mark class="mention-to-user">${X.type}${X.target.id}</mark>`,"g");R=R.replace(te,`<mark class="mention-to-user">@${X.name}</mark>`),te=RegExp(`<mark>${X.type}${X.target.id}</mark>`,"g"),R=R.replace(te,`<mark>@${X.name}</mark>`)}return R},_e=()=>{A.value&&(h.value=A.value.value)},me=()=>{h.value===""||I.value||de()},de=()=>{A.value&&H(A.value.value),e.emit("postComment")},ee=()=>{var ve;return{trimmedComment:h.value,rawComment:(ve=A.value)==null?void 0:ve.value}},J=()=>{e.emit("update-button-status",I.value||b.value)};return{commentArea:A,trimmedComment:h,errorMessages:U,hasError:I,highlightedText:k,handleInput:M,updateTrimmedComment:_e,postComment:me,handleFocus:()=>{K(),e.emit("focus")},resetTrimmedComment:()=>{h.value="",A.value&&(A.value.value=""),k.value&&(k.value.innerHTML=""),f.value=void 0,K()},mention:v}}});var Vm=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"m-mention-autocomplete-textarea"},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.hasError,expression:"hasError"}]},e._l(e.errorMessages,function(a){return t("div",{key:a,staticClass:"m-error c-formBlock__text c-formBlock__text--error"},[e._v(" "+e._s(a)+" ")])}),0),t("div",{staticClass:"m-highlight-and-textarea"},[t("textarea",{directives:[{name:"model",rawName:"v-model.trim",value:e.trimmedComment,expression:"trimmedComment",modifiers:{trim:!0}}],ref:"commentArea",staticClass:"m-comment-box-textarea c-text c-text--m",class:{"c-formInput--error":e.hasError,"m-normal-textarea":!e.hasError,disabled:e.disabled},style:{"min-height":`${e.minHeight}px`},attrs:{id:"textarea",rows:e.rows,placeholder:e.placeholder,disabled:e.disabled},domProps:{value:e.trimmedComment},on:{focus:e.handleFocus,blur:[function(a){e.$emit("blur"),e.updateTrimmedComment()},function(a){return e.$forceUpdate()}],input:[function(a){a.target.composing||(e.trimmedComment=a.target.value.trim())},function(a){return e.handleInput()}],keydown:[function(a){return!a.type.indexOf("key")&&e._k(a.keyCode,"enter",13,a.key,"Enter")||!a.ctrlKey?null:e.postComment.apply(null,arguments)},function(a){return!a.type.indexOf("key")&&e._k(a.keyCode,"enter",13,a.key,"Enter")||!a.metaKey?null:e.postComment.apply(null,arguments)}]}}),e._v(" "),t("div",{ref:"highlightedText",staticClass:"m-highlighted-text c-text c-text--m",style:{"min-height":`${e.minHeight}px`}}),t("div",{staticClass:"mention-list-mount-point",attrs:{id:e.elId}})])])},jm=[],Km=T(Hm,Vm,jm,!1,null,"d7aa6aab",null,null);const $t=Km.exports,Ym=D({props:{datetime:{type:String,required:!0},hideTooltip:{type:Boolean,default:!1}},methods:{formatDateForComment:bc,formatDateTime:la},setup(s){const e=oe(s.datetime),t=!s.hideTooltip&&mr(e);return{day:e,showTooltip:t}}});var Qm=function(){var e=this,t=e._self._c;return e._self._setupProxy,e.showTooltip?t("span",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:{content:e.formatDateTime(e.datetime),delay:{show:300},offset:8,autoHide:!1},expression:`{
      content: formatDateTime(datetime),
      delay: { show: 300 },
      offset: 8,
      autoHide: false
    }`,modifiers:{top:!0}}]},[e._v(e._s(e.formatDateForComment(e.datetime)))]):t("span",[e._v(e._s(e.formatDateForComment(e.datetime)))])},Wm=[],zm=T(Ym,Qm,Wm,!1,null,null,null,null);const Vr=zm.exports;function gs(s,e,t,a){const n=a==null?void 0:a.filter(i=>i.is_member),r=n==null?void 0:n.map(i=>i.id);return(e==null?void 0:e.filter(i=>{const u=t==null?void 0:t.find(c=>c.id===i.theme_id);return(r==null?void 0:r.includes(i.group_id))||(u==null?void 0:u.access_scope)==="personal"&&(u==null?void 0:u.user_id)===N.getUserId()}))??[]}const jr=Symbol("InfoForScopedCommentsKey"),rn=(s,e)=>{const t=Bn(jr)??{memberGroupIds:g([]),personalThemeIds:g([])};return{scopedComments:l(()=>e.value.filter(n=>t.memberGroupIds.value.includes(n.group_id)||t.personalThemeIds.value.includes(n.theme_id)))}},Jm=new Zo(ei,{recentLength:9,exclude:["flags"],emojisToShowFilter:s=>s.added_in<=tu}),Xm={allowedTags:["a"],allowedAttributes:{a:["href","target","style","class"]}},Qt=(s,e=Xm)=>ti(s,e),vt=s=>s.replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll("'","&#39;").replaceAll('"',"&quot;"),Zm=D({name:"ArticleComment",props:{comment:{type:Object,required:!0},commentFontSize:{type:String,default:"14px"},commentLineHeight:{type:String,default:"22px"},omitting:{type:Boolean,default:!1},article:{type:Object},showAvatar:{type:Boolean},avatarSize:{type:String,default:"m"},showReplyComment:{type:Boolean},showGroup:{type:Boolean},showReplyButton:{type:Boolean,default:!0},groupCommentsCount:{type:Number,default:void 0},isDisplayOnly:{type:Boolean,default:!1},isChild:{type:Boolean,default:!1},isSummaryGroup:{type:Boolean,default:!1},pageName:{type:String},feature:{type:String},foldReplies:{type:Boolean,default:!0},showJoinGroupButton:{type:Boolean,default:!1},showReaction:{type:Boolean,default:!0},showCommentMenu:{type:Boolean,default:!0}},components:{Avatar:at,CommentReactionList:Am,CommentBox:Fm,CommentMenu:mm,RelativeTime:Vr,MentionAutocompleteTextarea:$t,Picker:si},setup(s,e){const t=se(),a=ie(),n=fe(),r=Ye(),{comment:o,isChild:i,foldReplies:u,pageName:c,feature:p}=$e(s),m=l(()=>t.state.userInfo.userInfo),d=l(()=>t.state.groups.groups),_=l(()=>t.state.themeList.themes),h=l(()=>t.getters["teamUsers/activeTeamUsers"]),v=g(!1),f=g(!1),C=g(!1),y=g(!1),A=g(!1),k=g(void 0),S=g(!1),b=g(),U=g();ne(()=>{$(),w(),I()});const I=()=>{n.$on("comment-deleted",te=>{var E;o.value.children=(E=o.value.children)==null?void 0:E.filter(L=>L.id!==te)}),n.$on("comment-updated",te=>{var L;const E=(L=o.value.children)==null?void 0:L.findIndex(V=>V.id===te.id);if(E>=0){const V=o.value.children.slice();V[E]=te,o.value.children=V}})};Be(()=>{window.removeEventListener("click",W)}),Sn(()=>{w()});const w=()=>{x("mention-name"),x("url-link")},x=te=>{var L;Array.from(((L=b.value)==null?void 0:L.getElementsByClassName(te))??[]).forEach(V=>{V.removeEventListener("click",B),V.addEventListener("click",B)})},B=te=>{te.stopPropagation()},$=()=>{const te=document.getElementsByClassName("url-link");for(const E of te)E.addEventListener("click",()=>Ge.trackArticleView(r))},P=(te,E=!1)=>kc(te,E,Vi),M=()=>{v.value=!0},O=()=>{v.value=!1},Y=()=>{const te=new Set(o.value.emoji_reactions.map(E=>E.reaction)).size;if(!C.value&&te>=za){t.commit("snackbar/addMessages",{type:"error",message:`リアクションの上限数（${za}種類）に達しています`});return}C.value=!C.value},W=te=>{var L;te.stopPropagation();const E=((L=U.value)==null?void 0:L.trimmedComment)??"";y.value&&E.length>0&&E!==k.value&&localStorage.setItem(X.value,E),C.value=!1,y.value=!1,window.removeEventListener("click",W)},j=()=>{A.value=!0},K=async te=>{if(i.value){e.emit("click-reply",o.value.user_name);return}for(window.addEventListener("click",W),y.value=!0,j();!U.value;)await ze();const E=U.value.$refs.commentArea;if(E){k.value=`@${te}`;const L=localStorage.getItem(X.value)??void 0;E.value=L??k.value;const V=document.createEvent("Event");V.initEvent("input",!0,!0),E.dispatchEvent(V),await ze(),E.focus(),E.value=E.value.concat(" ")}},le=()=>{var te;return(((te=U.value)==null?void 0:te.trimmedComment)??"").length===0},ye=()=>{var te;(te=U.value)==null||te.postComment()},H=async()=>{var te,E;J.value&&(await F.joinGroup((te=J.value)==null?void 0:te.id),t.dispatch("groups/fetchGroups",(E=m.value)==null?void 0:E.id))},ue=async()=>{var te,E;if(U.value){const L=await F.sendComment({groupId:o.value.group_id,adpDocument:o.value.article,themeId:o.value.theme_id,content:(te=U.value)==null?void 0:te.trimmedComment,mention:(E=U.value)==null?void 0:E.mention,parentCommentId:o.value.id,trackingBaseData:{pageName:c==null?void 0:c.value,feature:p==null?void 0:p.value,pageUrl:a.fullPath}}).catch(V=>{throw t.commit("snackbar/addMessages",{message:"コメントを投稿できませんでした",type:"error"}),V});t.commit("snackbar/addMessages",{message:"コメントを投稿しました",type:"success"}),e.emit("reply",L),U.value.resetTrimmedComment(),localStorage.removeItem(X.value)}},_e=l(()=>m.value?qm(o.value.content,h.value,d.value,m.value):""),me=l(()=>Qt(_e.value)),de=l(()=>Vt()),ee=l(()=>{const te=h.value.find(E=>E.id===o.value.user_id);return te==null?void 0:te.image_url}),J=l(()=>d.value&&d.value.length>0?d.value.find(E=>E.id===Number(o.value.group_id)):{id:-1,name:"",is_member:!1}),ce=l(()=>!i.value&&(a.name==="anewsHome"||a.name==="groupComment"||a.name==="themeFeed"||a.name==="themeFeaturedArticles"||a.name==="teamFeaturedArticles")),ke=l(()=>{var te;return gs(m.value,(te=s.article)==null?void 0:te.comments,_.value,d.value)}),R=l(()=>a.query.commentId?Number(a.query.commentId):void 0),ve=l(()=>{var te;return!u.value||o.value.id===R.value||((te=o.value.children)==null?void 0:te.find(E=>E.id===R.value))!==void 0}),X=l(()=>`reply-comment-${o.value.id}`);return{emojiIndex:Jm,articleCommentRef:b,replyRef:U,userInfo:m,closeMenus:W,group:J,imageUrl:ee,highlightedCommentId:R,showOtherCommentLink:ce,showReplies:ve,expandedReplies:A,isOpenReplyTextarea:y,postComment:ue,isReplyTextEmpty:le,scopedComments:ke,isMobileUser:de,formatUserName:P,isReactionMenuOpen:C,sanitizedParsedComment:me,callPostComment:ye,joinGroup:H,openReplyTextarea:K,openCommentMenu:M,closeCommentMenu:O,toggleReactionMenu:Y,isTogglingReaction:f,replyFocused:S,expandReplies:j,getArticlePageUrl:Jn}}});var e_=function(){var e=this,t=e._self._c;return e._self._setupProxy,e.userInfo?t("div",{ref:"articleCommentRef",staticClass:"m-article-comment",class:{"none-article":!e.article},on:{click:e.closeMenus}},[e.showGroup&&e.group?t("div",{staticClass:"group"},[t("div",{staticClass:"group-content"},[t("div",{staticClass:"group-name-content c-title c-title--s"},[t(e.isDisplayOnly?"div":"router-link",{tag:"component",staticClass:"group-name",class:e.isDisplayOnly?"":"link",attrs:{to:`/groups/${e.group.id}`}},[t("sm-icons",{staticClass:"xs"},[e._v("users")]),t("div",{staticClass:"group-name-text"},[e._v(" "+e._s(e.group.is_member?e.group.name:`${e.group.name}(未参加)`)+" ")])],1),e.groupCommentsCount?t("div",{staticClass:"group-comments-count"},[e._v(" ・"+e._s(e.groupCommentsCount)+"件 ")]):e._e()],1),t("div",{staticClass:"group-invite"},[e.showJoinGroupButton&&!e.group.is_member?t("button",{staticClass:"c-btn c-btn--small c-btn--auto c-btn--AnewsPrimary",on:{click:e.joinGroup}},[e._v(" 参加 ")]):e._e()])])]):e._e(),e.isSummaryGroup?t("div",{staticClass:"spacing-16"}):e._e(),t("div",{staticClass:"m-comment-body",class:{"m-comment-body__outer":!e.showGroup}},[t(e.isDisplayOnly?"div":"router-link",{tag:"component",attrs:{to:`/users/${e.comment.user_id}`}},[e.showAvatar?t("Avatar",{staticClass:"comment-avatar",attrs:{size:e.avatarSize,imageUrl:e.imageUrl}}):e._e()],1),t("div",{staticClass:"comment-and-buttons"},[t("div",{class:{"m-comment":!e.showAvatar,"m-comment-avatar":e.showAvatar,highlight:e.highlightedCommentId===e.comment.id}},[t("CommentBox",{nativeOn:{mouseover:function(a){return e.openCommentMenu.apply(null,arguments)},mouseleave:function(a){return e.closeCommentMenu.apply(null,arguments)}},scopedSlots:e._u([{key:"default",fn:function({toggleEmojiReaction:a}){return[t("div",{staticClass:"m-comment-header"},[t("div",{staticClass:"m-comment-sub-info"},[e.isDisplayOnly?t("div",{staticClass:"m-comment-user-name-unlink c-title c-title--s"},[e._v(" "+e._s(e.formatUserName(e.comment.user_name,!1))+" ")]):t("router-link",{staticClass:"m-comment-user-name c-title",class:{"c-title--m":e.isMobileUser,"c-title--s":!e.isMobileUser},attrs:{to:`/users/${e.comment.user_id}`}},[e._v(e._s(e.formatUserName(e.comment.user_name,!1)))]),t("div",{staticClass:"m-midpoint c-text c-text--s"},[e._v("・")]),t("div",{staticClass:"m-commented-date c-text c-text--s"},[t("RelativeTime",{attrs:{datetime:e.comment.created_at,hideTooltip:e.isChild}})],1)],1),!e.isDisplayOnly&&e.showCommentMenu?t("div",{staticClass:"comment-menu-wrap"},[t("CommentMenu",{attrs:{comment:{...e.comment,article:e.article}}})],1):e._e()]),t("div",{staticClass:"m-comment-content c-text c-text--m"},[t("div",{staticClass:"content",class:{omit:e.omitting},style:{"font-size":e.commentFontSize,"line-height":e.commentLineHeight},domProps:{innerHTML:e._s(e.sanitizedParsedComment)}})]),!e.isMobileUser&&!e.isDisplayOnly?t("CommentReactionList",{attrs:{comment:e.comment},on:{click:function(n){return a(e.article,n.comment,n.reaction)}}}):e._e()]}}],null,!1,1447394804)})],1),e.isDisplayOnly?e._e():t("div",{staticClass:"buttons"},[t("CommentBox",{scopedSlots:e._u([{key:"default",fn:function({toggleEmojiReaction:a}){return[t("div",{staticClass:"reaction-add-button",on:{click:function(n){return n.stopPropagation(),e.toggleReactionMenu.apply(null,arguments)}}},[e.showReaction?t("sm-icons",{staticClass:"small"},[e._v("smile-plus")]):e._e(),t("div",{staticClass:"reaction-menu"},[t("div",{staticClass:"reaction-button-list-wrap",on:{click:function(n){n.preventDefault(),n.stopPropagation()}}},[e.isReactionMenuOpen?t("div",{staticClass:"emoji-picker"},[t("Picker",{attrs:{data:e.emojiIndex,set:"twitter",native:!0,showPreview:!1,i18n:{search:"検索",categories:{search:"検索結果",recent:"よく使う絵文字",smileys:"スマイリー & 人",people:"顔 & 人",nature:"動物 & 自然",foods:"食べ物 & 飲み物",activity:"アクティビティ",places:"旅行 & 場所",objects:"オブジェクト",symbols:"記号",flags:"旗",custom:"カスタム"}}},on:{select:function(n){a(e.article,e.comment,n.native),e.isReactionMenuOpen=!1}}})],1):e._e()])])],1)]}}],null,!1,4270158792)}),e.showReplyButton?t("div",{staticClass:"reply-button c-title c-title--s",on:{click:function(a){return a.stopPropagation(),(n=>e.openReplyTextarea(e.comment.user_name)).apply(null,arguments)}}},[e._v(" 返信 ")]):e._e(),e.showOtherCommentLink&&e.scopedComments.length>1?t("router-link",{staticClass:"other-comment-link c-title c-title--s",attrs:{to:e.getArticlePageUrl(e.article)}},[e._v("その他のコメントを表示")]):e._e()],1),!e.showReplies&&e.showReplyComment&&!e.expandedReplies&&e.comment.children.length>0&&!e.isDisplayOnly?t("div",{staticClass:"reply-comment-count c-title c-title--s",on:{click:function(a){return a.stopPropagation(),e.expandReplies.apply(null,arguments)}}},[t("sm-icons",{staticClass:"reply-arrow-icon primary small"},[e._v("subdirectory-arrow-right")]),e._v("返信"+e._s(e.comment.children.length)+"件を表示 ")],1):e._e(),e.isDisplayOnly&&!e.showReplyComment&&!e.expandedReplies&&e.comment.children.length>0?t("div",{staticClass:"reply-comment-count display-only c-title c-title--s"},[t("sm-icons",{staticClass:"reply-arrow-icon small"},[e._v("subdirectory-arrow-right")]),e._v("返信"+e._s(e.comment.children.length)+"件 ")],1):e._e(),e.showReplyComment&&(e.showReplies||e.expandedReplies)?t("div",{staticClass:"repy-comment-list"},e._l(e.comment.children,function(a){return t("div",{key:a.id,staticClass:"reply-comment"},[t("ArticleComment",{attrs:{article:e.article,isChild:!0,comment:a,showAvatar:!0,avatarSize:"m",pageName:e.pageName,feature:e.feature},on:{"click-reply":e.openReplyTextarea}})],1)}),0):e._e(),e.isOpenReplyTextarea?t("div",{staticClass:"reply-widget",on:{click:function(a){a.stopPropagation()}}},[t("router-link",{attrs:{to:`/users/${e.userInfo.id}`}},[t("Avatar",{attrs:{size:e.avatarSize,imageUrl:e.userInfo.image_url}})],1),t("MentionAutocompleteTextarea",{ref:"replyRef",staticClass:"reply-textarea",attrs:{placeholder:"返信コメントする...",minHeight:40,rows:1,autoFocus:!1,elId:`mention-list-mount-point-reply-${e.comment.id}`},on:{postComment:e.postComment,focus:function(a){e.replyFocused=!0},blur:function(a){e.replyFocused=!1}}}),t("div",{staticClass:"replay-button-area"},[t("button",{staticClass:"reply-button-small c-btn c-btn--small c-btn--AnewsPrimary",class:{disabled:e.isReplyTextEmpty()},attrs:{disabled:e.isReplyTextEmpty()},on:{click:function(a){return a.stopPropagation(),e.callPostComment.apply(null,arguments)}}},[e._v(" 投稿 ")])])],1):e._e()])],1)]):e._e()},t_=[],s_=T(Zm,e_,t_,!1,null,"59e96344",null,null);const Kr=s_.exports,a_=D({props:{comments:{type:Array,default:()=>[]},omitting:{type:Boolean,default:!1},adpDocument:{type:Object},showAvatar:{type:Boolean,default:!0},showReplyComment:{type:Boolean,default:!0},showReplyButton:{type:Boolean,default:!0},feature:{type:String,default:""},pageName:{type:String,default:""},isSummaryGroup:{type:Boolean,default:!1},showCommentWidget:{type:Boolean,default:!1},groupId:{type:Number},foldReplies:{type:Boolean,default:!0},showJoinGroupButton:{type:Boolean,default:!1},showReaction:{type:Boolean,default:!0},showCommentMenu:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1}},components:{ArticleComment:Kr,Avatar:at,MentionAutocompleteTextarea:$t},methods:{},setup(s){const e=ie(),t=fe(),{data:a}=xe(),n=g();return{userInfo:a,commentRef:n,isCommentTextEmpty:()=>{var c;return(((c=n.value)==null?void 0:c.trimmedComment)??"").length===0},showGroupName:c=>s.isSummaryGroup?c===0:!0,callPostComment:()=>{var c;(c=n.value)==null||c.postComment()},postComment:async()=>{var c,p,m,d;if(n.value)try{const _=await F.sendComment({groupId:s.groupId,adpDocument:s.adpDocument,content:(c=n.value)==null?void 0:c.trimmedComment,mention:(p=n.value)==null?void 0:p.mention,trackingBaseData:{pageName:"article",feature:"group_comments",pageUrl:e.fullPath}}),h=s.adpDocument;(m=h==null?void 0:h.comments)==null||m.push(_),t.$emit("article-updated",h),t.$emit("comment-created",{..._,updateArticle:h}),t.$store.commit("snackbar/addMessages",{message:"コメントを投稿しました",type:"success"}),(d=n.value)==null||d.resetTrimmedComment()}catch(_){throw t.$store.commit("snackbar/addMessages",{message:"コメントを投稿できませんでした",type:"error"}),_}}}}});var n_=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"m-comment-list"},[e._l(e.comments,function(a,n){return t("div",{key:a.id,staticClass:"m-comment-list-body"},[t("ArticleComment",{attrs:{article:e.adpDocument,comment:a,omitting:e.omitting,showAvatar:e.showAvatar,showReplyComment:e.showReplyComment,showGroup:e.showGroupName(n),showReplyButton:e.showReplyButton,isSummaryGroup:e.isSummaryGroup,showJoinGroupButton:e.showJoinGroupButton,feature:e.feature,pageName:e.pageName,foldReplies:e.foldReplies,showReaction:e.showReaction,showCommentMenu:e.showCommentMenu},on:{reply:r=>a.children.push(r)}})],1)}),e.userInfo&&e.showCommentWidget?t("div",{staticClass:"comment-widget"},[t("router-link",{attrs:{to:`/users/${e.userInfo.id}`}},[t("Avatar",{attrs:{size:"m",imageUrl:e.userInfo.image_url}})],1),t("div",{staticClass:"spacing-08"}),t("MentionAutocompleteTextarea",{ref:"commentRef",attrs:{placeholder:"コメントする...",minHeight:40,rows:1,autoFocus:!1,elId:`mention-list-mount-point-${e.groupId}`,disabled:e.disabled},on:{postComment:e.postComment}}),t("div",{staticClass:"spacing-08"}),t("button",{staticClass:"comment-button-small c-btn c-btn--small c-btn--AnewsPrimary",class:{disabled:e.isCommentTextEmpty()},attrs:{disabled:e.isCommentTextEmpty()},on:{click:e.callPostComment}},[e._v(" 投稿 ")])],1):e._e()],2)},r_=[],o_=T(a_,n_,r_,!1,null,"af8684ee",null,null);const Yr=o_.exports,i_=D({components:{AdpDocumentCardUserAction:Nr,CommentList:Yr,Content:Ue,AdpDocumentBasicInfo:Or,AdpDocumentAllianceMedia:Sr},methods:{isArticle:ot},props:{id:{type:String,required:!0},doc_type:{type:String,required:!0}},setup({id:s,doc_type:e}){const t=ie(),a=se(),n=fe(),{data:r}=xe(),o=l(()=>a.state.teamInfo.teamInfo),i=l(()=>{var M;return((M=o.value)==null?void 0:M.enable_alliance_media)??!1}),{data:u,state:c,mutate:p}=Cr(s,e),{data:m,state:d}=nt(),_=l(()=>{var M;return(M=m.value)==null?void 0:M.themes.find(O=>O.id===Number(t.query.themeId))}),{data:h}=Pe(),v=l(()=>{var M;return(M=r.value)==null?void 0:M.enable_translate_article_title}),f=async()=>{u.value&&await F.trackIntegration("article",t,{article:{id:u.value.id,doc_type:e}})};Z(()=>c.value,()=>{var M,O;c.value===be.SUCCESS&&(f(),(M=_==null?void 0:_.value)!=null&&M.id&&n.$emit("select-news-menu-item",(O=_==null?void 0:_.value)==null?void 0:O.id))});const C="article";ne(async()=>{await F.trackPageView({pageName:C,pageUrl:t.path,adpDocument:{id:Number(s),doc_type:e}})});const y=()=>{a.commit("modal/setArticle",u.value),a.commit("modal/setTheme",_.value),a.commit("modal/setPageName",C),a.commit("modal/setMarkSource","article")},A=()=>{y(),a.commit("modal/showModal","mark")},k=()=>{y(),a.commit("modal/showModal","commentCreate")},S=()=>{y(),a.commit("modal/showModal","groupMark")};Z(()=>[c.value,d.value],()=>{if(c.value===be.SUCCESS&&d.value===be.SUCCESS)switch(t.query.modal){case"mark":U.value?a.commit("snackbar/addMessages",{message:"この記事は既にマークされています",type:""}):A();break;case"group_mark":S();break;case"comment":k();break}});const b=g(!1),U=l(()=>{var M;return(M=u.value)==null?void 0:M.marks.find(O=>{var Y;return O.user_id===((Y=r.value)==null?void 0:Y.id)})}),I=l(()=>{if(!w.value||w.value.length==0)return[];let M=w.value.map(Y=>Y.group_id);M=[...new Set(M)],M=M==null?void 0:M.sort((Y,W)=>Y<W?-1:Y>W?1:0);const O=[];return M==null||M.forEach(Y=>{const W=(w.value??[]).filter(j=>j.group_id===Y);O.push({group_id:Y,comments:W})}),O}),w=l(()=>{var M,O,Y;return gs(r.value,(M=u.value)==null?void 0:M.comments,(O=m.value)==null?void 0:O.themes,(Y=h.value)==null?void 0:Y.groups)}),x=async(M,O)=>{try{const Y=M.marks.find(W=>W.user_id===O);Y&&(await F.deleteMark(Y.id),M.marks=M.marks.filter(W=>W.id!==Y.id),In(u,"marks",M.marks))}catch(Y){throw a.commit("snackbar/addMessages",{message:"マークを取り消せませんでした",type:"error"}),Y}a.commit("snackbar/addMessages",{message:"マークを取り消しました",type:""})},B=async(M,O)=>{var Y;try{await F.sendMark(M,O,"article",{pageName:C,pageUrl:t.fullPath})}catch(W){throw a.commit("snackbar/addMessages",{message:"マークできませんでした",type:"error"}),W}a.commit("snackbar/addMessages",{type:"",messageTemplates:[{tag:"a",text:"マイページ",href:`/#/users/${(Y=r.value)==null?void 0:Y.id}`},{tag:"span",text:"にマークしました"},{tag:"icon",text:"external-link"}]})},$=async()=>{var M;b.value||!r.value||!u.value||(b.value=!0,U.value?await x(u.value,r.value.id):await B(u.value,((M=_.value)==null?void 0:M.id)??null),await p(),ze(()=>b.value=!1))},P=l(()=>u.value?"is_alliance_media"in u.value&&u.value.is_alliance_media:!1);return{adpDocument:u,comments:w,theme:_,isMarkingArticle:b,groupComments:I,markArticle:$,showMarkModal:A,showCreateCommentModal:k,showGroupMarkModal:S,userEnableTranslateTitle:v,pageName:C,isAllianceMedia:P,teamInfo:o,enableAllianceMedia:i}}});var u_=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("Content",[e.adpDocument?t("div",{staticClass:"document-container"},[t("div",{staticClass:"document-content"},[t("div",{staticClass:"document-card"},[e.isAllianceMedia?t("AdpDocumentAllianceMedia",{attrs:{adpDocument:e.adpDocument,teamInfo:e.teamInfo,enableAllianceMedia:e.enableAllianceMedia}}):t("AdpDocumentBasicInfo",{staticClass:"info",attrs:{adpDocument:e.adpDocument,themeId:e.theme?e.theme.id:void 0,userEnableTranslateTitle:e.userEnableTranslateTitle,pageName:e.pageName,size:"l"}}),t("AdpDocumentCardUserAction",{staticClass:"user-actions",attrs:{adpDocument:e.adpDocument,comments:e.comments,hasActionMenu:!0,hasShortUserName:!0,isUndisplayButtonShown:!1,isSiteExclusionButtonShown:!1,isMarkingArticle:e.isMarkingArticle,disabled:!e.enableAllianceMedia&&e.isAllianceMedia},on:{"click-mark-icon":e.markArticle,"click-open-mark-modal":e.showMarkModal,"click-comment-icon":e.showCreateCommentModal,"click-group-mark-icon":e.showGroupMarkModal}})],1),e.groupComments.length>0?t("div",{staticClass:"comments"},e._l(e.groupComments,function(a){return t("div",{key:a.group_id,staticClass:"comment-list"},[a.comments&&a.comments.length>0?t("CommentList",{attrs:{adpDocument:e.adpDocument,comments:a.comments,showGroup:!0,isSummaryGroup:!0,showCommentWidget:!0,groupId:a.group_id,showJoinGroupButton:!0}}):e._e()],1)}),0):t("div",{staticClass:"no-comments"},[t("div",{staticClass:"document-text-content"},[t("div",{staticClass:"c-text c-text--m"},[e._v(" この記事に対するコメントはまだありません ")]),t("div",{staticClass:"spacing-12"}),t("button",{staticClass:"c-btn c-btn--auto c-btn--AnewsPrimary",on:{click:e.showCreateCommentModal}},[e._v(" コメントする ")])])])])]):e._e()])},c_=[],l_=T(i_,u_,c_,!1,null,"f02eec0d",null,null);const on=l_.exports,d_=D({components:{CommentList:Yr,AdpDocumentCardUserAction:Nr,AdpDocumentBasicInfo:Or},methods:{isArticle:ot},props:{adpDocument:{type:Object},comment:{type:Object},themeId:{type:Number},themeExcludedSitesCount:{type:Number},width:{type:String,default:"616px"},showComment:{type:Boolean,default:!0},showThemeTag:{type:Boolean,default:!1},articleExclusionId:{type:Number},actionTypeOfThemeTag:{type:String,default:""},hasShortUserName:{type:Boolean,default:!1},pageName:{type:String,required:!0},feature:{type:String},feedType:{type:String},markSource:{type:String},rankInWholeFeed:{type:Number},searchData:{type:Object},isSelected:{type:Boolean,default:!1},enableHover:{type:Boolean,default:!1},showCommentCount:{type:Number,default:3},group:{type:Object},isRead:{type:Boolean,default:!1},foldReplies:{type:Boolean,default:!0},caseStudyText:{type:String,default:""},trendCompanyText:{type:String,default:""},topic:{type:Object},industryData:{type:Object},hideUndisplayButton:{type:Boolean,default:!1},enableSiteExclusionButton:{type:Boolean,default:!1},showUserAction:{type:Boolean,default:!0},isUseRemoveGroupMark:{type:Boolean,default:!1}},setup(s,e){const t=se(),a=ie(),n=fe(),r=l(()=>t.state.userInfo.userInfo),o=l(()=>t.state.teamInfo.teamInfo),i=l(()=>{var ee;return((ee=o.value)==null?void 0:ee.enable_alliance_media)??!1}),u=g(!1),c=l(()=>!s.adpDocument||s.adpDocument.marks.length===0?null:s.adpDocument.marks.slice().sort((ee,J)=>new Date(ee.created_at).valueOf()-new Date(J.created_at).valueOf())[0]),p=l(()=>{var ee;return((ee=c.value)==null?void 0:ee.source)==="personal_feed"}),m=l(()=>{var ee;return((ee=c.value)==null?void 0:ee.source)==="article_share"}),d=l(()=>{var ee;return((ee=s.adpDocument)==null?void 0:ee.marks.some(J=>{var ce;return J.user_id===((ce=r.value)==null?void 0:ce.id)}))??!1}),_=l(()=>{var ee;return(ee=r.value)==null?void 0:ee.enable_translate_article_title}),h=l(()=>{if(!s.adpDocument)return!1;const ee=oe(s.adpDocument.published_at),J=ee.isSame(oe().subtract(1,"day"),"day"),ce=ee.isSame(oe(),"day");return J||ce}),v=async()=>{var J;if(!ot(s.adpDocument))return;const ee=s.adpDocument;try{await F.excludeArticle(ee.theme_id,ee,{pageName:s.pageName,pageUrl:a.fullPath,feature:s.feature,feedType:s.feedType},s.rankInWholeFeed),t.commit("snackbar/addMessages",{message:"記事を非表示にしました",type:""})}catch(ce){throw t.commit("snackbar/addMessages",{message:"記事を非表示にできませんでした",type:"error"}),ce}n.$emit("article-removed",{themeId:s.themeId,articleId:(J=s.adpDocument)==null?void 0:J.id,feedType:s.feedType,feedDate:s.adpDocument.feed_date})},f=async()=>{var J,ce,ke;if(!ot(s.adpDocument))return;const ee=s.adpDocument;if(s.themeExcludedSitesCount&&s.themeExcludedSitesCount>=ts){t.commit("snackbar/addMessages",{message:`上限（${ts}件）に達しています。登録したメディアは設定から変更できます。`,type:"error"});return}try{await F.excludeSiteAndArticle(ee,{pageName:s.pageName,pageUrl:a.fullPath,feature:s.feature,feedType:s.feedType},s.rankInWholeFeed),t.commit("snackbar/addMessages",{message:"メディアを除外しました（次回の更新から反映されます）",type:""})}catch(R){let ve="メディアを除外できませんでした";Je(R)&&((J=R.response)==null?void 0:J.data.error)==="site limit exceed"?ve=`上限（${ts}件）に達しています。登録したメディアは設定から変更できます。`:Je(R)&&((ce=R.response)==null?void 0:ce.data.error)==="site already excluded"&&(ve="既に登録しているメディアです"),t.commit("snackbar/addMessages",{message:ve,type:"error"});return}n.$emit("article-removed",{themeId:s.themeId,articleId:(ke=s.adpDocument)==null?void 0:ke.id,feedType:s.feedType,feedDate:s.adpDocument.feed_date})},C=async()=>{const ee=s.adpDocument;if(!ee)return;const J=await F.excludeArticle(void 0,ee,{pageName:s.pageName,pageUrl:a.fullPath,feature:s.feature,feedType:s.feedType},s.rankInWholeFeed);n.$emit("article-updated",{...ee,article_exclusion_id:J.id});try{t.commit("snackbar/addMessages",{message:"フィードバックをいただきありがとうございます",showUndo:!0,type:"",undoFunc:async()=>{await F.deleteExcludeArticle(J.id),n.$emit("article-updated",{...ee,article_exclusion_id:null}),t.commit("snackbar/addMessages",{message:"フィードバックを取り消しました",type:""}),n.$emit("personal-feed-article-restored",ee)}})}catch(ce){throw t.commit("snackbar/addMessages",{message:"フィードバックエラーになりました。",type:"error"}),ce}n.$emit("personal-feed-article-removed",ee)},y=async()=>{const ee=s.adpDocument;if(ee&&s.articleExclusionId){await F.deleteExcludeArticle(s.articleExclusionId),n.$emit("article-updated",{...ee,article_exclusion_id:null});try{t.commit("snackbar/addMessages",{message:"フィードバックをいただきありがとうございます",showUndo:!0,type:"",undoFunc:async()=>{const J=await F.excludeArticle(void 0,ee,{pageName:s.pageName,pageUrl:a.fullPath,feature:s.feature,feedType:s.feedType},s.rankInWholeFeed);n.$emit("article-updated",{...ee,article_exclusion_id:J.id}),t.commit("snackbar/addMessages",{message:"フィードバックを取り消しました",type:""})}})}catch(J){throw t.commit("snackbar/addMessages",{message:"フィードバックエラーになりました。",type:"error"}),J}}},A=async()=>{u.value||!r.value||!s.adpDocument||(u.value=!0,d.value?await H(r.value.id):await ue(s.adpDocument,s.themeId??null,r.value.id,s.markSource),await ze(),u.value=!1)},k=l(()=>{var ke,R;const ee=((ke=s.adpDocument)==null?void 0:ke.hit_keywords)??[],J=((R=s.adpDocument)==null?void 0:R.synonym_keywords)??[],ce=[...ee,...J].filter(ve=>ve.length>0);return ce.length>0?`含むキーワード
・${ce.join(`
・`)}`:""}),S=l(()=>s.comment||I.value.length>0),b=l(()=>{var ee;return((ee=s.adpDocument)==null?void 0:ee.comments)??[]}),{scopedComments:U}=rn(r,b),I=l(()=>s.comment?[s.comment]:U.value),w=l(()=>{var ee,J;return(s.comment?(ee=s.comment.article)==null?void 0:ee.comments:(J=s.adpDocument)==null?void 0:J.comments)??[]}),{scopedComments:x}=rn(r,w),B=l(()=>I.value.slice(-s.showCommentCount)),$=l(()=>{if(s.hideUndisplayButton||!s.themeId||!ot(s.adpDocument))return!1;switch(a.name){case"themeFeed":case"anewsHome":return!0}return!1}),P=l(()=>{if(!s.enableSiteExclusionButton||!s.themeId||!ot(s.adpDocument))return!1;switch(a.name){case"themeFeed":return!0}return!1}),M=()=>{e.emit("click-remove-group-mark")},O=l(()=>s.caseStudyText!==""&&s.trendCompanyText!==""),Y=l(()=>s.feature==="team_marks"),W=l(()=>{if(s.themeId||O.value||Y.value||ns(s.adpDocument))return!1;switch(a.name){case"anewsHome":return!0;case"personalNews":return!0;case"personalResearchPapers":return!0;case"userViews":return!0}return!1}),j=()=>{t.commit("modal/setArticle",s.adpDocument),t.commit("modal/setTheme",t.state.themeList.themes.find(ee=>ee.id===s.themeId)),t.commit("modal/setGroup",s.group),t.commit("modal/setPageName",s.pageName),t.commit("modal/setFeature",s.feature),t.commit("modal/setFeedType",s.feedType),t.commit("modal/setMarkSource",s.markSource),t.commit("modal/setRankInWholeFeed",s.rankInWholeFeed),t.commit("modal/setSearchData",s.searchData),t.commit("modal/setIndustryData",s.industryData),t.commit("modal/setDescription",s.trendCompanyText)},K=()=>{j(),t.commit("modal/showModal","commentCreate")},le=()=>{j(),t.commit("modal/showModal","groupMark")},ye=()=>{j(),t.commit("modal/showModal","mark")},H=async ee=>{if(!s.adpDocument)return;const J=s.themeId??null;try{const ce=await F.fetchDocument(s.adpDocument.id,s.adpDocument.doc_type),ke=ce.marks.find(R=>R.user_id===ee);ke&&(await F.deleteMark(ke.id),ce.marks=ce.marks.filter(R=>R.id!==ke.id),In(s.adpDocument,"marks",ce.marks),ce.hit_keywords=s.adpDocument.hit_keywords,ce.synonym_keywords=s.adpDocument.synonym_keywords,await _e(ce),t.commit("snackbar/addMessages",{message:"マークを取り消しました",type:"",showUndo:!0,undoFunc:()=>{ue(ce,J,ee,s.markSource,!1)}}))}catch{t.commit("snackbar/addMessages",{message:"マークを取り消せませんでした",type:"error"})}},ue=async(ee,J,ce,ke,R=!0)=>{var ve,X;if(r.value)try{const te=await F.sendMark(ee,J,ke,{pageName:s.pageName,pageUrl:a.fullPath,feature:s.feature,feedType:s.feedType,groupId:(ve=s.group)==null?void 0:ve.id},s.rankInWholeFeed,s.searchData,s.industryData,s.trendCompanyText);ee.marks.push({...te,user_name:r.value.user_name}),await _e(ee),R&&t.commit("snackbar/addMessages",{type:"",messageTemplates:[{tag:"a",text:"マイページ",href:`/#/users/${(X=r.value)==null?void 0:X.id}`},{tag:"span",text:"にマークしました"},{tag:"icon",text:"external-link"}]})}catch{t.commit("snackbar/addMessages",{message:"マークできませんでした",type:"error"})}},_e=async ee=>{switch(await t.dispatch("userActions/fetchMyActionCount"),n.$emit("article-updated",ee),a.name){case"userMarks":await t.dispatch("userActions/fetchUserActionCount",Number(a.params.userId)),await t.dispatch("userActions/updateUserMarkArticle",{userId:Number(a.params.userId),themeId:Number(s.themeId),articleId:ee.id,docType:ee.doc_type});break;case"userComments":await t.dispatch("userActions/fetchUserActionCount",Number(a.params.userId));break;case"search":await t.dispatch("searchResults/updateArticle",{articleId:ee.id,docType:ee.doc_type});break}},me=l(()=>Mr(s.adpDocument)),de=l(()=>s.adpDocument?"is_alliance_media"in s.adpDocument&&s.adpDocument.is_alliance_media:!1);return{formatDate:De,userInfo:r,isMarkingArticle:u,isMarkedPersonalFeed:p,isMarkedArticleShare:m,userEnableTranslateTitle:_,isNewArticle:h,undisplayArticle:v,siteExclusionArticle:f,notInterestedArticle:C,removeNotInterestedArticle:y,markArticle:A,hitKeywordsString:k,hasComment:S,comments:I,countedComments:x,latestComments:B,isUndisplayButtonShown:$,isSiteExclusionButtonShown:P,onClickRemoveGroupMark:M,isIndustryNews:O,isNotInterested:W,showCreateCommentModal:K,showGroupMarkModal:le,showMarkModal:ye,docTypeDisplayName:me,isAllianceMedia:de,enableAllianceMedia:i}}});var m_=function(){var a;var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"document-card",class:{"document-card__inner":e.adpDocument&&e.comments.length===0,"document-card-comment__inner":e.adpDocument&&e.comments.length>0,selected:e.isSelected,hovered:e.enableHover},style:{width:e.width},on:{click:function(n){return e.$emit("click")}}},[e.articleExclusionId?[t("div",{staticClass:"o-tags"},[t("div",{staticClass:"o-not-interested-tag"},[t("sm-icons",{staticClass:"small"},[e._v("thumbs-down")]),t("div",{staticClass:"o-text c-text c-text--s"},[e._v(" この"+e._s(e.docTypeDisplayName)+"に興味がない ")])],1)])]:e._e(),e.adpDocument?t("div",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:{content:e.hitKeywordsString,delay:{show:300},offset:8},expression:`{
        content: hitKeywordsString,
        delay: { show: 300 },
        offset: 8
      }`,modifiers:{top:!0}}],staticClass:"document-info"},[t("div",{staticClass:"document-body"},[t("AdpDocumentBasicInfo",{attrs:{adpDocument:e.adpDocument,trendCompanyText:e.isIndustryNews?e.trendCompanyText:void 0,isNewArticle:e.isIndustryNews&&e.isNewArticle,userEnableTranslateTitle:e.userEnableTranslateTitle,themeId:e.themeId,groupId:(a=e.group)==null?void 0:a.id,rankInWholeFeed:e.rankInWholeFeed,pageName:e.pageName,feature:e.feature,feedType:e.feedType,searchData:e.searchData,industryData:e.industryData}})],1)]):e._e(),e.adpDocument&&e.showUserAction?t("AdpDocumentCardUserAction",{attrs:{adpDocument:e.adpDocument,comments:e.countedComments,hasActionMenu:!0,hasShortUserName:e.hasShortUserName,isUndisplayButtonShown:e.isUndisplayButtonShown,isSiteExclusionButtonShown:e.isSiteExclusionButtonShown,isRemoveGroupMarkButtonShown:e.isUseRemoveGroupMark,isMarkingArticle:e.isMarkingArticle,isNotInterested:e.isNotInterested,articleExclusionId:e.articleExclusionId,disabled:!e.enableAllianceMedia&&e.isAllianceMedia},on:{"click-mark-icon":e.markArticle,"click-open-mark-modal":e.showMarkModal,"click-comment-icon":e.showCreateCommentModal,"click-group-mark-icon":e.showGroupMarkModal,"click-undisplay":e.undisplayArticle,"click-site-exclusion":e.siteExclusionArticle,"click-not-interested":e.notInterestedArticle,"click-remove-not-interested":e.removeNotInterestedArticle,"click-remove-group-mark":e.onClickRemoveGroupMark}}):e._e(),e.adpDocument&&e.showComment&&e.latestComments.length>0&&!e.isIndustryNews?t("div",{staticClass:"o-divider"}):e._e(),e.hasComment&&e.showComment?t("CommentList",{attrs:{adpDocument:e.adpDocument,comments:e.latestComments,feature:e.feature,pageName:e.pageName,foldReplies:e.foldReplies},on:{"click-comment":e.showCreateCommentModal}}):e._e()],2)},__=[],p_=T(d_,m_,__,!1,null,"c972c1e4",null,null);const Re=p_.exports,v_=D({props:{group:{type:Object,required:!0}},setup(s){const e=fe(),t=g(!1),a=l(()=>s.group.is_member?"退会":"参加"),n=l(()=>s.group.is_member?"c-btn--AnewsSecondary":"c-btn--AnewsPrimary");return{isLoading:t,toggle:async o=>{t.value=!0,o.is_member?await F.leaveGroup(o==null?void 0:o.id):(await F.joinGroup(o==null?void 0:o.id),await F.sendGroupView(o==null?void 0:o.id)),e.$emit("update-group-list"),t.value=!1},buttonText:a,buttonClass:n}}});var f_=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"group-toggle-button"},[e.group.group_type!=="all_user_group"?t("button",{staticClass:"c-btn c-btn--small button",class:e.buttonClass,attrs:{disabled:e.isLoading},on:{click:function(a){return a.preventDefault(),(()=>e.toggle(e.group)).apply(null,arguments)}}},[e._v(" "+e._s(e.buttonText)+" ")]):e._e()])},g_=[],h_=T(v_,f_,g_,!1,null,"2fe80cc1",null,null);const kt=h_.exports,ha=(s,e)=>e?e.role==="admin"||e.role==="group_admin"&&s.is_member:!1,Qr=(s,e)=>e?(e==null?void 0:e.role)==="admin"||s.is_member:!1,ss=s=>["admin","group_admin"].includes(s),Pt=(s,e,t=void 0)=>{if(!s.id)return[];const a=t?[{name:"アクティビティ",linkTo:{name:"groupActivity",params:{groupId:s.id}}},{name:"コメント",linkTo:{name:"groupComment",params:{commentId:t}}},{name:"マーク",linkTo:{name:"groupMarks",params:{groupId:s.id}}}]:[{name:"アクティビティ",linkTo:{name:"groupActivity",params:{groupId:s.id}}},{name:"コメント",linkTo:{name:"groupDetail",params:{groupId:s.id}}},{name:"マーク",linkTo:{name:"groupMarks",params:{groupId:s.id}}}];return s.group_type==="specific_user_group"&&Qr(s,e)&&a.push({name:"メンバー",linkTo:{name:"groupMembers",params:{groupId:s.id}}}),s.group_type==="specific_user_group"&&ha(s,e)&&a.push({name:"設定",linkTo:{name:"groupEdit",params:{groupId:s.id}}}),a},y_=D({components:{GroupToggleButton:kt,Header:Se,Content:Ue,AdpDocumentCard:Re},setup(){const s=Te(),e=ie(),t=se(),a=fe(),{data:n,mutate:r}=Pe(),{data:o}=xe(),i=l(()=>e.params.commentId),{data:u,state:c,mutate:p}=Gc(i),m=l(()=>{var v;return["admin","group_admin"].includes(((v=o.value)==null?void 0:v.role)??"")});ne(()=>{a.$on("article-updated",d)}),Be(()=>{a.$off("article-updated",d)});const d=v=>{u.value&&(u.value.article=v)},_=async()=>{if(u.value){const v=u.value.article?{id:u.value.article.id}:void 0;await F.trackIntegration("comment",e,{article:v,comment:{id:u.value.id},group:{id:u.value.group_id}})}};Z(()=>c.value,()=>{var v,f;c.value===be.ERROR?(t.commit("snackbar/addMessages",{message:"指定されたコメントは存在しません",type:"error"}),s.replace("/")):c.value===be.SUCCESS&&((v=u.value)!=null&&v.parent_comment_id)?s.replace(`/comments/${u.value.parent_comment_id}`):c.value===be.SUCCESS&&(a.$emit("select-group-menu-item",(f=u.value)==null?void 0:f.group_id),_())});const h=l(()=>(n.value??{groups:[]}).groups.find(v=>{var f;return v.id===((f=u.value)==null?void 0:f.group_id)}));return a.$on("comment-updated",()=>{p()}),a.$on("comment-deleted",()=>{p()}),{group:h,userInfo:o,mutate:r,comment:u,isGroupAdmin:m,getTabs:Pt}}});var C_=function(){var e=this,t=e._self._c;return e._self._setupProxy,e.group&&e.comment&&e.userInfo?t("div",{staticClass:"group-comment-container"},[t("Header",{attrs:{title:e.group.name,detail:`メンバー${e.group.member_count}人`,tabs:e.getTabs(e.group,e.userInfo,e.comment.id)},scopedSlots:e._u([{key:"titleMenu",fn:function(){return[e.group.group_type==="specific_user_group"&&e.isGroupAdmin?t("router-link",{staticClass:"edit-link c-text c-text--m",attrs:{to:`/groups/${e.group.id}/edit`}},[e._v("編集")]):e._e()]},proxy:!0},{key:"button",fn:function(){return[t("GroupToggleButton",{attrs:{group:e.group}})]},proxy:!0}],null,!1,2810880308)}),t("Content",[t("div",{staticClass:"group-comment-content"},[t("AdpDocumentCard",{staticClass:"article-card",attrs:{adpDocument:e.comment.article,comment:e.comment,group:e.group,pageName:"group",foldReplies:!1}})],1)])],1):e._e()},b_=[],A_=T(y_,C_,b_,!1,null,"87a3af5d",null,null);const k_=A_.exports,x_=D({setup(){return{}}}),Wt=""+new URL("state-empty-article-66ca1e94.png",import.meta.url).href;var w_=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"no-feed"},[t("div",{staticClass:"c-text c-text--m"},[e._t("default")],2),t("img",{attrs:{src:Wt}})])},E_=[],F_=T(x_,w_,E_,!1,null,"68a58db0",null,null);const xt=F_.exports,T_=D({components:{BasicEmptyFeed:xt},props:{theme:{type:Object,required:!0},displayFeedType:{type:String,required:!0},themeFeedType:{type:String,required:!0},docType:{type:String,required:!0},enableToEditTheme:{type:Boolean,default:!1}},setup(s){const e=Fe({researchPaper:{disabled:!1,name:"論文",label:"表示する技術文献の「論文」"},patent:{disabled:!1,name:"特許",label:"表示する技術文献の「特許」"},foreignFeed:{disabled:!1,name:"海外メディア",label:"「海外メディアの情報を収集する」"}});s.docType==="research_paper"&&(e.researchPaper.disabled=!s.theme.is_research_paper_enabled),s.docType==="patent"&&(e.patent.disabled=!s.theme.is_patent_enabled),s.themeFeedType==="foreign"&&(e.foreignFeed.disabled=!s.theme.is_foreign_media_enabled);const t=Object.keys(e).filter(r=>e[r].disabled)[0],a=e[t],n=l(()=>s.theme.is_chinese&&s.displayFeedType=="domestic");return{disabledOption:a,isDomesticMediaDisplayOnChineseTheme:n}}});var D_=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("BasicEmptyFeed",[e.disabledOption?[t("div",{staticClass:"disabled-message"},[e._v(" このテーマは"+e._s(e.disabledOption.name)+"の設定が有効になっていません。 ")]),e.enableToEditTheme?[e._v(" "+e._s(e.disabledOption.name)+"の情報を取得したい場合は、テーマの"),t("router-link",{staticClass:"theme-edit-link",attrs:{to:{name:"themeEdit",params:{themeId:e.theme.id}}}},[e._v("設定ページ")]),e._v("にある"+e._s(e.disabledOption.label)+"を有効にしてください。 ")]:e._e()]:e.isDomesticMediaDisplayOnChineseTheme?[t("div",{staticClass:"disabled-message"},[e._v("このテーマは中国語メディア専用です。")]),e._v(" 配信記事を見たい場合はメディアの表示を「国内・海外メディア両方」もしくは「海外メディアのみ」に切り替えてください。 ")]:[e._t("default")]],2)},B_=[],S_=T(T_,D_,B_,!1,null,"e20fed4c",null,null);const hs=S_.exports,ya=(s,e,t)=>(s==null?void 0:s.role)==="admin"||["group_admin","editor"].includes((s==null?void 0:s.role)??"")&&(e==null?void 0:e.access_scope)==="group"&&(t!=null&&t.is_member)||["group_admin","editor"].includes((s==null?void 0:s.role)??"")&&(e==null?void 0:e.access_scope)==="public"?!0:(e==null?void 0:e.access_scope)==="personal"&&(e==null?void 0:e.user_id)===(s==null?void 0:s.id),Wr=(s,e,t)=>(s==null?void 0:s.role)==="admin"||(e==null?void 0:e.access_scope)=="public"||(e==null?void 0:e.access_scope)==="personal"&&(e==null?void 0:e.user_id)===(s==null?void 0:s.id)?!0:!!((e==null?void 0:e.access_scope)==="group"&&(t!=null&&t.is_member)),I_=D({props:{articlesByDate:{type:Array,default:()=>[]},articles:{type:Array,default:()=>[]},theme:{type:Object},date:{type:ai.Dayjs,required:!0},dateStr:{type:String,required:!0},dateLabel:{type:String,required:!0},feedData:{type:Object,required:!0},isVisibleEmptyFeed:{type:Boolean,default:!1},feed:{type:String,required:!0},displayFeedType:{type:String,required:!0},themeFeedType:{type:String,required:!0}},components:{AdpDocumentCard:Re,BasicEmptyFeed:xt,ThemeEmptyFeed:hs},setup(s,e){const t=async({value:v})=>{e.emit("select-date",v)},a=(v,f)=>{if(!f.rank)return;const C=s.articlesByDate.filter(y=>y.date.isAfter(v)).map(y=>y[s.themeFeedType].value.articles.length);return C.length>0?C.reduce((y,A)=>y+A)+f.rank:f.rank},n=s.feed==="personal_news"?"personal_feed":"theme",r=s.feed==="personal_news"?"personal_feed":s.feed,{data:o}=xe(),{data:i}=Pe(),u=l(()=>{var v,f,C,y;return((v=o.value)==null?void 0:v.role)!=="viewer"||((f=s.theme)==null?void 0:f.access_scope)==="personal"&&((C=s.theme)==null?void 0:C.user_id)===((y=o.value)==null?void 0:y.id)}),c=l(()=>{var C,y,A;const v=(C=s.theme)==null?void 0:C.group_id,f=(A=(y=i.value)==null?void 0:y.groups)==null?void 0:A.find(k=>k.id===v);return Wr(o.value,s.theme,f)}),p=l(()=>{var C,y,A;const v=(C=s.theme)==null?void 0:C.group_id,f=(A=(y=i.value)==null?void 0:y.groups)==null?void 0:A.find(k=>k.id===v);return ya(o.value,s.theme,f)}),m=g(),d=g(!1);Xe(()=>{removeEventListener("click",h)});const _=()=>{d.value=!0,addEventListener("click",h)},h=()=>{m.value?d.value=m.value.showPopup:d.value=!1};return{selectDate:t,rankInWholeFeed:a,markSource:n,feature:r,enableToEditTheme:u,isArticleHideable:c,isSiteExcludable:p,selectboxRef:m,clickSelectBox:_,selectboxOpened:d,EMPTY_KEYWORD_FEED_MESSAGE:na}}});var M_=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"feed-articles-media",class:{"selectbox-open":e.selectboxOpened}},[t("div",{staticClass:"media-title c-title c-title--xm"},[t("div",{staticClass:"media-title-name"},[e._v(" "+e._s(e.themeFeedType==="domestic"?"国内メディア":"海外メディア")+" ")]),t("div",[t("sm-selectbox",{ref:"selectboxRef",staticClass:"date-select-box",attrs:{labels:e.articlesByDate.map(a=>a.dateLabel),values:e.articlesByDate.map(a=>a.dateStr),label:e.dateLabel,selectedLabel:e.dateLabel},on:{selected:e.selectDate},nativeOn:{click:function(a){return e.clickSelectBox.apply(null,arguments)}}})],1),t("div",{staticClass:"media-title-count c-text c-text--s"},[e._v(" ・"+e._s(e.articles.length)+"件 ")])]),e._l(e.articles,function(a){return t("div",{key:a.id,staticClass:"article-card"},[t("div",{staticClass:"divider"}),t("AdpDocumentCard",{attrs:{width:"100%",adpDocument:a,themeId:e.theme?e.theme.id:void 0,"theme-excluded-sites-count":e.theme?e.theme.site_exclusion_ids.length:void 0,feedType:e.themeFeedType,rankInWholeFeed:e.rankInWholeFeed(e.date,a),isRead:a.is_read,showCommentCount:1,markSource:e.markSource,pageName:e.feed,feature:e.feature,hideUndisplayButton:!e.isArticleHideable,enableSiteExclusionButton:e.isSiteExcludable}})],1)}),t("div",{staticStyle:{display:"flex","justify-content":"center"}},[e.feedData.isViewMoreButtonVisible?t("div",{staticClass:"view-more-button c-text c-text--m",on:{click:()=>e.feedData.loadMore()}},[e._v(" すべて表示（"+e._s(e.feedData.remainingArticles)+"） ")]):e._e()]),e.feedData.isViewMoreButtonVisible?t("div",{staticClass:"spacing-16"}):e._e(),!e.feedData.isLoaded||e.feedData.isFetchingData?t("sm-loading",{staticClass:"loading loading-spacer"}):e._e(),e.isVisibleEmptyFeed?[t("div",{staticClass:"divider"}),e.theme?t("ThemeEmptyFeed",{attrs:{displayFeedType:e.displayFeedType,themeFeedType:e.themeFeedType,docType:"article",theme:e.theme,enableToEditTheme:e.enableToEditTheme}},[e._v(e._s(e.feed==="keyword_feed"?e.EMPTY_KEYWORD_FEED_MESSAGE:"関連ニュースはありませんでした。"))]):t("BasicEmptyFeed",[e._v(e._s(e.EMPTY_KEYWORD_FEED_MESSAGE))])]:e._e()],2)},$_=[],P_=T(I_,M_,$_,!1,null,"6aac09be",null,null);const N_=P_.exports,L_=D({props:{isChinese:{type:Boolean,default:!1}},setup(){return{}}}),U_=""+new URL("loading2-d222651e.gif",import.meta.url).href;var R_=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"theme-initial-state"},[t("div",{staticClass:"title"},[t("sm-icons",{staticClass:"sm-icons primary"},[e._v("check-circle")]),t("div",{staticClass:"spacing-08"}),t("div",{staticClass:"c-title c-title--xm"},[e._v("テーマが作成されました")])],1),e._m(0),e._m(1),t("div",{staticClass:"message"},[t("div",{staticClass:"c-text c-text--m"},[e.isChinese?e._e():t("span",[e._v("準備が終わるまで、昨日までの記事を確認してみましょう。"),t("br")]),e._v(" ニュースは"),t("span",{staticClass:"green-600"},[e._v("閲覧")]),e._v("や"),t("span",{staticClass:"green-600"},[e._v("マーク")]),e._v("などを元に興味にあわせてお届けします。 ")])]),t("div",{staticClass:"c-text c-text--m"},[t("span",{staticClass:"favorite-message"},[e._v("お気に入りにするとメール配信対象")]),t("span",[e._v("になります。")]),t("div",{staticClass:"favorite-icon"},[t("sm-icons",{staticClass:"astrategy-primary"},[e._v("star-fill")]),t("sm-icons",[e._v("long-arrow-right")]),t("sm-icons",[e._v("envelop")])],1)])])},O_=[function(){var s=this,e=s._self._c;return s._self._setupProxy,e("div",{staticClass:"ready-image"},[e("img",{attrs:{width:"120",height:"120",src:U_}})])},function(){var s=this,e=s._self._c;return s._self._setupProxy,e("div",{staticClass:"ready-message"},[e("div",{staticClass:"c-text c-text--xl"},[s._v("準備しています...")]),e("div",{staticClass:"c-text c-text--m"},[s._v("(5~10分)")])])}],G_=T(L_,R_,O_,!1,null,"40ee78b3",null,null);const q_=G_.exports,H_=20,V_=200,j_=D({props:{keywords:{type:Array,default:()=>[]},lang:{type:String,default:"ja"},isEntertainmentFilterEnabled:{type:Boolean,default:!1},limit:{type:Number,default:V_},initialFetchArticleCount:{type:Number,default:H_},to_date:{type:Object,default:()=>oe()},theme:{type:Object,required:!0},pageName:{type:String,required:!0},markSource:{type:String,rquired:!0},feature:{type:String,required:!0},rankOffset:{type:Number,required:!0}},components:{AdpDocumentCard:Re,BasicEmptyFeed:xt},methods:{},setup(s){const e=Fe({list:void 0}),t=g(!1),a=g(!1);let n=0;const r=({offset:c,limit:p})=>({keywords:s.keywords,lang:s.lang,entertainment_filter:s.theme.is_entertainment_sites_filtered,to_date:s.to_date.format("YYYY/MM/DD"),exclude_site_ids:s.theme.site_exclusion_ids,offset:c,limit:p});ne(async()=>{t.value=!0;const c=await F.searchPastArticles(r({offset:0,limit:s.initialFetchArticleCount})).catch(p=>{throw t.value=!1,p});n=c.result_count,e.list=c.articles.map((p,m)=>({...p,rank:m+1,isPastArticle:!0})),t.value=!1,c.result_count>s.initialFetchArticleCount&&(a.value=!0)});const o=l(()=>e.list===void 0?[]:e.list),i=l(()=>{if(e.list===void 0)return 0;const p=Math.min(n,s.limit)-s.initialFetchArticleCount;return Math.max(0,p)});return{searchedArticles:e,dayjs:oe,isLoading:t,showLoadAllButton:a,displayArticles:o,moreArticleCount:i,addArticles:async()=>{a.value=!1,t.value=!0;const c=await F.searchPastArticles(r({offset:s.initialFetchArticleCount,limit:s.limit-s.initialFetchArticleCount})).catch(p=>{throw a.value=!0,t.value=!1,p});e.list=e.list.concat(c.articles.map((p,m)=>({...p,rank:m+1,isPastArticle:!0}))),t.value=!1}}}});var K_=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",[e._l(e.displayArticles,function(a){return t("div",{key:a.id,staticClass:"article-card"},[t("div",{staticClass:"divider"}),t("AdpDocumentCard",{attrs:{width:"100%",adpDocument:a,themeId:e.theme.id,feedType:e.lang==="ja"?"domestic":"foreign",rankInWholeFeed:e.rankOffset+(a.rank-1),isRead:a.is_read,showCommentCount:1,hideUndisplayButton:!0,markSource:e.markSource,pageName:e.pageName,feature:e.feature}})],1)}),t("div",{staticClass:"spacing-16"}),t("div",{staticClass:"view-more-button__wrapper"},[e.showLoadAllButton?t("button",{staticClass:"view-more-button o-theme-edit-save outlined c-outlineBtn c-btn--auto c-btn--small c-outlineBtn--secondary",on:{click:e.addArticles}},[e._v(" すべて表示("+e._s(e.moreArticleCount)+") ")]):e._e()]),e.searchedArticles.list&&e.searchedArticles.list.length===0?t("div",[t("BasicEmptyFeed",[e._v("過去の記事はありませんでした。")])],1):e._e(),e.isLoading?t("div",{staticClass:"loading-container"},[t("sm-loading",{staticClass:"loading"})],1):e._e()],2)},Y_=[],Q_=T(j_,K_,Y_,!1,null,"183fc853",null,null);const W_=Q_.exports,z_=D({props:{feed:{type:String,required:!0},hasViewMoreButton:{type:Boolean,default:!0}},components:{ThemeEmptyFeed:hs,PastArticles:W_,FeedArticleMedia:N_,ThemeEmptyState:q_},setup(s){const e=se(),t=ie(),a=fe(),{feed:n,hasViewMoreButton:r}=$e(s),o=l(()=>n.value==="keyword_feed"?"新着":n.value==="related_feed"?"関連":"パーソナル"),i=l(()=>n.value==="keyword_feed"?(E,L,V,re)=>F.getThemeKeywordFeeds(u.value,E,L,V,re):n.value==="related_feed"?(E,L,V,re)=>F.getThemeRelatedFeeds(u.value,E,L,V,re):(E,L,V,re)=>F.getPersonalNews(E,L,V,re)),u=l(()=>Number(t.params.themeId)),{data:c,mutate:p}=n.value!=="personal_news"?pa(u.value):{data:g({themes:void 0}),mutate:()=>Promise.resolve()},m=l(()=>{var E;return(E=c.value)==null?void 0:E.themes}),d=l(()=>e.state.feedType.feedType),{data:_}=xe(),{data:h}=Pe(),v=l(()=>{var Ee,Me;const E=n.value==="personal_news",L=d.value==="all",V=d.value==="domestic"&&!((Ee=m.value)!=null&&Ee.is_chinese),re=d.value==="foreign"&&((Me=m.value)==null?void 0:Me.is_foreign_media_enabled);return E||L||V||re}),f=l(()=>{var E,L,V,re;return((E=_.value)==null?void 0:E.role)!=="viewer"||((L=m.value)==null?void 0:L.access_scope)==="personal"&&((V=m.value)==null?void 0:V.user_id)===((re=_.value)==null?void 0:re.id)}),C=l(()=>{var E;return(E=m.value)!=null&&E.feed_last_updated_at?oe(m.value.feed_last_updated_at):oe()}),y=g(!0),A=g(0),k=(E,L,V)=>{const re=n.value==="related_feed"?Qs:E?20:200,Ee=async(Me=re)=>{var ae,Ae,we;const q=(ae=b.find(Le=>Le.date===V))==null?void 0:ae[L];if(!q||!q.value)return;q.value.isViewMoreButtonVisible=!1,q.value.isFetchingData=!0;const G=await i.value(L,V,1,Me);if(q.value.articles=G.articles,n.value==="keyword_feed"){const Le=(Ae=m.value)!=null&&Ae.keyword_feed_counts?(we=m.value)==null?void 0:we.keyword_feed_counts[V.format("YYYY-MM-DD")]:{domestic:0,foreign:0};q.value.feedCount=Le&&Le[L]?Le[L]:0}else n.value==="personal_news"?q.value.feedCount=G.count:q.value.feedCount=q.value.articles.length;q.value.feedCount-=M.items.length,q.value.remainingArticles=q.value.feedCount-q.value.articles.length,q.value.isViewMoreButtonVisible=r.value&&q.value.remainingArticles>0,q.value.isFetchingData=!1,q.value.isLoaded=!0};return{articles:[],feedCount:0,isLoaded:!1,isFetchingData:!1,isViewMoreButtonVisible:!1,remainingArticles:0,load:Ee,loadMore:async()=>{var q;const Me=(q=b.find(G=>G.date===V))==null?void 0:q[L];Me!=null&&Me.value&&await Ee(Me.value.feedCount)}}},S=()=>({articles:[],feedCount:0,isLoaded:!0,isFetchingData:!1,isViewMoreButtonVisible:!1,remainingArticles:0,load:()=>{},loadMore:()=>{}}),b=[],U=(E,L)=>{var Ee;const V=E.subtract(L,"days"),re={date:V,dateStr:V.format("YYYY-MM-DD"),dateLabel:Ac(V,E),domestic:g(["all","domestic"].includes(d.value)?k(d.value==="all","domestic",V):S()),foreign:g(["all","foreign"].includes(d.value)&&(n.value==="personal_news"||(Ee=m.value)!=null&&Ee.is_foreign_media_enabled)?k(d.value==="all","foreign",V):S())};b[L]=re};let I;const w=g(),x=()=>{var E;I==null||I.disconnect(),I=new IntersectionObserver((L,V)=>{L.forEach(re=>{if(re.intersectionRatio>0){const Ee=re.target.dataset.dateStr,Me=oe(Ee),q=b.slice(1).find(G=>G.date.isSame(Me,"day"));q&&q.domestic.value.articles.length===0&&q.foreign.value.articles.length===0&&(q.domestic.value.load(),q.foreign.value.load()),V.unobserve(re.target)}})},{threshold:.1,rootMargin:"120px 0px 0px 0px"}),(E=w.value)==null||E.forEach((L,V)=>{V!==0&&(I==null||I.observe(L))})},B=async()=>{var L,V;if(y.value=!0,I==null||I.disconnect(),n.value!=="personal_news"&&(!((L=m.value)!=null&&L.id)||!v.value)){y.value=!1;return}let E=7;if(n.value==="keyword_feed"||n.value==="related_feed"){const re=Object.keys(((V=m.value)==null?void 0:V.keyword_feed_counts)??[]).sort();if(re.length>0){const Ee=oe(re[0]);E=Math.min(7,C.value.diff(oe(Ee),"day")+1)}}if(E>0){for(let re=0;re<E;re++)U(C.value,re);await Promise.all([b[0].domestic.value.load(),b[0].foreign.value.load()]),A.value=b[0].domestic.value.feedCount+b[0].foreign.value.feedCount}y.value=!1,await ze(),x(),ee()};Z(()=>{var E;return(E=m.value)==null?void 0:E.id},async()=>await B()),Z(()=>d.value,async()=>{M.items=[],await p(),await B()});const $=l(()=>b.map(E=>E.domestic.value.isLoaded&&E.foreign.value.isLoaded).reduce((E,L)=>E&&L,!0));ne(async()=>{await B(),a.$on("article-updated",P),a.$on("article-removed",O),a.$on("personal-feed-article-removed",j),a.$on("personal-feed-article-restored",K)}),Be(()=>{a.$off("article-updated",P),a.$off("article-removed",O),a.$off("personal-feed-article-removed",j),a.$off("personal-feed-article-restored",K),I==null||I.disconnect(),de==null||de.disconnect()});const P=E=>{b.forEach(L=>{[L.domestic.value.articles,L.foreign.value.articles].forEach(V=>{const re=V.findIndex(Ee=>Ee.id===E.id);re>=0&&(V[re].marks=E.marks,V[re].is_read=E.is_read)})})},M=Fe({items:[]}),O=({articleId:E})=>{M.items.push(E),W(E,-1)},Y=({articleId:E})=>{const L=[...M.items];L.includes(E)&&(M.items=L.filter(V=>V!==E),W(E,1))},W=(E,L)=>{b.forEach((V,re)=>{const Ee=V.domestic.value.articles.find(q=>q.id===E),Me=V.foreign.value.articles.find(q=>q.id===E);Ee&&(V.domestic.value.feedCount+=L),Me&&(V.foreign.value.feedCount+=L),(Ee||Me)&&re===0&&(A.value+=L)})},j=E=>O({articleId:E.id}),K=E=>{Y({articleId:E.id})},le=E=>E.filter(L=>!M.items.includes(L.id)),ye=async E=>{const L=b.filter(V=>V.date.isAfter(E,"day")&&(!V.domestic.value.isLoaded||!V.foreign.value.isLoaded)).map(V=>b.indexOf(V));for(let V of L)await Promise.all([b[V].domestic.value.load(),b[V].foreign.value.load()])},H=g(),ue=async E=>{var V;const L=(V=H.value)==null?void 0:V.find(re=>re.dataset.dateStr===E);L&&(await ye(oe(E)),ze(()=>{const Me=L.getBoundingClientRect().top+window.pageYOffset-112-16;window.scrollTo({top:Me,behavior:"smooth"})}))},_e=g(),me=g(!1);let de;const ee=()=>{de==null||de.disconnect(),de=new IntersectionObserver((E,L)=>{E.forEach(V=>{V.intersectionRatio>0&&(me.value=!0,L.unobserve(V.target))})}),_e.value&&de.observe(_e.value)},J=l(()=>{var E;return n.value==="keyword_feed"&&((E=m.value)==null?void 0:E.feed_last_updated_at)==null}),ce=l(()=>{var E,L;return((E=m.value)==null?void 0:E.feed_last_updated_at)==null?oe((L=m.value)==null?void 0:L.created_at).subtract(1,"day").endOf("day"):oe().subtract(7,"day").endOf("day")}),ke=E=>{const L=b.map(V=>V[E].value.articles.length);return L.length>0?L.reduce((V,re)=>V+re):0},R=n.value==="personal_news"?"personal_feed":"theme",ve=n.value==="personal_news"?"personal_feed":n.value,X=l(()=>{var V,re,Ee;const E=(V=m.value)==null?void 0:V.group_id,L=(Ee=(re=h.value)==null?void 0:re.groups)==null?void 0:Ee.find(Me=>Me.id===E);return Wr(_.value,m.value,L)}),te=l(()=>{var V,re,Ee;const E=(V=m.value)==null?void 0:V.group_id,L=(Ee=(re=h.value)==null?void 0:re.groups)==null?void 0:Ee.find(Me=>Me.id===E);return ya(_.value,m.value,L)});return{theme:m,feedName:o,feedType:d,hasFeed:v,isLoadingInitial:y,enableToEditTheme:f,articlesByDate:b,allLoaded:$,currentDayFeedCount:A,selectDate:ue,markSource:R,pageName:n.value,feature:ve,removedArticles:M,getVisibleArticles:le,isInitialStateKeywordFeed:J,scrolledPastArticles:me,pastArticlesToDate:ce,keywordFeedCount:ke,dateSelectRefs:H,feedRefs:w,pastArticlesRef:_e,isArticleHideable:X,isSiteExcludable:te,EMPTY_KEYWORD_FEED_MESSAGE:na}}});var J_=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"feed-articles-container"},[e.hasFeed&&!e.isLoadingInitial&&!e.isInitialStateKeywordFeed?t("div",{staticClass:"feed-articles"},e._l(e.articlesByDate,function(a){return t("div",{key:a.dateLabel,ref:"feedRefs",refInFor:!0,attrs:{"data-date-str":a.dateStr}},[t("div",{ref:"dateSelectRefs",refInFor:!0,staticClass:"articles",attrs:{"data-date-str":a.dateStr}},[t("div",[(e.feedType==="all"||e.feedType==="domestic")&&(!e.theme||!e.theme.is_chinese)?t("FeedArticleMedia",{attrs:{articlesByDate:e.articlesByDate,articles:e.getVisibleArticles(a.domestic.value.articles),theme:e.theme,date:a.date,dateStr:a.dateStr,dateLabel:a.dateLabel,feedData:a.domestic.value,isVisibleEmptyFeed:a.domestic.value.isLoaded&&e.getVisibleArticles(a.domestic.value.articles).length===0,feed:e.feed,displayFeedType:e.feedType,themeFeedType:"domestic"},on:{"select-date":e.selectDate}}):e._e()],1),t("div",[e.feedType==="all"||e.feedType==="foreign"?t("FeedArticleMedia",{attrs:{articlesByDate:e.articlesByDate,articles:e.getVisibleArticles(a.foreign.value.articles),theme:e.theme,date:a.date,dateStr:a.dateStr,dateLabel:a.dateLabel,feedData:a.foreign.value,isVisibleEmptyFeed:a.foreign.value.isLoaded&&e.getVisibleArticles(a.foreign.value.articles).length===0,feed:e.feed,displayFeedType:e.feedType,themeFeedType:"foreign"},on:{"select-date":e.selectDate}}):e._e()],1)])])}),0):e.isLoadingInitial?t("div",{staticClass:"loading-container"},[t("sm-loading",{staticClass:"loading"})],1):e.theme?[e.hasFeed?e._e():t("ThemeEmptyFeed",{staticClass:"empty-feed",attrs:{theme:e.theme,displayFeedType:e.feedType,themeFeedType:e.feedType,enableToEditTheme:e.enableToEditTheme,docType:"article"}},[e._v(e._s(e.EMPTY_KEYWORD_FEED_MESSAGE))]),e.isInitialStateKeywordFeed?t("ThemeEmptyState",{attrs:{isChinese:e.theme.is_chinese}}):e._e()]:e._e(),e.theme&&e.feed==="keyword_feed"?t("div",{ref:"pastArticlesRef",staticClass:"past-articles"},[e.theme.is_chinese?e._e():t("div",{staticClass:"c-title c-title--xm"},[e._v("過去の記事")]),t("div",{staticClass:"spacing-16"}),!e.theme.is_chinese&&(e.isInitialStateKeywordFeed||e.scrolledPastArticles)?t("div",[e.feedType==="all"?t("div",[t("div",{staticClass:"media-label c-title c-title--m"},[e._v("国内メディア")]),t("PastArticles",{attrs:{keywords:e.theme?e.theme.keywords:[],to_date:e.pastArticlesToDate,lang:"ja",rankOffset:e.keywordFeedCount("domestic")+1,theme:e.theme,pageName:e.pageName,markSource:e.markSource,feature:e.feature}}),t("div",{staticClass:"spacing-12"}),t("div",{staticClass:"spacing-16"}),t("div",{staticClass:"media-label c-title c-title--m"},[e._v("海外メディア")]),t("PastArticles",{attrs:{keywords:e.theme?e.theme.keywords:[],to_date:e.pastArticlesToDate,lang:"en",rankOffset:e.keywordFeedCount("foreign")+1,theme:e.theme,pageName:e.pageName,markSource:e.markSource,feature:e.feature}}),t("div",{staticClass:"spacing-16"})],1):e.feedType==="domestic"?t("div",[t("PastArticles",{attrs:{keywords:e.theme?e.theme.keywords:[],to_date:e.pastArticlesToDate,lang:"ja",rankOffset:e.keywordFeedCount("domestic")+1,theme:e.theme,pageName:e.pageName,markSource:e.markSource,feature:e.feature}})],1):e.feedType==="foreign"?t("div",[t("PastArticles",{attrs:{keywords:e.theme?e.theme.keywords:[],date_to:e.pastArticlesToDate,lang:"en",rankOffset:e.keywordFeedCount("foreign")+1,theme:e.theme,pageName:e.pageName,markSource:e.markSource,feature:e.feature}}),t("div",{staticClass:"spacing-16"})],1):e._e()]):e._e(),!e.theme.is_chinese&&e.scrolledPastArticles?t("div",{staticClass:"induction"},[e._m(0),t("div",{staticClass:"spacing-12"}),t("div",{staticClass:"message c-title c-title--xm"},[e._v(" 気になる記事は見つかりましたか？ ")]),t("div",{staticClass:"spacing-12"}),e._m(1),t("div",{staticClass:"spacing-12"}),t("div",{staticClass:"message c-text c-text--m"},[t("router-link",{staticClass:"green-600 link",attrs:{to:{path:`/themes/${e.theme.id}/edit`}}},[e._v(" 設定ページに移動 ")])],1)]):e._e()]):e._e()],2)},X_=[function(){var s=this,e=s._self._c;return s._self._setupProxy,e("div",{staticClass:"image-wrap"},[e("img",{staticClass:"image",attrs:{src:or}})])},function(){var s=this,e=s._self._c;return s._self._setupProxy,e("div",{staticClass:"message c-text c-text--m"},[s._v(" あなたの興味・関心にあった記事が少ないなと感じたら、"),e("br"),s._v(" 設定ページでキーワードを追加してみてください。 ")])}],Z_=T(z_,J_,X_,!1,null,"533eae3a",null,null);const us=Z_.exports,ep=D({props:{adpDocuments:{type:Array,required:!0},pageName:{type:String,required:!0},groupId:{type:Number,required:!1},isExportEditableInfo:{type:Boolean,required:!1,default:!0}},setup(s){const e=ie(),t=se(),{adpDocuments:a}=$e(s),n=o=>{var u;const i=ot(o)?o.media_name:Gt(o)?o.journal_name:"";return[`${o.title}`,`日付： ${o.published_at?De(o.published_at):""}`,`掲載メディア： ${i}`,`URL： ${o.url}`,s.isExportEditableInfo?`メモ： ${o.memo??""}`:null,s.isExportEditableInfo?`タグ： ${((u=o.tags)==null?void 0:u.join(","))??""}`:null].filter(c=>c!==null).join(`
`)};return{copy:()=>{const o=a.value.map(n).join(`

`),i=new Dn(".copy-button",{text:()=>o});i.on("success",u=>{if(window.clipboardData){const c=window.clipboardData.getData("text").replace(/\r\n/g,`
`);if(u.text!==c){t.commit("snackbar/addMessages",{message:"記事情報をコピーできませんでした",type:"error"});return}}F.trackEvent("copy_articles_to_clipboard",{pageName:s.pageName,pageUrl:e.fullPath},void 0,s.groupId,{articles:a.value.map(c=>c.id)}),t.commit("snackbar/addMessages",{message:"記事情報をコピーしました",type:""}),i.destroy()})}}}});var tp=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("span",{staticClass:"copy-button",on:{click:e.copy}},[t("sm-icons",{staticClass:"small"},[e._v("copy")]),t("span",{staticClass:"c-title c-title--m"},[e._v("記事情報をコピー")])],1)},sp=[],ap=T(ep,tp,sp,!1,null,"9e5389e1",null,null);const Ca=ap.exports,np=D({setup(){return{}}});var rp=function(){var e=this;return e._self._c,e._self._setupProxy,e._m(0)},op=[function(){var s=this,e=s._self._c;return s._self._setupProxy,e("div",{staticClass:"adp-document-info"},[e("div",{staticClass:"heading"},[e("div",{staticClass:"c-title c-title--s"},[s._v("記事の情報")])]),e("div",{staticClass:"o-image"},[e("img",{attrs:{src:Wt}})]),e("div",{staticClass:"c-text c-text--m"},[s._v(" 記事を選択すると記事につけたタグやメモなどが表示されます ")])])}],ip=T(np,rp,op,!1,null,"c80a7585",null,null);const ba=ip.exports,up=D({props:{name:{type:String,default:""},isDelete:{type:Boolean,default:!1},isAdd:{type:Boolean,default:!1},showTooltip:{type:Boolean,default:!0}},setup(s,e){return{deleteTag:()=>{e.emit("deleteTag",s.name)},addTag:()=>{e.emit("addTag",s.name)}}}});var cp=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{directives:[{name:"tooltip",rawName:"v-tooltip.bottom",value:e.showTooltip?{content:e.name,delay:{show:300},autoHide:!1}:void 0,expression:`
      showTooltip
        ? { content: name, delay: { show: 300 }, autoHide: false }
        : undefined
    `,modifiers:{bottom:!0}}],staticClass:"a-tag c-outlineTag",class:{"c-outlineTag--delete":e.isDelete}},[t("div",{staticClass:"a-tag-text c-text c-text--m",class:{"a-tag-icon__content":e.isDelete||e.isAdd}},[e._v(" "+e._s(e.name)+" ")]),e.isDelete?t("sm-icons",{on:{click:e.deleteTag}},[e._v("times")]):e._e(),e.isAdd?t("sm-icons",{staticClass:"clickable small",on:{click:e.addTag}},[e._v("plus")]):e._e()],1)},lp=[],dp=T(up,cp,lp,!1,null,"33b05e10",null,null);const Nt=dp.exports,mp=D({components:{TagItem:Nt},props:{tagList:{type:Array,default:()=>[]},selectedTags:{type:Array,default:()=>[]},placeholder:{type:String,default:""},isEdit:{type:Boolean,default:!1}},setup(s,e){const t=g(""),a=g(!1),n=g(!1),r=g(),o=v=>{var C;const f=v.target;r.value&&!((C=r.value)!=null&&C.contains(f))&&u()},i=()=>{a.value=!0,document.addEventListener("click",o);const v=document.querySelector(".dialog-container");v&&v.addEventListener("click",o)},u=()=>{a.value=!1,document.removeEventListener("click",o);const v=document.querySelector(".dialog-container");v&&v.removeEventListener("click",o)},c=v=>{var C;if(_.value)return;if(!v&&t.value===""){n.value=!0;return}if(d.value.indexOf(t.value)>-1)return;let f=d.value;v?f.push(v):f.push(t.value),e.emit("update:selectedTags",f),(C=r.value)==null||C.blur(),t.value="",u()},p=v=>{let f=d.value;f=f.filter(C=>C!==v),e.emit("update:selectedTags",f)},m=l(()=>s.tagList.filter(v=>!d.value.includes(v.name)&&v.name.includes(t.value))),d=l(()=>s.selectedTags),_=l(()=>t.value.length>zi),h=l(()=>{let v="";return _.value?v="タグは16文字以内で入力してください。":n.value&&(v="文字を入力してください"),v});return Z(()=>s.isEdit,()=>{t.value=""}),Z(()=>t.value,()=>{t.value!==""&&(n.value=!1)}),{inputValue:t,listVisible:a,filteredList:m,selectedTagList:d,tooLongTag:_,emptyTag:n,errorMessage:h,showList:i,hideList:u,addItem:c,removeItem:p,inputTag:r}}});var _p=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"m-input-tag"},[e.isEdit?t("div",{staticClass:"c-formBlock"},[t("div",{staticClass:"c-formBlock__label"},[e._v("タグ")]),e.tooLongTag||e.emptyTag?t("div",{staticClass:"c-formBlock__text c-formBlock__text--error"},[e._v(" "+e._s(e.errorMessage)+" ")]):e._e(),t("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.inputValue,expression:"inputValue",modifiers:{trim:!0}}],ref:"inputTag",staticClass:"m-input-tag__input c-textInput",class:{"c-formInput--error":e.tooLongTag||e.emptyTag},attrs:{type:"text",placeholder:e.placeholder},domProps:{value:e.inputValue},on:{click:function(a){return a.stopPropagation(),a.preventDefault(),(()=>{}).apply(null,arguments)},focus:e.showList,keypress:function(a){return!a.type.indexOf("key")&&e._k(a.keyCode,"enter",13,a.key,"Enter")?null:e.addItem()},input:function(a){a.target.composing||(e.inputValue=a.target.value.trim())},blur:function(a){return e.$forceUpdate()}}})]):e._e(),e.listVisible?t("div",{staticClass:"m-input-tag__list"},[e.filteredList.length===0?t("div",{staticClass:"item disabled"},[e._m(0)]):e._l(e.filteredList,function(a){return t("div",{key:a.name,staticClass:"item",on:{click:function(n){return n.stopPropagation(),n.preventDefault(),e.addItem(a.name)}}},[t("div",{staticClass:"info"},[t("div",{staticClass:"name c-text c-text--m"},[e._v(e._s(a.name))])]),t("div",{staticClass:"count c-text c-text--m"},[e._v(e._s(a.count))])])})],2):e._e(),t("div",{staticClass:"selected-items"},e._l(e.selectedTagList,function(a){return t("div",{key:a,staticClass:"item"},[t("TagItem",{attrs:{name:a,isDelete:e.isEdit},on:{deleteTag:function(n){return e.removeItem(a)}}})],1)}),0)])},pp=[function(){var s=this,e=s._self._c;return s._self._setupProxy,e("div",{staticClass:"info"},[e("div",{staticClass:"name c-text c-text--m"},[s._v("タグがありません")])])}],vp=T(mp,_p,pp,!1,null,"d4cdb1b7",null,null);const Aa=vp.exports,fp=D({components:{InputTag:Aa},props:{adpDocument:{type:Object},creator:{type:Object,required:!1},tagList:{type:Array,default:()=>[]},editable:{type:Boolean,default:!1}},setup(s,e){var f,C,y,A;const t=g(!1),a=g(((f=s.adpDocument)==null?void 0:f.memo)??""),n=Fe({list:[...((C=s.adpDocument)==null?void 0:C.tags)??[]]}),r=g("");let o=[...((y=s.adpDocument)==null?void 0:y.tags)??[]],i=((A=s.adpDocument)==null?void 0:A.memo)??"";ne(()=>{_()});const u=()=>{t.value=!1,_(),e.emit("article-info-updated",{...s.adpDocument,memo:a.value,tags:n.list},{shouldUpdateMemo:i!==a.value,shouldUpdateTags:o.toString()!==n.list.toString()})},c=()=>{var k,S;t.value=!1,a.value=((k=s.adpDocument)==null?void 0:k.memo)??"",n.list=[...((S=s.adpDocument)==null?void 0:S.tags)??[]],e.emit("cancel-edit")};Z(()=>s.adpDocument,()=>{var k,S;t.value=!1,a.value=((k=s.adpDocument)==null?void 0:k.memo)??"",_(),n.list=[...((S=s.adpDocument)==null?void 0:S.tags)??[]]});const p=()=>{t.value=!0,e.emit("click-edit"),o=[...n.list??[]],i=a.value},m=()=>{let k=a.value;const S=a.value.match(Qa)??[];for(const b of S){const U=new RegExp(b,"ig");k=k.replace(U,`<a class="url-link" href="" target="_blank">${b}</a>`)}r.value=k},d=async()=>{var U,I;let k=r.value;const S=(U=s.adpDocument)==null?void 0:U.id,b=a.value.match(Qa)??[];for await(const w of b){const x=await F.fetchUrlPreview(w).catch(()=>{}),B=new RegExp(`<a class="url-link" href="" target="_blank">${w}</a>`,"g");if(x?k=k.replace(B,`<a class="url-link" href="${w}" target="_blank">${x.title}</a>`):k=k.replace(B,`<a class="url-link" href="${w}" target="_blank">${w}</a>`),S!==((I=s.adpDocument)==null?void 0:I.id))return;r.value=k}},_=()=>{r.value=a.value,m(),d()},h=l(()=>s.adpDocument===void 0?"":ot(s.adpDocument)?s.adpDocument.media_name:Gt(s.adpDocument)?s.adpDocument.journal_name:""),v=l(()=>Qt(r.value));return{editing:t,editingMemo:a,selectedTags:n,displayMemo:r,sanitizedDisplayMemo:v,updateArticleInfo:u,cancelEdit:c,clickEdit:p,adpDocumentMediaJournalName:h}}});var gp=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"article-info"},[e.adpDocument?t("div",{staticClass:"basic-info"},[t("div",{staticClass:"heading"},[t("sm-icons",[e._v("newspaper")]),t("div",{staticClass:"spacing-04"}),t("div",{staticClass:"c-title c-title--m"},[e._v("基本情報")])],1),t("div",{staticClass:"article-title"},[t("div",{staticClass:"sub-heading c-title c-title--s"},[e._v("タイトル")]),t("div",{staticClass:"spacing-02"}),t("div",{staticClass:"c-text c-text--m"},[e._v(e._s(e.adpDocument.title))])]),t("div",{staticClass:"spacing-12"}),t("div",{staticClass:"article-media"},[t("div",{staticClass:"sub-heading c-title c-title--s"},[e._v("メディア")]),t("div",{staticClass:"c-text c-text--m"},[e._v(e._s(e.adpDocumentMediaJournalName))])]),t("div",{staticClass:"spacing-12"}),t("div",{staticClass:"article-url"},[t("div",{staticClass:"sub-heading c-title c-title--s"},[e._v("URL")]),t("div",{staticClass:"body"},[t("a",{staticClass:"url-link",attrs:{href:e.adpDocument.url,target:"_blank"}},[t("div",{staticClass:"url c-text c-text--m"},[e._v(e._s(e.adpDocument.url))]),t("div",[t("sm-icons",{staticClass:"primary small"},[e._v("external-link")])],1)])])]),e.creator?t("div",{staticClass:"creator"},[t("div",{staticClass:"spacing-12"}),t("div",{staticClass:"sub-heading c-title c-title--s"},[e._v("共有者")]),t("div",{staticClass:"c-text c-text--m"},[e._v(e._s(e.creator.user_name))])]):e._e()]):e._e(),e.editable?[t("div",{staticClass:"spacing-24"}),t("div",{staticClass:"memo"},[t("div",{staticClass:"heading"},[t("sm-icons",[e._v("pencil")]),t("div",{staticClass:"spacing-04"}),t("div",{staticClass:"c-title c-title--m"},[e._v("メモ")])],1),!e.editing&&e.displayMemo.length>0?t("div",{staticClass:"memo-content c-text c-text--m",domProps:{innerHTML:e._s(e.sanitizedDisplayMemo)}}):e._e(),!e.editing&&e.displayMemo.length===0?t("div",{staticClass:"memo-empty c-text c-text--m"},[e._v(" 未記入 ")]):e._e(),e.editing?t("div",{staticClass:"c-formBlock__label"},[e._v("メモ")]):e._e(),e.editing?t("textarea",{directives:[{name:"model",rawName:"v-model.trim",value:e.editingMemo,expression:"editingMemo",modifiers:{trim:!0}}],staticClass:"memo-textarea c-textArea",domProps:{value:e.editingMemo},on:{keydown:[function(a){return!a.type.indexOf("key")&&e._k(a.keyCode,"enter",13,a.key,"Enter")||!a.ctrlKey?null:e.updateArticleInfo.apply(null,arguments)},function(a){return!a.type.indexOf("key")&&e._k(a.keyCode,"enter",13,a.key,"Enter")||!a.metaKey?null:e.updateArticleInfo.apply(null,arguments)}],input:function(a){a.target.composing||(e.editingMemo=a.target.value.trim())},blur:function(a){return e.$forceUpdate()}}}):e._e()]),t("div",{staticClass:"spacing-24"}),t("div",{staticClass:"tags"},[t("div",{staticClass:"heading"},[t("sm-icons",[e._v("tag")]),t("div",{staticClass:"spacing-04"}),t("div",{staticClass:"c-title c-title--m"},[e._v("タグ")])],1),(!e.selectedTags.list||e.selectedTags.list.length===0)&&!e.editing?t("div",{staticClass:"tags-empty c-text c-text--m"},[e._v(" 未設定 ")]):e._e(),t("InputTag",{attrs:{placeholder:"タグを入力後、改行でタグを追加",tagList:e.tagList,selectedTags:e.selectedTags.list,isEdit:e.editing},on:{"update:selectedTags":function(a){return e.$set(e.selectedTags,"list",a)},"update:selected-tags":function(a){return e.$set(e.selectedTags,"list",a)}}})],1),t("div",{staticClass:"spacing-24"}),e.editing?e._e():t("div",{staticClass:"edit-button c-outlineBtn c-outlineBtn--secondary c-btn--small",on:{click:e.clickEdit}},[e._v(" 編集 ")]),e.editing?t("div",[t("div",{staticClass:"save-button c-btn c-btn--small c-btn--AnewsPrimary",on:{click:e.updateArticleInfo}},[e._v(" 保存 ")]),t("div",{staticClass:"spacing-12"}),t("div",{staticClass:"cancel-button c-outlineBtn c-btn--small c-outlineBtn--secondary",on:{click:e.cancelEdit}},[e._v(" キャンセル ")])]):e._e()]:e._e()],2)},hp=[],yp=T(fp,gp,hp,!1,null,"602ffddc",null,null);const ka=yp.exports,Cp=D({components:{SearchBar:At},props:{tagList:{type:Array},targetTags:{type:Array},emptyFilterMessage:{type:String,default:"指定したタグはありません。"},isShowCount:{type:Boolean,default:!0}},setup(s,{emit:e}){const t=g(""),a=g([]),n=g([]);return ne(()=>{n.value=[...s.targetTags??[]],a.value=s.tagList??[]}),{filterQuery:t,filteredArticleTags:a,filterTags:m=>{t.value=m,a.value=s.tagList??[],a.value=a.value.filter(d=>d.name.includes(t.value))},selectTag:(m,d)=>{if(d)n.value.push(m);else{const _=n.value.indexOf(m);n.value.splice(_,1)}},isSelectedTag:m=>n.value.includes(m),handleSelectAllTags:()=>{const m=a.value.map(d=>d.name);m.forEach(d=>{const _=n.value.indexOf(d);_>=0&&n.value.splice(_,1)}),n.value.push(...m)},handleDeselectAllTags:()=>{a.value.map(d=>d.name).forEach(d=>{const _=n.value.indexOf(d);_>=0&&n.value.splice(_,1)})},handleTagFilterArticles:()=>{e("filter-articles",n.value)}}}});var bp=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"tag-select"},[t("div",{staticClass:"tag-search-bar"},[t("SearchBar",{on:{onChangeQuery:e.filterTags}})],1),t("div",{staticClass:"tag-list"},[(!e.tagList||e.tagList.length===0)&&e.filterQuery.length===0?t("div",{staticClass:"tags-empty c-text c-text--m"},[e._v(" 未設定 ")]):e._e(),e.filteredArticleTags.length===0&&e.filterQuery.length>0?t("div",{staticClass:"tags-empty c-text c-text--m"},[e._v(" "+e._s(e.emptyFilterMessage)+" ")]):e._e(),e._l(e.filteredArticleTags,function(a){return t("div",{key:a.id,staticClass:"tag"},[t("sm-checkbox-label",{staticClass:"checkbox-label",attrs:{value:e.isSelectedTag(a.name)},on:{change:function(n){return e.selectTag(a.name,n)}}},[t("span",{staticClass:"m-checkbox-label"},[e._v(e._s(e.isShowCount?a.name+"("+a.count+")":a.name))])])],1)})],2),t("div",{staticClass:"btn-area"},[t("button",{staticClass:"select-all-btn c-text c-text--m",on:{click:e.handleSelectAllTags}},[e._v(" すべて選択 ")]),t("button",{staticClass:"select-deselect-btn c-text c-text--m",on:{click:e.handleDeselectAllTags}},[e._v(" 選択解除 ")]),t("button",{staticClass:"tag-filter-btn c-btn c-btn--small c-btn--AnewsPrimary",on:{click:e.handleTagFilterArticles}},[e._v(" 適用 ")])])])},Ap=[],kp=T(Cp,bp,Ap,!1,null,"a2fe374c",null,null);const ys=kp.exports,Cs=function(s,e,t,a,n,r=0,o=!1){if(!s||!e)return;const i=62,u=64,c=u+n+i,p=s.offsetHeight,m=window.innerHeight,d=window.pageYOffset,_=window.pageXOffset;if(o){if(e.offsetHeight<=p){s.style.position="relative",s.style.top="",s.style.bottom="";return}return s.style.position="fixed",d>n?s.style.top=`${u+i}px`:(s.style.position="absolute",s.style.top=`${r}px`),s.style.bottom="auto",{windowScrollY:d,contentPosition:"top"}}if(e.offsetHeight==p)return;if(p<m)return s.style.position!="fixed"&&(s.style.position="fixed",s.style.top=`${c}px`,s.style.bottom="auto",s.style.transform=`translateX(-${_}px)`),d>n?(s.style.top=`${u+i}px`,s.style.transform=`translateX(-${_}px)`):(s.style.position="absolute",s.style.top=`${r}px`,s.style.transform="translateX(0px)"),{windowScrollY:d,contentPosition:a};const h=s.offsetTop,v=h+p,f=d>=t;if(f&&a=="bottom"||!f&&a=="top")return!f&&a=="top"&&(d>n?s.style.top=`${u+i}px`:(s.style.position="absolute",s.style.top=`${r}px`,s.style.transform="translateX(0px)")),s.style.position==="fixed"&&(s.style.transform=`translateX(-${_}px)`),{windowScrollY:d,contentPosition:a};const C=s.style.position=="fixed";return!f&&(C||d>=h+n)||f&&(C||d-c+m<=v)?(a="middle",C&&(s.style.position="absolute",s.style.top=`${Math.max(0,d-c+h)}px`,s.style.bottom="auto",s.style.transform="translateX(0px)"),{windowScrollY:d,contentPosition:a}):(s.style.position=="absolute"&&(s.style.position="fixed",s.style.transform=`translateX(-${_}px)`,f?(a="bottom",s.style.top="auto",s.style.bottom="0"):(a="top",s.style.top=`${c-n}px`,s.style.bottom="auto")),{windowScrollY:d,contentPosition:a})},xa=(s,e,t)=>s.metaKey||s.ctrlKey?t.map(a=>a.id).includes(e.id)?t.filter(a=>a.id!==e.id):[...t,e]:t.length===1&&t[0].id===e.id?[]:[e],xp=160,Zt=50,wp="group_activities",Ep=D({components:{Header:Se,Content:Ue,TagItem:Nt,TagSelect:ys,AdpDocumentCard:Re,AdpDocumentExport:Ca,AdpDocumentInfo:ka,AdpDocumentInfoDefault:ba,GroupToggleButton:kt},setup(){const s=ie(),e=fe(),t=se(),{data:a}=xe(),{data:n,state:r}=Pe(),o=g(),i=g(),u=g(!1),c=g(!1),p=g(!0),m=g(!1),d=g(!0),_=g(void 0),h=g("updatedAt"),v=g([]),f=g([]),C=g([]),y=l(()=>s.params.groupId),A=g(void 0),k=l(()=>{var G;return((G=A.value)==null?void 0:G.map(ae=>({...ae,id:ae.name})))??[]});let S=1,b=1,U=0,I,w="top",x=new AbortController;const B=l(()=>{var G;return(G=n.value)==null?void 0:G.groups.find(ae=>ae.id===Number(y.value))});ne(async()=>{j()&&(P(),document.addEventListener("click",O),window.addEventListener("scroll",ce),window.addEventListener("resize",J),e.$on("comment-deleted",ye),e.$on("comment-updated",H),A.value=await F.fetchGroupTags(Number(y.value),!0),ce(),f.value=await ee(),d.value=!1,i.value&&(I=new ResizeObserver(()=>J()),I.observe(i.value)))}),Be(()=>{document.removeEventListener("click",O),window.removeEventListener("scroll",ce),window.removeEventListener("resize",J),e.$off("comment-deleted",ye),e.$off("comment-updated",H),I==null||I.disconnect()});const $=async G=>{try{const ae=G.group_marks.findIndex(Ae=>{var we;return Ae.group_id===((we=B.value)==null?void 0:we.id)});if(ae===-1)throw new Error("targetGroupMark is not found");await F.deleteGroupMark(G.group_marks[ae].id),G.group_marks.splice(ae,1),t.commit("snackbar/addMessages",{message:"グループマークを外しました",type:""})}catch{t.commit("snackbar/addMessages",{message:"グループマークを外せませんでした",type:"error"})}},P=async()=>{var G,ae;(G=B.value)!=null&&G.is_member&&await F.sendGroupView(B.value.id),e.$emit("clear-group-unread-count",(ae=B.value)==null?void 0:ae.id)},M=G=>{C.value=C.value.filter(ae=>ae!==G)},O=()=>m.value=!1,Y=G=>{const ae=G.value;ae==="all"?_.value=void 0:_.value=ae==="existsMemo"},W=G=>G.group_marks.find(ae=>{var Ae;return ae.group_id===((Ae=B.value)==null?void 0:Ae.id)})!==void 0,j=()=>y.value===void 0?!1:r.value===be.SUCCESS&&B.value===void 0?(t.commit("snackbar/addMessages",{message:"指定されたグループは存在しません",type:"error"}),Et.push({name:"anewsHome"}),!1):!0;Z(()=>y.value,async()=>{j()&&(x.abort(),x=new AbortController,_e(),A.value=await F.fetchGroupTags(Number(y.value),!0,x),C.value=[])}),Z(()=>B.value,async()=>{P()}),Z(()=>[C.value,_.value],async()=>{_e(),d.value=!0,f.value=await ee(),d.value=!1}),Z(h,()=>{h.value==="updatedAt"?f.value=K(f.value):f.value=le(f.value)});const K=G=>G.sort((ae,Ae)=>R(Ae).getTime()-R(ae).getTime()),le=G=>G.sort((ae,Ae)=>ke(Ae).getTime()-ke(ae).getTime()),ye=G=>{f.value=f.value.filter(ae=>ae.data.id!==G)},H=G=>{f.value=f.value.map(ae=>ae.type==="comment"&&ae.data.id===G.id?{type:"comment",data:G}:ae)},ue=(G,ae)=>{v.value=xa(G,ae,v.value)},_e=()=>{f.value=[],v.value=[],b=1,S=1,c.value=!1,u.value=!1,m.value=!1},me=async()=>{if(u.value)return[];const G=await F.fetchGroupActivityComments(y.value,S,Zt,C.value,x,_.value);return G.length>=Zt?S=S+1:u.value=!0,G},de=async()=>{if(c.value)return[];const G=await F.fetchGroupMarks(y.value,b,Zt,C.value,x,_.value);return G.length>=Zt?b=b+1:c.value=!0,G},ee=async()=>{const[G,ae]=await Promise.all([me(),de()]),Ae=G.map(ut=>({type:"comment",data:ut})),we=ae.map(ut=>({type:"mark",data:ut}));return h.value==="updatedAt"?K([...Ae,...we]):le([...Ae,...we])},J=G=>ce(G,!0),ce=(G,ae=!1)=>{if(!o.value||!i.value)return;const Ae=Cs(i.value,o.value,U,w,xp,0,ae);Ae&&(U=Ae.windowScrollY,w=Ae.contentPosition)},ke=G=>{if(G.type==="comment"){const ae=G.data;return new Date(ae.created_at)}else{const ae=G.data;return new Date(ae.group_marks[ae.group_marks.length-1].created_at)}},R=G=>{if(G.type==="comment"){const ae=G.data,we=[...ae.children.map(Le=>new Date(Le.created_at).getTime()),new Date(ae.created_at).getTime()];return new Date(Math.max(...we))}else{const ae=G.data,Ae=ae.comments.map(ut=>{const Xt=ut.children.map(Ut=>new Date(Ut.created_at).getTime());return[new Date(ut.created_at).getTime(),...Xt]}).flat(),we=ae.group_marks.map(ut=>new Date(ut.created_at).getTime()),Le=[...Ae,...we];return new Date(Math.max(...Le))}},ve=G=>v.value.map(ae=>ae.id).includes(G.id),X=G=>!ve(G),te=()=>{t.commit("modal/setGroup",B)},E=()=>{te(),t.commit("modal/showModal","commentCreateWithoutArticle")},L=G=>{p.value=G.value==="showComment"},V=G=>{h.value!==G.value&&(h.value=G.value)},re=()=>m.value=!m.value;return t.subscribe(G=>{if(G.type==="modal/setWithoutArticleComment"){const ae=G.payload;f.value.unshift({type:"comment",data:ae})}}),{group:B,myInfo:a,getTabs:Pt,openCommentCreateModalWithoutArticleInfo:E,groupActivities:f,selectedArticles:v,toggleSelected:ue,enableHover:X,rightColumn:o,rightContent:i,isSelected:ve,handleArticleCardCommentOpen:L,isShowArticleCardComment:p,updateArticleInfo:async(G,ae)=>{const Ae=Number(y.value);if(Ae)try{ae.shouldUpdateMemo&&(G.memo?await F.updateGroupArticleMemo(Ae,G.id,G.doc_type,G.memo):await F.deleteGroupArticleMemo(Ae,G.id,G.doc_type).catch(we=>{var Le;if(((Le=we.response)==null?void 0:Le.status)!==404)throw we})),ae.shouldUpdateTags&&await F.updateGroupArticleTags(Ae,G.id,G.doc_type,G.tags||[]),v.value=v.value.map(we=>we.id===G.id?G:we),f.value=f.value.map(we=>{var Le;return we.type==="mark"?we.data.id===G.id?{type:we.type,data:G}:we:((Le=we.data.article)==null?void 0:Le.id)===G.id?{type:we.type,data:{...we.data,article:G}}:we}),await F.trackEvent("set_article_option",{pageName:"group",pageUrl:s.fullPath,feature:"group_activities"},G.id,Ae,{tags:G.tags,memo:G.memo}),t.commit("snackbar/addMessages",{message:"記事情報を更新しました",type:""})}catch{t.commit("snackbar/addMessages",{message:"記事情報を更新できませんでした",type:"error"})}},addActivity:async()=>{d.value=!0;let G=[];if(C.value.length===0&&_.value===void 0)G=await ee();else{const Ae=(await de()).map(we=>({type:"mark",data:we}));G=le(Ae)}f.value=[...f.value,...G]},disableAddGroupMark:c,disableAddComment:u,changeSortType:V,toggleTagMenu:re,selectedTags:C,isOpenTagMenu:m,tags:k,handleTagFilterArticles:G=>{m.value=!1,C.value.sort()!==G.sort()&&(C.value=G)},removeTag:M,handleMemoFilterArticles:Y,isLoading:d,PAGE_NAME:wp,removeGroupMark:$,hasGroupMark:W}}}),bs=""+new URL("state-prepare-feed-small-4117e912.png",import.meta.url).href;var Fp=function(){var e=this,t=e._self._c;return e._self._setupProxy,e.group?t("div",{staticClass:"group-activity"},[e.myInfo?t("Header",{attrs:{title:e.group.name,detail:`メンバー${e.group.member_count}人`,tabs:e.getTabs(e.group,e.myInfo),contentWidth:"912px"},scopedSlots:e._u([{key:"button",fn:function(){return[e.group.group_type!=="all_user_group"?t("GroupToggleButton",{attrs:{group:e.group}}):e._e()]},proxy:!0}],null,!1,1827677073)}):e._e(),t("Content",[t("div",{staticClass:"group-content"},[t("div",{staticClass:"action-bar"},[t("div",{staticClass:"group-activity-header"},[t("span",{staticClass:"c-title c-title--m"},[e._v("アクティビティ一覧")]),t("button",{staticClass:"c-btn c-btn--small group-activity-add-comment-btn",on:{click:e.openCommentCreateModalWithoutArticleInfo}},[e._v(" グループにコメントする ")])]),t("div",{staticClass:"spacing-16"}),t("div",{staticClass:"group-activity-btns-header"},[t("div",{staticClass:"group-activity-selects"},[t("sm-selectbox",{staticClass:"small",attrs:{labels:["すべての記事","メモした記事","メモしてない記事"],values:["all","existsMemo","noMemos"],placeholder:"すべての記事"},on:{selected:e.handleMemoFilterArticles}}),t("div",{staticClass:"spacing-16"}),t("div",{ref:"tagBox",staticClass:"tag-box",on:{click:function(a){return a.preventDefault(),a.stopPropagation(),(()=>{}).apply(null,arguments)}}},[t("div",{staticClass:"tag-selectbox",on:{click:e.toggleTagMenu}},[t("sm-selectbox",{key:e.selectedTags.length,staticClass:"small",attrs:{placeholder:`タグ ${e.selectedTags.length>0?e.selectedTags.length:""}`}})],1),e.isOpenTagMenu&&e.tags?t("TagSelect",{attrs:{tagList:e.tags,selectedTags:e.selectedTags},on:{"filter-articles":e.handleTagFilterArticles}}):e._e()],1),t("div",{staticClass:"spacing-16"}),t("div",{staticClass:"tag-selectbox"},[t("sm-selectbox",{staticClass:"small",attrs:{placeholder:"更新順",labels:["更新順","最新順"],values:["updatedAt","latestedAt"]},on:{selected:e.changeSortType}})],1),t("div",{staticClass:"spacing-16"}),t("sm-selectbox",{staticClass:"small",attrs:{labels:["コメントを表示","コメントを非表示"],values:["showComment","hideComment"],placeholder:"コメントを表示"},on:{selected:e.handleArticleCardCommentOpen}})],1),e.selectedArticles.length>0?t("AdpDocumentExport",{staticClass:"export-button",attrs:{adpDocuments:e.selectedArticles,pageName:e.PAGE_NAME,groupId:e.group.id}}):e._e()],1),e.selectedTags.length>0?t("div",{staticClass:"selected-tags"},[t("span",{staticClass:"c-text c-text--s"},[e._v("選択中のタグ")]),e._l(e.selectedTags,function(a){return t("TagItem",{key:a,staticClass:"tag",attrs:{name:a,isDelete:!0},on:{deleteTag:function(n){return e.removeTag(a)}}})})],2):e._e(),t("div",{staticClass:"group-activity-content"},[t("div",{staticClass:"group-activity-card-list-area"},[e.groupActivities.length===0&&!e.isLoading?t("div",[t("div",{staticClass:"no-activity"},[t("div",{staticClass:"content"},[t("div",{staticClass:"c-text c-text--m"},[e._v(" 該当するアクティビティはありませんでした。 ")])]),t("img",{attrs:{src:bs}})])]):e._e(),e._l(e.groupActivities,function(a){return t("div",{key:`${a.type}_${a.data.id}`},[a.type==="comment"&&!a.data.article?[e.isShowArticleCardComment?t("div",{staticClass:"group-activity-card"},[t("AdpDocumentCard",{attrs:{width:"100%",adpDocument:a.data.article,themeId:a.data.theme_id,comment:a.data,pageName:e.PAGE_NAME,feature:"group_activities"}})],1):e._e()]:a.type==="comment"&&a.data.article?[t("div",{staticClass:"group-activity-card"},[t("AdpDocumentCard",{attrs:{width:"100%",adpDocument:a.data.article,themeId:a.data.theme_id,group:e.group,showComment:e.isShowArticleCardComment,pageName:e.PAGE_NAME,feature:"group_activities",enableHover:e.enableHover(a.data.article),isSelected:e.isSelected(a.data.article),isUseRemoveGroupMark:e.hasGroupMark(a.data.article)},on:{"click-remove-group-mark":function(n){return e.removeGroupMark(a.data.article)}},nativeOn:{click:function(n){return e.toggleSelected(n,a.data.article)}}})],1)]:a.type==="mark"?[t("div",{staticClass:"group-activity-card"},[t("AdpDocumentCard",{attrs:{width:"100%",adpDocument:a.data,themeId:a.data.theme_id,group:e.group,feature:"group_activities",showComment:e.isShowArticleCardComment,pageName:e.PAGE_NAME,isSelected:e.isSelected(a.data),enableHover:e.enableHover(a.data),isUseRemoveGroupMark:e.hasGroupMark(a.data)},on:{"click-remove-group-mark":function(n){return e.removeGroupMark(a.data)}},nativeOn:{click:function(n){return e.toggleSelected(n,a.data)}}})],1)]:e._e()],2)}),t("div",{staticClass:"group-activity-add-item-btn-container"},[!(e.disableAddComment&&e.disableAddGroupMark)&&e.groupActivities.length!==0?t("button",{staticClass:"c-btn c-btn--small c-btn--AnewsPrimary c-text c-text--",on:{click:e.addActivity}},[e._v(" もっと見る ")]):e._e()])],2),t("div",{ref:"rightColumn",staticClass:"side-content"},[t("div",{ref:"rightContent",staticClass:"side-content-body"},[e.selectedArticles.length===1?t("AdpDocumentInfo",{staticClass:"article-info",attrs:{editable:!0,adpDocument:e.selectedArticles[0],creator:e.myInfo,tagList:[]},on:{"article-info-updated":e.updateArticleInfo}}):t("AdpDocumentInfoDefault")],1)])])])])])],1):e._e()},Tp=[],Dp=T(Ep,Fp,Tp,!1,null,"95ce6691",null,null);const Bp=Dp.exports,Sp=D({props:{pageLimit:Number,paginationFunc:Function,dataAccessor:Function},setup(s){const e=ie(),t=fe(),{pageLimit:a,paginationFunc:n,dataAccessor:r}=s,o=g(!1);let i=Fe({items:[]});const u=g(1),{data:c,state:p}=n(u,a),m=()=>r(c==null?void 0:c.value)??[],d=new dt(()=>{o.value&&p.value==be.SUCCESS&&m().length>0&&u.value++},0);Z(c,()=>{const y=m();y.length>0&&i.items.splice((u.value-1)*a,y.length,...y),o.value=!0});const _=()=>{u.value=1,o.value=!1,i.items.splice(0,i.items.length)};Z(()=>e.path,()=>_());const h=y=>{i.items.unshift(y)},v=(y,A)=>{const k=i.items.filter(y);k.length>0&&A(k)},f=(y,A)=>{i.items.splice(A,0,y)},C=(y,A)=>{A(i.items,y)};return ne(()=>{t.$on("pagination-item-create",h),t.$on("pagination-items-update",v),t.$on("pagination-item-insert",f),t.$on("pagination-item-delete",C)}),Xe(()=>{d.removeEvent(),_(),t.$off("pagination-item-create",h),t.$off("pagination-items-update",v),t.$off("pagination-item-insert",f),t.$off("pagination-item-delete",C)}),{container:i,loaded:o}}});var Ip=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"items"},[e._t("default",null,{items:e.container.items,loaded:e.loaded})],2)},Mp=[],$p=T(Sp,Ip,Mp,!1,null,null,null,null);const wt=$p.exports,Pp=D({props:{pageName:{type:String,required:!0},feature:String,showGroup:{type:Boolean,default:!1},pageLimit:{type:Number,default:10},paginationFunc:{type:Function,required:!0},dataAccessor:{type:Function,required:!0},group:{type:Object}},components:{AdpDocumentCard:Re,SwrScrollingPagination:wt},setup(){const s=fe();se();const e=(o,i)=>{const u=o.findIndex(c=>c.id===i);u>=0?o.splice(u,1):o.forEach(c=>{var m;const p=(m=c.children)==null?void 0:m.findIndex(d=>d.id===i);p>=0&&c.children.splice(p,1)})},t=(o,i)=>{var u;return o.id===i||((u=o.children)==null?void 0:u.some(c=>c.id===i))},a=(o,i)=>{const u=o.findIndex(c=>c.id===i.id);u>=0?o[u].content=i.content:o.forEach(c=>{var m;const p=(m=c.children)==null?void 0:m.findIndex(d=>d.id===i.id);p>=0&&(c.children[p].content=i.content)})},n=o=>{s.$emit("pagination-item-delete",o,i=>e(i,o))},r=o=>{s.$emit("pagination-items-update",i=>t(i,o.id),i=>a(i,o))};return ne(()=>{s.$on("comment-deleted",n),s.$on("comment-updated",r)}),Be(()=>{s.$off("comment-deleted",n),s.$off("comment-updated",r)}),{}}});var Np=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"group-comment-list"},[t("SwrScrollingPagination",{attrs:{pageLimit:e.pageLimit,paginationFunc:e.paginationFunc,dataAccessor:e.dataAccessor},scopedSlots:e._u([{key:"default",fn:function({items:a,loaded:n}){return[e._l(a,function(r){return t("div",{key:r.id,staticClass:"group-comment-card"},[t("AdpDocumentCard",{staticClass:"article-card",attrs:{adpDocument:r.article,themeId:r.theme_id,comment:r,group:e.group,showThemeTag:!0,pageName:e.pageName,feature:e.feature}})],1)}),n&&a.length===0?e._t("emptyState"):e._e()]}}],null,!0)})],1)},Lp=[],Up=T(Pp,Np,Lp,!1,null,"dc1cceb1",null,null);const Rp=Up.exports,Op=D({components:{Avatar:at,GroupToggleButton:kt,Header:Se,Content:Ue,MentionAutocompleteTextarea:$t,GroupCommentList:Rp},methods:{isGroupAdmin:ss},setup(){const s=Te(),e=l(()=>ie()),t=fe(),a=se(),{data:n,mutate:r,state:o}=Pe(),{data:i}=xe(),u=Fe({list:[]}),{data:c}=Qe(),p=g(!1),m=l(()=>{var P,M;return((P=i.value)==null?void 0:P.role)==="admin"||((M=_.value)==null?void 0:M.is_member)}),d=l(()=>e.value.params.groupId),_=l(()=>(n.value??{groups:[]}).groups.find(P=>P.id===Number(d.value))),h=async()=>{await F.trackPageView({pageName:"group",pageUrl:e.value.fullPath,group:{id:Number(e.value.params.groupId)}})},v=async()=>{var P,M;(P=_.value)!=null&&P.is_member&&await F.sendGroupView(_.value.id),t.$emit("clear-group-unread-count",(M=_.value)==null?void 0:M.id)},f=P=>{P.group_id===Number(d.value)&&t.$emit("pagination-item-create",P)},C=P=>{t.$emit("pagination-items-update",M=>B(M,P.id),M=>$(M,P))};ne(()=>{y()&&(h(),v(),I(),t.$on("comment-created",f),t.$on("article-updated",C))}),Be(()=>{t.$off("comment-created",f),t.$off("article-updated",C)}),Z(()=>d.value,()=>{y()&&(h(),I())}),Z(()=>_.value,()=>{y()&&v()}),Z(()=>a.state.modal.isSharing,()=>{if(a.state.modal.isSharing){const P=a.state.modal.comment,M=a.state.modal.article;t.$emit("pagination-item-create",{...P,article:M}),a.commit("modal/setIsSharing",!1)}});const y=()=>d.value===void 0?!1:o.value===be.SUCCESS&&_.value===void 0?(a.commit("snackbar/addMessages",{message:"指定されたグループは存在しません",type:"error"}),s.push({name:"anewsHome"}),!1):!0,A=g(),k=()=>p.value?!1:(A.value??{trimmedComment:""}).trimmedComment.length>0,S=g(!1),b=async()=>{var P;if(k()){if(S.value=!0,A.value){const M=A.value.trimmedComment,O=A.value.mention,Y={pageName:"group",feature:"group_comments",pageUrl:e.value.fullPath};if(M.length>0)try{const W=M.match(lt);let j;W&&W[0].match(/^https?/)&&(j=W[0]);let K;j&&(K=await F.createArticleShare(j,Y).catch(()=>{}));const le=await F.sendComment({groupId:Number(d.value),content:M,mention:O,trackingBaseData:Y,adpDocument:K});t.$emit("pagination-item-create",{...le,article:K}),a.commit("snackbar/addMessages",{message:"コメントを投稿しました",type:"success"})}catch{a.commit("snackbar/addMessages",{message:"コメントを投稿できませんでした",type:"error"})}}S.value=!1,(P=A.value)==null||P.resetTrimmedComment()}},U=()=>{var P,M;((P=A.value)==null?void 0:P.trimmedComment)!==""&&((M=A.value)==null||M.postComment())},I=async()=>{u.list=await F.fetchGroupMembers(Number(d.value))},w=l(()=>{const P=u.list.filter(W=>ss(W.role)).sort((W,j)=>W.created_at.localeCompare(j.created_at)),M=u.list.filter(W=>!ss(W.role)).sort((W,j)=>W.created_at.localeCompare(j.created_at)),O=5;return P.concat(M).slice(0,O)}),x=P=>{var O;const M=(O=c.value)==null?void 0:O.users.find(Y=>Y.id===P);return M?M.image_url:""},B=(P,M)=>{var O;return((O=P.article)==null?void 0:O.id)===M},$=(P,M)=>(P.forEach(O=>{var Y;((Y=O.article)==null?void 0:Y.id)===M.id&&(O.article=M)}),P);return{group:_,filteredGroupMembers:w,hasCommentPermission:m,userIconUrl:x,mutate:r,urlParse:Hr,formatDate:De,myInfo:i,commentTextRef:A,callPostComment:U,post:b,isPostEnabled:k,isPostingComment:S,pageLimit:10,paginationFunc:(P,M)=>Oc(d,P,M),dataAccessor:P=>P==null?void 0:P.group_comments,getTabs:Pt,disabledButton:p}}});var Gp=function(){var e=this,t=e._self._c;return e._self._setupProxy,e.group&&e.myInfo?t("div",{staticClass:"group"},[t("Header",{attrs:{title:e.group.name,detail:`メンバー${e.group.member_count}人`,tabs:e.getTabs(e.group,e.myInfo),contentWidth:"912px"},scopedSlots:e._u([{key:"button",fn:function(){return[e.group.group_type!=="all_user_group"?t("GroupToggleButton",{attrs:{group:e.group}}):e._e()]},proxy:!0}],null,!1,1827677073)}),t("Content",[t("div",{staticClass:"group-content"},[t("div",{staticClass:"comment-area"},[e.hasCommentPermission?t("div",{staticClass:"new-comment"},[e.myInfo?t("router-link",{attrs:{to:`/users/${e.myInfo.id}`}},[t("div",{staticClass:"user-info"},[t("Avatar",{attrs:{imageUrl:e.myInfo.image_url}}),t("div",{staticClass:"c-title c-title--m user-name"},[e._v(" "+e._s(e.myInfo.user_name)+" ")])],1)]):e._e(),t("MentionAutocompleteTextarea",{ref:"commentTextRef",staticClass:"comment-text-area",attrs:{placeholder:"コメントを書く（URLのみの投稿はできません）",disabled:e.isPostingComment,minHeight:60,showUrlPreview:!0},on:{postComment:e.post},model:{value:e.disabledButton,callback:function(a){e.disabledButton=a},expression:"disabledButton"}}),t("div",{staticClass:"btn-area"},[t("button",{staticClass:"o-post-button c-btn c-btn--AnewsPrimary",class:{disabled:!e.isPostEnabled()||e.isPostingComment},attrs:{disabled:!e.isPostEnabled()||e.isPostingComment},on:{click:e.callPostComment}},[e._v(" 投稿 ")])])],1):e._e(),t("GroupCommentList",{staticClass:"comment-list",class:{"no-new-comment":!e.hasCommentPermission},attrs:{pageName:"group",feature:"group_comments",group:e.group,pageLimit:e.pageLimit,paginationFunc:e.paginationFunc,dataAccessor:e.dataAccessor},scopedSlots:e._u([{key:"emptyState",fn:function(){return[t("div",{staticClass:"no-comments",class:{"no-new-comment":!e.hasCommentPermission}},[t("div",{staticClass:"content"},[t("div",{staticClass:"c-text c-text--m"},[e._v("コメントはまだありません。")]),t("div",{staticClass:"c-text c-text--m"},[e._v(" 感じたことや気づいたことなど、気軽に投稿してみてください！ ")])]),t("img",{attrs:{src:bs}})])]},proxy:!0}],null,!1,2495018618)})],1),e.group.group_type!=="all_user_group"?t("div",{staticClass:"side-content"},[t("div",{staticClass:"description-container"},[t("div",{staticClass:"inner"},[t("div",{staticClass:"c-title c-title--s"},[e._v("グループの説明")]),e.group.description?t("div",{staticClass:"description c-text c-text--m",domProps:{innerHTML:e._s(e.urlParse(e.group.description))}}):e._e(),e.group.description?e._e():t("div",{staticClass:"no-description c-text c-text--m"},[e._v(" 説明文はありません ")]),t("div",{staticClass:"created-at c-text c-text--m"},[e._v(" 作成日 "+e._s(e.formatDate(e.group.created_at))+" ")])])]),e.hasCommentPermission?t("div",{staticClass:"member-list"},[t("div",{staticClass:"o-header"},[t("div",{staticClass:"member-title c-title c-title--s"},[e._v(" メンバー・"+e._s(e.group.member_count)+"人 ")]),t("router-link",{staticClass:"member-list-link c-title c-title--s",attrs:{to:`/groups/${e.group.id}/members`}},[e._v("すべて表示")])],1),e._l(e.filteredGroupMembers,function(a){return t("div",{key:a.id},[t("router-link",{staticClass:"member-content",attrs:{to:`/users/${a.id}`}},[t("Avatar",{staticClass:"member-image",attrs:{imageUrl:e.userIconUrl(a.id),size:"s"}}),t("div",{staticClass:"member-name c-text c-text--m"},[e._v(" "+e._s(a.user_name)+" ")]),e.isGroupAdmin(a.role)?t("div",{staticClass:"member-authority c-text c-text--m"},[e._v(" 管理者 ")]):e._e()],1)],1)})],2):e._e()]):e._e()])])],1):e._e()},qp=[],Hp=T(Op,Gp,qp,!1,null,"8674ac27",null,null);const Vp=Hp.exports,jp=D({components:{Header:Se,Content:Ue,MSTeamsSettingsCard:Fr,GroupToggleButton:kt},setup(){var I;const s=Te(),e=ie(),t=se(),{data:a}=xe(),{data:n}=et(),r=g(""),o=g(""),i=g(!0),u=l(()=>r.value.length>rs),c=l(()=>o.value.length>os),p=l(()=>r.value.length>0&&!u.value&&!c.value),m=l(()=>Number(e.params.groupId)),{data:d,mutate:_}=Pe(),{data:h}=nt(),v=l(()=>(d.value??{groups:[]}).groups.find(w=>w.id===m.value)),f=g((I=v.value)==null?void 0:I.name),C=g(""),y=g({}),A=async()=>{let w;try{w=await F.fetchGroup(m.value)}catch(x){throw s.push({name:"groupList"}),x}w.group_type==="all_user_group"&&s.push({name:"groupList"}),f.value=w.name,C.value=w.description,r.value=w.name,o.value=w.description??"",i.value=w.enabled_overlooked_mail};ne(async()=>{await A(),await k()});const k=async()=>{var w;try{const x=await F.fetchGroupMSTeamsSettings(m.value);y.value={settings:x,submittable:!0,type:"group"}}catch(x){if(Je(x)&&((w=x.response)==null?void 0:w.status)===404){y.value={settings:{webhook_url:"",enabled_ms_teams_notification:!1,enabled_comment_content:!0,enabled_group_mark_content:!0},type:"group",submittable:!0};return}throw x}};return Z(()=>v.value,()=>v.value&&!ha(v.value,a.value)?s.push({name:"groupList"}):void 0),{teamInfo:n,initialGroupName:f,initialGroupDesc:C,inputGroupName:r,inputGroupDesc:o,isEnableOverlookedMail:i,tooLongGroupName:u,tooLongGroupDesc:c,MAX_GROUP_NAME_LENGTH:rs,MAX_GROUP_DESCRIPTION_LENGTH:os,updateGroup:async()=>{if(!(!p.value||!y.value.submittable))try{await F.updateGroup(m.value,r.value,o.value,i.value),await F.updateGroupMSTeamsSettings(m.value,y.value.settings),t.commit("snackbar/addMessages",{message:"グループの設定を更新しました",type:""}),s.push(`/groups/${m.value}`)}catch(w){throw t.commit("snackbar/addMessages",{message:"グループの設定を更新できませんでした",type:"error"}),w}},updatable:p,deleteGroup:async()=>{var $;const w=async()=>{try{await F.deleteGroup(m.value),s.push({name:"groupList"}),t.commit("snackbar/addMessages",{message:"グループを削除しました",type:""})}catch{t.commit("snackbar/addMessages",{message:"グループを削除できませんでした",type:"error"})}};let x=`削除したグループは元に戻すことはできません。
本当にグループを削除しますか？`;((($=h.value)==null?void 0:$.themes)||[]).filter(P=>P.access_scope==="group"&&P.group_id===m.value).length>0&&(x=`削除したグループは元に戻すことはできません。
また、このグループを削除するとこのグループで公開範囲を指定しているテーマも一緒に削除されます。
削除したくないテーマは公開範囲設定を変更してください。一度削除したテーマは復元できません。
本当にグループを削除しますか？`);const B={headerText:"グループを削除しますか？",bodyText:x,action:w};t.commit("confirmationModal/showConfirmationModal"),t.commit("confirmationModal/setTextAndAction",B)},moveToGroupMembersPage:()=>{s.push({name:"groupMembers"})},group:v,settings:y,getTabs:Pt,myInfo:a,mutate:_}}});var Kp=function(){var e=this,t=e._self._c;return e._self._setupProxy,e.group&&e.myInfo?t("div",{staticClass:"o-group-edit"},[t("Header",{attrs:{title:e.initialGroupName,detail:`メンバー${e.group.member_count}人`,tabs:e.getTabs(e.group,e.myInfo)},scopedSlots:e._u([{key:"button",fn:function(){return[t("GroupToggleButton",{attrs:{group:e.group}})]},proxy:!0}],null,!1,4227801705)}),t("Content",[t("div",{staticClass:"o-group-edit-wrap"},[t("div",{staticClass:"o-group-edit-body"},[t("div",{staticClass:"title c-title c-title--s"},[e._v("グループの設定")]),t("div",{staticClass:"o-group-name-label c-formBlock__label c-title c-titile--m"},[e._v(" グループ名 ")]),t("div",{directives:[{name:"show",rawName:"v-show",value:e.tooLongGroupName,expression:"tooLongGroupName"}],staticClass:"o-error c-formBlock__text c-formBlock__text--error"},[e._v(" グループ名は "+e._s(e.MAX_GROUP_NAME_LENGTH)+"文字以内で入力してください。 ")]),t("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.inputGroupName,expression:"inputGroupName",modifiers:{trim:!0}}],ref:"groupNameInput",staticClass:"o-group-name-input c-text c-text--m c-textInput",class:{"c-formInput--error":e.tooLongGroupName,"m-normal-text-area":!e.tooLongGroupName},domProps:{value:e.inputGroupName},on:{keydown:[function(a){return!a.type.indexOf("key")&&e._k(a.keyCode,"enter",13,a.key,"Enter")||!a.ctrlKey?null:e.updateGroup.apply(null,arguments)},function(a){return!a.type.indexOf("key")&&e._k(a.keyCode,"enter",13,a.key,"Enter")||!a.metaKey?null:e.updateGroup.apply(null,arguments)}],input:function(a){a.target.composing||(e.inputGroupName=a.target.value.trim())},blur:function(a){return e.$forceUpdate()}}}),t("div",{staticClass:"o-group-desc-label c-formBlock__label c-title c-titile--m"},[e._v(" グループの説明 ")]),t("div",{directives:[{name:"show",rawName:"v-show",value:e.tooLongGroupDesc,expression:"tooLongGroupDesc"}],staticClass:"o-error c-formBlock__text c-formBlock__text--error"},[e._v(" グループの説明は"+e._s(e.MAX_GROUP_DESCRIPTION_LENGTH)+"文字以内で入力してください。 ")]),t("textarea",{directives:[{name:"model",rawName:"v-model.trim",value:e.inputGroupDesc,expression:"inputGroupDesc",modifiers:{trim:!0}}],staticClass:"o-group-desc-input c-text c-text--m c-textArea",class:{"c-formInput--error":e.tooLongGroupDesc,"m-normal-text-area":!e.tooLongGroupDesc},domProps:{value:e.inputGroupDesc},on:{keydown:[function(a){return!a.type.indexOf("key")&&e._k(a.keyCode,"enter",13,a.key,"Enter")||!a.ctrlKey?null:e.updateGroup.apply(null,arguments)},function(a){return!a.type.indexOf("key")&&e._k(a.keyCode,"enter",13,a.key,"Enter")||!a.metaKey?null:e.updateGroup.apply(null,arguments)}],input:function(a){a.target.composing||(e.inputGroupDesc=a.target.value.trim())},blur:function(a){return e.$forceUpdate()}}}),t("div",[t("div",{staticClass:"o-group-mail-setting-label c-formBlock__label c-title c-titile--m"},[e._v(" メール配信設定 ")]),t("sm-checkbox-label",{staticClass:"o-checkbox-label",attrs:{value:e.isEnableOverlookedMail},on:{change:function(a){e.isEnableOverlookedMail=!e.isEnableOverlookedMail}}},[e._v("読み逃しメールを配信")]),t("div",{staticClass:"o-checkbox-mail-setting c-text c-text--s"},[e._v(" 当日コメントやグループマークがあった記事を配信します。 ")])],1),t("div",{staticClass:"spacing-16"}),e.teamInfo&&e.teamInfo.enable_ms_teams_integration?t("div",{staticClass:"title c-title c-title--s"},[e._v(" Teams連携 ")]):e._e(),e.teamInfo&&e.teamInfo.enable_ms_teams_integration?t("div",{staticClass:"o-group-ms-teams-settings"},[t("MSTeamsSettingsCard",{attrs:{title:"このグループの情報をTeamsに配信",desc:"Microsoft Teamsのチャネルに、このグループの情報を配信します。",helpLink:"https://anews-stockmark.zendesk.com/hc/ja/articles/1500000888001",hasBorder:!1},model:{value:e.settings,callback:function(a){e.settings=a},expression:"settings"}})],1):e._e(),t("button",{staticClass:"o-save-button c-btn c-btn--small c-btn--AnewsPrimary",class:{disabled:!e.updatable||!e.settings.submittable},attrs:{disabled:!e.updatable||!e.settings.submittable},on:{click:e.updateGroup}},[e._v(" 保存 ")])]),t("div",{staticClass:"o-group-delete-section"},[t("div",{staticClass:"o-label c-text c-text--m"},[e._v("グループを削除")]),t("div",{staticClass:"o-group-delete"},[t("div",{staticClass:"o-delete-title c-formBlock__label c-title c-title--m"},[e._v(" グループを削除 ")]),t("div",{staticClass:"o-delete-text c-text c-text--m"},[e._v(" 完全に削除し、復元することはできません。 ")]),t("button",{staticClass:"o-delete-button c-btn c-btn--auto c-btn--small c-btn--negative c-text c-text--m",on:{click:e.deleteGroup}},[e._v(" グループを削除する ")])])])])])],1):e._e()},Yp=[],Qp=T(jp,Kp,Yp,!1,null,"23296c77",null,null);const Wp=Qp.exports,Ns=new Map([["all","すべての記事"],["true","メモした記事"],["false","メモしてない記事"]]),zp=s=>{const e=g(s.query.memo_exists??"all"),t=l(()=>({placeholder:Ns.get(e.value),labels:Array.from(Ns.values()),values:Array.from(Ns.keys())}));return{memoExists:e,memoSelectOptions:t,onMemoSelected:n=>{e.value!==n.value&&(e.value=n.value)}}},Jp=160,Xp=D({components:{AdpDocumentCard:Re,GroupToggleButton:kt,Header:Se,Content:Ue,SwrScrollingPagination:wt,AdpDocumentInfo:ka,AdpDocumentInfoDefault:ba,AdpDocumentExport:Ca,TagSelect:ys,TagItem:Nt},setup(){const s=Te(),e=ie(),t=fe(),a=se(),{data:n,mutate:r,state:o}=Pe(),{data:i}=xe(),u=Fe({items:[]}),{memoExists:c,memoSelectOptions:p,onMemoSelected:m}=zp(e),d=g(!1),_=g({items:[]}),h=l(()=>e.params.groupId),v=l(()=>{var E,L;return((E=i.value)==null?void 0:E.role)==="admin"||((L=b.value)==null?void 0:L.is_member)}),{data:f,mutate:C}=tn(h,g(1),1,g("all"),g({items:[]})),y=l(()=>{var E;return(E=f.value)==null?void 0:E.count}),{data:A,mutate:k}=qc(h.value),S=l(()=>{var E;return{tags:((E=A.value)==null?void 0:E.tags.map(L=>({...L,id:L.name})))??[]}}),b=l(()=>(n.value??{groups:[]}).groups.find(E=>E.id===Number(h.value))),U=async()=>{var re;const E=a.state.route.previousRoute,L=E.name!==null,V=L&&String((re=E.params)==null?void 0:re.groupId)!==String(h.value);await F.trackPageView({pageName:"group",pageUrl:e.fullPath,group:{id:Number(e.params.groupId)},fromUrl:L?E.path:null,fromSnackbarLink:V?"article_group_mark":void 0})},I=()=>{var E;B()&&(U(),(E=b.value)!=null&&E.is_member&&a.commit("modal/setGroup",b.value))};let w;const x=E=>{t.$emit("pagination-items-update",L=>O(L,E.id),L=>Y(L,E))};ne(()=>{I(),document.addEventListener("click",ye),window.addEventListener("scroll",te),window.addEventListener("resize",X),te(),ke.value&&(w=new ResizeObserver(()=>X()),w.observe(ke.value)),t.$on("article-updated",x)}),Be(()=>{document.removeEventListener("click",ye),a.commit("modal/setGroup",void 0),window.removeEventListener("scroll",te),window.removeEventListener("resize",X),w==null||w.disconnect(),t.$off("article-updated",x)}),Z(()=>h.value,()=>I()),Z(()=>o.value,()=>{o.value===be.SUCCESS&&I()});const B=()=>h.value===void 0?!1:o.value===be.SUCCESS&&b.value===void 0?(a.commit("snackbar/addMessages",{message:"指定されたグループは存在しません",type:"error"}),s.push({name:"anewsHome"}),!1):!0,$=E=>u.items.map(L=>L.id).includes(E.id),P=E=>!$(E),M=(E,L)=>{u.items=xa(E,L,u.items)},O=(E,L)=>E.id===L,Y=(E,L)=>{const V=E.findIndex(re=>re.id===L.id);return V>=0&&(E[V].marks=L.marks,E[V].memo=L.memo,E[V].tags=L.tags),E},W=async(E,L)=>{const V=Number(h.value);try{V&&(L.shouldUpdateMemo&&(E.memo?await F.updateGroupArticleMemo(V,E.id,E.doc_type,E.memo):await F.deleteGroupArticleMemo(V,E.id,E.doc_type).catch(re=>{var Ee;if(((Ee=re.response)==null?void 0:Ee.status)!==404)throw re})),L.shouldUpdateTags&&await F.updateGroupArticleTags(V,E.id,E.doc_type,E.tags||[]),u.items=u.items.map(re=>re.id===E.id?E:re),await F.trackEvent("set_article_option",{pageName:"group",pageUrl:e.fullPath,feature:"group_marks"},E.id,V,{tags:E.tags,memo:E.memo}),k(),t.$emit("pagination-items-update",re=>O(re,E.id),re=>Y(re,E)),t.$emit("article-updated",E),a.commit("snackbar/addMessages",{message:"記事情報を更新しました",type:""}))}catch{a.commit("snackbar/addMessages",{message:"記事情報を更新できませんでした",type:"error"})}},j=(E,L)=>{const V=E.findIndex(re=>re.id===L);V>=0&&E.splice(V,1)},K=async E=>{var L;try{const V=(L=E.group_marks)==null?void 0:L.filter(re=>{var Ee;return re.group_id==((Ee=b.value)==null?void 0:Ee.id)})[0].id;V&&(await F.deleteGroupMark(V),C(),k(),t.$emit("pagination-item-delete",E.id,re=>j(re,E.id)),a.commit("snackbar/addMessages",{message:"グループマークを外しました",type:""}))}catch{a.commit("snackbar/addMessages",{message:"グループマークを外せませんでした",type:"error"})}},le=E=>{d.value=!1,_.value.items.sort()!==E.sort()&&(_.value.items=E)},ye=()=>d.value=!1,H=()=>d.value=!d.value,ue=E=>{_.value.items=_.value.items.filter(L=>L!==E)};Z(()=>[_.value.items,c.value],async()=>{const E=c.value==="true"?"with_memo":c.value==="false"?"without_memo":"all";await F.trackEvent("mark_filter",{pageName:"group",pageUrl:e.fullPath,feature:"group_marks"},void 0,Number(h.value),{filter:{tags:_.value.items,memo:E}})});const _e=E=>{var L;return(L=E.group_marks)==null?void 0:L.find(V=>{var re;return V.group_id==((re=b.value)==null?void 0:re.id)})},me=E=>{var L;return(L=_e(E))==null?void 0:L.theme_id},de=E=>{var L;return(L=_e(E))==null?void 0:L.creator_id},{data:ee}=Qe(),J=l(()=>{var E;return(E=ee.value)==null?void 0:E.users.find(L=>{var V;return L.id===((V=_e(u.items[0]))==null?void 0:V.creator_id)})}),ce=g(),ke=g();let R=0,ve="top";const X=E=>te(E,!0),te=(E,L=!1)=>{if(!ce.value||!ke.value)return;const V=Cs(ke.value,ce.value,R,ve,Jp,0,L);V&&(R=V.windowScrollY,ve=V.contentPosition)};return{group:b,mutate:r,urlParse:Hr,formatDate:De,myInfo:i,hasEditInfoPermission:v,pageLimit:10,paginationFunc:(E,L)=>tn(h,E,L,c,_),dataAccessor:E=>E==null?void 0:E.marked_articles,getTabs:Pt,isSelected:$,enableHover:P,toggleSelected:M,selectedArticles:u,removeGroupMark:K,tags:S,updateArticleInfo:W,markCount:y,memoSelectOptions:p,onMemoSelected:m,isOpenTagMenu:d,targetTags:_,handleTagFilterArticles:le,toggleTagMenu:H,memoExists:c,removeTag:ue,getGroupMark:_e,getSelectedArticleGroupMarkUser:J,getGroupMarkThemeId:me,getGroupMarkCreatorId:de,rightColumn:ce,rightContent:ke}}});var Zp=function(){var e=this,t=e._self._c;return e._self._setupProxy,e.group?t("div",{staticClass:"group"},[e.myInfo?t("Header",{attrs:{title:e.group.name,detail:`メンバー${e.group.member_count}人`,tabs:e.getTabs(e.group,e.myInfo)},scopedSlots:e._u([{key:"button",fn:function(){return[e.group.group_type!=="all_user_group"?t("GroupToggleButton",{attrs:{group:e.group}}):e._e()]},proxy:!0}],null,!1,1827677073)}):e._e(),t("Content",[t("div",{staticClass:"group-content"},[t("div",{staticClass:"action-bar"},[t("div",{staticClass:"left-side-container"},[t("span",{staticClass:"c-title c-title--m"},[e._v("マーク"),t("span",{key:e.markCount,staticClass:"c-text c-text--s"},[e._v("・ "+e._s(e.markCount)+"件")])]),t("sm-selectbox",e._b({staticClass:"small o-memo-filter",on:{selected:e.onMemoSelected}},"sm-selectbox",e.memoSelectOptions,!1)),t("div",{staticClass:"spacing-16"}),t("div",{ref:"tagBox",staticClass:"tag-box",on:{click:function(a){return a.preventDefault(),a.stopPropagation(),(()=>{}).apply(null,arguments)}}},[t("div",{staticClass:"tag-selectbox",on:{click:e.toggleTagMenu}},[t("sm-selectbox",{key:e.targetTags.items.length,staticClass:"small",attrs:{placeholder:`タグ ${e.targetTags.items.length>0?e.targetTags.items.length:""}`}})],1),e.isOpenTagMenu&&e.tags?t("TagSelect",{attrs:{tagList:e.tags.tags,targetTags:e.targetTags.items},on:{"filter-articles":e.handleTagFilterArticles}}):e._e()],1)],1),e.selectedArticles.items.length>0?t("AdpDocumentExport",{staticClass:"export-button",attrs:{adpDocuments:e.selectedArticles.items,pageName:"group",groupId:e.group.id}}):e._e()],1),e.targetTags.items.length>0?t("div",{staticClass:"selected-tags"},[t("span",{staticClass:"c-text c-text--s"},[e._v("選択中のタグ")]),e._l(e.targetTags.items,function(a){return t("TagItem",{key:a,staticClass:"tag",attrs:{name:a,isDelete:!0},on:{deleteTag:function(n){return e.removeTag(a)}}})})],2):e._e(),t("div",{staticClass:"mark-page-content"},[t("div",{staticClass:"article-area"},[t("SwrScrollingPagination",{key:`${[e.memoExists,e.targetTags.items]}`,attrs:{pageLimit:e.pageLimit,paginationFunc:e.paginationFunc,dataAccessor:e.dataAccessor},scopedSlots:e._u([{key:"default",fn:function({items:a,loaded:n}){return[e._l(a,function(r){return t("AdpDocumentCard",{key:r.id,staticClass:"article-card",attrs:{pageName:"group",adpDocument:r,group:e.group,themeId:e.getGroupMarkThemeId(r),feature:"group_marks",actionTypeOfThemeTag:"mark",showComment:!1,showThemeTag:!0,isSelected:e.isSelected(r),enableHover:e.enableHover(r),isUseRemoveGroupMark:!0},on:{"click-remove-group-mark":function(o){return e.removeGroupMark(r)}},nativeOn:{click:function(o){return e.toggleSelected(o,r)}}})}),n&&a.length===0?t("div",{staticClass:"no-marks"},[t("div",{staticClass:"content"},[t("div",{staticClass:"c-text c-text--m"},[e._v(" "+e._s(e.markCount===0?"該当する記事はありませんでした。":"お探しの条件に合う記事がありません")+" ")])]),t("img",{attrs:{src:Wt}})]):e._e()]}}],null,!1,119423277)})],1),t("div",{ref:"rightColumn",staticClass:"side-content"},[t("div",{ref:"rightContent",staticClass:"side-content-body"},[e.selectedArticles.items.length===1?t("AdpDocumentInfo",{staticClass:"article-info",attrs:{editable:e.hasEditInfoPermission,adpDocument:e.selectedArticles.items[0],creator:e.getSelectedArticleGroupMarkUser,tagList:e.tags.tags},on:{"article-info-updated":e.updateArticleInfo}}):t("AdpDocumentInfoDefault"),e.group.group_type!=="all_user_group"?t("div",{staticClass:"description-container"},[t("div",{staticClass:"inner"},[t("div",{staticClass:"c-title c-title--s"},[e._v("グループの説明")]),e.group.description?t("div",{staticClass:"description c-text c-text--m",domProps:{innerHTML:e._s(e.urlParse(e.group.description))}}):e._e(),e.group.description?e._e():t("div",{staticClass:"no-description c-text c-text--m"},[e._v(" 説明文はありません ")]),t("div",{staticClass:"created-at c-text c-text--m"},[e._v(" 作成日 "+e._s(e.formatDate(e.group.created_at))+" ")])])]):e._e()],1)])])])])],1):e._e()},ev=[],tv=T(Xp,Zp,ev,!1,null,"3daf7cbd",null,null);const sv=tv.exports,av=D({components:{Header:Se,Content:Ue,SearchBar:At,GroupToggleButton:kt},setup(){const s=ie(),e=Te(),t=se(),a=fe(),n=l(()=>Number(s.params.groupId)),{data:r}=Pe(),{data:o,state:i}=xe(),{data:u,error:c,mutate:p}=Rc(n),m=l(()=>{var M;return((M=u.value)==null?void 0:M.group_users)??[]}),d=l(()=>(r.value??{groups:[]}).groups.find(M=>M.id===n.value)??{}),_=l(()=>m.value.length),h=l(()=>rv(m,$)),{sortByArgumentProperty:v,sortedBy:f,sort:C}=nv(),y=l(()=>C(h.value)),A=M=>({admin:"グループ管理者",group_admin:"グループ管理者",editor:"編集者",viewer:"閲覧者"})[M.role],{onEditButton:k,editMenuOpen:S,editMenu:b,closeEditMenu:U,selectedUserId:I,toggleOnEditButton:w,removeMember:x}=ov(n.value,M=>{p(()=>({group_users:m.value.filter(O=>O.id!==M)})),t.commit("snackbar/addMessages",{message:"メンバーを更新しました",type:""})});Z(c,M=>{M&&e.push({name:"groupActivity"})}),Z(()=>d.value,()=>d.value&&!Qr(d.value,o.value)?e.push({name:"groupList"}):void 0);const B=()=>{t.commit("modal/showModal","userInvite")},$=g(""),P=M=>{$.value=M};return a.$on("group-member-added",M=>{const O=m.value.map(W=>W.id),Y=M.filter(W=>!O.includes(W.id));p(()=>({group_users:m.value.concat(Y.map(W=>({id:W.id,user_name:W.user_name,email:W.email,role:W.role,last_viewed_at:"",created_at:W.created_at,updated_at:W.updated_at})))}))}),{state:i,STATES:be,group:d,userInfo:o,groupMembers:m,onEditButton:k,editMenuOpen:S,editMenu:b,closeEditMenu:U,selectedUserId:I,filteredGroupMembers:h,sortByArgumentProperty:v,sortedBy:f,sortedGroupMembers:y,toggleOnEditButton:w,removeMember:x,showGroupInvite:B,onChangeQuery:P,getTabs:Pt,hasEditPermission:ha,groupMemberCount:_,authority:A}}}),un={admin:1,group_admin:2,editor:3,viewer:4},nv=()=>{const s=Fe({user_name:"",email:"",role:""}),e=r=>{t(r)},t=r=>{s[r]==="asc"?s[r]="desc":(s[r]==="desc"||Object.keys(s).forEach(o=>{s[o]=""}),s[r]="asc")};return{sortByArgumentProperty:e,sortedBy:r=>s[r],sort:r=>{const o=Object.keys(s).filter(c=>s[c]!=="")[0];if(!o)return r;if(o==="role"){const c=r.slice();return c.sort((p,m)=>{const[d,_]=s[o]=="asc"?[p,m]:[m,p];return un[d.role]-un[_.role]}),c}let i=r.filter(c=>c[o]!==""),u=r.filter(c=>c[o]==="");return s[o]==="asc"?i.sort((c,p)=>c[o].localeCompare(p[o],"ja")):i.sort((c,p)=>-c[o].localeCompare(p[o],"ja")),i.concat(u)}}},rv=(s,e)=>e.value===""?s.value:s.value.filter(t=>Object.values(t).join().toLowerCase().includes(e.value.toLowerCase())),ov=(s,e)=>{const t=g(!1),a=g(!1),n=g(-1);return{onEditButton:t,editMenuOpen:a,selectedUserId:n,toggleOnEditButton:()=>{t.value=!t.value},editMenu:c=>{n.value=c.id,a.value=!a.value},closeEditMenu:()=>{a.value=!1},removeMember:async()=>{t.value=!1,await F.leaveGroup(s,n.value),e(n.value)}}};var iv=function(){var e=this,t=e._self._c;return e._self._setupProxy,e.state===e.STATES.SUCCESS&&e.userInfo?t("div",{staticClass:"o-group-members",on:{click:e.closeEditMenu,keydown:function(a){return!a.type.indexOf("key")&&e._k(a.keyCode,"esc",27,a.key,["Esc","Escape"])?null:e.closeEditMenu.apply(null,arguments)}}},[t("Header",{attrs:{title:e.group.name,detail:`メンバー${e.group.member_count}人`,tabs:e.getTabs(e.group,e.userInfo)},scopedSlots:e._u([{key:"button",fn:function(){return[t("GroupToggleButton",{attrs:{group:e.group}})]},proxy:!0}],null,!1,4227801705)}),t("Content",[t("div",{staticClass:"o-group-members-wrap"},[t("div",{staticClass:"o-header"},[t("div",{staticClass:"o-group-search-info"},[t("SearchBar",{on:{onChangeQuery:e.onChangeQuery}})],1),e.group.group_type==="specific_user_group"&&e.hasEditPermission(e.group,e.userInfo)?t("button",{staticClass:"o-add-member-button c-btn c-btn--primary",on:{click:e.showGroupInvite}},[e._v(" メンバー追加 ")]):e._e()]),t("div",{staticClass:"o-group-members-body"},[t("table",{staticClass:"o-member-body",attrs:{cellspacing:"0"}},[t("tr",{staticClass:"o-column-description"},[t("th",{staticClass:"m-member-name",on:{click:function(a){return e.sortByArgumentProperty("user_name")}}},[t("div",{staticClass:"header-content"},[e._v(" 名前"),e.sortedBy("user_name")==="asc"?t("span",{staticClass:"o-sort-icon"},[e._v("↑")]):e._e(),e.sortedBy("user_name")==="desc"?t("span",{staticClass:"o-sort-icon"},[e._v("↓")]):e._e()])]),t("th",{staticClass:"m-mail-address",on:{click:function(a){return e.sortByArgumentProperty("email")}}},[t("div",{staticClass:"header-content"},[e._v(" メールアドレス"),e.sortedBy("email")==="asc"?t("span",{staticClass:"o-sort-icon"},[e._v("↑")]):e._e(),e.sortedBy("email")==="desc"?t("span",{staticClass:"o-sort-icon"},[e._v("↓")]):e._e()])]),t("th",{staticClass:"m-authority",on:{click:function(a){return e.sortByArgumentProperty("role")}}},[t("div",{staticClass:"header-content"},[e._v(" 権限"),e.sortedBy("role")==="asc"?t("span",{staticClass:"o-sort-icon"},[e._v("↑")]):e._e(),e.sortedBy("role")==="desc"?t("span",{staticClass:"o-sort-icon"},[e._v("↓")]):e._e()])])]),e._l(e.sortedGroupMembers,function(a){return t("tr",{key:a.id,staticClass:"o-member-list-row",class:{"on-edit-button":e.onEditButton}},[t("td",{staticClass:"m-member-name c-text c-text--m"},[t("router-link",{attrs:{to:`/users/${a.id}`}},[e._v(e._s(a.user_name))])],1),t("td",{staticClass:"m-mail-address c-text c-text--s"},[e._v(" "+e._s(a.email)+" ")]),t("td",{staticClass:"m-authority c-text c-text--m"},[e._v(" "+e._s(e.authority(a))+" ")]),e.hasEditPermission(e.group,e.userInfo)?t("td",{staticClass:"m-edit-icon"},[e.userInfo&&e.userInfo.id!==a.id?t("div",{staticClass:"m-edit-menu-ellipsis",on:{mouseover:e.toggleOnEditButton,mouseout:e.toggleOnEditButton,click:function(n){return n.stopPropagation(),e.editMenu(a)}}},[t("sm-icons",[e._v("ellipsis-h")]),e.editMenuOpen&&e.selectedUserId===a.id?t("div",{staticClass:"o-user-edit-menu c-text c-text--m",on:{keydown:function(n){return!n.type.indexOf("key")&&e._k(n.keyCode,"esc",27,n.key,["Esc","Escape"])?null:e.closeEditMenu.apply(null,arguments)}}},[t("div",{staticClass:"o-items-wrapper"},[t("div",{staticClass:"o-remove-member c-text c-text--m",on:{click:e.removeMember}},[e._v(" グループから外す ")])])]):e._e()],1):e._e()]):e._e()])})],2)])])])],1):e._e()},uv=[],cv=T(av,iv,uv,!1,null,"61fa0934",null,null);const lv=cv.exports,dv=D({components:{GroupToggleButton:kt},methods:{isGroupAdmin:ss},props:{group:{type:Object,required:!0}},setup(){const{data:s}=xe();return{userInfo:s}}});var mv=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("router-link",{staticClass:"m-group-search-card",attrs:{to:`/groups/${e.group.id}`}},[t("div",{staticClass:"group-content"},[t("div",{staticClass:"group-name c-title c-title--m"},[t("sm-icons",{staticClass:"small icon space-right"},[e._v("users")]),e._v(e._s(e.group.name)+" "),e.group.is_member?t("div",{staticClass:"added"},[t("sm-icons",{staticClass:"xs primary icon"},[e._v("check")]),t("span",{staticClass:"c-text c-text--xs"},[e._v("参加中")])],1):e._e()],1),t("div",{staticClass:"group-info c-text c-text--s"},[e.userInfo&&e.isGroupAdmin(e.userInfo.role)?t("div",{staticClass:"admin"},[e._v(" 管理者・ ")]):e._e(),t("div",{staticClass:"member-count"},[e._v("メンバー"+e._s(e.group.member_count)+"人")]),e.group.description!==""?t("div",{staticClass:"description"},[e._v(" ・"+e._s(e.group.description)+" ")]):e._e()])]),t("div",{staticClass:"group-button"},[t("GroupToggleButton",{attrs:{group:e.group}})],1)])},_v=[],pv=T(dv,mv,_v,!1,null,"1974320f",null,null);const vv=pv.exports,fv=D({components:{GroupSearchCard:vv,Header:Se},setup(s,e){const{data:t,state:a}=Pe(),n=[{value:{field:"created_at",order:"desc"},label:"新しい順"},{value:{field:"created_at",order:"asc"},label:"古い順"},{value:{field:"name",order:"asc"},label:"グループ名（昇順）"},{value:{field:"name",order:"desc"},label:"グループ名（降順）"},{value:{field:"member_count",order:"desc"},label:"参加人数が多い順"},{value:{field:"member_count",order:"asc"},label:"参加人数が少ない順"}],r=[{value:{field:"none",equals:null},label:"すべてのグループ"},{value:{field:"is_member",equals:!0},label:"参加中のグループ"},{value:{field:"is_member",equals:!1},label:"未参加のグループ"}],o=g(n[0].value),i=g(r[0].value),u=g(""),c=d=>{o.value=d.value},p=d=>{i.value=d.value},m=l(()=>{let d=t.value?t.value.groups.filter(h=>h.group_type!=="all_user_group"):[];const _=i.value.field;return _!=="none"&&(d=d.filter(h=>h[_]===i.value.equals)),u.value!==""&&(d=d.filter(h=>h.name.includes(u.value))),d=Dt(d,o.value.field,o.value.order),d});return{state:a,STATES:be,formatDate:De,sortList:n,filterList:r,searchKeyword:u,selectSort:c,selectFilter:p,queriedGroups:m}}});var gv=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"group-search"},[t("Header",{attrs:{title:"グループ検索",alignLeft:!0}}),t("div",{staticClass:"group-search__content"},[t("div",{staticClass:"o-group-search__keyword"},[t("button",{staticClass:"m-search-button"},[t("sm-icons",{staticClass:"small"},[e._v("search")])],1),t("input",{directives:[{name:"model",rawName:"v-model",value:e.searchKeyword,expression:"searchKeyword"}],staticClass:"c-textInput",attrs:{type:"text",placeholder:"グループ名で検索"},domProps:{value:e.searchKeyword},on:{input:function(a){a.target.composing||(e.searchKeyword=a.target.value)}}})]),t("div",{staticClass:"spacing-16"}),t("div",{staticClass:"o-group-search__select"},[t("div",{staticClass:"o-group-search__counts"},[t("div",{staticClass:"c-title c-title--m"},[e._v(" グループ"),t("span",{staticClass:"c-text c-text--s count"},[e._v("・"+e._s(e.queriedGroups.length)+"件")])])]),t("div",{staticClass:"spacing-16"}),t("sm-selectbox",{staticClass:"small",attrs:{placeholder:e.sortList[0].label,labels:e.sortList.map(a=>a.label),values:e.sortList.map(a=>a.value)},on:{selected:e.selectSort}}),t("div",{staticClass:"spacing-16"}),t("sm-selectbox",{staticClass:"small",attrs:{placeholder:e.filterList[0].label,labels:e.filterList.map(a=>a.label),values:e.filterList.map(a=>a.value)},on:{selected:e.selectFilter}})],1),t("div",{staticClass:"spacing-16"}),e.queriedGroups||e.state===e.STATES.SUCCESS?t("div",{staticClass:"list-content"},[e._l(e.queriedGroups,function(a){return t("div",{key:a.id,staticClass:"list"},[t("GroupSearchCard",{attrs:{group:a}})],1)}),e.queriedGroups.length===0?t("div",{staticClass:"no-search-result c-text c-text--m"},[e._v(" 該当するグループはありません ")]):e._e()],2):e._e()])],1)},hv=[],yv=T(fv,gv,hv,!1,null,"7bf70ad9",null,null);const Cv=yv.exports,bv=D({props:{article:{type:Object,required:!0},themeId:{type:Number,default:void 0},pageName:{type:String,required:!0},feature:{type:String,required:!0},feedType:{type:String,default:void 0},markSource:{type:String,default:void 0}},components:{MarkButton:Pr},setup(s){const e=ie(),t=se(),a=fe(),{data:n}=xe(),r=g(!1),o=l(()=>{var x;return(x=s.article)==null?void 0:x.marks.some(B=>{var $;return B.user_id===(($=n.value)==null?void 0:$.id)})}),i=l(()=>{var x;return da(((x=s.article)==null?void 0:x.marks)??[],"marks")}),u=l(()=>{var x;return(((x=s.article)==null?void 0:x.marks)??[]).length>0}),c=l(()=>{var x;return(((x=s.article)==null?void 0:x.group_marks)??[]).length>0}),p=l(()=>{var x;return(((x=s.article)==null?void 0:x.marks)??[]).length}),m=l(()=>{var x;return(((x=s.article)==null?void 0:x.group_marks)??[]).length}),d=l(()=>f.value.length),_=l(()=>{var x;return pr((x=s.article)==null?void 0:x.group_marks)}),{data:h}=nt(),{data:v}=Pe(),f=l(()=>{var x,B,$;return gs(n.value,(x=s.article)==null?void 0:x.comments,(B=h.value)==null?void 0:B.themes,($=v.value)==null?void 0:$.groups)}),C=l(()=>_r(f.value)),y=async()=>{r.value||(r.value=!0,o.value?await A():await S(s.article,s.themeId,s.markSource,!0),r.value=!1)},A=async()=>{try{const[x]=s.article.marks.filter(B=>{var $;return B.user_id===(($=n.value)==null?void 0:$.id)});if(x){await F.deleteMark(x.id);const B={...s.article,marks:s.article.marks.filter($=>{var P;return $.user_id!==((P=n.value)==null?void 0:P.id)})};await k(B)}}catch(x){throw t.commit("snackbar/addMessages",{message:"マークを取り消せませんでした",type:"error"}),x}t.commit("snackbar/addMessages",{message:"マークを取り消しました",type:"",showUndo:!0,undoFunc:()=>{S(s.article,s.themeId,s.markSource,!1)}})},k=async x=>{a.$emit("article-updated",x),await t.dispatch("userActions/fetchMyActionCount")},S=async(x,B,$,P=!0)=>{var M,O;try{const Y=await F.sendMark(x,B,$,{pageName:s.pageName,pageUrl:e.fullPath,feature:s.feature,feedType:s.feedType}),W={...s.article,marks:[...s.article.marks,{...Y,user_name:(M=n.value)==null?void 0:M.user_name}]};await k(W)}catch(Y){throw t.commit("snackbar/addMessages",{message:"マークできませんでした",type:"error"}),Y}P&&t.commit("snackbar/addMessages",{type:"",messageTemplates:[{tag:"a",text:"マイページ",href:`/#/users/${(O=n.value)==null?void 0:O.id}`},{tag:"span",text:"にマークしました"},{tag:"icon",text:"external-link"}]})},b=()=>{var x;t.commit("modal/setArticle",s.article),t.commit("modal/setTheme",(x=h.value)==null?void 0:x.themes.find(B=>B.id===Number(s.themeId))),t.commit("modal/setPageName",s.pageName),t.commit("modal/setFeature",s.feature),t.commit("modal/setFeedType",s.feedType)};return{hasMyMark:o,markUsersString:i,markCount:p,groupMarkCount:m,commentCount:d,groupMarked:c,marked:u,markGroupsString:_,commentUsersString:C,clickGroupMarkIcon:()=>{b(),t.commit("modal/showModal","groupMark")},markArticle:y,showCreateCommentModal:()=>{b(),t.commit("modal/showModal","commentCreate")},showMarkModal:()=>{b(),t.commit("modal/showModal","mark")}}}});var Av=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"article-actions"},[t("div",{staticClass:"m-mark-comment-wrap"},[t("MarkButton",{attrs:{adpDocument:e.article,small:!0},on:{clickMarkButton:e.markArticle,clickOpenMarkModalButton:e.showMarkModal}}),t("div",{staticClass:"group-mark"},[e.groupMarked?t("div",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:{content:e.markGroupsString,delay:{show:300},offset:8,autoHide:!1},expression:`{
            content: markGroupsString,
            delay: { show: 300 },
            offset: 8,
            autoHide: false
          }`,modifiers:{top:!0}}],staticClass:"m-mark-not-active-wrap"},[t("div",{staticClass:"m-mark-not-active hover-action",on:{click:e.clickGroupMarkIcon}},[t("sm-icons",{staticClass:"m-icon small icon"},[e._v("group-mark")]),t("div",{staticClass:"m-mark-text c-title c-title--s"},[e._v(" "+e._s(e.groupMarkCount)+" ")])],1)]):t("div",{staticClass:"m-no-mark-wrap"},[t("div",{staticClass:"m-no-mark hover-action",on:{click:e.clickGroupMarkIcon}},[t("sm-icons",{staticClass:"m-icon small icon"},[e._v("group-mark")])],1)])]),e.commentCount>0?t("div",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:{content:e.commentUsersString,delay:{show:300},offset:8,autoHide:!1},expression:`{
          content: commentUsersString,
          delay: { show: 300 },
          offset: 8,
          autoHide: false
        }`,modifiers:{top:!0}}],staticClass:"m-comment-info hover-action",on:{click:e.showCreateCommentModal}},[t("sm-icons",{staticClass:"m-icon small"},[e._v("comment")]),t("div",{staticClass:"m-comment-text c-title c-title--s"},[e._v(e._s(e.commentCount))])],1):t("div",{staticClass:"m-no-comment hover-action",on:{click:e.showCreateCommentModal}},[t("sm-icons",{staticClass:"m-icon small"},[e._v("comment")])],1)],1)])},kv=[],xv=T(bv,Av,kv,!1,null,"3bfa3dca",null,null);const wv=xv.exports,Ev=D({props:{rank:{type:Number}},setup(s,e){return{color:l(()=>{switch(s.rank){case 1:return"#e95532";case 2:return"#F5AC33";case 3:return"#1DA482";default:return"#B3B3B3"}})}}});var Fv=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"rank-badge c-title c-title--xs",style:{background:e.color}},[e._v(" "+e._s(e.rank)+" ")])},Tv=[],Dv=T(Ev,Fv,Tv,!1,null,"8877721a",null,null);const wa=Dv.exports,Bv=D({props:{article:{type:Object,required:!0},rank:{type:Number},themeId:{type:Number},showRankBadge:{type:Boolean,default:!1},pageName:{type:String,required:!0},feature:{type:String,required:!0},feedType:{type:String}},components:{ArticleActions:wv,RankBadge:wa},setup(s){const e=ie(),t=Ye(),a=fe(),{data:n}=xe(),r=g(s.article.image_url);return{userInfo:n,articleImage:r,noImage:It,trackArticleView:c=>{Ge.trackArticleView(t),F.sendView({adpDocument:c,themeId:s.themeId??void 0,trackingBaseData:{pageName:s.pageName,pageUrl:e.fullPath,feature:s.feature,feedType:s.feedType}}),a.$emit("article-updated",{...c,is_read:!0})},isTitleTranslated:c=>{var p;return((p=n.value)==null?void 0:p.enable_translate_article_title)&&c.lang&&c.lang!=="ja"},setRightClickRedirectUrl:(c,p)=>{const m={adpDocument:p,themeId:s.themeId??void 0,trackingBaseData:{pageName:s.pageName,pageUrl:e.fullPath,feature:s.feature,feedType:s.feedType}};Ur(c,m)},unsetRedirectUrl:Rr}}});var Sv=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{key:e.article.id,staticClass:"article"},[t("div",{staticClass:"article-info"},[e.showRankBadge&&e.rank&&e.rank<=3?t("RankBadge",{staticClass:"rank-badge-outer",attrs:{rank:e.rank}}):e._e(),t("div",{staticClass:"title-container"},[t("div",{staticClass:"document-media-name c-text c-text--s"},[e._v(" "+e._s(e.article.media_name)+" ")]),t("a",{staticClass:"title title-media-name c-text c-text--m",class:{read:e.article.is_read},attrs:{href:e.article.url,target:"_blank"},on:{click:function(a){return a.stopPropagation(),e.trackArticleView(e.article)},mouseup:function(a){return"button"in a&&a.button!==1?null:(a.stopPropagation(),e.trackArticleView(e.article))},contextmenu:function(a){return e.setRightClickRedirectUrl(a,e.article)},mouseleave:e.unsetRedirectUrl}},[e._v(e._s(e.isTitleTranslated(e.article)?e.article.translated_title:e.article.title))]),e.isTitleTranslated(e.article)?t("div",{staticClass:"translated-title c-text c-text--s"},[e._v(" 元タイトル："+e._s(e.article.title)+" ")]):e._e()]),t("a",{attrs:{href:e.article.url,target:"_blank"},on:{contextmenu:function(a){return e.setRightClickRedirectUrl(a,e.article)},mouseleave:e.unsetRedirectUrl}},[t("img",{staticClass:"article-image lazyload",attrs:{loading:"lazy",src:e.articleImage,"data-src":e.articleImage},on:{error:function(a){e.articleImage=e.noImage},mouseup:function(a){return"button"in a&&a.button!==1?null:(a.stopPropagation(),e.trackArticleView(e.article))},click:function(a){return a.stopPropagation(),e.trackArticleView(e.article)}}})])],1),t("ArticleActions",{staticClass:"actions",attrs:{article:e.article,themeId:e.themeId,pageName:e.pageName,feature:e.feature}})],1)},Iv=[],Mv=T(Bv,Sv,Iv,!1,null,"5631daf9",null,null);const zr=Mv.exports,$v=D({props:{pageName:{type:String,required:!0},feature:{type:String,required:!0},articles:{type:Array,required:!0},themeId:{type:Number},title:{type:String,default:"注目の記事"},tooltipText:{type:String,default:Ys},linkTo:{type:String}},components:{ArticleCardSmall:zr},setup(){const s=g(!1),e=()=>{s.value=!1};return ne(()=>{document.addEventListener("click",e)}),Be(()=>{document.removeEventListener("click",e)}),{TOOLTIP_FOR_TEAM_FEATURED_ARTICLES:Ys,showTooltip:s}}}),Pv=""+new URL("state-empty-articles-51362e20.png",import.meta.url).href;var Nv=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"featured-article-list"},[t("div",{staticClass:"list-title"},[t("div",{staticClass:"text c-title c-title--s"},[e._v(e._s(e.title))]),e.articles.length>0?t("div",{staticClass:"icon",on:{click:function(a){a.stopPropagation(),e.showTooltip=!e.showTooltip}}},[t("sm-icons",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:{content:e.tooltipText,trigger:"manual",autoHide:!1,show:e.showTooltip,offset:8},expression:`{
            content: tooltipText,
            trigger: 'manual',
            autoHide: false,
            show: showTooltip,
            offset: 8
          }`,modifiers:{top:!0}}],staticClass:"small"},[e._v("question-circle")])],1):e._e()]),e._l(e.articles,function(a,n){return t("div",{key:a.id,staticClass:"articles"},[t("ArticleCardSmall",{attrs:{article:a,rank:n+1,showRankBadge:!0,themeId:e.themeId,pageName:e.pageName,feature:e.feature}}),e.linkTo||n<e.articles.length-1?t("div",{staticClass:"divider"}):e._e()],1)}),e.linkTo&&e.articles.length>0?t("div",{staticClass:"featured-article-page-link c-title c-title--s"},[t("router-link",{staticClass:"link",attrs:{to:e.linkTo}},[e._v("もっと見る")])],1):e._e(),e.articles&&e.articles.length===0?t("div",{staticClass:"empty-articles"},[e._m(0),t("div",{staticClass:"message c-text c-text--m"},[e._v(" 記事に対してマークやコメントをすることで注目の記事がランキング表示されます。 ")])]):e._e()],2)},Lv=[function(){var s=this,e=s._self._c;return s._self._setupProxy,e("div",{staticClass:"image-wrap"},[e("img",{staticClass:"image",attrs:{src:Pv}})])}],Uv=T($v,Nv,Lv,!1,null,"47186702",null,null);const Jr=Uv.exports,Rv=D({components:{AdpDocumentCard:Re,BasicEmptyFeed:xt},setup(){var h;const s=se(),e=fe(),{data:t}=kr(),a=l(()=>{var v;return((v=t.value)==null?void 0:v.industries)??[]}),n=l(()=>{var v;return(v=a.value)==null?void 0:v.find(f=>f.is_default)}),r=g(N.getIndustryId()?Number(N.getIndustryId()):(h=n.value)==null?void 0:h.id),o=l(()=>{var v;return(v=a.value)==null?void 0:v.find(f=>f.id===r.value)}),{data:i}=Ar(r),u=l(()=>{var C;const v=((C=i.value)==null?void 0:C.industry_articles)??[];let f=[];return v.forEach((y,A)=>{(A===0||v[A-1].topic_id!==v[A].topic_id)&&f.push(y)}),f.slice(0,5)}),c=l(()=>s.state.feedType.feedType),p=v=>{if(u.value==null)return;const f=u.value.findIndex(C=>C.id===v.id);f>=0&&(u.value[f].marks=v.marks,u.value[f].is_read=v.is_read)},m=v=>{var f;return(f=o.value)==null?void 0:f.topics.find(C=>C.id===v)},d=v=>({id:r.value??0,topic:{id:v,rank:1}});Z(()=>a.value,()=>{!N.getIndustryId()&&!r.value&&n.value&&(r.value=n.value.id)}),ne(async()=>{e.$on("article-updated",p)}),Be(async()=>{e.$off("article-updated",p)});const _=l(()=>r.value===void 0?"現在、業界が未選択になっています。":"この業界のニュースはありませんでした。");return{articles:u,feedType:c,PREVIEW_COUNT:5,currentIndustry:o,getTopic:m,getIndustryTrackingData:d,noFeedMessage:_}}});var Ov=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"industry-news-preview"},[t("div",{staticClass:"title"},[t("div",{staticClass:"c-text c-text--l"},[e._v("業界ニュース")]),e.currentIndustry?t("div",{staticClass:"industry-name c-text c-text--m"},[e._v(" "+e._s(`・「${e.currentIndustry.name}」を選択中`)+" ")]):e._e()]),e.currentIndustry&&e.articles&&e.articles.length>0?t("div",{staticClass:"preview-articles"},[e._l(e.articles,function(a){return t("div",{key:a.id,staticClass:"articles"},[t("div",{staticClass:"spacing-12"}),t("AdpDocumentCard",{attrs:{pageName:"home",feature:"industry_news",adpDocument:a,showCommentCount:1,isRead:a.is_read,topic:e.getTopic(a.topic_id),caseStudyText:a.case_study_text,trendCompanyText:a.trend_company_text,industryData:e.getIndustryTrackingData(a.topic_id),width:"100%"}})],1)}),t("div",{staticClass:"spacing-16"}),t("div",{staticClass:"industry-news-page-link"},[t("router-link",{attrs:{to:"/team/industry_news"}},[t("button",{staticClass:"c-btn c-btn--small c-btn--AnewsPrimary c-text c-text--"},[e._v(" もっと見る ")])])],1)],2):e._e(),e.currentIndustry===void 0||e.articles&&e.articles.length===0?t("div",{staticClass:"empty-state"},[t("div",{staticClass:"spacing-12"}),t("BasicEmptyFeed",[e._v(e._s(e.noFeedMessage))])],1):e._e()])},Gv=[],qv=T(Rv,Ov,Gv,!1,null,"c78b8370",null,null);const Hv=qv.exports,Vv=5,jv=D({components:{AdpDocumentCard:Re},props:{feedType:{type:String,required:!0}},setup(s){const e=fe(),{feedType:t}=$e(s),{data:a}=xr(g(1),Vv,!0,t.value==="all"?void 0:t.value,void 0),n=l(()=>{var o;return((o=a.value)==null?void 0:o.marked_articles)??[]}),r=o=>{const i=n.value.findIndex(u=>u.id===o.id);i>=0&&(n.value[i].marks=o.marks,n.value[i].is_read=o.is_read)};return ne(async()=>{e.$on("article-updated",r)}),Be(async()=>{e.$off("article-updated",r)}),{articles:n}}});var Kv=function(){var e=this,t=e._self._c;return e._self._setupProxy,e.articles&&e.articles.length>0?t("div",{staticClass:"mark-news"},[e._m(0),t("div",{staticClass:"divider"}),e._l(e.articles,function(a){return t("div",{key:a.id,staticClass:"articles"},[t("AdpDocumentCard",{attrs:{pageName:"home",feature:"team_marks",feedType:e.feedType,adpDocument:a,showCommentCount:1,isRead:a.is_read,width:"100%"}}),t("div",{staticClass:"divider"})],1)}),t("router-link",{staticClass:"mark-news-page-link",attrs:{to:"/team/marks"}},[t("button",{staticClass:"c-btn c-btn--small c-btn--AnewsPrimary c-text c-text--"},[e._v(" もっと見る ")])])],2):e._e()},Yv=[function(){var s=this,e=s._self._c;return s._self._setupProxy,e("div",{staticClass:"title-position"},[e("div",{staticClass:"title c-text c-text--l"},[s._v("新着マークニュース")])])}],Qv=T(jv,Kv,Yv,!1,null,"87309531",null,null);const Wv=Qv.exports,zv=""+new URL("mobile-app-qr-development-4893f64d.svg",import.meta.url).href,Jv=""+new URL("mobile-app-qr-production-f3387255.svg",import.meta.url).href,Xv=""+new URL("mobile-app-qr-staging-54579fa7.svg",import.meta.url).href,Zv=D({setup(){return{iosUrl:On,androidUrl:Gn,qrImgPath:(()=>{switch("production"){case"development":return zv;case"staging":return Xv;default:return Jv}})()}}}),Xr=""+new URL("app-download-apple-988fe0a4.svg",import.meta.url).href,Zr=""+new URL("app-download-google-4cf8da81.png",import.meta.url).href;var e0=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"m-mobile-app-info"},[t("div",{staticClass:"c-text c-text--m"},[e._v("アプリでもっと手軽に！")]),t("div",{staticClass:"m-qr-code"},[t("img",{attrs:{src:e.qrImgPath}})]),t("div",{staticClass:"m-download-buttons"},[t("a",{staticClass:"m-download-button ios",attrs:{href:e.iosUrl,target:"_blank"}},[t("img",{attrs:{src:Xr}})]),t("a",{staticClass:"m-download-button android",attrs:{href:e.androidUrl,target:"_blank"}},[t("img",{attrs:{src:Zr}})])])])},t0=[],s0=T(Zv,e0,t0,!1,null,"6c0dd49e",null,null);const a0=s0.exports;function cs(s,e,t){const a="intercom-script";if(document.getElementById(a))return;const r={app_id:"pa4jpete",hide_default_launcher:!0,user_id:String(s.id),email:s.email,user_role:s.role,personal_feed:s.has_personal_news,theme_favorite:t.length>0,mark:s.marked_article_count>0,team_id:e.id,created_at:Math.round(Date.parse(s.created_at)/1e3)},o=document.createElement("script");o.id=a,o.innerText=`(function(){var w=window;var ic=w.Intercom;if(typeof ic==="function"){ic('reattach_activator');ic('update',w.intercomSettings);}else{var d=document;var i=function(){i.c(arguments);};i.q=[];i.c=function(args){i.q.push(args);};w.Intercom=i;var l=function(){var s=d.createElement('script');s.type='text/javascript';s.async=true;s.src='https://widget.intercom.io/widget/pa4jpete';var x=d.getElementsByTagName('script')[0];x.parentNode.insertBefore(s,x);};if(document.readyState==='complete'){l();}else if(w.attachEvent){w.attachEvent('onload',l);}else{w.addEventListener('load',l,false);}}})();`,document.head.appendChild(o),window.Intercom("boot",r)}function Ls(s){window.Intercom("startTour",s)}const Us={SHOW_INDUSTRY:408909,SHOW_LATEST_MARKS:408917,SHOW_SEARCH:409269},n0=D({props:{actionedArticleCounts:{type:Object,required:!0}},setup(s,e){const t=se(),a=l(()=>t.state.feedType.feedType),n=l(()=>["all","domestic"].includes(a.value)),r=l(()=>["all","foreign"].includes(a.value)),{actionedArticleCounts:o}=$e(s),i=10,u=l(()=>r.value?o.value.foreign:o.value.domestic),c=l(()=>u.value>=i);return{feedType:a,requiredActionCount:i,actionCount:u,isPreparingFeed:c,isFeedIncludingDomestic:n,isFeedIncludingForeign:r,navigateToIndustry:async()=>{e.emit("openLeftMenu"),await ze(),Ls(Us.SHOW_INDUSTRY)},navigateToLatestMarks:async()=>{e.emit("openLeftMenu"),await ze(),Ls(Us.SHOW_LATEST_MARKS)},navigateToSearch:()=>{Ls(Us.SHOW_SEARCH)}}}}),r0=""+new URL("state-empty-mark-6ca93e6d.png",import.meta.url).href;var o0=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"personal-feed-container"},[t("div",{staticClass:"o-no-personal-feed",class:{"o-no-personal-feed-preparing":e.isPreparingFeed}},[e.isPreparingFeed?t("div",{staticClass:"o-title c-text c-text--l"},[e._v(" あなた専用のニュースを準備しています... ")]):e._e(),e.isPreparingFeed?t("div",{staticClass:"o-explanation o-explanation-preparing"},[e._m(0),t("img",{attrs:{src:bs}})]):e._e(),e.isPreparingFeed?e._e():t("div",{staticClass:"o-explanation"},[t("div",{staticClass:"o-description c-text c-text--m"},[e._v(" 10件の"+e._s(e.isFeedIncludingForeign?"国内・海外":"")+"記事を"),t("span",{staticClass:"c-title o-text-emphasis"},[e._v("閲覧")]),e._v("や"),t("span",{staticClass:"c-title o-text-emphasis"},[e._v("マーク")]),e._v("、"),t("span",{staticClass:"c-title o-text-emphasis"},[e._v("コメント")]),e._v("をすることで"),t("br"),t("span",{staticClass:"c-title"},[e._v("あなた専用の"+e._s(e.feedType==="foreign"?"海外メディア":"")+"ニュース")]),e._v("が配信されるようになります！ ")]),t("img",{attrs:{src:r0}})]),t("div",{staticClass:"o-progress-bar-container"},[e._l(e.requiredActionCount,function(a,n){return[t("div",{key:`filled-bar-${n}`,class:n<e.actionCount?"o-progress-bar o-progress-filled":"o-progress-bar"}),t("div",{key:`filled-point-${n}`,class:n<e.actionCount?"o-progress-point o-progress-filled":"o-progress-point"})]})],2),t("div",{staticClass:"o-progress-numbers"},e._l(e.requiredActionCount,function(a,n){return t("span",{key:n,staticClass:"o-progress-number"},[e._v(e._s(n+1))])}),0),t("div",{staticClass:"spacing-16"}),e.isPreparingFeed?e._e():[t("div",{staticClass:"o-hint c-text c-text--m"},[t("a",{attrs:{href:"https://anews-stockmark.zendesk.com/hc/ja/articles/4413097891481-%E3%83%91%E3%83%BC%E3%82%BD%E3%83%8A%E3%83%AB%E3%83%8B%E3%83%A5%E3%83%BC%E3%82%B9%E3%82%92%E9%85%8D%E4%BF%A1%E3%81%95%E3%81%9B%E3%82%8B",target:"_blank"}},[e._v("学習のヒント")]),t("sm-icons",{staticClass:"small"},[e._v("external-link")])],1),e._m(1),t("div",{staticClass:"o-actions c-text c-text--m"},[t("button",{staticClass:"c-textLink c-textLink--underbar",on:{click:e.navigateToIndustry}},[e._v(" 業界の情報を集めたい ")]),t("button",{staticClass:"c-textLink c-textLink--underbar",on:{click:e.navigateToSearch}},[e._v(" キーワードから探したい ")]),t("button",{staticClass:"c-textLink c-textLink--underbar",on:{click:e.navigateToLatestMarks}},[e._v(" みんなの注目から探したい ")])])]],2)])},i0=[function(){var s=this,e=s._self._c;return s._self._setupProxy,e("div",{staticClass:"o-description c-text c-text--m"},[s._v(" ニュースを選別するための情報が集まりました。"),e("br"),e("span",{staticClass:"c-title"},[s._v("あなた専用のニュース")]),s._v("をお届けします！ ")])},function(){var s=this,e=s._self._c;return s._self._setupProxy,e("div",{staticClass:"o-instruction c-text c-text--m"},[e("span",{staticClass:"c-title"},[s._v("どうやって記事を探しますか？")]),s._v(" 目的にあった方法をご案内します。 ")])}],u0=T(n0,o0,i0,!1,null,"351bae5e",null,null);const eo=u0.exports,c0=D({components:{AdpDocumentCard:Re,PersonalNewsCountdown:eo},setup(){const s=se(),e=fe(),{data:t,mutate:a}=xe();e.$on("article-updated",()=>{a()});const n=l(()=>s.state.feedType.feedType);if(n.value==="all"){const{data:r,state:o}=Ms(g(1),g(3),g("domestic")),{data:i,state:u}=Ms(g(1),g(3),g("foreign")),c=l(()=>o.value===be.SUCCESS&&u.value===be.SUCCESS),p=Fe({items:[]});e.$on("personal-feed-article-removed",d=>{p.items.push(d.id)}),e.$on("personal-feed-article-restored",d=>{p.items=p.items.filter(_=>_!==d.id)});const m=l(()=>c.value&&r.value&&i.value?[...r.value.personal_feeds,...i.value.personal_feeds].filter(d=>!p.items.includes(d.id)):[]);return{userInfo:t,isLoaded:c,articles:m,feedType:n}}else{const{data:r,state:o}=Ms(g(1),g(5),g(n.value)),i=l(()=>o.value===be.SUCCESS),u=Fe({items:[]});e.$on("personal-feed-article-removed",p=>{u.items.push(p.id)}),e.$on("personal-feed-article-restored",p=>{u.items=u.items.filter(m=>m!==p.id)});const c=l(()=>i.value&&r.value?r.value.personal_feeds.filter(p=>!u.items.includes(p.id)):[]);return{userInfo:t,isLoaded:i,articles:c,feedType:n}}}});var l0=function(){var e=this,t=e._self._c;return e._self._setupProxy,e.userInfo&&e.articles.length>0?t("div",{staticClass:"o-personal-feed"},[e._m(0),t("div",{staticClass:"o-divider"}),e._l(e.articles,function(a){return t("div",{key:a.id,staticClass:"o-personal-feed-article"},[t("AdpDocumentCard",{attrs:{pageName:"home",markSource:"personal_feed",feature:"personal_feed",feedType:e.feedType,adpDocument:a,showCommentCount:1,isRead:a.is_read,width:"100%"}}),t("div",{staticClass:"o-divider"})],1)}),t("div",{staticClass:"o-footer"},[t("router-link",{attrs:{to:{name:"personalNews"}}},[t("button",{staticClass:"c-btn c-btn--small c-btn--AnewsPrimary c-text c-text--m"},[e._v(" もっと見る ")])])],1)],2):e.userInfo?t("div",{staticClass:"no-articles"},[e.isLoaded&&e.userInfo.personal_news_counts?t("PersonalNewsCountdown",{attrs:{actionedArticleCounts:e.userInfo.personal_news_counts??{domestic:0,foreign:0}},on:{openLeftMenu:function(a){return e.$emit("openLeftMenu")}}}):t("div",{staticClass:"o-no-personal-feed"},[t("div",{staticClass:"o-feed-loading"},[e._v(" ")])])],1):e._e()},d0=[function(){var s=this,e=s._self._c;return s._self._setupProxy,e("div",{staticClass:"o-title c-text c-text--l"},[s._v(" パーソナルニュース"),e("span",{staticClass:"o-subtitle"},[s._v("・あなた専用のニュースをお届けします")])])}],m0=T(c0,l0,d0,!1,null,"0265669d",null,null);const _0=m0.exports,p0=D({components:{AdpDocumentCard:Re,ThemeEmptyFeed:hs},props:{theme:{type:Object,required:!0}},setup(s){const e=se(),t=fe(),{data:a}=xe(),n=l(()=>{var h,v;return((h=a.value)==null?void 0:h.role)!=="viewer"||s.theme.access_scope==="personal"&&s.theme.user_id===((v=a.value)==null?void 0:v.id)}),{data:r}=pa(s.theme.id),o=l(()=>{var h;return(h=r.value)==null?void 0:h.themes}),i=l(()=>e.state.feedType.feedType),u=Fe({items:[]});t.$on("article-removed",({themeId:h,articleId:v})=>{h===s.theme.id&&u.items.push(v)});const{data:c}=i.value==="all"?$s(s.theme.id,g("domestic"),void 0,g(1),3):{data:{value:void 0}},{data:p}=i.value==="all"?$s(s.theme.id,g("foreign"),void 0,g(1),3):{data:{value:void 0}},{data:m}=i.value!=="all"?$s(s.theme.id,i,void 0,g(1),5):{data:{value:void 0}},d=l(()=>i.value==="all"?c.value&&p.value?[...c.value.keyword_feeds,...p.value.keyword_feeds]:void 0:m.value?m.value.keyword_feeds:void 0),_=l(()=>{var h;return(h=d.value)==null?void 0:h.filter(v=>!u.items.includes(v.id))});return{themeDetail:o,feedType:i,userInfo:a,enableToEditTheme:n,articles:_,EMPTY_KEYWORD_FEED_MESSAGE:na}}});var v0=function(){var e=this,t=e._self._c;return e._self._setupProxy,e.articles?t("div",{key:e.feedType,staticClass:"o-picked-up-articles"},[e.articles.length>0?t("div",{staticClass:"articles"},e._l(e.articles,function(a,n){return t("div",{key:a.id,staticClass:"o-article"},[n!==0?t("div",{staticClass:"spacing-08"}):e._e(),t("AdpDocumentCard",{attrs:{id:`${e.theme.id}-${a.id}`,pageName:"home",feature:"themes_pickup",adpDocument:a,themeId:e.theme.id,showCommentCount:1,feedType:e.feedType,isRead:a.is_read}})],1)}),0):e.themeDetail?t("ThemeEmptyFeed",{attrs:{displayFeedType:e.feedType,themeFeedType:e.feedType==="foreign"?"foreign":"domestic",docType:"article",theme:e.themeDetail,enableToEditTheme:e.enableToEditTheme}},[e._v(e._s(e.EMPTY_KEYWORD_FEED_MESSAGE))]):e._e(),t("div",{staticClass:"o-footer"},[t("router-link",{attrs:{to:{name:"themeFeed",params:{themeId:e.theme.id}}}},[t("button",{staticClass:"c-btn c-btn--small c-btn--AnewsPrimary c-text c-text--m o-load-more-button"},[e._v(" もっと見る ")])])],1)],1):e._e()},f0=[],g0=T(p0,v0,f0,!1,null,"104d6053",null,null);const h0=g0.exports,y0=D({components:{PickedUpArticles:h0},setup(){const s=se(),e=l(()=>s.state.feedType.feedType),{data:t}=nt(e);return{favoriteThemes:l(()=>{var n;return[...((n=t.value)==null?void 0:n.themes)??[]].filter(r=>!r.is_deleted&&r.is_favorite).sort((r,o)=>r.order-o.order)})}}});var C0=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"o-picked-up-feeds"},[e.favoriteThemes.length>0?t("div",{staticClass:"o-themes"},e._l(e.favoriteThemes,function(a){return t("div",{key:a.id,staticClass:"o-theme"},[t("div",{staticClass:"o-theme-label"},[t("router-link",{staticClass:"o-theme-name",attrs:{to:{name:"themeFeed",params:{themeId:a.id}}}},[t("sm-icons",{staticClass:"small o-theme-hash"},[e._v("hashtag")]),t("div",{staticClass:"o-theme-name-text c-text c-text--l"},[e._v(" "+e._s(a.name)+" ")]),t("div",{staticClass:"o-total-article-count c-text c-text--m"},[e._v(" ・"+e._s(a.keyword_feed_count)+"件 ")])],1)],1),t("PickedUpArticles",{attrs:{theme:a}})],1)}),0):e._e()])},b0=[],A0=T(y0,C0,b0,!1,null,"fe9af778",null,null);const k0=A0.exports,x0=D({setup(s,e){const t=se(),a=l(()=>t.state.themeList.hasFetchedThemes),n=l(()=>t.getters["themeList/memberThemes"]),r=l(()=>t.getters["themeList/favoriteThemes"]),o=l(()=>t.state.userInfo.userInfo),i=g([]);ne(()=>i.value=r.value.slice());const u=l(()=>n.value.filter(_=>{var h;return _.access_scope!=="personal"||_.user_id===((h=o.value)==null?void 0:h.id)}));return{memberThemes:n,favoritePossibleThemes:u,hasFetchedThemes:a,isFavoriteTheme:_=>i.value.some(h=>h.id===_.id),isSelectedThemesEmpty:()=>i.value.length===0,selectFavoriteTheme:_=>{i.value.find(v=>v.id===_.id)?i.value=i.value.filter(v=>v.id!==_.id):i.value.push(_)},handleFavoriteTheme:async()=>{i.value.forEach(_=>{r.value.find(v=>v.id===_.id)||e.emit("toggleFavorite",_)}),r.value.forEach(_=>{i.value.find(v=>v.id===_.id)||e.emit("toggleFavorite",_)})}}}}),w0=""+new URL("top-6bb3d87c.png",import.meta.url).href;var E0=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"o-theme-favorite-board"},[e.memberThemes.length===0?t("div",{staticClass:"o-explanation"},[t("img",{staticClass:"o-image",attrs:{src:w0}}),e._m(0),t("router-link",{attrs:{to:{name:"themeSearch"}}},[t("button",{staticClass:"c-btn c-btn--small c-btn--AnewsPrimary"},[t("sm-icons",{staticClass:"small",style:{color:"#FFFFFF"}},[e._v("search-white")]),t("div",{staticClass:"theme-search c-text c-text--m"},[e._v("テーマを探す")])],1)])],1):e._e(),e.favoritePossibleThemes.length!==0?t("div",{staticClass:"o-explanation"},[e._m(1),t("div",{staticClass:"select-button-area"},e._l(e.favoritePossibleThemes,function(a){return t("div",{key:a.id,staticClass:"m-button",class:{"o-favorite":e.isFavoriteTheme(a)},on:{click:function(n){return n.preventDefault(),e.selectFavoriteTheme(a)}}},[t("div",{staticClass:"m-status c-text c-text--m",class:{"o-favorite":e.isFavoriteTheme(a)}},[e._v(" "+e._s(`# ${a.name}`)+" ")]),e.isFavoriteTheme(a)?t("sm-icons",{staticClass:"small astrategy-primary"},[e._v("star-fill")]):t("div",[t("sm-icons",{staticClass:"small primary"},[e._v("star")])],1)],1)}),0),t("div",{staticClass:"apply-button-area"},[t("button",{staticClass:"c-btn c-btn--small c-btn--AnewsPrimary c-text c-text--m",class:{disabled:e.isSelectedThemesEmpty()},attrs:{disabled:e.isSelectedThemesEmpty()},on:{click:function(a){return a.preventDefault(),e.handleFavoriteTheme()}}},[e._v(" 適用 ")])])]):e._e()])},F0=[function(){var s=this,e=s._self._c;return s._self._setupProxy,e("div",{staticClass:"o-sentence"},[e("div",{staticClass:"o-sentence1 c-title c-title--l"},[s._v("Anewsへようこそ！")]),e("div",{staticClass:"o-sentence2 o-text c-text c-text--m"},[s._v(" 興味のあるテーマを探して"),e("br"),s._v(" ニュースを取得できるようにしましょう。 ")])])},function(){var s=this,e=s._self._c;return s._self._setupProxy,e("div",{staticClass:"o-sentence"},[e("div",{staticClass:"o-sentence1 c-title c-title--l"},[s._v("テーマのお気に入り")]),e("div",{staticClass:"o-sentence2 o-text c-text c-text--m"},[s._v(" 追加したテーマをお気に入りしてみましょう。"),e("br"),s._v(" トップページで表示されたり、最新ニュースがメールで届くようになります。 ")])])}],T0=T(x0,E0,F0,!1,null,"7943790d",null,null);const D0=T0.exports,B0=D({components:{PickedUpFeeds:k0,FeaturedArticleList:Jr,ThemeFavoriteBoard:D0,PersonalNewsPreview:_0,MarkNews:Wv,MobileAppInfo:a0,IndustryNewsPreview:Hv},setup(){const s=se(),e=fe(),t=ie(),{data:a}=xe();et(),ne(()=>{F.trackPageView({pageName:"home",pageUrl:t.fullPath})});const{data:n,mutate:r}=br(g(1),10),o=l(()=>s.state.feedType.feedType),{data:i,state:u}=nt(o),c=l(()=>u.value===be.SUCCESS),p=l(()=>{var f;return(((f=i.value)==null?void 0:f.themes)??[]).filter(C=>!C.is_deleted)}),m=l(()=>p.value.length>0),d=l(()=>p.value.filter(f=>f.is_member).length===0),_=l(()=>p.value.filter(f=>f.is_member).length>0&&(p.value.filter(f=>f.is_favorite)??[]).length<1),h=l(()=>(p.value.filter(f=>f.is_favorite)??[]).length>0);return e.$on("article-updated",()=>{r()}),{userInfo:a,feedType:o,isLoaded:c,hasThemes:m,featuredArticles:n,showThemeSearchBoard:d,showThemeFavoriteBoard:_,hasFavoriteThemes:h,toggleFavorite:async f=>{if(f.is_favorite)try{await F.deleteFavoriteTheme(f.id),s.commit("snackbar/addMessages",{message:"お気に入りを解除しました",type:""})}catch(y){throw s.commit("snackbar/addMessages",{message:"お気に入りの解除に失敗しました",type:"error"}),y}else try{await F.postFavoriteTheme(f.id),s.commit("snackbar/addMessages",{message:"お気に入りに登録しました",type:""})}catch(y){throw s.commit("snackbar/addMessages",{message:"お気に入りの登録に失敗しました",type:"error"}),y}const C=p.value.find(y=>y.id===Number(f.id));if(C==null)throw new Error("theme is undefined");C.is_favorite=!C.is_favorite,await s.commit("themeList/updateTheme",C),e.$emit("theme-updated",C)}}}}),S0=""+new URL("state-empty-theme-0df85be5.png",import.meta.url).href;var I0=function(){var e=this,t=e._self._c;return e._self._setupProxy,e.isLoaded?t("div",{staticClass:"o-anews-home"},[e.hasThemes?t("div",{staticClass:"o-home-body"},[t("div",{staticClass:"o-home-main"},[t("PersonalNewsPreview",{attrs:{feedType:e.feedType},on:{openLeftMenu:function(a){return e.$emit("openLeftMenu")}}}),e.feedType!=="foreign"?t("div",[t("div",{staticClass:"spacing-16"}),t("IndustryNewsPreview")],1):e._e(),t("div",{staticClass:"spacing-16"}),t("MarkNews",{attrs:{feedType:e.feedType}}),t("div",{staticClass:"o-spacing"}),e.showThemeSearchBoard?t("div",{staticClass:"o-theme-favorite-board"},[t("ThemeFavoriteBoard")],1):e._e(),e.showThemeSearchBoard?t("div",{staticClass:"o-spacing"}):e._e(),e.showThemeFavoriteBoard?t("div",{staticClass:"o-theme-favorite-board"},[t("ThemeFavoriteBoard",{on:{toggleFavorite:e.toggleFavorite}})],1):e._e(),e.showThemeFavoriteBoard?t("div",{staticClass:"o-spacing"}):e._e(),e.hasFavoriteThemes?t("div",{staticClass:"o-picked-up-feeds"},[t("PickedUpFeeds")],1):e._e()],1),e.hasThemes?t("div",{ref:"teamCommentsColumn",staticClass:"o-team-comments"},[t("div",{ref:"teamCommentsContent",staticClass:"o-team-comments-column-content",staticStyle:{position:"absolute",top:"0"}},[e.featuredArticles?t("div",{staticClass:"featured-articles"},[t("div",{staticClass:"o-activities"},[t("FeaturedArticleList",{attrs:{pageName:"home",feature:"team_feature_articles",articles:e.featuredArticles.featured_articles.slice(0,8),linkTo:"/team/featured_articles"}}),t("MobileAppInfo")],1)]):e._e()])]):e._e()]):t("div",{staticClass:"o-has-no-theme"},[t("div",{staticClass:"o-explanation"},[t("div",{staticClass:"o-sentence"},[t("div",{staticClass:"o-title c-title c-title--l"},[e._v("まずはテーマを作成")]),t("div",{staticClass:"o-sentence1 o-text c-text c-text--m"},[e._v(" 毎日受け取りたいニュースのテーマを作成しましょう！ ")]),t("div",{staticClass:"o-sentence2 o-text c-text c-text--m"},[e._v(" どのようなテーマを作ったらいいのか悩んだときは、"),t("br"),e._v(" お気軽に"),t("a",{staticClass:"o-help-text",attrs:{href:"https://anews-stockmark.zendesk.com/hc/ja",target:"_blank"}},[e._v("ヘルプ")]),e._v("からカスタマーサポートにご相談ください。 ")]),t("div",{staticClass:"o-footer"},[t("router-link",{attrs:{to:{name:"themeCreate"}}},[t("button",{staticClass:"c-btn c-btn--auto c-btn--AnewsPrimary"},[e._v(" テーマを作成する ")])])],1)]),t("img",{staticClass:"o-no-theme",attrs:{src:S0}})])])]):e._e()},M0=[],$0=T(B0,I0,M0,!1,null,"5ee7dcd6",null,null);const P0=$0.exports,N0=D({setup(){const s=se(),e=l(()=>s.state.snackbar.isShown),t=l(()=>s.state.snackbar.message),a=l(()=>s.state.snackbar.type),n=l(()=>s.state.snackbar.timeout),r=l(()=>s.state.snackbar.showUndo),o=l(()=>s.state.snackbar.messageTemplates),i=()=>{s.commit("snackbar/removeMessage")};return{isShown:e,message:t,type:a,timeout:n,showUndo:r,messageTemplates:o,close:i,undo:()=>{i(),s.state.snackbar.undoFunc()}}}});var L0=function(){var e=this,t=e._self._c;return e._self._setupProxy,e.isShown?t("sm-snackbar",{staticClass:"m-snackbar",attrs:{timeout:e.timeout,message:e.message,type:e.type,showUndo:e.showUndo},on:{close:e.close,undo:e.undo}},[e.messageTemplates.length>0?t("div",{staticClass:"snackbar-content"},[e._l(e.messageTemplates,function(a,n){return[a.tag==="a"?t("a",{key:`${n}_a_${a.text}`,staticClass:"snackbar-link",attrs:{href:a.href,target:"_blank"}},[e._v(e._s(a.text))]):a.tag==="icon"?t("sm-icons",{key:`${n}_icon_${a.text}`,staticClass:"snackbar-icon"},[e._v(" "+e._s(a.text)+"-white ")]):t("span",{key:`${n}_span_${a.text}`},[e._v(e._s(a.text))])]})],2):e._e()]):e._e()},U0=[],R0=T(N0,L0,U0,!1,null,"e3c7c793",null,null);const Ea=R0.exports,O0=D({setup(){const s=se(),e=l(()=>s.state.confirmationModal.headerText),t=l(()=>s.state.confirmationModal.bodyText),a=l(()=>s.state.confirmationModal.confirmationType),n=l(()=>s.state.confirmationModal.btnText),r=g(!1),o=async()=>{await s.dispatch("confirmationModal/executeAction"),i()},i=()=>{s.commit("confirmationModal/hideConfirmationModal")},u=l(()=>t.value.length===0);return{headerText:e,confirmationType:a,btnText:n,bodyText:t,hover:r,confirm:o,hideConfirmationModal:i,bodyTextEmpty:u}}});var G0=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",[t("sm-dialog",{staticClass:"auto-height screen-center",on:{close:e.hideConfirmationModal},scopedSlots:e._u([{key:"header",fn:function(){return[t("div",{staticClass:"m-header"},[t("pre",{staticClass:"c-text c-text--m"},[e._v(e._s(e.headerText))])])]},proxy:!0},{key:"body",fn:function(){return[t("div",{staticClass:"m-body"},[t("pre",{staticClass:"m-body-text c-text c-text--m"},[e._v(e._s(e.bodyText))])])]},proxy:!0},{key:"footer",fn:function(){return[t("div",{staticClass:"m-footer",class:{empty:e.bodyTextEmpty}},[t("div",{staticClass:"m-footer-buttons"},[t("button",{staticClass:"m-cancel-button c-btn c-btn--auto c-btnOutline",on:{click:e.hideConfirmationModal}},[e._v(" キャンセル ")]),t("button",{staticClass:"m-create-button c-btn c-btn--auto",class:{"c-btn--AnewsPrimary":e.confirmationType==="submit","c-btn--negative":e.confirmationType!=="submit"},on:{click:function(a){return e.confirm()}}},[e._v(" "+e._s(e.btnText)+" ")])])])]},proxy:!0}])})],1)},q0=[],H0=T(O0,G0,q0,!1,null,"e5b1987f",null,null);const to=H0.exports,so=(s,e)=>`
  自社名は${s}です。
  ${s}の事業、技術、特徴をまとめると次のようになります:

  ${e}
  `,ao=s=>{const e=s.articles.slice(0,cu).map(t=>`${t.solution_sentence},${t.title},${t.published_at}`).join(`
`);return`
以下のinput dataに示す事例情報をもとに、${s.company_name}の事業、技術、特徴についてまとめてください。
番号付きで最大4つまでにしてください。
内容はMECEにしつつ、可能な限り多く書き出してください。
output全体を900文字以内に収めてください。

output format:
事業:(サービス、商品がある場合はサービス名、商品名を先頭に記載し、続けて背景や事業の前提、対象業界、ターゲット、特徴を含めまとめててください)
#.xxx
#.xxx

技術:(具体的な技術名、基礎技術名がある場合には記載すること、技術と事業の関係性を述べられる場合は記載すること)
#.xxx
#.xxx

特徴:(同業種、競合企業と比較した特徴。具体的な名称を記載すること。)
#.xxx
#.xxx

input data:
事例文, 記事タイトル, 日付
${e}
`},V0=(s,e)=>`
    Please answer the questions below. Must respond in Japanese.
    If you don't know the specific question, please give a general answer.
    Background of the question: ${s}
    Question: ${e}
  `,j0=(s,e,t)=>`
  業界の事例情報を読んでレポートを作成してください.以下のフォーマットで出力してください.
  日本語で記述.
  記述内容は、数値を用いてできる限り具体的な情報を提示.
  結果がない項目は出力結果に含めない.
  input dataの事例情報以外の情報を利用しない.
  出力フォーマットの内容のみ記述.

  記述内容:
  業界の取り組みの特徴: 事例情報に記述されている内容から、この業界の取り組みの特徴を200文字程度で記述して下さい.
  自業界との関係性: 自業界は、${s}業界です。事例情報に記述されている内容は自業界に関係がありますか？もしそうであれば理由も教えてください.自社との関係性の記述はここには不要です.
  事例: 事例情報から、着目すべき事例を最大7個記述してください.企業名が同じ事例は1個にまとめる.記載事例の説明は最大200文字程度にしてください.参照元のIDを記述してください.
  ---出力フォーマット---
  ■業界の取り組みの特徴■
  xxx

  ■自業界との関係性■
  xxx

  ■事例■
  #.企業名,企業名 [ID#,ID#]
  事例内容
  #.企業名,企業名 [ID#,ID#]
  事例内容

  ---input data(事例情報)---
  事例の業界: ${e}
  事例一覧:
  ID,日付,企業,課題,解決策,事例文,記事タイトル
  ${t}
`,K0=s=>`
Summarize the following text in about 250 characters. in Japanese.
---
${s}
  `,Y0=s=>`
以下のタイトルの記事は自社事業に影響・関係がありそうですか？
もしそうであれば理由を教えてください。
同一業界の法規制や業界団体に関する情報であれば、業界の背景情報を合わせて説明してください。
以下の関係しない例に当てはまる場合には、'関係しない'と返答してください。
出力結果は、関係する場合の理由または'関係しない'のみ出力する。

関係しない例:
- 影響や関係がない場合
- 情報不足で判断が難しい場合
- 一般的な判断しかできない場合
- 自社情報が与えられていない、不明な場合
            
(入力情報)
タイトル:${s}
            
(出力結果:関係する場合)
関係する
理由:xxx
                        
(出力結果:関係しない場合)
関係しない`;class zt{constructor(){ge(this,"dbName");ge(this,"storeName");ge(this,"db");this.dbName="reportsDB",this.storeName="reports",this.db=null}async init(e){return new Promise((t,a)=>{e===null&&a("userIdがありません。");const n=indexedDB.open(this.dbName+`-user${e}`,1);n.onupgradeneeded=r=>{const o=n.result;if(o.onerror=()=>{a("DBの作成に失敗しました。")},!o.objectStoreNames.contains(this.storeName)){const i={keyPath:"id",autoIncrement:!0};o.createObjectStore(this.storeName,i)}},n.onsuccess=r=>{this.db=n.result,t("success")},n.onerror=r=>{a("DBの取得に失敗しました。")}})}async get(e){return new Promise((t,a)=>{if(!this.db){a("dbがありません。");return}const o=this.db.transaction([this.storeName],"readonly").objectStore(this.storeName).get(e);o.onsuccess=i=>{t(o.result)},o.onerror=i=>{a("データの取得に失敗しました。")}})}async getAll(){return new Promise((e,t)=>{if(!this.db){t("dbがありません。");return}const r=this.db.transaction([this.storeName],"readonly").objectStore(this.storeName).getAll();r.onsuccess=o=>{e(r.result)},r.onerror=o=>{t("データの取得に失敗しました。")}})}async create(e){return new Promise((t,a)=>{if(!this.db){a("dbがありません。");return}const o=this.db.transaction([this.storeName],"readwrite").objectStore(this.storeName).add(e);o.onsuccess=i=>{t(o.result)},o.onerror=i=>{a("データの作成に失敗しました。")}})}async update(e){return new Promise((t,a)=>{if(!this.db){a("dbがありません。");return}const o=this.db.transaction([this.storeName],"readwrite").objectStore(this.storeName).put(e);o.onsuccess=i=>{t(o.result)},o.onerror=i=>{a("データの更新に失敗しました。")}})}async delete(e){return new Promise((t,a)=>{if(!this.db){a("dbがありません。");return}const o=this.db.transaction([this.storeName],"readwrite").objectStore(this.storeName).delete(e);o.onsuccess=i=>{t(e)},o.onerror=i=>{a("データの削除に失敗しました。")}})}close(){this.db&&this.db.close()}}const Q0=D({setup(){return{CONTACT_MAIL_LINK:lu,STOCKMARK_LABS_HELP_URL:uu}}}),W0=""+new URL("logo_lab-35d15ce5.png",import.meta.url).href;var z0=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"header"},[t("div",{staticClass:"header-left"},[t("router-link",{staticClass:"anews-logo-link",attrs:{to:{name:"selectTemplate"}}},[t("img",{staticClass:"anews-logo",attrs:{src:W0}})]),t("div",{staticClass:"spacing-12"}),t("div",{staticClass:"spacing-08"}),t("div",{staticClass:"header-title"},[e._v("調査AIエージェントβ")]),t("div",{staticClass:"spacing-16"})],1),t("div",{staticClass:"header-right"},[t("div",[t("a",{attrs:{href:e.CONTACT_MAIL_LINK,target:"_blank",rel:"noopener"}},[e._v("✉️お問い合せ")])]),t("div",{staticClass:"spacing-12"}),t("div",{staticClass:"spacing-08"}),t("div",[t("a",{attrs:{href:e.STOCKMARK_LABS_HELP_URL,target:"_blank",rel:"noopener"}},[e._v(" この機能に関するヘルプ ")])])])])},J0=[],X0=T(Q0,z0,J0,!1,null,"cb5f362c",null,null);const Z0=X0.exports,ef=D({props:{reports:{type:Array,required:!0}},setup(s,e){const t=ie(),a=g(N.getLeftLabsMenuIsExpanded()),n=g(!1),r=l(()=>a.value||n.value),o=()=>{n.value=!1,a.value=!a.value,N.setLeftLabsMenuIsExpanded(a.value)},i=l(()=>[...s.reports].reverse());Z(r,_=>{e.emit(_?"open":"close")},{immediate:!0});const u=l(()=>t.name==="selectTemplate"),c=_=>_===void 0?!1:_===Number(t.params.reportId),p=l(()=>t.name==="reportSetting"),m=l(()=>vs-s.reports.length),d=l(()=>p.value?"cog-white":"cog");return{isMenuVisible:r,isExpanded:a,isHovering:n,toggleIsFolded:o,isSelectedNewReport:u,isSelectedSavedReport:c,reportRemainingCount:m,reversedReports:i,isReportSetting:p,cogIcon:d}}});var tf=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"left-menu-wrapper"},[t("div",{staticClass:"left-menu",class:{folded:!e.isMenuVisible},on:{mouseover:function(a){e.isHovering=!0},mouseleave:function(a){e.isHovering=!1}}},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.isMenuVisible,expression:"isMenuVisible"}],staticClass:"left-menu-items"},[t("div",{staticClass:"left-menu-item-reports"},[t("div",{staticClass:"left-menu-new-report"},[t("router-link",{attrs:{to:{name:"selectTemplate"}}},[t("div",{staticClass:"left-menu-item-report",class:{selected:e.isSelectedNewReport}},[e._v(" 新しいレポート ")])]),t("div",{staticClass:"spacing-12"}),t("router-link",{attrs:{to:{name:"reportSetting"}}},[t("div",{staticClass:"left-menu-item-setting",class:{selected:e.isReportSetting}},[t("sm-icons",{staticClass:"setting-icon"},[e._v(e._s(e.cogIcon))]),t("div",{staticClass:"spacing-04"}),t("div",[e._v("設定")])],1)])],1),t("div",{staticClass:"left-menu-saved-reports"},[e.reports.length>0?t("div",{staticClass:"report-remaining-count"},[t("div",[e._v("残り "+e._s(e.reportRemainingCount)+"レポート")]),t("div",{staticClass:"spacing-12"})]):e._e(),e._l(e.reversedReports,function(a){return t("div",{key:a.id},[t("router-link",{attrs:{to:{name:"savedReport",params:{reportId:a.id}}}},[t("div",{staticClass:"left-menu-item-report",class:{selected:e.isSelectedSavedReport(a.id)}},[e._v(" "+e._s(a.title)+" ")])]),t("div",{staticClass:"spacing-12"})],1)})],2)])]),t("button",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:{content:e.isExpanded?"折りたたむ":"開いたままにする",offset:8,autoHide:!1},expression:`{
          content: !isExpanded ? '開いたままにする' : '折りたたむ',
          offset: 8,
          autoHide: false
        }`,modifiers:{top:!0}}],staticClass:"left-menu-arrow c-text c-text--s",class:{"visible-menu":e.isMenuVisible},on:{click:e.toggleIsFolded}},[t("sm-icons",{staticClass:"small"},[e._v("chevron-"+e._s(e.isExpanded?"left":"right"))])],1)])])},sf=[],af=T(ef,tf,sf,!1,null,"1687dc27",null,null);const nf=af.exports,rf=D({components:{Header:Z0,LeftMenu:nf,Snackbar:Ea,ConfirmationModal:to},setup(){const s=document.querySelector('link[rel="icon"]');s.href="/labs-favicon.ico";const e=N.getUserId(),t=se(),a=l(()=>t.state.confirmationModal.confirmationModalOpen),n=g(!0),r=new zt,o=g([]);ne(async()=>{if(await r.init(e),o.value=await r.getAll(),N.getLabsReportSetting())return;const c=await F.getUserSolutions(["ja","en"],jn,null);if(c){const m=[{content:ao(c),role:"user"}],d={company_name:c.company_name,industry_name:c.industry_name,content:""};for await(let _ of F.reportStreamChat(m))d.content+=_,N.setLabsReportSetting(d)}});const i=async()=>{o.value=await r.getAll()};return Be(()=>{r.close()}),{reports:o,update:i,isLeftMenuOpen:n,confirmationModalOpen:a}}});var of=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"labs-root"},[t("Header"),t("Snackbar"),e.confirmationModalOpen?t("ConfirmationModal"):e._e(),t("div",{staticClass:"container"},[t("LeftMenu",{attrs:{reports:e.reports},on:{open:function(a){e.isLeftMenuOpen=!0},close:function(a){e.isLeftMenuOpen=!1}}}),t("div",{staticClass:"content",class:{"left-menu-folded":!e.isLeftMenuOpen}},[t("div",{staticClass:"page-content"},[t("router-view",{on:{update:e.update}})],1)])],1)],1)},uf=[],cf=T(rf,of,uf,!1,null,null,null,null);const lf=cf.exports,df=D({setup(){const s=se(),e=g(""),t=g(""),a=g(""),n=g(!1),r=()=>{N.setLabsReportSetting({company_name:e.value,industry_name:t.value,content:a.value}),s.commit("snackbar/addMessages",{message:"保存しました",type:"success"})};return ne(()=>{const i=N.getLabsReportSetting();i&&(e.value=i.company_name,a.value=i.content)}),{saveSetting:r,compamyName:e,content:a,regenerateSetting:async()=>{n.value=!0;const i=await F.getUserSolutions(["ja","en"],jn,e.value);if(i){t.value=i.industry_name;const c=[{content:ao(i),role:"user"}],p={company_name:i.company_name,industry_name:i.industry_name,content:""};for await(let m of F.reportStreamChat(c))p.content+=m,a.value=p.content,N.setLabsReportSetting(p)}n.value=!1},isGenerating:n}}});var mf=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"report-setting"},[t("div",{staticClass:"report-setting-forms"},[t("div",{staticClass:"c-title c-title--l"},[e._v("設定")]),t("div",{staticClass:"spacing-32"}),t("div",{staticClass:"spacing-08"}),e._m(0),t("div",{staticClass:"spacing-16"}),e._m(1),t("div",{staticClass:"spacing-04"}),t("input",{directives:[{name:"model",rawName:"v-model",value:e.compamyName,expression:"compamyName"}],staticClass:"c-text c-text--m",attrs:{type:"text"},domProps:{value:e.compamyName},on:{input:function(a){a.target.composing||(e.compamyName=a.target.value)}}}),t("div",{staticClass:"spacing-16"}),t("label",{staticClass:"c-title c-title--m"},[e._v(" 会社情報（企業名と過去の事例等から自動的に埋めています） 最大1000文字 ")]),t("div",{staticClass:"spacing-04"}),t("div",{staticClass:"c-text c-text--m warning-message"},[e._v(" ※機密情報や個人情報を入れないでください。 ")]),t("div",{staticClass:"spacing-04"}),t("textarea",{directives:[{name:"model",rawName:"v-model",value:e.content,expression:"content"}],staticClass:"c-text c-text--m",attrs:{maxlength:"1000"},domProps:{value:e.content},on:{input:function(a){a.target.composing||(e.content=a.target.value)}}}),t("div",{staticClass:"spacing-32"}),t("div",{staticClass:"spacing-08"}),t("div",{staticClass:"buttons"},[t("button",{staticClass:"c-btn c-btn--auto",class:{disabled:e.isGenerating},attrs:{disabled:e.isGenerating},on:{click:e.regenerateSetting}},[e._v(" 企業名から会社情報を再作成する ")]),t("div",{staticClass:"spacing-12"}),t("button",{staticClass:"c-btn c-btn--auto c-btn--labs",on:{click:e.saveSetting}},[e._v(" 変更を反映する ")])])])])},_f=[function(){var s=this,e=s._self._c;return s._self._setupProxy,e("div",{staticClass:"c-text c-text--m"},[s._v(" 情報は、レポートで情報との関係性を提示する際に利用します。"),e("br"),s._v(" Anewsの利用情報やStockmarkが持つナレッジ情報に加えて、本情報を利用することができます。 ")])},function(){var s=this,e=s._self._c;return s._self._setupProxy,e("div",[e("label",{staticClass:"c-title c-title--m"},[s._v(" 企業名（契約情報から自動的に埋めています） ")])])}],pf=T(df,mf,_f,!1,null,"7d26a5c5",null,null);const vf=pf.exports,ff=D({props:{query:{type:String,required:!0}},setup(s,e){var C;const{data:t}=et(),a=g([]),n=20,r=g(1),o=g(0),i=g(""),u=((C=t.value)==null?void 0:C.enable_foreign_lang_media)??!1,c=g(!1),p=async(y,A)=>{const k=u?void 0:"ja";return await F.search({query:A,sort:"recomended_v2",entertainment_filter:!1,lang:k},y,n)},m=async y=>(await F.getNaturalSentenceQueryKeywords(y)).query_keywords.join(" ");Z(()=>s.query,async()=>{a.value=[],r.value=1,o.value=0,i.value="",c.value=!0;const y=await m(s.query);i.value=y||s.query;const A=await p(r.value,i.value);o.value=A.result_count,a.value=A.articles,c.value=!1});const d=()=>{e.emit("close")},_=async y=>{const A=y.target;if(A.scrollTop+A.clientHeight>A.scrollHeight-10&&o.value>a.value.length){r.value+=1;const k=await p(r.value,i.value);a.value=[...a.value,...k.articles]}},h=y=>{e.emit("articleInsert",y)},v=y=>oe(y).format("YYYY/MM/DD"),f=l(()=>o.value.toLocaleString());return{articles:a,formatPublishedAt:v,scroll:_,close:d,resultCount:o,searchQuery:i,isSearching:c,articleInsert:h,displayResultCount:f}}}),Rs="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAArYAAADwCAYAAAD1nSe0AAAACXBIWXMAABYlAAAWJQFJUiTwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAt/SURBVHgB7d1vUlvXGcDh9yIJBELgMWN/TlfQLMFZQbKU7qDpDpqdtCtolpCuoN4AHicCoT+AqvfadDqeATuOjc45PM/MHRH8UeTcn16de28XH9hsNq+2Lz9sj++3xzcBAADl+OX98beu617//z90dz9sg/bZ9uWv2+MvAQAA5ft7vAvct/kffdi+j9qft8efAwAA6pHT2+8ybvfe/yIntaIWAIDafBvvWja67bT2m+3rfwIAAOr1XU5sfwwAAKjbDxm2tiAAAFC773MrwiYAAKByewEAAA0QtgAANEHYAgDQBGELAEAThC0AAE0QtgAANEHYAgDQBGELAEAThC0AAE0QtgAANEHYAgDQBGELAEAThC0AAE0QtgAANEHYAgDQBGELAEAThC0AAE0QtgAANEHYAgDQBGELAEAThC0AAE0QtgAANEHYAgDQBGELAEAThC0AAE0QtgAANEHYAgDQBGELAEAThC0AAE0QtgAANEHYAgDQBGELAEAThgEAVGu1WsViseiPm5ubgD9qNBrFcDiM6XQag8EgatJttgIAqEqevmezWVxeXgZ8LZPJpA/cruuiBsIWACqTp+7z8/NYr9cBX1tOcM/OzqqIW3tsAaAyOakVtTyW/FvLv7kaCFsAqEjuo7X9gMeWf3O5n7t0whYAKlLL5Iz25AWKpRO2AFARWxDYFWELAHxR19fXAbtQw+3khC0AAE0QtgAANEHYAgDQBGELAEAThC0AAE0QtgAANEHYAgDQBGELAEAThC0AAE0QtgAANEHYAgDQBGELAEAThC0AAE0QtgAANEHYAgDQhGE0YrPZxGKxiOVyGdfX1/2RvwOAz9V1XQyHw/44ODiI8Xjc/w4oU/Vhe3NzE5eXlzGfz4UsAF9UnlfW63V/XF1d9b87PDyM6XQag8EggLJUG7a52Mxmsz5qAeCxZODmMZlM+sA1wYVyVBm2OaU9Pz/vXwFgF3Kwklvgzs7OTG+hENVdPJZ7Z0UtACW4G7TkuQnYvarCNheQN2/eiFoAiuHcBOWoJmxzT61JLQAlupvcuogZdquasM0LxUQtAKXKc1Seq4DdqSJs727pBQAly3OVIQzsThVh6xMwALUwiIHdKT5sc7/S3U2xAaB0ec6y1xZ2o/iwzXsEAkAtbm9vnbtgR4oP2+VyGQBQk9VqFcDjKz5s8/ncAFAT5y7YjeLD1tWlANTGuQt2o4qLxwCgJrnPFnh8VT1SFwAA7lN82HZdFwBQk709cyPYheL/zxsMBgEANXHugt0oPmz39/cDAGoyGo0CeHzCFgC+MOcu2I3iw3Y8HttnC0BV8twFPL4qLh47OjoKAKhBnrMMZGA3qrhsczKZBADU4Pj4OIDdqCJs8+pScQtA6fJc5Y4IsDvV3GhvOp1aLAAoVp6j8lwF7E41YZv7lc7OzsQtAMXJc1Oeo+ythd2q6tEouXA8f/5c3AJQDOcmKEd1z/wbDocmtwAU4W5Sm+cmYPeqfJh1LiQvX750QRkAO5PnoBcvXhi0QEGq/oh5cnLSLywXFxcxn88DAL6mu3uru/sBlKn6705yYTk9Pe0jd7FYxGq1ivV6HdfX17HZbAIAPleGbG4zGI1G/WNyPQ0TytbMpqBcaA4PD/sDAICnp8o9tgAA8CFhCwBAE4QtAABNELYAADRB2AIA0ARhCwBAE4QtAABNELYAADRB2AIA0IRmnjyWj8/NR+oul8v+cboeqQvw6e4eHZvHwcGBR8cCVao+bG9ubuLy8jLm87mQBfhMuX6u1+v+uLq66n+XjyifTqcxGAwCoAbVhm0uwrPZrI9aAL68DNw8JpNJH7gmuEDpqgzbnNKen5/3rwB8XTlAyK1eZ2dnprdA0aq7eCz3zopagMd1N1DINRigVFWFbS6sb968EbUAO2ANBkpXTdjmnlqTWoDdupvculgXKFE1YZsXiolagN3LtTjXZIDSVBG2d7f0AqAMuSYbNgClqSJsTQYAymPgAJSm+LDNfVx3NwsHoBy5NttrC5Sk+LDNeycCUJ7b21trNFCU4sN2uVwGAGVarVYBUIriwzafWw5AmazRQEmKD1tX3QKUyxoNlKSKi8cAKFPuswUoRVWP1AUAgPsUH7Zd1wUAZdrbMx8BylH8ijQYDAKAMlmjgZIUH7b7+/sBQJlGo1EAlELYAvDZrNFASYoP2/F4bJ8tQKFyjQYoRRUXjx0dHQUAZcm12eABKEkVl7NOJpMAoCzHx8cBUJIqwjavuhW3AOXINdkdEYDSVHMDwul0ahEFKECuxbkmA5SmmrDNfVxnZ2fiFmCHcg3OtdjeWqBEVT0yJhfU58+fi1uAHbAGA6Wr7lmIw+HQ5Bbgkd1NanMNBihVlQ/5zgX25cuXLigDeAS51r548cJAAShe1R+9T05O+gX34uIi5vN5APBl3N1D3N0PgJpU/51SLrinp6d95C4Wi1itVrFer+P6+jo2m00A8HEZsrnNYDQa9Y/J9dRHoEbNbJbKBfjw8LA/AAB4eqrcYwsAAB8StgAANEHYAgDQBGELAEAThC0AAE0QtgAANEHYAgDQBGELAEAThC0AAE0QtgAANEHYAgDQBGELAEAThC0AAE0QtgAANEHYAgDQhGFUbLPZxMXFRaxWq7i5uekP6tN1XYxGoxiPx/0xGAwCAOD3qjJsM2Dfvn3bBy31yw8o+V7m8dtvv8Xh4WFMp1OBCwD8LtWF7eXlZcxmsz6GaNPV1VUsl8s+bo+OjgIA4FNUtcc2gzYneqK2fbe3t/Hrr7/27zkAwKeoJmxzUpv7aXla8j2fz+cBAPAxVYRt7qk1uXu68r13YSAA8DFVhK09tU9bbkvIiwUBAB5SfNjmpC4vJuJpyzsm+HADADyk+LBdLBYBKfdZAwDcR9hSjbwFGADAfYoP2/V6HZBcQAYAPKT4sLWvkjvCFgB4SFUPaAAAgPsUH7aDwSAg7e35HAYA3E/YUo3RaBQAAPcpPmwPDg4C0ng8DgCA+xQftpPJJCD5kAMAPKT4sO26Lvb394On7ejoyLYUAOBBVVyN8+zZsz5weZryvT8+Pg4AgIdUEbY5qZtOp8HTdHJyYloLAHxUNfdPyr224vbpyfc8tyEAAHzMMCqSX0fn19Kz2cwTyRqX73NOakUtAPCpqgrblJPbvO3TxcVFzOfzoD1594PT01PbDwCA36W6sE0ZPBk+OcFdLBaxXC5jtVqZ4lZqOBz272ne/SI/uLhQEAD4HFWG7Z2MoQwh97oFAKCai8cAAOAhwhYAgCYIWwAAmiBsAQBogrAFAKAJwhYAgCYIWwAAmiBsAQBogrAFAKAJwhYAgCYIWwAAmiBsAQBogrAFAKAJwhYAgCYIWwAAmiBsAaAig8EgYBdGo1GUTtgCQEXG43HALghbAOCLErbsyvHxcZRO2AJARfb392MymQQ8pvybq2EbjLAFgMpMp9MYDocBjyG3IOTfXA26zVYAAFXJ0/dsNovLy8uAryUntRm1XddFDYQtAFTs5uYmLi4uYr1e9wf8UfltwMHBQb+fO7e+1ETYAgDQBHtsAQBogrAFAKAJwhYAgCYIWwAAmiBsAQBogrAFAKAJwhYAgCYIWwAAmiBsAQBogrAFAKAJwhYAgCYIWwAAmiBsAQBogrAFAKAJwhYAgCYIWwAAmiBsAQBogrAFAKAJwhYAgCYIWwAAmiBsAQBogrAFAKAJwhYAgCYIWwAAmiBsAQBogrAFAKAJwhYAgCYIWwAAmiBsAQBogrAFAKAJwhYAgCYIWwAAmpBh+zoAAKBuv2TY/jMAAKBuv3SbzebV9od/BQAA1OtPe13X/bz94acAAIA6/bRt2tdd/rSd2j6Ld1PbbwMAAOrx7+3xahu2b/u7IuQP25fvwuQWAIB6ZLu+et+y0X34r9vp7Tfblx+3x5/DBBcAgLK8jnc3P/jH+y21//NfAXoOxMAzGYsAAAAASUVORK5CYII=";var gf=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"article-search-result",on:{"&scroll":function(a){return e.scroll.apply(null,arguments)}}},[t("div",{staticClass:"header"},[t("button",{staticClass:"close-button",on:{click:e.close}},[t("sm-icons",[e._v("times")])],1)]),t("div",{directives:[{name:"show",rawName:"v-show",value:e.searchQuery!=="",expression:"searchQuery !== ''"}]},[t("span",{staticClass:"query"},[e._v(e._s(e.searchQuery))]),e._v(" を検索しています... "),t("div",{staticClass:"spacing-08"})]),t("div",{directives:[{name:"show",rawName:"v-show",value:!e.isSearching&&e.articles.length>0,expression:"!isSearching && articles.length > 0"}]},[t("span",{staticClass:"result-count"},[e._v(e._s(e.displayResultCount)+" ")]),e._v(" 件の結果が見つかりました。 "),t("div",{staticClass:"spacing-08"})]),t("div",{directives:[{name:"show",rawName:"v-show",value:!e.isSearching&&e.articles.length===0,expression:"!isSearching && articles.length === 0"}]},[t("span",{staticClass:"query"},[e._v(e._s(e.searchQuery))]),t("br"),e._v(" に一致する記事が見つかりませんでした。 "),t("div",{staticClass:"spacing-08"})]),t("div",e._l(e.articles,function(a){return t("div",{key:a.id,staticClass:"article-list-item"},[t("div",{staticClass:"article-card"},[t("div",[t("div",{staticClass:"article-media-name"},[e._v(e._s(a.media_name))]),t("div",{staticClass:"spacing-04"}),t("div",{staticClass:"c-title c-title--m"},[t("a",{attrs:{href:a.url,target:"_blank"}},[e._v(e._s(a.title))])]),t("div",{staticClass:"spacing-04"}),t("div",{staticClass:"article-published-at c-text c-text--s"},[e._v(" "+e._s(e.formatPublishedAt(a.published_at))+" ")])]),t("div",[t("img",{attrs:{src:a.image_url}})])]),t("div",{staticClass:"hidden"},[t("div",{staticClass:"spacing-08"}),t("div",{staticClass:"spacing-02"}),t("button",{staticClass:"insert-article-button c-title c-title--m",on:{click:function(n){return e.articleInsert(a)}}},[e._v(" ←メモに挿入 ")])])])}),0),t("div",{directives:[{name:"show",rawName:"v-show",value:e.isSearching,expression:"isSearching"}],staticClass:"no-articles"},[t("img",{staticClass:"no-article",attrs:{src:Rs}}),t("img",{staticClass:"no-article",attrs:{src:Rs}}),t("img",{staticClass:"no-article",attrs:{src:Rs}})])])},hf=[],yf=T(ff,gf,hf,!1,null,"5978d8a4",null,null);const Cf=yf.exports;class bf{constructor({data:e}){ge(this,"data");this.data=e}render(){const e=this.data&&this.data.title?this.data.title:"タイトルなし",t=this.data&&this.data.url?this.data.url:"",a=this.data&&this.data.publishedAt?this.data.publishedAt:"yyyy/mm/dd",n=this.data&&this.data.mediaName?this.data.mediaName:"-",r=this.data&&this.data.imageUrl?this.data.imageUrl:"/image/empty-image.png",o=document.createElement("div"),i=`
    <div class="card-section">
      <div class="card-info">
        <div class="c-title c-title--m card-info-title">
          <a href="${vt(t)}" target="_blank" rel="noopener">${vt(e)}</a>
        </div>
        <div class="card-info-options c-text c-text--xs">
          <div class="card-info-timestamp">${vt(a)}</div>
          <div class="card-info-media">${vt(n)}</div>
        </div>
      </div>
      <div class="card-image">
        <img src="${vt(r)}" />
      </div>
    </div>
    `;return o.innerHTML=i,o}save(){return{title:this.data.title,imageUrl:this.data.imageUrl,mediaName:this.data.mediaName,publishedAt:this.data.publishedAt,url:this.data.url}}}class Af{constructor({api:e,config:t}){ge(this,"api");ge(this,"button");ge(this,"title");ge(this,"gtag");this.api=e,this.button=null,this.title=t.title,this.gtag=t.gtag}static get isInline(){return!0}render(){return this.button=document.createElement("button"),this.button.type="button",this.button.textContent="AIに聞く🪄",this.button.classList.add(this.api.styles.inlineToolButton),this.button.classList.add("inline-tool-button"),this.button}async surround(e){const t=e.toString();Ge.trackAskAi(this.gtag,t);const a=this.api.blocks.getCurrentBlockIndex(),n=this.api.blocks.insert("callout",{text:`アシスタントが調査中...
`},{},a+1),r=[{role:"user",content:V0(this.title,t)}];let o=!1;for await(let i of F.reportStreamChat(r))o||(n.call("clearHTML"),o=!0),n.call("appendHTML",vt(i).replace(/\n/g,"<br>"))}checkState(e){}}const no={allowedTags:["mark","a","div","br","b","i"],allowedAttributes:{a:["href","target"],mark:["class"],div:["class"],br:[],b:[],i:[]}};class kf{constructor({data:e}){ge(this,"data");ge(this,"formDom");this.data=e}static get toolbox(){return{title:"CallOut",icon:"💡"}}static get sanitize(){return{text:{br:!0}}}render(){var o;const e=document.createElement("div"),t=document.createElement("div"),a=this.formDom=document.createElement("div");e.classList.add("callout-section"),t.innerText="💡";const n=((o=this.data)==null?void 0:o.text)??"",r=Qt(n,no);return a.innerHTML=r,a.contentEditable="true",a.classList.add("callout-text"),e.appendChild(t),e.appendChild(a),e}save(e){var t;return{text:((t=this.formDom)==null?void 0:t.innerHTML)??""}}clearHTML(){this.formDom&&(this.formDom.innerHTML="")}appendHTML(e){this.formDom&&(this.formDom.innerHTML+=e)}}async function xf(s,e,t){await s.isReady;const a=N.getLabsReportSetting();let n=s.blocks.getBlocksCount();const r=t==="ja"||t==="all",o=t==="en"||t==="all",i=(a==null?void 0:a.company_name)||"",u=(a==null?void 0:a.industry_name)||"";s.blocks.insert("callout",{text:`アシスタントが調査中...
`},{},n);const c=await wf(e),p=n,m=so(i,(a==null?void 0:a.content)||"");if(r){const d=await F.getKeywordSolutionSearch(c||e,["ja"],zs*Xa);d.length>0&&(s.blocks.insert("header",{text:"国内の事例",level:3},{},++n),s.blocks.insert("paragraph",{text:"<b>調査期間: 6ヶ月</b>"},{},++n)),n=await cn(s,d,n,u,m)}if(o){const d=await F.getKeywordSolutionSearch(c||e,["en"],zs*Xa);d.length>0&&(s.blocks.insert("header",{text:"海外の事例",level:3},{},++n),s.blocks.insert("paragraph",{text:"<b>調査期間: 6ヶ月</b>"},{},++n),n=await cn(s,d,n,u,m))}s.blocks.delete(p)}const wf=async s=>(await F.getNaturalSentenceQueryKeywords(s)).query_keywords.join(" "),cn=async(s,e,t,a,n)=>{const r={role:"system",content:n};for(const o of e){const i=o.articles.slice(0,zs),u={role:"user",content:j0(a,o.industry_name,Ef(i))},c=[r,u];s.blocks.insert("header",{text:`${o.industry_name} （事例件数 ${i.length}）`},{},++t);const p=s.blocks.insert("quote",{text:""},{},++t);for await(let m of F.reportStreamChat(c))p.call("appendHTML",vt(m).replace(/\n/g,"<br>"));i.forEach((m,d)=>{s.blocks.insert("articleCard",{title:m.title,url:m.url,publishedAt:m.published_at,mediaName:m.site_name,imageUrl:m.image_url},{},++t)})}return t},Ef=s=>s.map((e,t)=>{var a,n;return`${t+1},${e.published_at},"${e.subjective_company_entities.join(",")}","${((a=e.issues)==null?void 0:a.join(","))||""}",${((n=e.solutions)==null?void 0:n.join(","))||""},${e.solution_sentence},${e.title}`}).join(`
`);class Tt{constructor({api:e}){ge(this,"api");ge(this,"button");ge(this,"tag");ge(this,"iconClasses");this.api=e,this.button=null,this.tag="MARK",this.iconClasses={base:this.api.styles.inlineToolButton,active:this.api.styles.inlineToolButtonActive}}static get CSS(){return"cdx-marker"}static get isInline(){return!0}render(){return this.button=document.createElement("button"),this.button.type="button",this.button.textContent="M",this.button.classList.add(this.iconClasses.base),this.button.classList.add("inline-tool-button"),this.button}surround(e){if(!e)return;let t=this.api.selection.findParentTag(this.tag,Tt.CSS);t?this.unwrap(t):this.wrap(e)}wrap(e){let t=document.createElement(this.tag);t.classList.add(Tt.CSS),t.appendChild(e.extractContents()),e.insertNode(t),this.api.selection.expandToTag(t)}unwrap(e){this.api.selection.expandToTag(e);let t=window.getSelection();if(!t)return;let a=t.getRangeAt(0),n=a.extractContents();e.parentNode&&e.parentNode.removeChild(e),a.insertNode(n),t.removeAllRanges(),t.addRange(a)}checkState(){const e=this.api.selection.findParentTag(this.tag,Tt.CSS);this.button&&this.button.classList.toggle(this.iconClasses.active,!!e)}static get sanitize(){return{mark:{class:Tt.CSS}}}}class Ff{constructor({data:e}){ge(this,"data");ge(this,"formDom");this.data=e}static get toolbox(){return{title:"Quote",icon:"“"}}static get sanitize(){return{text:{br:!0}}}render(){var r;const e=document.createElement("div"),t=this.formDom=document.createElement("blockquote");e.classList.add("quote-section");const a=((r=this.data)==null?void 0:r.text)??"",n=Qt(a,no);return t.innerHTML=n,t.contentEditable="true",e.appendChild(t),e}save(e){var t;return{text:((t=this.formDom)==null?void 0:t.innerHTML)??""}}clearHTML(){this.formDom&&(this.formDom.innerHTML="")}appendHTML(e){this.formDom&&(this.formDom.innerHTML+=e)}}class Tf{constructor({api:e,config:t}){ge(this,"api");ge(this,"button");ge(this,"gtag");this.api=e,this.button=null,this.gtag=t.gtag}static get isInline(){return!0}render(){return this.button=document.createElement("button"),this.button.type="button",this.button.textContent="AIと探す🔍",this.button.classList.add(this.api.styles.inlineToolButton),this.button.classList.add("inline-tool-button"),this.button}async surround(e){const t=e.toString();Ge.trackSearchWithAi(this.gtag,t);const a=e.extractContents(),n=document.createElement("mark");n.classList.add("cdx-marker"),n.append(a),e.insertNode(n);const r=new CustomEvent("search",{detail:t}),o=n.closest(".editorjs");o&&o.dispatchEvent(r)}checkState(e){}}class Df{constructor({api:e,config:t}){ge(this,"api");ge(this,"button");ge(this,"gtag");this.api=e,this.button=null,this.gtag=t.gtag}static get isInline(){return!0}render(){return this.button=document.createElement("button"),this.button.type="button",this.button.textContent="要約する",this.button.classList.add(this.api.styles.inlineToolButton),this.button.classList.add("inline-tool-button"),this.button}async surround(e){const t=e.toString();Ge.trackSummarize(this.gtag,t);const a=this.api.blocks.getCurrentBlockIndex();if(t.length>2e3){this.api.blocks.insert("callout",{text:'<span class="red">2000文字以内で入力してください</span>'},{},a+1);return}const n=this.api.blocks.insert("callout",{text:`アシスタントが要約中...
`},{},a+1),r=[{role:"user",content:K0(t)}];let o=!1;for await(let i of F.reportStreamChat(r))o||(n.call("clearHTML"),o=!0),n.call("appendHTML",vt(i).replace(/\n/g,"<br>"))}checkState(e){}}async function Bf(s,e){await s.isReady;const t=N.getLabsReportSetting();let a=s.blocks.getBlocksCount();const n=e==="ja"||e==="all",r=e==="en"||e==="all",o=so((t==null?void 0:t.company_name)||"",(t==null?void 0:t.content)||""),i=n?await dn("domestic"):[],u=r?await dn("foreign"):[];s.blocks.insert("paragraph",{text:"今日のパーソナルニュースの一覧を全て取得しました。全ての記事に対して、影響をスキャンします。"},{},a++),s.blocks.insert("callout",{text:`アシスタントが調査中...
`},{},a);const c=a;if(a++,i.length>0){s.blocks.insert("header",{text:"国内"},{},a++);const p=a;for(const m of i)a=await ln(s,m,a,o);a===p&&s.blocks.insert("callout",{text:"関係するニュースはありませんでした"},{},a)}if(u.length>0){s.blocks.insert("header",{text:"海外"},{},a++);const p=a;for(const m of u)a=await ln(s,m,a,o);a===p&&s.blocks.insert("callout",{text:"関係するニュースはありませんでした"},{},a)}s.blocks.delete(c),i.length===0&&u.length===0&&s.blocks.insert("callout",{text:"関係するニュースはありませんでした"},{},a)}const ln=async(s,e,t,a)=>{var i;if(/(セミナー)|(展示会)/.test(e.title))return t;const n={role:"system",content:a},r={role:"user",content:Y0(e.title)},o=[n,r];try{const u=await F.reportChat(o);u==="関係しない"||(s.blocks.insert("articleCard",{url:e.url,title:e.title,imageUrl:e.image_url,mediaName:e.media_name,publishedAt:oe(e.published_at).format("YYYY/MM/DD")},{},t++),s.blocks.insert("quote",{text:u.replaceAll(`
`,"<br>")},{},t++),s.blocks.insert("paragraph",{text:"&nbsp;"},{},t++))}catch(u){if(Je(u)&&((i=u.response)==null?void 0:i.status)===408)return t;throw u}return t},Sf=async(s,e)=>{const t=oe();return await F.getPersonalNews(s,t,e,200)},dn=async s=>{let e=1,t=0,a=[];do{const n=await Sf(s,e++);t=n.count,a=a.concat(n.articles)}while(t>a.length);return a};class If{constructor({data:e}){ge(this,"data");this.data=e}static get sanitize(){return{text:{br:!0}}}render(){const e=this.data.text?this.data.text:"",t=document.createElement("div");return t.classList.add("red"),t.innerHTML=e,t.contentEditable="true",t}save(e){return{text:e.innerHTML}}}const Mf=D({props:{data:{type:Object,required:!0},templateName:{type:String,default:""},langs:{type:String,default:"ja"},keyword:{type:String,default:""}},components:{ArticleSearchResult:Cf},setup(s,{emit:e}){const t=Ye();let a;const n=g(),r=g(""),o=g({blocks:[],title:"タイトルなし"}),i=l({get(){return o.value.title},set(d){o.value.title=d,e("update",o.value)}});Z(()=>s.data.id,d=>{a&&a.destroy(),o.value=s.data,i.value=o.value.title,a=new ni({logLevel:"ERROR",holder:n.value,autofocus:!0,tools:{paragraph:{inlineToolbar:!0,config:{preserveBlank:!0}},header:{class:ri,inlineToolbar:!0},callout:{class:kf,inlineToolbar:!0},quote:{class:Ff,inlineToolbar:!0},marker:Tt,AskAi:{class:Af,config:{title:i.value,gtag:t},inlineToolbar:!0},searchWithAi:{class:Tf,config:{gtag:t},inlineToolbar:!0},summarize:{class:Df,config:{gtag:t},inlineToolbar:!0},articleCard:{class:bf,inlineToolbar:!0},warningMessage:{class:If}},data:{blocks:o.value.blocks},onReady:()=>{new oi({editor:a,maxLength:100})},onChange:()=>{a&&a.save().then(_=>{o.value.blocks=_.blocks,e("update",o.value)})}}),s.templateName==="todayNews"?Bf(a,s.langs):s.templateName==="caseStudy"&&xf(a,s.keyword,s.langs)});const u=g(!1);return{title:i,editorjsRef:n,isOpenSearchResult:u,closeSearchResult:()=>{u.value=!1},search:d=>{u.value=!0,r.value=d.detail},searchQuery:r,articleInsert:async d=>{const _={title:d.title,url:d.url,imageUrl:d.image_url,mediaName:d.media_name,publishedAt:oe(d.published_at).format("YYYY/MM/DD")};a&&a.blocks.insert("articleCard",_)}}}});var $f=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"editor"},[t("div",{staticClass:"editor-header"},[t("div",{staticClass:"editor-title c-text c-text--m"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.title,expression:"title"}],domProps:{value:e.title},on:{input:function(a){a.target.composing||(e.title=a.target.value)}}})]),t("button",{staticClass:"c-btn c-btn--auto c-btnOutline small",on:{click:function(a){return e.$emit("delete")}}},[e._v(" 削除 ")])]),t("div",{staticClass:"editor-content"},[t("div",{ref:"editorjsRef",staticClass:"editorjs",on:{search:e.search}}),t("ArticleSearchResult",{directives:[{name:"show",rawName:"v-show",value:e.isOpenSearchResult,expression:"isOpenSearchResult"}],staticClass:"search-result",attrs:{query:e.searchQuery},on:{close:function(a){e.isOpenSearchResult=!1},articleInsert:e.articleInsert}})],1)])},Pf=[],Nf=T(Mf,$f,Pf,!1,null,"f6698ff7",null,null);const Lf=Nf.exports,Uf=D({components:{Editor:Lf},props:{templateName:{type:String,default:""},langs:{type:String,default:"ja"},keyword:{type:String,default:""}},setup(s,{emit:e}){const t=new zt,a=ie(),n=Te(),r=se(),o=N.getUserId(),i=g({title:"タイトルなし",blocks:[]});ne(async()=>{await t.init(o),i.value=await t.get(Number(a.params.reportId)),i.value===void 0&&n.push({name:"selectTemplate"})}),Z(()=>a.params.reportId,async()=>{a.params.reportId!==void 0&&(i.value=await t.get(Number(a.params.reportId)),i.value===void 0&&n.push({name:"selectTemplate"}))});const u=p=>{t.update(p),e("update")},c=async()=>{const m={headerText:"削除してよろしいですか？",bodyText:`このレポートを削除します。
削除したレポートは元に戻すことができません。`,action:async()=>{try{await t.delete(Number(a.params.reportId))}catch(d){throw r.commit("snackbar/addMessages",{message:"レポートを削除できませんでした",type:"error"}),d}r.commit("snackbar/addMessages",{message:"レポートを削除しました",type:""}),e("update"),n.push({name:"selectTemplate"})}};r.commit("confirmationModal/showConfirmationModal"),r.commit("confirmationModal/setTextAndAction",m)};return Be(()=>{t.close()}),{savedData:i,reportUpdate:u,reportDelete:c}}});var Rf=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("Editor",{attrs:{data:e.savedData,templateName:e.templateName,keyword:e.keyword,langs:e.langs},on:{update:e.reportUpdate,delete:e.reportDelete}})},Of=[],Gf=T(Uf,Rf,Of,!1,null,null,null,null);const qf=Gf.exports,Hf=D({setup(){const s=N.getUserId(),e=se(),t=Te(),a=Ye(),n=g(""),r=g(!0),o=g(!0),i=l(()=>r.value&&o.value?"all":r.value?"ja":o.value?"en":""),u=l(()=>n.value.length>0&&(r.value||o.value));return{targetText:n,isDomestic:r,isForeign:o,creatable:u,createReport:async()=>{Ge.trackCreateTemplate(a,"業界ごとの事例のレポート"),Ge.trackCreateTemplateKeyword(a,"業界ごとの事例のレポート",n.value);const d=new zt;await d.init(s);const _={title:`${n.value}の業界ごとの事例`,blocks:[{type:"header",data:{text:"業界ごとの事例"}},{type:"paragraph",data:{text:""}},{type:"warningMessage",data:{text:"すべての結果が表示されるまでに5分ほどかかります。また、β版のため内容が正しくない場合があります。"}},{type:"paragraph",data:{text:""}},{type:"paragraph",data:{text:"調査エージェントが、業界別の事例を順番に調査してまとめます。※終わるまで編集しないでください。"}}]};if((await d.getAll()).length>=vs){e.commit("snackbar/addMessages",{message:"レポートの作成数が上限に達しています",type:"error"});return}const v=await d.create(_);t.push({name:"savedReport",params:{reportId:v.toString(),templateName:"caseStudy",keyword:n.value,langs:i.value}})},toggleEnabledDomestic:d=>{r.value=d},toggleEnabledForeign:d=>{o.value=d}}}}),ro=""+new URL("labs_report_image-7cbc4426.png",import.meta.url).href;var Vf=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"case-study-template"},[t("div",{staticClass:"c-title c-title--l"},[e._v("業界ごとの事例のレポート")]),t("div",{staticClass:"spacing-32"}),t("div",{staticClass:"spacing-08"}),t("div",[e._v(" 知りたいこと、調べること、気になっていることに関する、業界ごとの事例を調査してレポートを生成します。 ")]),t("div",{staticClass:"spacing-16"}),e._m(0),t("div",[t("input",{directives:[{name:"model",rawName:"v-model",value:e.targetText,expression:"targetText"}],attrs:{placeholder:"例：プラスチックの再利用について"},domProps:{value:e.targetText},on:{input:function(a){a.target.composing||(e.targetText=a.target.value)}}})]),t("div",{staticClass:"spacing-16"}),t("div",{staticClass:"select-info-type"},[t("div",[e._v("どこまでの情報を含めますか？")]),t("div",{staticClass:"checkbox"},[t("sm-checkbox-label",{attrs:{value:e.isDomestic},on:{change:e.toggleEnabledDomestic}},[e._v("国内")])],1),t("div",{staticClass:"checkbox"},[t("sm-checkbox-label",{attrs:{value:e.isForeign},on:{change:e.toggleEnabledForeign}},[e._v("海外")])],1)]),t("div",{staticClass:"spacing-32"}),t("div",{staticClass:"spacing-08"}),t("div",{staticClass:"c-title c-title--m"},[e._v("エージェントが実行するタスク")]),t("div",{staticClass:"spacing-08"}),e._m(1),t("div",{staticClass:"spacing-32"}),t("div",{staticClass:"spacing-08"}),t("button",{staticClass:"c-btn c-btn--auto c-btn--labs",class:{disabled:!e.creatable},attrs:{disabled:!e.creatable},on:{click:e.createReport}},[e._v(" レポートを生成する ")]),e._m(2)])},jf=[function(){var s=this,e=s._self._c;return s._self._setupProxy,e("div",[e("label",{staticClass:"c-title c-title--m"},[s._v(" 知りたいこと、調べること、気になっていること ")])])},function(){var s=this,e=s._self._c;return s._self._setupProxy,e("div",[e("div",[s._v("1. 業界の事例を検索します")]),e("div",[s._v(" 2.業種ごとに事例を分けて、業界の動き、自社業界との関連、具体事例をまとめます ")]),e("div",[s._v("3.関連のある記事情報を列挙してレポートにします")])])},function(){var s=this,e=s._self._c;return s._self._setupProxy,e("div",{staticClass:"template-image"},[e("img",{attrs:{src:ro}})])}],Kf=T(Hf,Vf,jf,!1,null,null,null,null);const Yf=Kf.exports,Qf=D({setup(){const s=se(),e=Te(),t=Ye(),a=N.getUserId(),n=g(!0),r=g(!0),o=l(()=>n.value&&r.value?"all":n.value?"ja":r.value?"en":""),i=m=>{n.value=m},u=m=>{r.value=m},c=l(()=>n.value||r.value);return{isDomestic:n,isForeign:r,creatable:c,createReport:async()=>{Ge.trackCreateTemplate(t,"今日のニュース解説");const m=new zt;await m.init(a);const d=oe(),_={title:`今日のニュース解説 ${d.format("YYYY/MM/DD")}`,blocks:[{type:"header",data:{text:`今日のニュース解説 ${d.format("YYYY/MM/DD")}`}},{type:"paragraph",data:{text:""}},{type:"warningMessage",data:{text:"すべての結果が表示されるまでに3分ほどかかります。また、β版のため内容が正しくない場合があります。"}},{type:"paragraph",data:{text:""}},{type:"paragraph",data:{text:`調査アシスタントが今日(${d.format("MM/DD")})の情報を調査してまとめます。※終わるまで編集しないでください。`}},{type:"paragraph",data:{text:""}}]};if((await m.getAll()).length>=vs){s.commit("snackbar/addMessages",{message:"レポートの作成数が上限に達しています",type:"error"});return}const v=await m.create(_);e.push({name:"savedReport",params:{reportId:v.toString(),templateName:"todayNews",langs:o.value}})},toggleEnabledDomestic:i,toggleEnabledForeign:u}}});var Wf=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"today-news-template"},[t("div",{staticClass:"c-title c-title--l"},[e._v("今日のニュース解説")]),t("div",{staticClass:"spacing-32"}),t("div",{staticClass:"spacing-08"}),t("div",[e._v(" 今日配信されたニュース(国内・海外)から自分に影響がある情報を解説します。 ")]),t("div",{staticClass:"spacing-16"}),t("div",{staticClass:"select-info-type"},[t("div",[e._v("どこまでの情報を含めますか？")]),t("div",{staticClass:"checkbox"},[t("sm-checkbox-label",{attrs:{value:e.isDomestic},on:{change:e.toggleEnabledDomestic}},[e._v("国内")])],1),t("div",{staticClass:"checkbox"},[t("sm-checkbox-label",{attrs:{value:e.isForeign},on:{change:e.toggleEnabledForeign}},[e._v("海外")])],1)]),t("div",{staticClass:"spacing-32"}),t("div",{staticClass:"spacing-08"}),t("div",{staticClass:"c-title c-title--m"},[e._v("エージェントが実行するタスク")]),t("div",{staticClass:"spacing-08"}),e._m(0),t("div",{staticClass:"spacing-32"}),t("div",{staticClass:"spacing-08"}),t("button",{staticClass:"c-btn c-btn--auto c-btn--labs",class:{disabled:!e.creatable},attrs:{disabled:!e.creatable},on:{click:e.createReport}},[e._v(" レポートを生成する ")]),e._m(1)])},zf=[function(){var s=this,e=s._self._c;return s._self._setupProxy,e("div",[e("div",[s._v("1.今日のパーソナルニュースの一覧を全て取得します")]),e("div",[s._v("2.全ての記事に対して、影響をスキャンします")]),e("div",[s._v("3.影響のありそうな国内の記事を解説します")]),e("div",[s._v("4.影響のありそうな海外の記事を解説します")])])},function(){var s=this,e=s._self._c;return s._self._setupProxy,e("div",{staticClass:"template-image"},[e("img",{attrs:{src:ro}})])}],Jf=T(Qf,Wf,zf,!1,null,null,null,null);const Xf=Jf.exports,Zf=D({props:{title:{type:String,required:!0},description:{type:String,required:!0}},setup(s,{emit:e}){return{select:()=>{e("select")}}}});var eg=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"option-card",on:{click:e.select}},[t("div",{staticClass:"card-header"},[t("div",{staticClass:"left-icon"},[t("sm-icons",[e._v("file-v")])],1),t("div",{staticClass:"card-title c-text c-text--m"},[e._v(e._s(e.title))]),t("div",[t("sm-icons",[e._v("chevron-right")])],1)]),t("div",{staticClass:"card-description c-text c-text--m"},[e._v(e._s(e.description))])])},tg=[],sg=T(Zf,eg,tg,!1,null,"2208e7be",null,null);const ag=sg.exports,ng=D({components:{TemplateOptionCard:ag},setup(){const s=N.getUserId(),e=new zt,t=Te(),a=se(),n=Ye(),r=async()=>{await e.init(s);const o={title:"タイトルなし",blocks:[{type:"paragraph",data:{text:`ここは自分にしか見えないメモです。
知りたいこと、調べること、気になっていることなど調査の作業用ノートとして自由に残してください。`}},{type:"warningMessage",data:{text:"注意：機密情報や個人情報を入れないでください。<br>データは暗号通信によって保護されており、チャットデータがモデルのトレーニングに使用されることはありません。"}},{type:"paragraph",data:{text:"💡使い方Tips： 記載した文字を選択して「AIに聞く🪄」を実行すると、選択した箇所についての情報を収集します。"}}]};if((await e.getAll()).length>=vs){a.commit("snackbar/addMessages",{message:"レポートの作成数が上限に達しています",type:"error"});return}const u=await e.create(o);Ge.trackCreateTemplate(n,"白紙のレポート"),await t.push({name:"savedReport",params:{reportId:u.toString()}})};return Be(()=>{e.close()}),{createPlainReport:r}}});var rg=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"select-template"},[t("div",{staticClass:"c-title c-title--l"},[e._v("レポートの目的を教えてください")]),t("div",{staticClass:"spacing-16"}),t("div",{staticClass:"spacing-08"}),t("div",{staticClass:"spacing-04"}),e._m(0),t("div",{staticClass:"spacing-16"}),t("div",{staticClass:"spacing-04"}),t("div",{staticClass:"c-text c-text--m warning-message"},[e._v(" Stockmark Labs は実験的な機能をトライアルする場であり、ここにある機能は変更・中断・提供中止される可能性があります。またデータの正確性・可用性・完全性・特定目的の適合性を保証するものではありません。 ")]),t("div",{staticClass:"spacing-16"}),t("div",{staticClass:"spacing-08"}),t("div",{staticClass:"spacing-04"}),e._m(1),t("div",{staticClass:"spacing-16"}),t("div",{staticClass:"templates"},[t("router-link",{attrs:{to:{name:"caseStudyTemplate"}}},[t("TemplateOptionCard",{attrs:{title:"業界ごとの事例のレポート",description:"知りたいこと、調べること、気になっていることに関する、業界ごとの事例を調査してレポートを生成します。"}})],1),t("router-link",{attrs:{to:{name:"todayNewsTemplate"}}},[t("TemplateOptionCard",{attrs:{title:"今日のニュース解説",description:"今日配信されたニュース（国内・海外）から自分に影響がある情報を解説します"}})],1),t("TemplateOptionCard",{attrs:{title:"白紙のレポート",description:"自由に記述できる白紙のレポートです。"},on:{select:e.createPlainReport}})],1)])},og=[function(){var s=this,e=s._self._c;return s._self._setupProxy,e("div",{staticClass:"c-text c-text--m warning-message"},[s._v(" ご利用前に必ず"),e("a",{attrs:{href:"https://stockmark.notion.site/df60e86794784d2fa54412cc3f6a6edb",target:"_blank",rel:"noopener"}},[s._v("注意事項")]),s._v("をお読みください。 ")])},function(){var s=this,e=s._self._c;return s._self._setupProxy,e("div",{staticClass:"c-text c-text--xm"},[s._v(" 知りたいこと、調べること、気になっていることをもとに、調査レポートを生成します。"),e("br"),s._v(" 依頼テンプレートまたは白紙を選択してください。 ")])}],ig=T(ng,rg,og,!1,null,"79781ea3",null,null);const ug=ig.exports,cg=D({setup(){return{userAgent:window.navigator.userAgent}}}),oo=""+new URL("logo_stockmark-1f84da01.png",import.meta.url).href;var lg=function(){var e=this,t=e._self._c;return e._self._setupProxy,e.userAgent.startsWith("Anews/")?e._e():t("div",{staticClass:"p-account-footer"},[e._m(0)])},dg=[function(){var s=this,e=s._self._c;return s._self._setupProxy,e("div",{staticClass:"p-account-footer-content"},[e("a",{attrs:{href:"https://stockmark.co.jp/",target:"_blank"}},[e("img",{staticClass:"p-logo-stockmark",attrs:{src:oo}})]),e("div",{staticClass:"p-footer-links"},[e("a",{staticClass:"p-about-company c-title c-title--m",attrs:{href:"https://stockmark.co.jp/company/",target:"_blank"}},[s._v("会社概要")]),e("a",{staticClass:"p-about-anews c-title c-title--m",attrs:{href:"https://stockmark.co.jp/product/anews/",target:"_blank"}},[s._v("Anewsについて")])])])}],mg=T(cg,lg,dg,!1,null,"f10a5645",null,null);const _g=mg.exports,pg=D({}),Bt=""+new URL("logo_anews-c925cad2.png",import.meta.url).href;var vg=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"p-account-header"},[e.$route.meta.type==="account"?t("img",{staticClass:"p-anews-logo",attrs:{src:Bt}}):t("a",{attrs:{href:"/"}},[t("img",{staticClass:"p-anews-logo",attrs:{src:Bt}})]),t("div",{staticClass:"p-user-menu"},[t("a",{staticClass:"p-help-menu",attrs:{href:"https://anews-stockmark.zendesk.com/hc/ja",target:"_blank"}},[t("sm-icons",{staticClass:"p-icon"},[e._v("question-circle")]),t("div",{staticClass:"p-help-text c-text c-text--m"},[e._v("ヘルプ")])],1)])])},fg=[],gg=T(pg,vg,fg,!1,null,"354cfd0e",null,null);const hg=gg.exports,yg=D({components:{AccountHeader:hg,AccountFooter:_g},setup(){return{userAgent:window.navigator.userAgent}}});var Cg=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"p-account"},[t("AccountHeader"),t("div",{staticClass:"p-account-body"},[t("router-view")],1),t("AccountFooter")],1)},bg=[],Ag=T(yg,Cg,bg,!1,null,"675045e1",null,null);const io=Ag.exports,kg=D({props:{users:{type:Array,required:!0},isInitiallyOpen:{type:Boolean,default:!0},isOwnUserIncluded:{type:Boolean,default:!1}},setup(s,e){const t=g(""),a=g();ne(()=>{var i,u;(i=a.value)==null||i.addEventListener("select-item",n),o(),s.isInitiallyOpen&&((u=a.value)==null||u.focus())}),Be(()=>{var i;(i=a.value)==null||i.removeEventListener("select-item",n)});const n=i=>{e.emit("select-item",i.detail),t.value="",o()},r=l(()=>{const i=N.getUserId();return s.users.filter(c=>s.isOwnUserIncluded||c.id!==i).map(c=>({textInCandidateList:`${c.user_name} ${c.email}`,textInComment:c.user_name,iconName:"user",type:"user",id:c.id}))}),o=async()=>{if(s.users.length===0)return;const i={isOpen:!0,disableTextInput:!0},u=document.getElementById("mention-list-mount-point");u&&a.value&&new Gr(a.value,u,[],r.value,0,i)};return{inputUserNameArea:a,trimmedUserName:t}}});var xg=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"m-user-autocomplete-textarea"},[t("div",{staticClass:"m-highlight-and-textarea"},[t("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.trimmedUserName,expression:"trimmedUserName",modifiers:{trim:!0}}],ref:"inputUserNameArea",staticClass:"m-user-input c-text c-text--m",attrs:{id:"textarea",placeholder:"メンバーを検索して追加"},domProps:{value:e.trimmedUserName},on:{input:function(a){a.target.composing||(e.trimmedUserName=a.target.value.trim())},blur:function(a){return e.$forceUpdate()}}}),t("div",{staticClass:"mention-list-mount-point",attrs:{id:"mention-list-mount-point"}})])])},wg=[],Eg=T(kg,xg,wg,!1,null,"90bfab0a",null,null);const uo=Eg.exports,Fg=D({components:{UserSelectTextarea:uo},setup(){var v;const s=se(),e=fe(),t=(v=s.state.modal.group)==null?void 0:v.id,a=s.state.modal.currentAdmins,n=()=>{s.commit("modal/hideModal")},{data:r,state:o}=Qe(),i=l(()=>{var f;return((f=r.value)==null?void 0:f.users.filter(C=>C.is_deleted===!1&&["admin","group_admin"].includes(C.role)))??[]}),u=l(()=>o.value===be.SUCCESS),c=Fe({list:[]}),p=l(()=>c.list.length>0),m=g(!1),d=f=>{var y;const C=(y=i.value)==null?void 0:y.find(A=>A.id===f.id);C&&!c.list.find(A=>A.id===(C==null?void 0:C.id))&&c.list.push(C)},_=f=>{c.list=c.list.filter(C=>C.id!==f)};return Z(()=>o.value,()=>{u.value&&a.forEach(f=>{var y;const C=(y=r.value)==null?void 0:y.users.find(A=>A.id===f.id);C&&d(C)})}),{adminUsers:i,isLoaded:u,isSaveEnabled:p,isSaving:m,hideModal:n,selectUser:d,removeUser:_,selectedUsers:c,save:async()=>{m.value=!0;const f=c.list.map(k=>k.id),C=a.map(k=>k.id),y=C.filter(k=>!f.includes(k)),A=f.filter(k=>!C.includes(k));try{A.length>0&&await F.createGroupInvitation(t,A);for(let k=0;k<y.length;k++)await F.leaveGroup(t,y[k]);e.$emit("group-admins-updated",{groupId:t,admins:c.list}),s.commit("snackbar/addMessages",{message:"保存しました",type:""}),n()}catch(k){throw s.commit("snackbar/addMessages",{message:"保存できませんでした",type:"error"}),k}m.value=!1}}}});var Tg=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"o-group-admin-edit"},[e.isLoaded?t("sm-dialog",{staticClass:"auto-height auto-width",on:{close:e.hideModal},scopedSlots:e._u([{key:"header",fn:function(){return[t("div",{staticClass:"o-header c-text c-text--m"},[e._v("グループ管理者編集")])]},proxy:!0},{key:"body",fn:function(){return[t("div",{staticClass:"o-body c-text c-text--m"},[t("div",{staticClass:"o-user-name"},[t("div",{staticClass:"o-user-name-text"},[e._v("名前、メールアドレスで検索")]),t("UserSelectTextarea",{staticClass:"o-user-name-input",attrs:{users:e.adminUsers,isInitiallyOpen:e.selectedUsers.list.length===0,isOwnUserIncluded:!0},on:{"select-item":e.selectUser}}),t("div",{staticClass:"spacing-16"}),t("div",{staticClass:"tag-field"},e._l(e.selectedUsers.list,function(a){return t("div",{key:a.id,staticClass:"o-user-name-tag c-tag c-tag--delete"},[t("span",{staticClass:"c-text c-text--m"},[e._v(e._s(a.user_name))]),t("sm-icons",{on:{click:function(n){return e.removeUser(a.id)}}},[e._v("times-white")])],1)}),0)],1)])]},proxy:!0},{key:"footer",fn:function(){return[t("div",{staticClass:"o-footer c-text c-text--m"},[t("button",{staticClass:"o-cancel-button c-btn c-btn--auto c-btnOutline",on:{click:e.hideModal}},[e._v(" キャンセル ")]),t("button",{staticClass:"o-create-button c-btn c-btn--auto c-btn--AnewsPrimary",class:{disabled:!e.isSaveEnabled||e.isSaving},attrs:{disabled:!e.isSaveEnabled||e.isSaving},on:{click:e.save}},[e._v(" 保存 ")])])]},proxy:!0}],null,!1,6627154)}):e._e()],1)},Dg=[],Bg=T(Fg,Tg,Dg,!1,null,"06097aab",null,null);const Sg=Bg.exports,Ig=""+new URL("spinner-cdb761d2.svg",import.meta.url).href,Mg=D({__name:"loadable-button",props:{isLoading:{type:Boolean}},setup(s){return{__sfc:!0,props:s,spinner:Ig}}});var $g=function(){var e=this,t=e._self._c,a=e._self._setupProxy;return t("button",e._g(e._b({},"button",e.$attrs,!1),e.$listeners),[e.isLoading?t("span",{staticClass:"spinner-wrapper"},[t("img",{staticClass:"spinner",attrs:{src:a.spinner}})]):e._e(),t("span",{class:{hidden:e.isLoading}},[e._t("default")],2)])},Pg=[],Ng=T(Mg,$g,Pg,!1,null,"eb81e371",null,null);const Jt=Ng.exports;oe.extend(ii);const Lg=D({components:{LoadableButton:Jt},setup(){var ue,_e,me,de,ee;const s=Te(),e=se(),{data:t}=xe(),{data:a}=bt(),n=g(e.state.userEditModal.type??"create"),r=g(e.state.userEditModal.targetUserInfo),{mutate:o}=jt(),i=g(!1),u=g(((ue=r.value)==null?void 0:ue.email)??""),c=g(((_e=r.value)==null?void 0:_e.user_name)??""),p=g(((me=r.value)==null?void 0:me.role)??"viewer"),m=g(((de=r.value)==null?void 0:de.product_contract_id)??null),d=g(((ee=r.value)==null?void 0:ee.org_department)??""),_=Fe({users:[]}),h=g(!1),v=new Map([["admin","管理者"],["group_admin","グループ管理者"],["editor","編集者"],["viewer","閲覧者"]]),f=l(()=>{var J;return(J=a.value)==null?void 0:J.management_contracts.filter(ce=>{const ke=oe();return oe(ce.end_date).isSameOrAfter(ke,"day")&&ce.product_contract_id!==null})}),C=l(()=>{var ce;let J=new Map([]);return(ce=f.value)==null||ce.forEach(ke=>{J.set(ke.product_contract_id,ke.contract_name)}),J}),y=g(!1),A=g(!1);Z(()=>c.value,()=>A.value=!0);const k=async()=>{var J;((J=t.value)==null?void 0:J.role)==="admin"&&(await e.dispatch("teamUsers/fetchTeamUsersForAdmin"),_.users=e.getters["teamUsers/activeTeamUsersForAdmin"])},S=async()=>{var J;((J=t.value)==null?void 0:J.role)!=="admin"&&(s.push({name:"anewsHome"}),e.commit("snackbar/addMessages",{message:"権限がありません",type:"error"}))};Z(()=>{var J;return(J=t.value)==null?void 0:J.id},async()=>{await S(),await k()}),ne(async()=>{await S(),await k(),window.addEventListener("click",K)}),Be(()=>{window.removeEventListener("click",K)});const b=l(()=>n.value==="create"?"メンバーの追加":n.value==="edit"?"メンバーの編集":""),U=l(()=>n.value==="create"?"追加":n.value==="edit"?"保存":""),I=({value:J})=>{p.value=J},w=({value:J})=>{m.value=J},x=l(()=>c.value.length===0),B=l(()=>u.value===""?!1:!RegExp(".*@.+").test(u.value)),$=l(()=>c.value.length>ji),P=l(()=>u.value&&!x.value&&!B.value&&m.value&&!$.value||i.value),M=()=>e.commit("userEditModal/hideUserEditModal"),O=async()=>{P.value&&(x.value||i.value||(i.value=!0,r.value===void 0?await Y():await W(),i.value=!1))},Y=async()=>{var J,ce;try{await F.createUser(u.value,c.value,p.value,d.value,m.value)}catch(ke){if(Je(ke)){if(((J=ke.response)==null?void 0:J.data.type)==="email_exists"){y.value=!1,e.commit("snackbar/addMessages",{message:"同じメールアドレスのユーザーが既に存在します",type:"error"});return}if(((ce=ke.response)==null?void 0:ce.data.type)==="already_deleted"){y.value=!0;return}}throw y.value=!1,e.commit("snackbar/addMessages",{message:"メンバーを追加できませんでした",type:"error"}),i.value=!1,ke}e.commit("snackbar/addMessages",{message:"メンバーを追加しました",type:""}),await k(),M(),o()},W=async()=>{var J;if(r.value){try{await F.updateUser(r.value.id,u.value,c.value,p.value,d.value,m.value),e.commit("snackbar/addMessages",{message:"メンバーの設定を更新しました",type:""})}catch(ce){throw e.commit("snackbar/addMessages",{message:Je(ce)&&((J=ce.response)==null?void 0:J.status)===400?"同じメールアドレスのユーザーが既に存在します":"メンバー情報を更新できませんでした",type:"error"}),i.value=!1,ce}e.commit("snackbar/addMessages",{message:"メンバーの設定を更新しました",type:""}),await k(),M(),o()}},j=()=>h.value=!0,K=()=>h.value=!1,le=J=>{J&&J.length>0&&(d.value=J),K()},ye=l(()=>Array.from(new Set(_.users.map(J=>J.org_department).filter(J=>J&&J.length>0))).sort((J,ce)=>J.localeCompare(ce))),H=l(()=>ye.value.filter(J=>d.value.length===0||J.includes(d.value)));return{trimmedMailAddress:u,displayName:c,role:p,displayOrgDepartment:d,headerText:b,buttonText:U,selectRole:I,targetUserInfo:r,notIncludingAt:B,hasNameChanged:A,isEmptyName:x,tooLongName:$,activeTeamUsersForAdmin:_,isDepartmentListVisible:h,roleMap:v,enableToEdit:P,editUser:O,hideUserEditModal:M,showList:j,setItem:le,filteredDepartmentList:H,isEditing:i,hasDeletedUserError:y,selectableContractsMap:C,selectContract:w,productContractId:m}}});var Ug=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"m-user-edit-modal"},[t("sm-dialog",{staticClass:"screen-center",on:{close:e.hideUserEditModal},scopedSlots:e._u([{key:"header",fn:function(){return[t("div",{staticClass:"c-dialog__title"},[e._v(e._s(e.headerText))])]},proxy:!0},{key:"body",fn:function(){return[t("div",{staticClass:"m-body"},[e.hasDeletedUserError?t("div",{staticClass:"deleted-user-error-message c-text c-text--m"},[e._v(" 削除済みユーザーはこの画面から追加することができません。お手数ですがサポート担当までご連絡ください。 ")]):e._e(),t("div",{staticClass:"c-formBlock"},[t("div",{staticClass:"c-formBlock__label"},[e._v("メールアドレス")]),e.notIncludingAt?t("div",{staticClass:"c-formBlock__text c-formBlock__text--error"},[t("pre",{staticClass:"c-text--s"},[e._v("メールアドレスを入力してください。")])]):e._e(),t("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.trimmedMailAddress,expression:"trimmedMailAddress",modifiers:{trim:!0}}],ref:"mailAddressArea",staticClass:"m-input c-text c-text--m c-textInput",class:{"c-formInput--error":e.notIncludingAt},domProps:{value:e.trimmedMailAddress},on:{keydown:[function(a){return!a.type.indexOf("key")&&e._k(a.keyCode,"enter",13,a.key,"Enter")||!a.ctrlKey?null:e.editUser.apply(null,arguments)},function(a){return!a.type.indexOf("key")&&e._k(a.keyCode,"enter",13,a.key,"Enter")||!a.metaKey?null:e.editUser.apply(null,arguments)}],input:function(a){a.target.composing||(e.trimmedMailAddress=a.target.value.trim())},blur:function(a){return e.$forceUpdate()}}})]),t("div",{staticClass:"c-formBlock"},[t("div",{staticClass:"c-formBlock__label"},[e._v("名前")]),e.tooLongName?t("div",{staticClass:"c-formBlock__text c-formBlock__text--error"},[t("pre",{staticClass:"c-text--s"},[e._v("名前は50文字以内で入力してください。")])]):e._e(),e.hasNameChanged&&e.isEmptyName?t("div",{staticClass:"c-formBlock__text c-formBlock__text--error"},[t("pre",{staticClass:"c-text--s"},[e._v("名前が空欄です。")])]):e._e(),t("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.displayName,expression:"displayName",modifiers:{trim:!0}}],ref:"nameArea",staticClass:"m-input c-text c-text--m c-textInput",class:{"c-formInput--error":e.tooLongName||e.hasNameChanged&&e.isEmptyName},domProps:{value:e.displayName},on:{keydown:[function(a){return!a.type.indexOf("key")&&e._k(a.keyCode,"enter",13,a.key,"Enter")||!a.ctrlKey?null:e.editUser.apply(null,arguments)},function(a){return!a.type.indexOf("key")&&e._k(a.keyCode,"enter",13,a.key,"Enter")||!a.metaKey?null:e.editUser.apply(null,arguments)}],input:function(a){a.target.composing||(e.displayName=a.target.value.trim())},blur:function(a){return e.$forceUpdate()}}})]),t("div",{staticClass:"c-formBlock"},[t("div",{staticClass:"c-formBlock__label"},[e._v("契約")]),t("sm-selectbox",{key:e.targetUserInfo?e.targetUserInfo.product_contract_id:void 0,staticClass:"m-contract",attrs:{label:e.selectableContractsMap.get(e.productContractId),labels:Array.from(e.selectableContractsMap.values()),values:Array.from(e.selectableContractsMap.keys())},on:{selected:e.selectContract}})],1),t("div",{staticClass:"c-formBlock"},[t("div",{staticClass:"c-formBlock__label"},[e._v("所属部署")]),t("div",{staticClass:"department-input"},[t("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.displayOrgDepartment,expression:"displayOrgDepartment",modifiers:{trim:!0}}],ref:"inputTag",staticClass:"m-input c-text c-text--m c-textInput",attrs:{type:"text",placeholder:""},domProps:{value:e.displayOrgDepartment},on:{click:function(a){return a.stopPropagation(),a.preventDefault(),(()=>{}).apply(null,arguments)},focus:e.showList,input:function(a){a.target.composing||(e.displayOrgDepartment=a.target.value.trim())},blur:function(a){return e.$forceUpdate()}}}),e.isDepartmentListVisible&&e.filteredDepartmentList.length>0?t("div",{staticClass:"department-list"},e._l(e.filteredDepartmentList,function(a){return t("div",{key:a,staticClass:"item c-text c-text--m",on:{click:function(n){return e.setItem(a)}}},[e._v(" "+e._s(a)+" ")])}),0):e._e()])]),t("div",{staticClass:"c-formBlock"},[t("div",{staticClass:"c-formBlock__label"},[e._v("権限")]),t("sm-selectbox",{key:e.targetUserInfo?e.targetUserInfo.role:void 0,staticClass:"m-role",attrs:{label:e.roleMap.get(e.role),labels:Array.from(e.roleMap.values()),values:Array.from(e.roleMap.keys())},on:{selected:e.selectRole}})],1)])]},proxy:!0},{key:"footer",fn:function(){return[t("div",{staticClass:"m-footer"},[t("div",{staticClass:"m-footer-buttons"},[t("button",{staticClass:"m-cancel-button c-btn c-btn--auto c-btnOutline",on:{click:e.hideUserEditModal}},[e._v(" キャンセル ")]),t("LoadableButton",{staticClass:"m-create-button c-btn c-btn--auto c-btn--AnewsPrimary",class:{disabled:!e.enableToEdit},attrs:{disabled:!e.enableToEdit,isLoading:e.isEditing},on:{click:e.editUser}},[e._v(" "+e._s(e.buttonText)+" ")])],1)])]},proxy:!0}])})],1)},Rg=[],Og=T(Lg,Ug,Rg,!1,null,"e96def55",null,null);const Gg=Og.exports,qg=D({components:{},setup(s,e){const t=Te(),a=se(),n=fe(),r=g(""),o=g(""),i=g(),{data:u,mutate:c}=Pe();ne(()=>{var v;return(v=i.value)==null?void 0:v.focus()});const p=l(()=>r.value.length>rs),m=l(()=>o.value.length>os),d=l(()=>r.value.length>0&&!p.value&&!m.value),_=()=>{a.commit("modal/hideModal"),n.$emit("close-modal")};return{trimmedGroupName:r,trimmedGroupDesc:o,createEnable:d,hideModal:_,tooLongGroupName:p,tooLongGroupDesc:m,createGroup:async()=>{if(d.value)try{if(await F.createGroup(r.value,o.value),await c(),_(),u.value){const v=Dt(u.value.groups,"created_at","desc").find(f=>f.name===r.value);t.push(`/groups/${(v==null?void 0:v.id)??void 0}`)}else t.push("/groups");a.commit("snackbar/addMessages",{message:"グループを作成しました",type:""})}catch{a.commit("snackbar/addMessages",{message:"グループを作成できませんでした",type:"error"})}},MAX_GROUP_NAME_LENGTH:rs,MAX_GROUP_DESCRIPTION_LENGTH:os,groupNameInput:i}}});var Hg=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"o-group-create"},[t("sm-dialog",{staticClass:"auto-height auto-width screen-center",on:{close:e.hideModal},scopedSlots:e._u([{key:"header",fn:function(){return[t("div",{staticClass:"o-header c-text c-text--m"},[e._v("グループを新しく作成")])]},proxy:!0},{key:"body",fn:function(){return[t("div",{staticClass:"o-body c-text c-text--m"},[t("div",{staticClass:"o-group-name"},[t("div",{staticClass:"o-group-name-text"},[e._v("グループ名")]),t("div",{directives:[{name:"show",rawName:"v-show",value:e.tooLongGroupName,expression:"tooLongGroupName"}],staticClass:"o-error c-formBlock__text c-formBlock__text--error"},[e._v(" グループ名は"+e._s(e.MAX_GROUP_NAME_LENGTH)+"文字以内で入力してください。 ")]),t("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.trimmedGroupName,expression:"trimmedGroupName",modifiers:{trim:!0}}],ref:"groupNameInput",staticClass:"o-group-name-input c-text c-text--m c-textInput",class:{"c-formInput--error":e.tooLongGroupName,"m-normal-text-area":!e.tooLongGroupName},domProps:{value:e.trimmedGroupName},on:{keydown:[function(a){return!a.type.indexOf("key")&&e._k(a.keyCode,"enter",13,a.key,"Enter")||!a.ctrlKey?null:e.createGroup.apply(null,arguments)},function(a){return!a.type.indexOf("key")&&e._k(a.keyCode,"enter",13,a.key,"Enter")||!a.metaKey?null:e.createGroup.apply(null,arguments)}],input:function(a){a.target.composing||(e.trimmedGroupName=a.target.value.trim())},blur:function(a){return e.$forceUpdate()}}})]),t("div",{staticClass:"o-group-desc"},[t("div",{staticClass:"o-group-desc-text"},[e._v("グループの説明")]),t("div",{directives:[{name:"show",rawName:"v-show",value:e.tooLongGroupDesc,expression:"tooLongGroupDesc"}],staticClass:"o-error c-formBlock__text c-formBlock__text--error"},[e._v(" グループの説明は"+e._s(e.MAX_GROUP_DESCRIPTION_LENGTH)+"文字以内で入力してください。 ")]),t("textarea",{directives:[{name:"model",rawName:"v-model.trim",value:e.trimmedGroupDesc,expression:"trimmedGroupDesc",modifiers:{trim:!0}}],staticClass:"o-group-desc-input c-text c-text--m c-textArea",class:{"c-formInput--error":e.tooLongGroupDesc,"m-normal-text-area":!e.tooLongGroupDesc},domProps:{value:e.trimmedGroupDesc},on:{keydown:[function(a){return!a.type.indexOf("key")&&e._k(a.keyCode,"enter",13,a.key,"Enter")||!a.ctrlKey?null:e.createGroup.apply(null,arguments)},function(a){return!a.type.indexOf("key")&&e._k(a.keyCode,"enter",13,a.key,"Enter")||!a.metaKey?null:e.createGroup.apply(null,arguments)}],input:function(a){a.target.composing||(e.trimmedGroupDesc=a.target.value.trim())},blur:function(a){return e.$forceUpdate()}}})])])]},proxy:!0},{key:"footer",fn:function(){return[t("div",{staticClass:"o-footer c-text c-text--m"},[t("button",{staticClass:"o-cancel-button c-btn c-btn--auto c-btnOutline",on:{click:e.hideModal}},[e._v(" キャンセル ")]),t("button",{staticClass:"o-create-button c-btn c-btn--auto c-btn--AnewsPrimary",class:{disabled:!e.createEnable},attrs:{disabled:!e.createEnable},on:{click:e.createGroup}},[e._v(" 作成 ")])])]},proxy:!0}])})],1)},Vg=[],jg=T(qg,Hg,Vg,!1,null,"2cf5f523",null,null);const Kg=jg.exports,co=(s,e)=>{let t=null;return(...a)=>{t&&window.clearTimeout(t),t=window.setTimeout(()=>{s(...a)},e)}},mn=s=>s instanceof Array?[...s]:typeof s=="object"?{...s}:s,ls=(s,e)=>{const t=g(mn(s.value));return Z(s,co(a=>{t.value=mn(a)},e)),t},Yg=s=>{const e=/([.+*?^$()[\]{}|\\])/g;return s.replace(e,"\\$&")},Qg=40,Wg=5,zg=D({model:{event:"input",prop:"value"},props:{value:{type:String,default:""}},setup(s,e){const t=g(s.value);Z(()=>s.value,I=>t.value=I);const a=g(void 0),n=l(()=>a.value??t.value),r=g(-1),o=()=>{a.value=void 0,r.value=-1},i=ls(l(()=>({text:n.value})),su),{data:u,isValidating:c}=al(i),p=l(()=>u.value===void 0?[]:u.value.candidates.filter(I=>I.text!==n.value).map(I=>{const w=new RegExp("("+Yg(n.value)+")","i"),x=I.text.split(w).filter(B=>B.trim()!=="");return{keyword:I.text,splitKeywords:[x[0],x.slice(1).join("")],score:I.score}}).sort((I,w)=>w.score-I.score)),m=l(()=>`${Math.min(p.value.length,Wg)*Qg}px`);Z(c,I=>{I&&o()});const d=g(!1),_=I=>{if(!I.target)return;const w=I.target.value;d.value=w.trim()!=="",t.value=w,o(),e.emit("input",w)},h=()=>{d.value=t.value.trim()!==""},v=g(),f=()=>{setTimeout(()=>{d.value=!1,o(),v.value&&(v.value.scrollTop=0)},200)};let C=!1;const y=()=>{C=!0},A=()=>{C=!1},k=g(),S=I=>{var w;if(!C)switch(I.key){case"ArrowDown":case"ArrowUp":{I.preventDefault(),a.value===void 0&&(a.value=t.value);let x=r.value;I.key==="ArrowDown"?(x++,x>=p.value.length&&(x=-1)):(x--,x<-1&&(x=p.value.length-1)),r.value=x,x===-1?t.value=a.value:(t.value=p.value[x].keyword,(w=k.value)==null||w[x].scrollIntoView({block:"nearest"}))}break;case"Enter":I.preventDefault(),r.value>=0?U(p.value[r.value].keyword,r.value):U(t.value,-1);break;case"Escape":I.preventDefault(),d.value=!1;break}},b=ie(),U=async(I,w)=>{const x=n.value;if(d.value=!1,t.value=I,o(),e.emit("input",I),e.emit("select",I),w>=0){const B={pageName:b.name??"",pageUrl:b.fullPath,keywords:[I],input_text:x,themeId:b.params.themeId?Number(b.params.themeId):void 0,rank:w+1};await F.trackAutocompleteEvent(B)}};return{inputValue:t,completions:p,dropdownHeight:m,isEditing:d,dropdownRef:v,focusIndex:r,buttonRefs:k,select:U,handlers:{input:_,focus:h,blur:f,compositionstart:y,compositionend:A,keydown:S}}}});var Jg=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",[e._t("default",function(){return[t("input",e._g({staticClass:"c-text c-text--m c-textInput",domProps:{value:e.inputValue}},e.handlers))]},{value:e.inputValue,handlers:e.handlers}),t("div",{staticClass:"dropdown-anchor"},[t("div",{ref:"dropdownRef",staticClass:"dropdown",class:{open:e.isEditing},style:{"--dropdown-height":e.dropdownHeight}},e._l(e.completions,function(a,n){return t("button",{key:`${n}_${a.keyword}`,ref:"buttonRefs",refInFor:!0,staticClass:"item",class:{focused:e.focusIndex===n},attrs:{type:"button"},on:{click:function(r){return e.select(a.keyword,n)}}},[t("sm-icons",{staticClass:"search-icon"},[e._v("search")]),t("span",{staticClass:"c-text c-text--m"},[e._v(e._s(a.splitKeywords[0]))]),t("span",{staticClass:"c-title c-title--m"},[e._v(e._s(a.splitKeywords[1]))])],1)}),0)])],2)},Xg=[],Zg=T(zg,Jg,Xg,!1,null,"d143ba8e",null,null);const Fa=Zg.exports,e3=D({components:{AutocompleteInput:Fa},setup(){const s=Te(),e=ie(),t=g("");ne(()=>{e.query.query&&typeof e.query.query=="string"&&(t.value=e.query.query)});const a=()=>{t.value!==e.query.query&&s.push({name:"search",query:{...e.query,query:t.value}})};return Z(()=>e.query,()=>{t.value=typeof e.query.query=="string"?e.query.query:""}),{query:t,search:a,searchMaxLength:200}}});var t3=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"m-keyword-search-bar"},[t("AutocompleteInput",{on:{select:e.search},scopedSlots:e._u([{key:"default",fn:function({value:a,handlers:n}){return[t("input",e._g({directives:[{name:"tooltip",rawName:"v-tooltip.bottom",value:e.query.length>=e.searchMaxLength?{content:"200文字以内で入力してください",delay:{show:300},autoHide:!1}:void 0,expression:`
            query.length >= searchMaxLength
              ? {
                  content: '200文字以内で入力してください',
                  delay: { show: 300 },
                  autoHide: false
                }
              : undefined
          `,modifiers:{bottom:!0}}],staticClass:"c-textInput",class:{"too-long":e.query.length>=e.searchMaxLength},attrs:{type:"text",placeholder:"検索ワードを入力してください",maxlength:e.searchMaxLength},domProps:{value:a}},n))]}}]),model:{value:e.query,callback:function(a){e.query=a},expression:"query"}}),t("button",{staticClass:"m-search-button",attrs:{disabled:e.query.length===0},on:{click:e.search}},[t("sm-icons",[e._v("search")])],1)],1)},s3=[],a3=T(e3,t3,s3,!1,null,"ca05ce57",null,null);const n3=a3.exports,r3=D({components:{KeywordSearchBar:n3},setup(){const s=se(),e=Ye();return{showArticleShareModal:()=>{s.commit("modal/showModal","articleShare")},sendGARecord:()=>{Ge.trackArticleView(e)}}}});var o3=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"o-feed-header"},[t("a",{staticClass:"o-anews-logo-link",attrs:{href:"/"}},[t("img",{staticClass:"p-anews-logo",attrs:{src:Bt}})]),t("KeywordSearchBar"),t("div",{staticClass:"o-navigation"},[t("div",{staticClass:"o-navigation-icon-list"},[t("button",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:{content:"共有",delay:{show:300}},expression:"{ content: '共有', delay: { show: 300 } }",modifiers:{top:!0}}],staticClass:"o-article-share-icon",on:{click:function(a){return a.stopPropagation(),e.showArticleShareModal.apply(null,arguments)}}},[t("sm-icons",{staticClass:"o-icon"},[e._v("clip-plus")])],1),t("a",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:{content:"ヘルプ",delay:{show:300}},expression:"{ content: 'ヘルプ', delay: { show: 300 } }",modifiers:{top:!0}}],staticClass:"o-help",attrs:{href:"https://anews-stockmark.zendesk.com/hc/ja",target:"_blank"},on:{click:function(a){return e.sendGARecord()}}},[t("sm-icons",{staticClass:"o-icon"},[e._v("question-circle")])],1)])])],1)},i3=[],u3=T(r3,o3,i3,!1,null,"79f9ea8c",null,null);const c3=u3.exports,l3=D({props:{activeMenu:{type:String,default:""}},setup(s){const{data:e}=xe(),{data:t}=Pe(),a=g(0),n=ie(),r=fe(),o=g(1),{data:i,mutate:u}=yr(o,0);ne(()=>{c(),r.$on("clear-notification-count",()=>a.value=0)});const c=async()=>{var _;await u(),a.value=((_=i.value)==null?void 0:_.notification.count)??0};Z(()=>n.path,c);const p=l(()=>{var _,h;return(h=(_=t.value)==null?void 0:_.groups.find(v=>v.group_type==="all_user_group"))==null?void 0:h.id}),m=l(()=>{var _;return((_=e.value)==null?void 0:_.role)==="admin"});return{menuItems:l(()=>{var _;return[{linkTo:{name:"anewsHome"},icon:"newspaper",label:"ニュース",isActive:s.activeMenu==="news"},{linkTo:{name:"userProfile",params:{userId:(_=e.value)==null?void 0:_.id}},icon:"user-circle",label:"マイページ",isActive:s.activeMenu==="my_page"},{linkTo:{name:"groupActivity",params:{groupId:String(p.value)}},icon:"users",label:"グループ",isActive:s.activeMenu==="group"},{linkTo:{name:"notifications"},icon:"bell",label:"お知らせ",isActive:s.activeMenu==="notification",hasNotification:a.value>0},...m.value?[{linkTo:{name:"contracts"},icon:"cog",label:"管理・設定",isActive:s.activeMenu==="admin"}]:[]]})}}});var d3=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"o-section-container"},[t("ul",{staticClass:"o-section-items"},e._l(e.menuItems,function(a){return t("li",{key:a.label},[t("router-link",{staticClass:"o-section o-section-item",class:{active:a.isActive},attrs:{to:a.linkTo,target:a.isTargetBlank?"_blank":"_self"}},[t("sm-icons",{class:{primary:a.isActive}},[e._v(e._s(a.icon))]),t("div",{staticClass:"o-section-text",class:{active:a.isActive}},[e._v(" "+e._s(a.label)+" ")]),a.hasNotification?t("div",{staticClass:"notification-mark"}):e._e()],1)],1)}),0)])},m3=[],_3=T(l3,d3,m3,!1,null,"8b5520da",null,null);const p3=_3.exports,v3=D({props:{name:{type:String,required:!0},icon:{type:String,default:void 0},count:{type:Number,default:void 0},isDisabled:{type:Boolean,default:!1},isExternalLink:{type:Boolean,default:!1},isSelected:{type:Boolean,default:!1},isDraggable:{type:Boolean,default:!1}},setup(){const s=g();return{titleRef:s,isVisibleToolTip:()=>{const t=s.value;return t&&Math.abs(t.offsetWidth-t.scrollWidth)>2}}}});var f3=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"item",class:{selected:e.isSelected,disabled:e.isDisabled}},[t("span",{staticClass:"name-icon c-text c-text--m"},[e.icon?[t("sm-icons",{staticClass:"icon small",class:{draggable:e.isDraggable}},[e._v(e._s(e.icon))]),e.isDraggable?t("sm-icons",{staticClass:"icon drag-icon small"},[e._v("bars")]):e._e()]:e._e(),t("span",{directives:[{name:"tooltip",rawName:"v-tooltip.bottom",value:{content:e.isVisibleToolTip()?e.name:"",popperOptions:{modifiers:{preventOverflow:{escapeWithReference:!0}}}},expression:`{
          content: isVisibleToolTip() ? name : '',
          popperOptions: {
            modifiers: {
              preventOverflow: {
                escapeWithReference: true
              }
            }
          }
        }`,modifiers:{bottom:!0}}],ref:"titleRef",staticClass:"name"},[e._v(e._s(e.name))]),e.isExternalLink?t("sm-icons",{staticClass:"small"},[e._v("external-link")]):e._e()],2),e.count&&e.count>0?t("span",{staticClass:"count c-text c-text--xs"},[e._v(e._s(e.count))]):e._e()])},g3=[],h3=T(v3,f3,g3,!1,null,"e562b196",null,null);const y3=h3.exports,C3=D({components:{ItemInner:y3},props:{id:{type:[String,Number],required:!0},name:{type:String,required:!0},route:{type:[String,Object],default:void 0},onClick:{type:Function,default:()=>{}},icon:{type:String,default:void 0},count:{type:Number,default:void 0},isDisabled:{type:Boolean,default:!1},isExternalLink:{type:Boolean,default:!1},isSelected:{type:Boolean,default:!1},isSelectedExactRoute:{type:Boolean,default:!1},isDraggable:{type:Boolean,default:!1}},setup(){return{}}});var b3=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",[e.route!==void 0&&!e.isDisabled?t("router-link",{attrs:{to:e.route},scopedSlots:e._u([{key:"default",fn:function({href:a,isActive:n,isExactActive:r}){return[t("a",{attrs:{href:a,target:e.isExternalLink?"_blank":void 0},on:{click:e.onClick}},[t("ItemInner",{attrs:{name:e.name,icon:e.icon,count:e.count,isDisabled:e.isDisabled,isExternalLink:e.isExternalLink,isSelected:e.isSelected||n&&!e.isSelectedExactRoute||r,isDraggable:e.isDraggable}})],1)]}}],null,!1,2137379505)}):t("div",{on:{click:e.onClick}},[t("ItemInner",{attrs:{name:e.name,icon:e.icon,count:e.count,isDisabled:e.isDisabled,isDraggable:e.isDraggable,isSelected:e.isSelected}})],1)],1)},A3=[],k3=T(C3,b3,A3,!1,null,"a9b444bd",null,null);const x3=k3.exports,w3=D({components:{Draggable:ui,Item:x3},props:{title:{type:String,default:void 0},items:{type:Array,required:!0},isFoldable:{type:Boolean,default:!1},initialIsOpen:{type:Boolean,default:!0},isSortable:{type:Boolean,default:!1}},setup(s,e){const{items:t}=$e(s),{initialIsOpen:a,isSortable:n}=s,r=g([...t.value]);Z(t,()=>r.value=[...t.value]);const o=g(a),i=()=>{o.value=!o.value,e.emit("menu-list-is-open",o.value)},u=g(!1);return{itemsInternal:r,isOpen:o,toggleIsOpen:i,start:()=>n?u.value=!0:void 0,move:()=>u.value,update:async d=>{u.value=!1,d.oldIndex!==d.newIndex&&e.emit("menu-list-order-changed",{from:d.oldIndex,to:d.newIndex,items:[...r.value]})}}}});var E3=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"item-list",class:{foldable:e.isFoldable}},[e.title?t("div",{staticClass:"title-icon c-title c-title--s",on:{click:()=>e.isFoldable?e.toggleIsOpen():void 0}},[t("span",{staticClass:"title"},[e._v(" "+e._s(e.title)+" ")]),e.isFoldable?t("sm-icons",{key:e.isOpen,staticClass:"toggle-icon small"},[e._v(e._s(e.isOpen?"chevron-up":"chevron-down"))]):e._e()],1):e._e(),e.isOpen?t("div",{staticClass:"items"},[t("Draggable",{attrs:{disabled:!e.isSortable,list:e.itemsInternal,tag:"ul",draggable:"li.item","ghost-class":"ghost",move:e.move},on:{start:e.start,end:e.update}},e._l(e.itemsInternal,function(a){return t("li",{key:`menu-item-${a.id}`,staticClass:"item"},[t("Item",e._b({},"Item",{...a,isDraggable:e.isSortable},!1))],1)}),0)],1):e._e()])},F3=[],T3=T(w3,E3,F3,!1,null,"8a2528e8",null,null);const As=T3.exports,Ta=D({props:{headerHeight:{type:Number,default:64},additionalHeight:{type:Number,default:0}},data(){return{height:`calc(100vh - ${this.headerHeight+this.additionalHeight}px)`}},setup(){return{}}}),_n=()=>{ci((s,e)=>({"361bc30c":s.height}))},pn=Ta.setup;Ta.setup=pn?(s,e)=>(_n(),pn(s,e)):_n;var D3=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"section-wrapper"},[e._t("default")],2)},B3=[],S3=T(Ta,D3,B3,!1,null,"f821db5c",null,null);const ks=S3.exports,I3=D({components:{ItemList:As,SectionWrapper:ks},setup(){const{data:s}=xe(),{data:e}=bt(),t=g(!0),a=l(()=>{var o;return(o=e.value)==null?void 0:o.management_contracts});Z(()=>a.value,o=>{t.value=o!=null&&(o==null?void 0:o.length)>0});const n=l(()=>[{id:"admin_contracts",name:"契約管理",route:{name:"contracts"},isDisabled:!t.value},{id:"admin_members",name:"メンバー管理",route:{name:"members"},isDisabled:!t.value},{id:"admin_theme",name:"テーマ管理",route:{name:"themeAdmin",id:"themeAdmin"}},{id:"admin_group",name:"グループ管理",route:{name:"groupAdmin"}},{id:"admin_dashboard",name:"レポート",route:{name:"dashboardHome"},isExternalLink:!0}]);return{userInfo:s,adminManageMenuItems:n,settingMenuItems:[{id:"environment",name:"環境設定",route:{name:"environmentSettings"}}]}}});var M3=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("SectionWrapper",[t("ItemList",{attrs:{title:"管理",items:e.adminManageMenuItems}}),t("ItemList",{attrs:{title:"設定",items:e.settingMenuItems}})],1)},$3=[],P3=T(I3,M3,$3,!1,null,"c85faee2",null,null);const N3=P3.exports,L3=D({components:{ItemList:As,SectionWrapper:ks},setup(){const s=se(),e=fe(),{data:t}=xe(),{data:a,mutate:n}=Pe(),r=l(()=>a.value?Dt(a.value.groups,"name","asc").filter(c=>c.is_member):[]),o=l(()=>{var c;return["group_admin","admin"].includes(((c=t.value)==null?void 0:c.role)??"")}),i=l(()=>{let c=[{id:"group_search",name:"グループ検索",route:{name:"groupList"},icon:"search",isSelectedExactRoute:!0}];return o.value&&c.push({id:"group_create",name:"グループ作成",onClick:()=>s.commit("modal/showModal","groupCreate"),icon:"plus"}),c});e.$on("update-group-list",()=>{var c;n(),s.dispatch("groups/fetchGroups",(c=t.value)==null?void 0:c.id)});const u=l(()=>r.value.map(c=>({id:c.id,name:c.name,route:{name:"groupActivity",params:{groupId:String(c.id)}},icon:"users",count:c.unread_comment_count,onClick:()=>{c.unread_comment_count=0}})));return{items:i,groupItems:u}}});var U3=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("SectionWrapper",[t("ItemList",{attrs:{items:e.items}}),t("ItemList",{key:`groups-${e.groupItems.length}`,attrs:{title:"グループ",items:e.groupItems}})],1)},R3=[],O3=T(L3,U3,R3,!1,null,"930a462c",null,null);const G3=O3.exports,q3="@stockmark.co.jp",H3=1,V3=s=>{var n;const e=s.email.endsWith(q3)||s.team_id===H3,t="wicle-script";let a=document.getElementById(t);if(!a){const r=document.createElement("script");r.textContent='!function(n){var o=window[n]=function(){var n=[].slice.call(arguments);return o.x?o.x.apply(0,n):o.q.push(n)};o.q=[],o.i=Date.now(),o.allow=function(){o.o="allow"},o.deny=function(){o.o="deny"}}("krt")',document.head.appendChild(r),a=document.createElement("script"),a.setAttribute("id",t),a.setAttribute("src","https://cdn-edge.karte.io/220753d2eff550c41445b311a7d7580a/edge.js"),document.head.appendChild(a)}(n=window.krt)==null||n.call(window,"customer",{userId:String(s.id),isInternalUser:e,"custom.team_id":String(s.team_id)})},j3=()=>{var s;(s=window.krt)==null||s.call(window,"customer",{userId:"",isInternalUser:!1,"custom.team_id":""})},K3=D({components:{ItemList:As,SectionWrapper:ks},setup(){const s=Ye(),e=ie(),t=Te(),{data:a}=xe(),n=l(()=>{var i,u;return[{id:"mypage",name:"マイページトップ",route:{name:"userProfile",params:{userId:String((i=a.value)==null?void 0:i.id)}},isSelectedExactRoute:!0,isSelected:["userProfile","userMarks","userComments","userViews"].includes(e.name??"")},{id:"export",name:"エクスポート",route:{name:"userExport",params:{userId:String((u=a.value)==null?void 0:u.id)}}}]});return{userInfo:a,myPageItems:n,settingItems:[{id:"settings_profile",name:"プロフィール",route:{name:"userSettingsProfile"}},{id:"settings_news",name:"ニュース配信",route:{name:"userSettingsNews"}},{id:"settings_mail",name:"メール配信",route:{name:"userSettingsEmail"}},{id:"settings_password",name:"パスワード",route:{name:"userSettingsPassword"}},{id:"settings_logout",name:"ログアウト",onClick:()=>{F.signout(),N.clear(s),t.push({name:"login"}),j3()}}]}}});var Y3=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("SectionWrapper",[t("ItemList",{attrs:{title:"マイページ",items:e.myPageItems}}),t("ItemList",{attrs:{title:"個人の設定",items:e.settingItems}})],1)},Q3=[],W3=T(K3,Y3,Q3,!1,null,"f30e7a11",null,null);const z3=W3.exports,J3=D({emits:["onSelect"],props:{feedType:{type:String,required:!0}},setup(s,e){const{feedType:t}=s,a=new Map([["all","国内・海外メディア両方"],["domestic","国内メディアのみ"],["foreign","海外メディアのみ"]]),n=g(t),r=g(!1),o=()=>r.value=!1,i=u=>{n.value!==u&&(n.value=u,e.emit("onSelect",{option:u})),o()};return ne(()=>{document.addEventListener("click",o)}),Be(()=>{document.removeEventListener("click",o)}),{options:a,selectedOption:n,isOptionsVisible:r,selectOption:i}}});var X3=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"media-type-selection",on:{click:function(a){return a.stopPropagation(),(()=>{}).apply(null,arguments)}}},[t("div",{staticClass:"title c-text c-text--xs"},[e._v("メディアの表示")]),t("div",[t("div",{staticClass:"selected c-text c-text--m",on:{click:function(a){return a.stopPropagation(),a.preventDefault(),(()=>e.isOptionsVisible=!e.isOptionsVisible).apply(null,arguments)}}},[e._v(" "+e._s(e.options.get(e.selectedOption))),t("sm-icons",[e._v("angle-down")])],1),e.isOptionsVisible?t("div",{staticClass:"options"},e._l(Array.from(e.options.entries()),function([a,n]){return t("div",{key:a,staticClass:"option c-text c-text--m",on:{click:function(r){return r.stopPropagation(),r.preventDefault(),(()=>e.selectOption(a)).apply(null,arguments)}}},[e._v(" "+e._s(n)+" ")])}),0):e._e()])])},Z3=[],eh=T(J3,X3,Z3,!1,null,"14dee66a",null,null);const th=eh.exports,sh=D({components:{MediaTypeSelection:th,ItemList:As,SectionWrapper:ks},setup(){const s=se(),e=fe(),t=ie(),{data:a}=et(),{data:n}=xe(),r=g(N.getFeedType()),o=l(()=>s.getters["themeList/memberThemes"]),i=l(()=>{var S;return(S=a.value)==null?void 0:S.enable_foreign_lang_media}),u=async({option:S})=>{r.value!==S&&(r.value=S,await s.dispatch("feedType/updateFeedType",S),await s.dispatch("themeList/fetchThemeList",S))},{data:c}=Pe(),p=l(()=>[{id:"home",name:"ホーム",route:{name:"anewsHome"},isSelectedExactRoute:!0},{id:"personal",name:"パーソナルニュース",route:{name:"personalNews"},isSelected:["personalNews","personalResearchPapers"].includes(t.name??"")},{id:"industry",name:"業界ニュース",route:{name:"industryNews"}},{id:"marks",name:"新着マークニュース",route:{name:"teamMarks"}},{id:"search",name:"テーマ検索",route:{name:"themeSearch"},icon:"search"},{id:"create",name:"テーマ作成",route:{name:"themeCreate"},icon:"plus"}]),m=S=>({id:S.id,name:S.name,route:{name:"themeFeed",params:{themeId:String(S.id)}},count:S.keyword_feed_count,icon:"hashtag"}),d=l(()=>[...o.value.filter(S=>S.is_favorite).sort((S,b)=>S.order-b.order).map(S=>m(S))]),_=S=>o.value.find(b=>b.id===S),h=S=>s.commit("themeList/updateTheme",S),v=async({to:S,items:b})=>{const U=b.map(w=>Number(w.route.params.themeId)),I=_(U[S]);I&&(I.order=S+1,h(I),await F.updateFavoriteTheme(I.id,I.order)),U.forEach((w,x)=>{const B=_(w);B&&x!==S&&(B.order=x+1,h(B))})},f=l(()=>o.value.filter(S=>!S.is_deleted&&!S.is_favorite)??[]),C=l(()=>f.value.filter(S=>{var b;return S.access_scope==="personal"&&S.user_id===((b=n.value)==null?void 0:b.id)}).map(S=>m(S))),y=l(()=>{var I;const S=[],b=f.value.filter(w=>w.access_scope==="group"),U=((I=c.value)==null?void 0:I.groups)??[];if(b&&U){const w=b.map(B=>B.group_id??-1),x=U.map(B=>B.id);w.filter((B,$)=>w.indexOf(B)===$).sort((B,$)=>x.indexOf(B)-x.indexOf($)).forEach(B=>{S.push([B,b.filter($=>$.group_id===B).map($=>m($))])})}return S}),A=l(()=>f.value.filter(S=>S.access_scope==="public").map(S=>m(S))),k=S=>{var U;const b=(U=c.value)==null?void 0:U.groups.find(I=>I.id===S);return b?b.name:""};return e.$on("theme-updated",async S=>{const b=_(S.id);b?b.is_favorite&&!S.is_favorite?await s.dispatch("themeList/fetchThemeList",r.value):h(b):await s.dispatch("themeList/fetchThemeList",r.value)}),e.$on("article-removed",({themeId:S,feedDate:b})=>{if(S){let U=_(S);const I=oe().format("YYYY-MM-DD");U&&I===b&&(U.keyword_feed_count=Math.max(0,U.keyword_feed_count-1))}}),{teamInfo:a,userInfo:n,feedType:r,mediaTypeSelectionEnabled:i,onFeedTypeSelect:u,items:p,groups:c,favoriteThemes:d,updateFavoriteThemeOrder:v,notFavoriteThemes:f,personalThemes:C,themesByGroup:y,publicThemes:A,getGroupName:k,userSession:N}}});var ah=function(){var e=this,t=e._self._c;return e._self._setupProxy,e.teamInfo&&e.userInfo?t("div",{staticClass:"left-menu-news"},[e.mediaTypeSelectionEnabled?t("div",{staticClass:"media-type-selection-wrapper"},[t("MediaTypeSelection",{staticClass:"media-type-selection",attrs:{feedType:e.feedType},on:{onSelect:e.onFeedTypeSelect}}),t("div",{staticClass:"spacing"})],1):e._e(),t("SectionWrapper",{attrs:{additionalHeight:e.mediaTypeSelectionEnabled?72:0}},[t("ItemList",{attrs:{items:e.items}}),e.favoriteThemes&&e.favoriteThemes.length>0?t("ItemList",{attrs:{title:"お気に入り",items:e.favoriteThemes,isFoldable:!0,initialIsOpen:e.userSession.getThemeListState("favorite",null),isSortable:!0},on:{"menu-list-is-open":a=>e.userSession.setThemeListState("favorite",null,a),"menu-list-order-changed":e.updateFavoriteThemeOrder}}):e._e(),e.personalThemes&&e.personalThemes.length>0?t("ItemList",{attrs:{title:"個人テーマ",items:e.personalThemes,isFoldable:!0,initialIsOpen:e.userSession.getThemeListState("personal",null)},on:{"menu-list-is-open":a=>e.userSession.setThemeListState("personal",null,a)}}):e._e(),e.groups&&e.themesByGroup&&e.themesByGroup.length>0?e._l(e.themesByGroup,function([a,n]){return t("ItemList",{key:a,attrs:{title:e.getGroupName(a),items:n,isFoldable:!0,initialIsOpen:e.userSession.getThemeListState("group",a)},on:{"menu-list-is-open":r=>e.userSession.setThemeListState("group",a,r)}})}):e._e(),e.publicThemes&&e.publicThemes.length>0?t("ItemList",{attrs:{title:"全体テーマ",items:e.publicThemes,isFoldable:!0,initialIsOpen:e.userSession.getThemeListState("public",null)},on:{"menu-list-is-open":a=>e.userSession.setThemeListState("public",null,a)}}):e._e()],2)],1):e._e()},nh=[],rh=T(sh,ah,nh,!1,null,"41d6056a",null,null);const oh=rh.exports,ih=D({components:{LeftSectionMenu:p3,GroupMenu:G3,AdminMenu:N3,MyPageMenu:z3,NewsMenu:oh},props:{isMenuVisible:Boolean,isExpanded:Boolean},setup(){const s=ie(),{data:e}=xe(),t=l(()=>s.meta.type==="admin"),a=l(()=>["theme","themeSearch","themeCreate"].includes(s.meta.type)||s.meta.type==="home"||s.meta.type==="article"||s.meta.type==="personalNews"||s.name==="teamFeaturedArticles"||s.name==="industryNews"||s.name==="teamMarks"),n=l(()=>s.name==="notifications"),r=l(()=>s.meta.type==="search"),o=l(()=>s.meta.type==="user"),i=l(()=>{var m;return s.meta.type==="user"&&s.params.userId==String((m=e.value)==null?void 0:m.id)||s.meta.type==="userSettings"}),u=l(()=>s.meta.type==="group"),c=l(()=>i.value||!(o.value||n.value)),p=l(()=>t.value?"admin":a.value||r.value?"news":n.value?"notification":i.value?"my_page":u.value?"group":"");return{userInfo:e,isAdminPages:t,isNewsPages:a,isSearchPages:r,isMyPage:i,isGroupPage:u,isExpandable:c,activeMenu:p}}});var uh=function(){var e=this,t=e._self._c;return e._self._setupProxy,e.userInfo?t("div",{staticClass:"o-left-menu"},[t("LeftSectionMenu",{attrs:{activeMenu:e.activeMenu}}),t("keep-alive",[e.isMenuVisible?[e.isAdminPages?t("AdminMenu",{staticClass:"left-menu__wrapper"}):e.isNewsPages||e.isSearchPages?t("NewsMenu",{staticClass:"left-menu__wrapper"}):e.isGroupPage?t("GroupMenu",{staticClass:"left-menu__wrapper"}):e.isMyPage?t("MyPageMenu",{staticClass:"left-menu__wrapper"}):e._e()]:e._e()],2),e.isExpandable?t("button",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:{content:e.isExpanded?"折りたたむ":"開いたままにする",offset:8,autoHide:!1},expression:`{
        content: !isExpanded ? '開いたままにする' : '折りたたむ',
        offset: 8,
        autoHide: false
      }`,modifiers:{top:!0}}],staticClass:"left-menu-arrow c-text c-text--s",class:{"visible-menu":e.isMenuVisible},on:{click:function(a){return e.$emit("toggleIsFolded")}}},[t("sm-icons",{staticClass:"small"},[e._v("chevron-"+e._s(e.isExpanded?"left":"right"))])],1):e._e()],1):e._e()},ch=[],lh=T(ih,uh,ch,!1,null,"d6545435",null,null);const dh=lh.exports,mh=D({props:{optionsMaxHeight:String,initialGroup:{type:Object,required:!1}},setup(s,{emit:e}){const{data:t}=Pe();xe();const a=Fe({items:[]}),n=g(void 0),r=()=>{if(t.value){const i=Dt(t.value.groups.filter(u=>u.is_member),"share_count","desc");a.items=i,s.initialGroup?n.value=a.items.find(u=>{var c;return u.id===((c=s.initialGroup)==null?void 0:c.id)}):n.value=a.items[0]}e("selected",n.value)};return Z(()=>t.value,r),r(),{groupList:a,selectedGroup:n,selectGroup:({value:i})=>{n.value=a.items.find(u=>u.id===i),e("selected",n.value)}}}});var _h=function(){var e=this,t=e._self._c;return e._self._setupProxy,e.selectedGroup?t("div",{staticClass:"group-select c-text c-text--m"},[t("sm-selectbox",{staticClass:"small",attrs:{placeholder:e.selectedGroup.name,labels:e.groupList.items.map(a=>a.is_member?a.name:`${a.name}（未参加）`),values:e.groupList.items.map(a=>a.id),optionsMaxHeight:e.optionsMaxHeight},on:{selected:e.selectGroup}}),t("span",{staticClass:"text"},[e._v("にコメントを投稿")])],1):e._e()},ph=[],vh=T(mh,_h,ph,!1,null,"6f141836",null,null);const lo=vh.exports,fh=D({props:{showHeader:{type:Boolean,default:!0}},setup(){return{}}});var gh=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"modal-mask"},[t("div",{staticClass:"modal-wrapper",on:{mousedown:function(a){return a.target!==a.currentTarget?null:e.$emit("close",!1)}}},[t("div",{staticClass:"modal-container",on:{click:function(a){return a.stopPropagation(),(()=>{}).apply(null,arguments)}}},[e.showHeader?t("div",{staticClass:"modal-header"},[e._t("header"),t("sm-icons",{staticClass:"small clickable close-icon",on:{click:function(a){return e.$emit("close",!0)}}},[e._v(" times-gray600 ")])],2):e._e(),t("div",{staticClass:"modal-content"},[e._t("body")],2)])])])},hh=[],yh=T(fh,gh,hh,!1,null,"2676f74d",null,null);const xs=yh.exports,Ch=D({components:{AdpDocumentCardSkeleton:Yt,CommentGroupSelect:lo,MentionAutocompleteTextarea:$t,Modal:xs,LoadableButton:Jt},setup(s,e){const t=se(),a=ie(),n=Te(),r=g(""),o=g(),i=g();ne(()=>{var w;return(w=i.value)==null?void 0:w.focus()});const u=l(()=>/^https?:\/\/[^.]+\.[^.]+/.test(r.value)),c=g(!1),p=g(!1),m=g({}),d=Fe({value:{}}),_=g(!1);Z(()=>r.value,async()=>{if(p.value=!1,c.value=!0,m.value={},r.value.length>0&&u.value)try{m.value=await F.fetchUrlPreview(r.value)}catch{p.value=!0}c.value=!1});const h=l(()=>{var w;return((w=m.value)==null?void 0:w.title)!==void 0}),v=g(void 0),f=w=>{v.value=w},C=l(()=>u.value&&h.value&&!_.value),y=()=>{_.value===!1&&t.commit("modal/hideModal")},A=async w=>{const x=N.getUserId(),B=d.value.marks.find(P=>P.user_id===x),$=B?await F.updateMark(B.id):await F.sendMark(d.value,null,"article_share",w);if(B){const P=d.value.marks.findIndex(M=>M.user_id===x);d.value.marks[P]=$}else d.value.marks.push($);t.commit("modal/setArticle",d.value)},k=async w=>{if(o.value){const x=o.value.trimmedComment,B=o.value.mention;if(x.length>0){const $=await F.sendComment({groupId:v.value.id,adpDocument:d.value,content:x,mention:B,trackingBaseData:w});t.commit("modal/setComment",$)}}},S=async()=>{var w;if(C.value&&v.value!==void 0){_.value=!0;const x={pageName:"article_share",pageUrl:a.fullPath};d.value=await F.createArticleShare(r.value,x),await A(x),await k(x),t.commit("snackbar/addMessages",{message:"外部リンクを共有しました",type:""}),((w=o.value)==null?void 0:w.trimmedComment)!==""?b():U()}_.value=!1,y()},b=()=>{const w=a.params.groupId;(a.name??"")==="groupActivity"&&Number(w)===v.value.id?t.commit("modal/setIsSharing",!0):n.push({name:"groupActivity",params:{groupId:String(v.value.id)}})},U=()=>{(a.name??"")==="userMarks"?t.commit("modal/setIsSharing",!0):n.push({name:"userMarks",params:{userId:String(N.getUserId())}})};return{trimmedUrl:r,preview:m,loadingPreview:c,noImage:Kt,formatDate:De,isUrlValid:u,hasPreview:h,hasError:p,shareEnabled:C,hideModal:y,callPostComment:()=>{var w,x;((w=o.value)==null?void 0:w.trimmedComment)!==""?(x=o.value)==null||x.postComment():S()},share:S,commentTextRef:o,isSharing:_,setSelectedGroup:f,urlInput:i}}});var bh=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("Modal",{staticClass:"m-article-share",on:{close:e.hideModal},scopedSlots:e._u([{key:"header",fn:function(){return[t("div",{staticClass:"m-header"},[t("div",{staticClass:"m-header-text c-text c-text--m"},[e._v(" URLを入力して、おすすめの記事を共有しよう ")])])]},proxy:!0},{key:"body",fn:function(){return[t("div",{staticClass:"m-body"},[t("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.trimmedUrl,expression:"trimmedUrl",modifiers:{trim:!0}}],ref:"urlInput",staticClass:"m-url-input c-text c-text--m c-textInput",class:e.isUrlValid?"m-normal-text-area":"c-formInput--error",attrs:{placeholder:"https://..."},domProps:{value:e.trimmedUrl},on:{input:function(a){a.target.composing||(e.trimmedUrl=a.target.value.trim())},blur:function(a){return e.$forceUpdate()}}}),t("div",{directives:[{name:"show",rawName:"v-show",value:e.shareEnabled,expression:"shareEnabled"}],staticClass:"m-article-and-comment-container"},[t("a",{staticClass:"m-article-card",attrs:{href:e.preview.url,target:"_blank"}},[t("div",{staticClass:"m-article-data"},[t("div",{staticClass:"m-article-site-name c-title c-title--s"},[e._v(" "+e._s(e.preview.media_name)+" ")]),t("div",{staticClass:"m-article-title c-text c-text-xm"},[e._v(" "+e._s(e.preview.title)+" ")]),t("div",{staticClass:"m-article-site-name c-text c-text--s"},[e._v(" "+e._s(e.preview.published_at?e.formatDate(e.preview.published_at):"")+" ")])]),t("div",{staticClass:"m-article-image-wrap"},[t("img",{attrs:{src:e.preview.image_url},on:{error:function(a){e.preview.image_url=e.noImage}}})])]),t("CommentGroupSelect",{attrs:{optionsMaxHeight:"150px"},on:{selected:e.setSelectedGroup}}),t("MentionAutocompleteTextarea",{ref:"commentTextRef",staticClass:"o-comment-text-area",attrs:{autoFocus:!1,placeholder:"コメントを書く（任意）",disabled:e.isSharing,mentionListOffset:-120},on:{postComment:e.share}})],1),e.hasError?t("div",{staticClass:"o-error c-formBlock__text c-formBlock__text--error"},[e._v(" URLから情報を取得できませんでした ")]):e.shareEnabled?e._e():t("AdpDocumentCardSkeleton",{staticClass:"m-article-card-skeleton",attrs:{loading:e.loadingPreview}}),t("div",{staticClass:"m-footer"},[e.hasPreview?t("div",{staticClass:"m-footer-buttons"},[t("button",{staticClass:"m-cancel-button c-btn c-btn--auto c-btnOutline",class:{disabled:e.isSharing},attrs:{disabled:e.isSharing},on:{click:e.hideModal}},[e._v(" キャンセル ")]),t("LoadableButton",{staticClass:"m-share-button c-btn c-btn--auto c-btn--AnewsPrimary",class:{disabled:!e.shareEnabled},attrs:{disabled:!e.shareEnabled,isLoading:e.isSharing},on:{click:e.callPostComment}},[e._v(" 共有する ")])],1):e._e()])],1)]},proxy:!0}])})},Ah=[],kh=T(Ch,bh,Ah,!1,null,"e3f3a339",null,null);const xh=kh.exports,wh=D({props:{article:{type:Object,required:!0},user:{type:Object,required:!0}},components:{ArticleComment:Kr},setup(s){const{data:e}=Pe(),{data:t}=nt(),a=l(()=>{var i,u,c;return gs(s.user,(i=s.article)==null?void 0:i.comments,(u=t.value)==null?void 0:u.themes,(c=e.value)==null?void 0:c.groups)}),n=l(()=>!a.value||a.value.length===0?[]:[...a.value].sort((i,u)=>i.created_at<u.created_at?1:i.created_at>u.created_at?-1:0).slice(0,eu)),r=l(()=>{let i=n.value.map(u=>u.group_id);return i=[...new Set(i)],i==null?void 0:i.map(u=>{const p=(a.value??[]).filter(m=>m.group_id===u).map(m=>[m.id,m.children.map(d=>d.id)]).flat(2).length;return{group_id:u,comment_count:p}})});return{formatComments:l(()=>n.value.map(i=>{const u=r.value.find(c=>c.group_id===i.group_id);return{comment:i,group_comments_count:u==null?void 0:u.comment_count}}))}}});var Eh=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",[t("div",{staticClass:"c-title c-title--xm"},[e._v("最新のコメント")]),t("div",{staticClass:"spacing-16"}),e.formatComments.length>0?e._l(e.formatComments,function(a){return t("div",{key:a.comment.id},[t("ArticleComment",{attrs:{article:e.article,comment:a.comment,"group-comments-count":a.group_comments_count,omitting:!1,showAvatar:!0,showReplyComment:!1,showGroup:!0,showReplyButton:!1,isSummaryGroup:!1,showJoinGroupButton:!1,foldReplies:!0,isDisplayOnly:!0}}),t("div",{staticClass:"spacing-04"})],1)}):e._e()],2)},Fh=[],Th=T(wh,Eh,Fh,!1,null,null,null,null);const Dh=Th.exports,Bh=D({components:{AdpDocumentCard:Re,CommentGroupSelect:lo,MentionAutocompleteTextarea:$t,Modal:xs,LatestCommentDisplay:Dh,LoadableButton:Jt},setup(){const s=se(),e=ie(),t=fe(),a=Te(),{data:n}=xe(),r=s.state.modal.article,o=s.state.modal.theme,i=s.state.modal.pageName,u=s.state.modal.feature,c=s.state.modal.feedType,p=s.state.modal.rankInWholeFeed,m=s.state.modal.group,d=s.state.modal.searchData,_=s.state.modal.industryData,h=s.state.modal.description,v=g(void 0),f=$=>v.value=$,C=`comment-${r.id}`,y=localStorage.getItem(C)??void 0,A=g(),k=l(()=>(A.value??{trimmedComment:""}).trimmedComment),S=g(!1),b=l(()=>k.value.length>0&&v.value!==void 0&&!S.value),U=async($,P,M,O,Y)=>{if(A.value){const W=A.value.trimmedComment,j=A.value.mention;if(W.length>0)try{const K=await F.sendComment({groupId:$,adpDocument:M,themeId:O,rankInWholeFeed:Y,content:W,mention:j,trackingBaseData:P,searchData:d,industryData:_,description:h});M==null||M.comments.push(K),t.$emit("article-updated",M),t.$emit("comment-created",{...K,article:M}),s.commit("snackbar/addMessages",{message:"コメントを投稿しました",type:"success"})}catch{s.commit("snackbar/addMessages",{message:"コメントを投稿できませんでした",type:"error"})}}},I=async()=>{if(b.value){S.value=!0;const $=e.params.groupId,P={pageName:i??"comment_creation",feature:u,pageUrl:e.fullPath,feedType:c,pageGroupId:$?parseInt($):void 0};await U(v.value.id,P,r,o==null?void 0:o.id,p),S.value=!1,localStorage.removeItem(C),x()}},w=()=>{var $,P;(($=A.value)==null?void 0:$.trimmedComment)!==""?(P=A.value)==null||P.postComment():I()},x=($=!1)=>{var P,M;S.value===!1&&($&&((P=A.value)!=null&&P.trimmedComment)&&localStorage.setItem(C,(M=A.value)==null?void 0:M.trimmedComment),s.commit("modal/hideModal"))};return{user:n,article:r,theme:o,selectedGroup:v,setSelectedGroup:f,initialComment:y,noImage:Kt,formatDate:De,isPostEnabled:b,hideModal:x,callPostComment:w,post:I,commentTextRef:A,isPostingComment:S,feature:u,group:m,moveToAllComments:()=>{a.push({name:r.doc_type==="research_paper"?"researchPaperPage":"articlePage",params:{id:String(r.id),doc_type:r.doc_type}}),x()},pageName:i}}});var Sh=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("Modal",{staticClass:"m-article-share",on:{close:a=>e.hideModal(!a)},scopedSlots:e._u([{key:"header",fn:function(){return[t("div",{staticClass:"m-header"},[t("div",{staticClass:"m-header-text c-text c-text--m"},[e._v("コメント投稿")])])]},proxy:!0},{key:"body",fn:function(){return[t("div",{staticClass:"m-body"},[e.user?t("div",{staticClass:"user-info"},[t("img",{staticClass:"user-icon",attrs:{src:e.user.image_url}}),t("div",{staticClass:"username c-title c-title--m"},[e._v(e._s(e.user.user_name))])]):e._e(),t("CommentGroupSelect",{attrs:{optionsMaxHeight:"240px",initialGroup:e.group},on:{selected:e.setSelectedGroup}}),t("MentionAutocompleteTextarea",{ref:"commentTextRef",staticClass:"o-comment-text-area",attrs:{placeholder:"コメントを書く",initialComment:e.initialComment,disabled:e.isPostingComment,mentionListOffset:-120},on:{postComment:e.post}}),t("AdpDocumentCard",{attrs:{adpDocument:e.article,themeId:e.theme?e.theme.id:void 0,showComment:!1,showUserAction:!1,pageName:"comment_creation",feature:e.feature}}),t("div",{staticClass:"m-buttons"},[t("LoadableButton",{staticClass:"m-post-button c-btn c-btn--auto c-btn--AnewsPrimary",class:{disabled:!e.isPostEnabled},attrs:{disabled:!e.isPostEnabled,isLoading:e.isPostingComment},on:{click:e.callPostComment}},[e._v(" コメントを投稿 ")])],1),e.article.comments.length>0&&e.user&&e.pageName!=="article"?t("div",{staticClass:"latest-comment"},[t("div",{staticClass:"spacing-08"}),t("latest-comment-display",{attrs:{article:e.article,user:e.user,theme:e.theme}}),t("div",{staticClass:"spacing-12"}),t("div",{staticClass:"comment-link"},[t("button",{staticClass:"outlined c-outlineBtn c-btn--auto c-btn--small",on:{click:e.moveToAllComments}},[e._v(" 全てのコメントを見る（返信する） ")])])],1):e._e()],1)]},proxy:!0}])})},Ih=[],Mh=T(Bh,Sh,Ih,!1,null,"1b85e15d",null,null);const $h=Mh.exports,Ph=D({components:{Modal:xs,Avatar:at,MentionAutocompleteTextarea:$t},setup(){const s=g(!1),{data:e}=xe(),t=ie(),a=se(),n=g(!1),r=()=>{a.commit("modal/hideModal")},o=g(),i=a.state.modal.group;if(i===void 0)throw new Error("group is undefined");return{hideModal:r,myInfo:e,disabledButton:s,commentTextRef:o,isPostingComment:n,isPostEnabled:()=>{var p;return s.value?!1:(((p=o.value)==null?void 0:p.trimmedComment.length)??0)>0},callPostComment:async()=>{if(!o.value)return;r(),n.value=!0;const p=o.value.trimmedComment,m=o.value.mention;if(p.length===0)return;const d={pageName:"group",feature:"group_activities",pageUrl:t.fullPath};try{const _=await F.sendComment({groupId:Number(i.id),content:p,mention:m,adpDocument:void 0,trackingBaseData:d});a.commit("modal/setWithoutArticleComment",_),a.commit("snackbar/addMessages",{message:"コメントを投稿しました",type:"success"})}catch{a.commit("snackbar/addMessages",{message:"コメントを投稿できませんでした",type:"error"})}n.value=!1}}}});var Nh=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("Modal",{attrs:{showHeader:!1},on:{close:e.hideModal},scopedSlots:e._u([{key:"body",fn:function(){return[t("div",{staticClass:"m-body ccwam-body"},[t("div",{staticClass:"ccwam-myinfo-area"},[e.myInfo?t("router-link",{attrs:{to:`/users/${e.myInfo.id}`},nativeOn:{click:function(a){return e.hideModal.apply(null,arguments)}}},[t("div",{staticClass:"ccwam-myinfo"},[t("Avatar",{attrs:{imageUrl:e.myInfo.image_url}}),t("div",{staticClass:"c-title c-title--m user-name"},[e._v(" "+e._s(e.myInfo.user_name)+" ")])],1)]):e._e()],1),t("MentionAutocompleteTextarea",{ref:"commentTextRef",staticClass:"comment-text-area ccwam-text-area",attrs:{placeholder:"コメントを書く（URLのみの投稿はできません）",disabled:e.isPostingComment,minHeight:100,showUrlPreview:!0},on:{postComment:e.callPostComment},model:{value:e.disabledButton,callback:function(a){e.disabledButton=a},expression:"disabledButton"}}),t("div",{staticClass:"ccwam-btn-area"},[t("button",{staticClass:"c-outlineBtn c-btn--auto c-outlineBtn--secondary",on:{click:e.hideModal}},[e._v(" キャンセル ")]),t("button",{staticClass:"c-btn c-btn--auto c-btn--AnewsPrimary",class:{disabled:!e.isPostEnabled()||e.isPostingComment},attrs:{disabled:!e.isPostEnabled()||e.isPostingComment},on:{click:e.callPostComment}},[e._v(" 投稿 ")])])],1)]},proxy:!0}])})},Lh=[],Uh=T(Ph,Nh,Lh,!1,null,"09b4654d",null,null);const Rh=Uh.exports,Oh=D({components:{Modal:xs},setup(){const s=se(),e=fe(),{data:t}=Qe(),a=s.state.modal.comment,n=g(a.content),r=g(),o=_=>{const h=_.target;h.style.height="22px",h.style.height=`${Math.max(90,h.scrollHeight)}px`};ne(()=>{var v;const _=document.getElementsByClassName("o-comment-edit-text-area");if(_.length===1){var h=new Event("input",{bubbles:!0,cancelable:!0});_[0].dispatchEvent(h)}(v=r.value)==null||v.focus()});const i=l(()=>{var _;return((_=n.value)==null?void 0:_.length)>Rn}),u=g(!1),c=()=>{var _;return((_=n.value)==null?void 0:_.length)>0&&!i.value&&!u.value},p=()=>{u.value===!1&&s.commit("modal/hideModal")},m=async()=>{if(c())try{const _=await F.updateComment(a.id,n.value);if(s.commit("snackbar/addMessages",{message:"コメントを編集しました",type:"success"}),e.$emit("comment-updated",_),a.article&&a.article.comments){const h=a.article.comments.findIndex(f=>f.id===a.id),v=a.article.comments.slice();v[h]=_,a.article.comments=v,e.$emit("article-updated",a.article)}p()}catch{s.commit("snackbar/addMessages",{message:"コメントを編集できませんでした",type:"error"})}};return{user:l(()=>{var _;return(_=t.value)==null?void 0:_.users.find(h=>h.id===a.user_id)}),formatDateTime:la,comment:a,commentContent:n,textAreaRef:r,updateHeight:o,tooLongComment:i,hideModal:p,updateComment:m,canUpdateComment:c,isPostingComment:u}}});var Gh=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("Modal",{staticClass:"m-article-share",on:{close:e.hideModal},scopedSlots:e._u([{key:"header",fn:function(){return[t("div",{staticClass:"m-header"},[t("div",{staticClass:"m-header-text c-text c-text--m"},[e._v("コメント編集")])])]},proxy:!0},{key:"body",fn:function(){return[t("div",{staticClass:"m-body"},[e.user?t("div",{staticClass:"user-info"},[t("img",{staticClass:"user-icon",attrs:{src:e.user.image_url}}),t("div",[t("div",{staticClass:"username c-title c-title--m"},[e._v(e._s(e.user.user_name))]),t("div",{staticClass:"c-text c-text--s"},[e._v(" "+e._s(e.formatDateTime(e.comment.created_at))+" ")])])]):e._e(),t("div",{staticClass:"o-comment-edit"},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.tooLongComment,expression:"tooLongComment"}],staticClass:"o-error c-formBlock__text c-formBlock__text--error"},[e._v(" コメントは500文字以内で入力してください。 ")]),t("textarea",{directives:[{name:"model",rawName:"v-model.trim",value:e.commentContent,expression:"commentContent",modifiers:{trim:!0}}],ref:"textAreaRef",staticClass:"o-comment-edit-text-area c-textArea c-text--m",class:{"c-formInput--error":e.tooLongComment,"m-normal-text-area":!e.tooLongComment},domProps:{value:e.commentContent},on:{input:[function(a){a.target.composing||(e.commentContent=a.target.value.trim())},e.updateHeight],keydown:[function(a){return!a.type.indexOf("key")&&e._k(a.keyCode,"enter",13,a.key,"Enter")||!a.ctrlKey?null:e.updateComment.apply(null,arguments)},function(a){return!a.type.indexOf("key")&&e._k(a.keyCode,"enter",13,a.key,"Enter")||!a.metaKey?null:e.updateComment.apply(null,arguments)}],blur:function(a){return e.$forceUpdate()}}})]),t("div",{staticClass:"m-footer"},[t("div",{staticClass:"m-footer-buttons"},[t("button",{staticClass:"m-cancel-button c-btn c-btn--auto",on:{click:e.hideModal}},[e.isPostingComment?e._e():t("span",[e._v("キャンセル")])]),t("button",{staticClass:"m-post-button c-btn c-btn--auto c-btn--AnewsPrimary",class:{disabled:!e.canUpdateComment()},attrs:{disabled:!e.canUpdateComment()},on:{click:e.updateComment}},[e.isPostingComment?e._e():t("span",[e._v("変更を保存")])])])])])]},proxy:!0}])})},qh=[],Hh=T(Oh,Gh,qh,!1,null,"b73a3311",null,null);const Vh=Hh.exports,jh=D({props:{optionsMaxHeight:String,isError:{type:Boolean,default:!1},initialGroup:{type:Object}},setup(s,{emit:e}){const{data:t}=Pe(),{data:a}=xe(),n=Fe({items:[]}),r=g(void 0),o=()=>{var u;if(t.value){const c=Dt(t.value.groups.filter(m=>m.is_member),"share_count","desc"),p=Dt(t.value.groups.filter(m=>!m.is_member),"share_count","desc");((u=a.value)==null?void 0:u.role)==="admin"?n.items=c.concat(p):n.items=c,r.value=s.initialGroup??n.items[0]}r.value!==void 0&&e("selected",r.value)};return Z(()=>{var u,c;return[(u=t.value)==null?void 0:u.groups.length,(c=a.value)==null?void 0:c.id]},o),o(),{groupList:n,selectedGroup:r,selectGroup:({value:u})=>{r.value=n.items.find(c=>c.id===u),r.value!==void 0&&e("selected",r.value)}}}});var Kh=function(){var e=this,t=e._self._c;return e._self._setupProxy,e.selectedGroup?t("div",{staticClass:"group-select c-text c-text--m"},[t("div",{staticClass:"wrapper"},[t("sm-selectbox",{staticClass:"small",class:{error:e.isError},attrs:{placeholder:e.selectedGroup.name,labels:e.groupList.items.map(a=>a.is_member?a.name:`${a.name}（未参加）`),values:e.groupList.items.map(a=>a.id),optionsMaxHeight:e.optionsMaxHeight},on:{selected:e.selectGroup}})],1)]):e._e()},Yh=[],Qh=T(jh,Kh,Yh,!1,null,"4ee69502",null,null);const Wh=Qh.exports,zh=D({components:{AdpDocumentCard:Re,GroupSelect:Wh,InputTag:Aa},setup(){const s=se(),e=ie(),t=fe(),a=s.state.modal.article,n=s.state.modal.theme,r=s.state.modal.group,o=s.state.modal.pageName,i=s.state.modal.feature,u=s.state.modal.feedType,c=s.state.modal.markSource,p=s.state.modal.rankInWholeFeed,m=s.state.modal.searchData,d=s.state.modal.industryData,_=s.state.modal.description,h=g(It),v=Fe({list:[]}),f=Fe({list:[]}),C=g(void 0),y=g(""),A=g(!1);ne(()=>{e.name==="userMarks"&&(f.list=a.tags??[],y.value=a.memo??"")});const k=async x=>{C.value=x;const B=a.group_marks.map($=>$.group_name);A.value=B.includes(x.name),v.list=await F.fetchGroupTags(x.id)},S=()=>{s.commit("modal/hideModal")},b=x=>{var P;let B=a;const $={...x,group_name:((P=C.value)==null?void 0:P.name)??""};B.group_marks.push($),t.$emit("article-updated",B)},U=async()=>{if(!C.value)return;const x=C.value.id,B=e.params.groupId;try{const $=await F.postGroupMark(x,a,n==null?void 0:n.id,c,{pageName:o,pageUrl:e.fullPath,pageGroupId:B?parseInt(B):void 0,feature:i,feedType:u},p,y.value,f.list,m,d,_);f.list.length>0&&await F.updateGroupArticleTags(x,a.id,a.doc_type,f.list),y.value!==""&&await F.updateGroupArticleMemo(x,a.id,a.doc_type,y.value),await F.trackEvent("set_article_option",{pageName:o,pageUrl:e.fullPath,feature:i},a.id,x,{tags:f.list,memo:y.value}),b($),s.commit("snackbar/addMessages",{type:"",messageTemplates:[{tag:"a",text:C.value.name,href:`/#/groups/${x}/marks`},{tag:"span",text:"にグループマークしました"},{tag:"icon",text:"external-link"}]})}catch{s.commit("snackbar/addMessages",{message:"グループマークできませんでした",type:"error"})}S()},I=l(()=>a.image_url?a.image_url:h.value),w=l(()=>$r(a));return{article:a,noImage:h,tagList:v,selectedTags:f,selectedGroup:C,editingMemo:y,isMarkedGroup:A,group:r,hideDialog:S,setSelectedGroup:k,updateArticle:b,submit:U,documentImageUrl:I,documentPublisher:w,theme:n,pageName:o,feature:i}}});var Jh=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"o-dialog-group-mark"},[t("sm-dialog",{staticClass:"auto-height auto-width screen-center",on:{close:e.hideDialog},scopedSlots:e._u([{key:"header",fn:function(){return[t("div",{staticClass:"o-header c-text c-text--m"},[e._v("グループマーク")])]},proxy:!0},{key:"body",fn:function(){return[t("div",{staticClass:"o-body c-text c-text--m"},[t("div",{staticClass:"o-group-select"},[t("GroupSelect",{attrs:{optionsMaxHeight:"160px",isError:e.isMarkedGroup,initialGroup:e.group},on:{selected:e.setSelectedGroup}}),t("div",{staticClass:"o-group-select__text c-text c-text--m"},[e._v("にマーク")])],1),e.isMarkedGroup?t("div",{staticClass:"o-group-select__error"},[e._v(" すでにこの記事は指定したグループでマークされています ")]):e._e(),t("div",{staticClass:"spacing-12"}),t("AdpDocumentCard",{attrs:{adpDocument:e.article,themeId:e.theme?e.theme.id:void 0,showComment:!1,showUserAction:!1,pageName:e.pageName,feature:e.feature}}),t("div",{staticClass:"spacing-08"}),t("InputTag",{attrs:{tagList:e.tagList.list,selectedTags:e.selectedTags.list,placeholder:"タグを入力後、改行でタグを追加",isEdit:!0},on:{"update:selectedTags":function(a){return e.$set(e.selectedTags,"list",a)},"update:selected-tags":function(a){return e.$set(e.selectedTags,"list",a)}}}),t("div",{staticClass:"c-formBlock"},[t("div",{staticClass:"c-formBlock__label"},[e._v("メモ")]),t("textarea",{directives:[{name:"model",rawName:"v-model.trim",value:e.editingMemo,expression:"editingMemo",modifiers:{trim:!0}}],staticClass:"o-article-memo c-textArea",attrs:{placeholder:"メモを入力"},domProps:{value:e.editingMemo},on:{keydown:[function(a){return!a.type.indexOf("key")&&e._k(a.keyCode,"enter",13,a.key,"Enter")||!a.ctrlKey?null:e.submit.apply(null,arguments)},function(a){return!a.type.indexOf("key")&&e._k(a.keyCode,"enter",13,a.key,"Enter")||!a.metaKey?null:e.submit.apply(null,arguments)}],input:function(a){a.target.composing||(e.editingMemo=a.target.value.trim())},blur:function(a){return e.$forceUpdate()}}})])],1)]},proxy:!0},{key:"footer",fn:function(){return[t("div",{staticClass:"o-footer c-text c-text--m"},[t("button",{staticClass:"o-create-button c-btn c-btn--auto c-btn--AnewsPrimary",class:{disabled:e.isMarkedGroup},attrs:{disabled:e.isMarkedGroup},on:{click:e.submit}},[e._v(" マーク ")])])]},proxy:!0}])})],1)},Xh=[],Zh=T(zh,Jh,Xh,!1,null,"cf553f1e",null,null);const ey=Zh.exports,ty=D({components:{InputTag:Aa,AdpDocumentCard:Re},setup(){const s=se(),e=ie(),{data:t}=xe(),a=s.state.modal.article,n=s.state.modal.theme,r=s.state.modal.pageName,o=s.state.modal.feature,i=s.state.modal.feedType,u=s.state.modal.markSource,c=s.state.modal.rankInWholeFeed,p=s.state.modal.searchData,m=g(It),{data:d}=Vc(),_=Fe({list:[]}),h=g(""),v=g(!1);ne(()=>{e.name==="userMarks"&&(_.list=a.tags??[],h.value=a.memo??"")});const f=()=>{s.commit("modal/hideModal")};return{userInfo:t,article:a,noImage:m,tags:d,selectedTags:_,editingMemo:h,isMarkedGroup:v,hideDialog:f,submit:async()=>{var y,A;try{const k=await F.sendMark(a,n==null?void 0:n.id,u,{pageName:r,pageUrl:e.fullPath,feature:o,feedType:i},c,p);_.list.length>0&&await F.updateUserArticleTags(a.id,a.doc_type,_.list),h.value!==""&&await F.updateUserArticleMemo(a.id,a.doc_type,h.value),await F.trackEvent("set_article_option",{pageName:r,pageUrl:e.fullPath,feature:o},a.id,void 0,{tags:_.list,memo:h.value}),a.marks.push({...k,user_name:((y=t.value)==null?void 0:y.user_name)??""}),s.commit("snackbar/addMessages",{type:"",messageTemplates:[{tag:"a",text:"マイページ",href:`/#/users/${(A=t.value)==null?void 0:A.id}`},{tag:"span",text:"にマークしました"},{tag:"icon",text:"external-link"}]})}catch{s.commit("snackbar/addMessages",{message:"マークできませんでした",type:"error"})}f()},theme:n,pageName:r,feature:o}}});var sy=function(){var e=this,t=e._self._c;return e._self._setupProxy,e.userInfo&&e.userInfo.id&&e.tags&&e.tags.user_tags?t("div",{staticClass:"o-dialog-group-mark"},[t("sm-dialog",{staticClass:"auto-height auto-width screen-center",on:{close:e.hideDialog},scopedSlots:e._u([{key:"header",fn:function(){return[t("div",{staticClass:"o-header c-text c-text--m"},[e._v("マーク")])]},proxy:!0},{key:"body",fn:function(){return[t("div",{staticClass:"o-body c-text c-text--m"},[t("AdpDocumentCard",{attrs:{adpDocument:e.article,themeId:e.theme?e.theme.id:void 0,showComment:!1,showUserAction:!1,pageName:e.pageName,feature:e.feature}}),t("div",{staticClass:"spacing-08"}),t("InputTag",{attrs:{tagList:e.tags.user_tags,selectedTags:e.selectedTags.list,placeholder:"タグを入力後、改行でタグを追加",isEdit:!0},on:{"update:selectedTags":function(a){return e.$set(e.selectedTags,"list",a)},"update:selected-tags":function(a){return e.$set(e.selectedTags,"list",a)}}}),t("div",{staticClass:"c-formBlock"},[t("div",{staticClass:"c-formBlock__label"},[e._v("メモ")]),t("textarea",{directives:[{name:"model",rawName:"v-model.trim",value:e.editingMemo,expression:"editingMemo",modifiers:{trim:!0}}],staticClass:"o-article-memo c-textArea",attrs:{placeholder:"メモを入力"},domProps:{value:e.editingMemo},on:{keydown:[function(a){return!a.type.indexOf("key")&&e._k(a.keyCode,"enter",13,a.key,"Enter")||!a.ctrlKey?null:e.submit.apply(null,arguments)},function(a){return!a.type.indexOf("key")&&e._k(a.keyCode,"enter",13,a.key,"Enter")||!a.metaKey?null:e.submit.apply(null,arguments)}],input:function(a){a.target.composing||(e.editingMemo=a.target.value.trim())},blur:function(a){return e.$forceUpdate()}}})])],1)]},proxy:!0},{key:"footer",fn:function(){return[t("div",{staticClass:"o-footer c-text c-text--m"},[t("button",{staticClass:"o-create-button c-btn c-btn--auto c-btn--AnewsPrimary",class:{disabled:e.isMarkedGroup},attrs:{disabled:e.isMarkedGroup},on:{click:e.submit}},[e._v(" マーク ")])])]},proxy:!0}],null,!1,869208641)})],1):e._e()},ay=[],ny=T(ty,sy,ay,!1,null,"cd0f647d",null,null);const ry=ny.exports,oy=D({props:{label:String,value:{type:Boolean,default:!1},isDisabled:{type:Boolean,default:!1}},setup({value:s},e){const t=g(s);return{innerValue:t,toggleValue:()=>{t.value=!t.value,e.emit("toggleValue",t.value)}}}});var iy=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("span",{key:`radio-${e.innerValue}`,staticClass:"radio-label",class:{disabled:e.isDisabled},on:{click:e.toggleValue}},[t("sm-radio",{attrs:{value:e.value,disabled:e.isDisabled}}),t("span",{staticClass:"c-inputLabel"},[e._v(e._s(e.label))])],1)},uy=[],cy=T(oy,iy,uy,!1,null,"979841f3",null,null);const ws=cy.exports,ly=D({components:{RadioLabel:ws},props:{selectPerspective:{type:Object,default:()=>({})}},setup(s,e){const{data:t}=tl(),a=l(()=>{var n;return!((n=t.value)!=null&&n.theme_perspectives)||t.value.theme_perspectives.length===0?[Wa]:t.value.theme_perspectives});return Z(a,()=>{Object.keys(s.selectPerspective).length===0&&e.emit("selected-perspective",a.value.length===0?Wa:a.value[0])}),{themePerspectives:a}}});var dy=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",[t("div",{staticClass:"c-title c-title--xl"},[e._v("特にどのような目的で知りたいですか？")]),t("div",{staticClass:"spacing-12"}),e._m(0),t("div",{staticClass:"spacing-32"}),t("div",{staticClass:"c-text c-text--m"},[e._v(" 情報収集の目的を教えてください（組み合わせによっては、現時点で情報がない場合がありますのでご了承ください） ")]),t("div",{staticClass:"spacing-12"}),e._l(e.themePerspectives,function(a){return t("div",{key:"perspective_"+a.id},[t("RadioLabel",{attrs:{label:a.question,value:e.selectPerspective.id===a.id},on:{toggleValue:function(n){return e.$emit("selected-perspective",a)}}}),t("div",{staticClass:"spacing-16"})],1)})],2)},my=[function(){var s=this,e=s._self._c;return s._self._setupProxy,e("div",{staticClass:"c-text c-text--m"},[s._v(" より関連する情報をお届けするために、もう一つ教えてください。"),e("br"),s._v(" 選択したトピックについて、特にどのような目的で知りたいですか？ ")])}],_y=T(ly,dy,my,!1,null,"a32a9802",null,null);const mo=_y.exports,py=D({props:{filter:{type:String,default:""}},setup(s,e){const{data:t}=el();return{themeTopicCategories:l(()=>{if(!t.value)return[];if(!s.filter)return t.value.theme_topic_categories;const o=s.filter.toLowerCase();return t.value.theme_topic_categories.flatMap(i=>{const u=i.theme_topics.filter(c=>{var p,m;return c.name.toLowerCase().includes(o)||((p=c.query_en)==null?void 0:p.toLowerCase().includes(o))||((m=c.query_ja)==null?void 0:m.toLowerCase().includes(o))});return u.length===0?[]:[{...i,theme_topics:u}]})}),selectThemeTopic:o=>{e.emit("select-theme-topic",o)},makeTooltip:o=>[o.query_ja,o.query_en].filter(i=>!!i).map(i=>"・"+i).join(`
`)}}});var vy=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",[e.themeTopicCategories.length>0?t("div",{staticClass:"c-title c-title--m"},[e._v(" トピック ")]):e._e(),e._l(e.themeTopicCategories,function(a){return t("div",{key:a.id,staticClass:"topic-select-form-item"},[t("div",{staticClass:"theme-topic-category-name"},[e._v(e._s(a.name))]),t("div",[t("div",{staticClass:"labels"},e._l(a.theme_topics,function(n){return t("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:e.makeTooltip(n),expression:"makeTooltip(topic)"}],key:n.id,staticClass:"c-btn c-btn--auto c-btnOutline",on:{click:function(r){return e.selectThemeTopic(n)}}},[e._v(" "+e._s(n.name)+" ")])}),0)])])})],2)},fy=[],gy=T(py,vy,fy,!1,null,"bbe73014",null,null);const _o=gy.exports,hy=D({components:{ThemeTopicOneSelectForm:_o,ThemePerspectiveSelectForm:mo},setup(){const s=fe(),e=se(),t=g(void 0),a=c=>{t.value=[c],n.value=!1},n=g(!0),r=()=>{e.commit("modal/hideModal")},o=async()=>{s.$emit("select-theme-topics",t.value,i.value),r()};ne(async()=>{const c=document.querySelector(".dialog-header");c&&(c.style.height="32px")});const i=g(void 0);return{selectThemeTopic:a,hideDialog:r,submit:o,isSelectTopic:n,selectedTopics:t,selectPerspective:i,selectedPerspective:c=>{i.value=c,s.$emit("select-perspective",i.value)}}}});var yy=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",[t("sm-dialog",{staticClass:"auto-width auto-height screen-center",on:{close:e.hideDialog},scopedSlots:e._u([{key:"header",fn:function(){return[t("div",{staticClass:"o-header c-text c-text--m modal-header"},[e._v("トピック一覧")])]},proxy:!0},{key:"body",fn:function(){return[e.isSelectTopic?t("div",{staticClass:"o-body c-text c-text--m modal-body"},[t("div",{staticClass:"c-text c-text--s"},[e._v("ステップ 1/2")]),t("div",{staticClass:"c-title c-title--xl"},[e._v("あなたの興味を教えてください")]),t("div",{staticClass:"spacing-12"}),t("div",{staticClass:"c-text c-text--m"},[e._v(" あなたの興味や業務に関連しそうなトピックを選んでください。 ")]),t("ThemeTopicOneSelectForm",{staticClass:"theme-topic-select-form",on:{"select-theme-topic":e.selectThemeTopic}})],1):t("div",{staticClass:"o-body c-text c-text--m modal-body"},[t("div",{staticClass:"c-text c-text--s"},[e._v("ステップ 2/2")]),t("ThemePerspectiveSelectForm",{staticClass:"theme-topic-select-form",attrs:{"select-perspective":e.selectPerspective},on:{"selected-perspective":e.selectedPerspective}})],1)]},proxy:!0},{key:"footer",fn:function(){return[t("div",{staticClass:"o-footer c-text c-text--m"},[t("button",{staticClass:"o-cancel-button c-btn c-btn--auto c-btnOutline",on:{click:e.hideDialog}},[e._v(" キャンセル ")]),e.isSelectTopic?e._e():[t("button",{staticClass:"o-cancel-button c-btn c-btn--auto c-btnOutline",on:{click:function(a){e.isSelectTopic=!0}}},[e._v(" 戻る ")]),t("button",{staticClass:"o-create-button c-btn c-btn--auto c-btn--AnewsPrimary",on:{click:e.submit}},[e._v(" 追加 ")])]],2)]},proxy:!0}])})],1)},Cy=[],by=T(hy,yy,Cy,!1,null,"1b88ee6c",null,null);const Ay=by.exports,ky=D({setup(){const s=se(),e=()=>{s.commit("modal/hideModal")};return ne(async()=>{N.setIsShownTranslateNotification()}),{hideModal:e}}});var xy=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",[t("sm-dialog",{staticClass:"screen-center auto-height",on:{close:e.hideModal},scopedSlots:e._u([{key:"header",fn:function(){return[t("div",{staticClass:"m-header"},[t("div",{staticClass:"m-header-text c-title c-title--m"},[e._v(" 海外メディアの記事配信について ")])])]},proxy:!0},{key:"body",fn:function(){return[t("div",{staticClass:"m-body"},[t("div",{staticClass:"c-text c-text--m"},[e._v(" 海外メディアの記事についてはタイトルが自動で日本語に翻訳されて表示されます。"),t("br"),e._v(" 翻訳がされていない状態で表示したい場合は "),t("router-link",{attrs:{to:{name:"userSettings"},custom:""},scopedSlots:e._u([{key:"default",fn:function({href:a,navigate:n}){return[t("a",{staticClass:"c-textLink c-textLink--underbar",attrs:{href:a},on:{click:r=>{e.hideModal(),n(r)}}},[e._v("マイページの設定")])]}}])}),e._v("より変更が可能です。 ")],1)])]},proxy:!0}])})],1)},wy=[],Ey=T(ky,xy,wy,!1,null,"64abc6c1",null,null);const Fy=Ey.exports,Ty=D({components:{UserSelectTextarea:uo},props:{users:{type:Array,required:!0},isLoaded:{type:Boolean,required:!0}},setup(s,{emit:e}){const t=g([]),a=l(()=>s.users.filter(c=>!t.value.find(p=>p.id===c.id)));return{buttonClickable:l(()=>t.value.length>0),displayTag:c=>{const p=s.users.find(m=>m.id===c.id);p&&!t.value.find(m=>m.id===p.id)&&t.value.push(p)},removeTag:c=>{t.value=t.value.filter(p=>p.id!==c)},selectedUsers:t,selectableUsers:a,clickAddButton:()=>{e("click-add-button",t.value.map(c=>c.id))},close:()=>{e("close")}}}});var Dy=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"o-group-invite"},[e.isLoaded?t("sm-dialog",{staticClass:"auto-height auto-width",on:{close:e.close},scopedSlots:e._u([{key:"header",fn:function(){return[t("div",{staticClass:"o-header c-text c-text--m"},[e._v("メンバーを追加する")])]},proxy:!0},{key:"body",fn:function(){return[t("div",{staticClass:"o-body c-text c-text--m"},[t("div",{staticClass:"o-user-name"},[t("div",{staticClass:"o-user-name-text"},[e._v("名前、メールアドレスで検索")]),t("UserSelectTextarea",{staticClass:"o-user-name-input",attrs:{users:e.selectableUsers},on:{"select-item":e.displayTag}}),t("div",{staticClass:"spacing-16"}),t("div",{staticClass:"tag-field"},e._l(e.selectedUsers,function(a){return t("div",{key:a.id,staticClass:"o-user-name-tag c-tag c-tag--delete"},[t("span",{staticClass:"c-text c-text--m"},[e._v(e._s(a.user_name))]),t("sm-icons",{on:{click:function(n){return e.removeTag(a.id)}}},[e._v("times-white")])],1)}),0)],1)])]},proxy:!0},{key:"footer",fn:function(){return[t("div",{staticClass:"o-footer c-text c-text--m"},[t("button",{staticClass:"o-cancel-button c-btn c-btn--auto c-btnOutline",on:{click:e.close}},[e._v(" キャンセル ")]),t("button",{staticClass:"o-create-button c-btn c-btn--auto c-btn--AnewsPrimary",class:{disabled:!e.buttonClickable},attrs:{disabled:!e.buttonClickable},on:{click:e.clickAddButton}},[e._v(" 追加 ")])])]},proxy:!0}],null,!1,1268181133)}):e._e()],1)},By=[],Sy=T(Ty,Dy,By,!1,null,"6a380613",null,null);const po=Sy.exports,Iy=D({components:{addUserModal:po},setup(){const s=ie(),e=se(),t=fe(),a=l(()=>Number(s.params.groupId)),n=l(()=>Number(s.params.themeId)),r=a.value&&!n.value?"group":"theme",o=r==="group"?"グループ":"テーマ",i=r==="group"?h=>F.createGroupInvitation(a.value,h):h=>F.createThemeInvitation(n.value,h),{data:u,state:c}=Qe(),p=l(()=>c.value===be.SUCCESS),m=l(()=>{var h;return((h=u.value)==null?void 0:h.users.filter(v=>v.is_deleted===!1))??[]}),d=()=>{e.commit("modal/hideModal")};return{isLoaded:p,activeUsers:m,hideModal:d,createInvitation:async h=>{var v;try{await i(h);const f=(v=u.value)==null?void 0:v.users.filter(C=>h.includes(C.id));t.$emit(`${r}-member-added`,f),e.commit("snackbar/addMessages",{message:`${o}に招待しました`,type:""}),d()}catch(f){throw e.commit("snackbar/addMessages",{message:`${o}に招待できませんでした`,type:"error"}),f}}}}});var My=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("addUserModal",{attrs:{users:e.activeUsers,isLoaded:e.isLoaded},on:{"click-add-button":e.createInvitation,close:e.hideModal}})},$y=[],Py=T(Iy,My,$y,!1,null,null,null,null);const Ny=Py.exports,Ly=D({setup(){const s=se(),e=()=>{s.commit("modal/hideModal")},t=Fe({items:[]});return ne(async()=>{t.items=await F.getSites(!0)}),{hideModal:e,sites:t}}});var Uy=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",[t("sm-dialog",{staticClass:"screen-center",on:{close:e.hideModal},scopedSlots:e._u([{key:"header",fn:function(){return[t("div",{staticClass:"m-header"},[t("span",{staticClass:"m-header-text"},[e._v("フィード設定について")])])]},proxy:!0},{key:"body",fn:function(){return[t("div",{staticClass:"m-body"},[t("div",{staticClass:"c-title c-title--m"},[e._v("エンタメ記事の除外機能について")]),t("div",{staticClass:"c-text c-text--m"},[e._v(" 除外機能を有効にすることで以下の記事配信がされなくなります。 "),t("ul",[t("li",[e._v("AIによりエンタメ記事と判定された記事")]),t("li",[e._v("下記に記載されているメディアの記事")])])]),t("div",{staticClass:"sites"},e._l(e.sites.items,function(a){return t("div",{key:a.id,staticClass:"site"},[t("div",{staticClass:"name c-text c-text--m"},[e._v(e._s(a.name))]),t("div",{staticClass:"url c-text c-text--s"},[e._v(e._s(a.hostname))])])}),0)])]},proxy:!0},{key:"footer",fn:function(){return[t("div",{staticClass:"m-footer"})]},proxy:!0}])})],1)},Ry=[],Oy=T(Ly,Uy,Ry,!1,null,"9590e728",null,null);const Gy=Oy.exports,qy=D({components:{addUserModal:po},setup(){const s=ie(),e=se(),t=fe(),a=l(()=>Number(s.params.contractId)),{data:n,state:r}=Qe(),{data:o}=wr(a),i=l(()=>r.value===be.SUCCESS),u=l(()=>{var d,_;const m=((d=o.value)==null?void 0:d.users.map(h=>h.id))??[];return((_=n.value)==null?void 0:_.users.filter(h=>h.is_deleted===!1&&!m.includes(h.id)&&h.role==="admin"))??[]}),c=async m=>{try{await F.addManagementContractManagingUsers(a.value,m),t.$emit("contract-member-added"),e.commit("snackbar/addMessages",{message:"契約管理者に追加しました",type:""}),p()}catch(d){throw e.commit("snackbar/addMessages",{message:"契約管理者に追加できませんでした",type:"error"}),d}},p=()=>{e.commit("modal/hideModal")};return{isLoaded:i,hideModal:p,selectableUsers:u,addUsers:c}}});var Hy=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("addUserModal",{attrs:{users:e.selectableUsers,isLoaded:e.isLoaded},on:{"click-add-button":e.addUsers,close:e.hideModal}})},Vy=[],jy=T(qy,Hy,Vy,!1,null,null,null,null);const Ky=jy.exports,Yy=D({components:{FeedHeader:c3,LeftMenu:dh,Snackbar:Ea,ConfirmationModal:to,UserEditModal:Gg,ArticleShare:xh,GroupCreate:Kg,CommentCreate:$h,CommentCreateWithoutArticleModal:Rh,CommentEdit:Vh,ThemeSettingsInfoModal:Gy,UserInvite:Ny,AddContractUserModal:Ky,TranslateNotificationModal:Fy,DialogGroupMark:ey,MarkModal:ry,GroupAdminUserEditModal:Sg,ThemeTopicSelectModal:Ay},props:{memberGroupIds:{type:Array},personalThemeIds:{type:Array}},setup(s){const e=se(),t=Te(),a=ie(),n=Ye(),r=fe(),{memberGroupIds:o,personalThemeIds:i}=$e(s);Mn(jr,{memberGroupIds:o,personalThemeIds:i});const u=l(()=>e.state.confirmationModal.confirmationModalOpen),c=l(()=>e.state.userEditModal.userEditModalOpen),p=l(()=>e.state.modal.modalType),m=l(()=>e.state.modal.modalOpen),d=l(()=>e.state.feedType.feedType),_=l(()=>e.state.teamInfo.teamInfo),h=l(()=>e.getters["themeList/favoriteThemes"]),v=g(void 0);ne(async()=>{await C(),f(),v.value&&_.value&&cs(v.value,_.value,h.value),v.value&&V3(v.value),r.$on("article-updated",K=>{$(K)}),document.addEventListener("visibilitychange",()=>{N.isActive()&&document.visibilityState==="visible"&&F.trackAccess()})});const f=()=>{{const K=document.createElement("script");K.setAttribute("id","ze-snippet"),K.setAttribute("src","https://static.zdassets.com/ekr/snippet.js?key=847dd7fe-899c-4d7c-8996-f43e9d25499a"),document.head.appendChild(K),window.zESettings={webWidget:{color:{theme:"#98D0BC"},offset:{horizontal:"4px",vertical:"14px"},authenticate:{chat:{jwtFn:function(le){fetch("/api/v1/integrations/zendesk").then(function(ye){ye.text().then(function(H){le(H)})})}}}}}}},C=async()=>{var le;if(!N.isActive())return;if(v.value=await F.fetchMyInfo(),S(),N.getUserId(),v.value.is_deleted){N.clear(n),e.commit("resetState"),t.push({name:"login"});return}N.start(v.value.id,v.value.team_id,n),e.commit("userInfo/setUserInfo",v.value),e.commit("userActions/setMyActionCount",v.value);const K=N.getFeedType();y.value&&A(),await Promise.all([e.dispatch("teamUsers/fetchTeamUsers"),e.dispatch("teamInfo/fetchTeamInfo"),e.dispatch("groups/fetchGroups",(le=v.value)==null?void 0:le.id),e.dispatch("themeList/fetchThemeList",K),F.trackAccess()]),b()},y=l(()=>{const K=a.query;return K&&K.widget==="comment"&&K.articleId}),A=async()=>{var le;const K=await k();((le=K.comments)==null?void 0:le.length)>0?t.replace(`/comments/${K.comments[0].id}`):t.replace("/")},k=async()=>await F.fetchDocument(Number(a.query.articleId),"article"),S=()=>{li(K=>{v.value!==void 0&&K.setUser({id:String(v.value.id)})})},b=()=>{const K=["anewsHome","themeFeed"],le=N.getIsShownTranslateNotification();d.value==="foreign"&&K.includes(a.name||"")&&!le&&e.commit("modal/showModal","translateNotification")};Z(()=>a.query,()=>{y.value&&A()}),Z(()=>[d.value,a.name],b),Z(_,()=>{var K;((K=_.value)==null?void 0:K.enable_foreign_lang_media)===!1&&d.value!=="domestic"&&e.dispatch("feedType/updateFeedType","domestic")});const U=l(()=>a.name==="notifications"),I=l(()=>a.meta.type==="user"),w=l(()=>{var K;return a.meta.type==="user"&&Number(a.params.userId)===((K=v.value)==null?void 0:K.id)||a.meta.type==="userSettings"}),x=l(()=>w.value||!(I.value||U.value)),B=()=>{c.value&&e.commit("userEditModal/hideUserEditModal"),e.commit("modal/hideModal")},$=async K=>{switch(a.name){case"userMarks":e.dispatch("userActions/updateUserMarkArticleLocally",{article:K});break;case"search":e.dispatch("searchResults/updateArticleLocally",{article:K});break}};let P=g(!0);P.value=N.getLeftMenuIsExpanded();const M=g(!1),O=()=>{P.value&&(M.value=!1),N.setLeftMenuIsExpanded(!P.value),P.value=!P.value},Y=()=>{M.value=!0},W=g(!1);Z(()=>P.value,()=>{W.value=!0,setTimeout(()=>W.value=!1,320)});const j=l(()=>P.value||M.value);return{confirmationModalOpen:u,userEditModalOpen:c,modalType:p,modalOpen:m,showTranslateNotification:b,isSubNavigationEnable:x,hidePopUp:B,isHovering:M,isMenuVisible:j,isExpanded:P,isMenuTransitioning:W,toggleIsFolded:O,openFoldedTemporary:Y}}});var Qy=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"p-main-view",attrs:{tabindex:"0"},on:{keydown:function(a){return!a.type.indexOf("key")&&e._k(a.keyCode,"esc",27,a.key,["Esc","Escape"])?null:e.hidePopUp.apply(null,arguments)}}},[t("div",[e.confirmationModalOpen?t("ConfirmationModal"):e._e(),e.userEditModalOpen?t("userEditModal"):e._e(),e.modalOpen&&e.modalType==="articleShare"?t("ArticleShare"):e._e(),e.modalOpen&&e.modalType==="groupCreate"?t("GroupCreate"):e._e(),e.modalOpen&&e.modalType==="commentCreate"?t("CommentCreate"):e._e(),e.modalOpen&&e.modalType==="commentCreateWithoutArticle"?t("CommentCreateWithoutArticleModal"):e._e(),e.modalOpen&&e.modalType==="commentEdit"?t("CommentEdit"):e._e(),e.modalOpen&&e.modalType==="themeSettingsInfo"?t("ThemeSettingsInfoModal"):e._e(),e.modalOpen&&e.modalType==="translateNotification"?t("TranslateNotificationModal"):e._e(),e.modalOpen&&e.modalType==="userInvite"?t("UserInvite"):e._e(),e.modalOpen&&e.modalType==="addContractUser"?t("AddContractUserModal"):e._e(),e.modalOpen&&e.modalType==="groupMark"?t("DialogGroupMark"):e._e(),e.modalOpen&&e.modalType==="mark"?t("MarkModal"):e._e(),e.modalOpen&&e.modalType==="groupAdminUserEdit"?t("GroupAdminUserEditModal"):e._e(),e.modalOpen&&e.modalType==="themeTopicSelect"?t("ThemeTopicSelectModal"):e._e()],1),t("div",{staticClass:"header"},[t("FeedHeader")],1),t("Snackbar"),t("div",{staticClass:"p-feed-page-body"},[t("div",{staticClass:"p-feed-left-menu-wrapper",on:{mouseenter:()=>e.isMenuTransitioning?void 0:e.isHovering=!0,mouseleave:()=>e.isMenuTransitioning?void 0:e.isHovering=!1}},[t("div",{staticClass:"p-feed-left-menu",class:{"p-feed-left-menu-no-subnavi":!e.isSubNavigationEnable||!e.isMenuVisible}},[t("LeftMenu",{attrs:{isMenuVisible:e.isMenuVisible,isExpanded:e.isExpanded},on:{toggleIsFolded:e.toggleIsFolded}})],1)]),t("div",{staticClass:"p-feed-content",class:{"p-feed-content-no-subnavi":!e.isSubNavigationEnable||!e.isMenuVisible}},[t("router-view",{attrs:{isMenuVisible:e.isMenuVisible},on:{openLeftMenu:e.openFoldedTemporary}})],1)])],1)},Wy=[],zy=T(Yy,Qy,Wy,!1,null,"73e89901",null,null);const Jy=zy.exports,Xy=D({setup(){const s=fe(),e=se(),t=Te(),a=ie(),{data:n}=et(),r=g(void 0),o=g(void 0),i=g(void 0);r.value=N.getSelectedThemeTopic(),s.$on("select-theme-topics",f=>{o.value=f}),s.$on("select-theme-topic",f=>{r.value=f,N.setSelectedThemeTopic(f)}),s.$on("select-perspective",f=>{i.value=f});const u=l(()=>a.path=="/onboarding/theme_topic_select"||a.path=="/onboarding/theme_perspective_select"),c=l(()=>i.value&&Object.keys(i.value).length>0),p=l(()=>{var S;const f=((S=n.value)==null?void 0:S.enable_foreign_lang_media)??!1;let C=[],y=[];C=r.value?[r.value]:[],y=Br(C,i.value,f);const A=y.filter(b=>b!=null&&b!=="");return A.filter((b,U)=>A.indexOf(b)===U)}),m=async()=>{var A,k,S;let f=r.value?r.value.name:"";(A=i.value)!=null&&A.name&&i.value.name!==""&&(f+=`_${i.value.name}`);const C=r.value&&r.value.id>=0?[r.value.name]:[],y=i.value?[i.value.question]:[];try{const b=(k=n.value)==null?void 0:k.enable_technical_literature,U=await F.createTheme(f,"",p.value,C,y,((S=n.value)==null?void 0:S.enable_foreign_lang_media)??!1,b??!1,b??!1,!1,!0,!1,[],"personal",void 0,void 0,!1,!0);await e.dispatch("themeList/fetchThemeList"),await F.addUserTheme(U.id),await F.postFavoriteTheme(U.id),await F.updateUserNeedOnboarding(!1),N.deleteSelectedThemeTopic(),t.push({name:"themeFeed",params:{themeId:U.id.toString()}})}catch{e.commit("snackbar/addMessages",{message:"テーマを作成できませんでした",type:"error"})}},d=()=>{m()},_=async()=>{let f="onboarding_job_selection";a.name==="themeTopicSelect"&&(f="onboarding_interest_input"),a.name==="themePerspectiveSelect"&&(f="onboarding_perspective_input"),await F.trackEvent("skip_onboarding",{pageName:f,pageUrl:a.fullPath},void 0,void 0,void 0),await F.updateUserNeedOnboarding(!1),t.push("/")},h=l(()=>a.path==="/onboarding/theme_topic_select"),v=l(()=>h.value?"/onboarding/job_select":"/onboarding/theme_topic_select");return{submit:d,isDisplayActionButton:u,isEnableSubmitButton:c,skipOnboarding:_,backToPath:v,isThemeTopicSelect:h,keywordList:p}}});var Zy=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"p-account-footer"},[t("div",{staticClass:"skip-link"},[t("a",{staticClass:"c-title c-title--m",on:{click:function(a){return a.preventDefault(),e.skipOnboarding.apply(null,arguments)}}},[e._v(" この手順をスキップ ")])]),e.isDisplayActionButton?t("div",{staticClass:"action-buttons"},[t("div",{staticClass:"spacing-16"}),t("router-link",{attrs:{to:e.backToPath}},[t("button",{staticClass:"c-btn c-btn--auto"},[e._v("戻る")])]),t("div",{staticClass:"spacing-16"}),e.isThemeTopicSelect?e._e():t("button",{staticClass:"c-btn c-btn--AnewsPrimary c-btn--auto",class:{disabled:!e.isEnableSubmitButton},attrs:{disabled:!e.isEnableSubmitButton},on:{click:e.submit}},[e._v(" 確定 ")])],1):e._e(),t("div",{staticClass:"spacing-footer-right"})])},eC=[],tC=T(Xy,Zy,eC,!1,null,"7b44eee2",null,null);const sC=tC.exports,aC=D({components:{Footer:sC},setup(){const s=se(),e=Te(),t=Ye();ne(async()=>{await a()});const a=async()=>{if(!N.isActive())return;const n=await F.fetchMyInfo();if(n.is_deleted){N.clear(t),s.commit("resetState"),e.push({name:"login"});return}N.start(n.id,n.team_id,t),await s.commit("userInfo/setUserInfo",n),await s.commit("userActions/setMyActionCount",n),await F.trackAccess();const r=N.getFeedType(),[o]=await Promise.all([F.fetchTeamInfo(),s.dispatch("themeList/fetchThemeList",r)]),i=s.getters["themeList/favoriteThemes"];cs(n,o,i)};return{}}});var nC=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"p-account"},[e._m(0),t("div",{staticClass:"p-account-body gray-1000"},[t("router-view")],1),t("Footer")],1)},rC=[function(){var s=this,e=s._self._c;return s._self._setupProxy,e("div",{staticClass:"p-account-header"},[e("img",{staticClass:"p-anews-logo",attrs:{src:Bt}})])}],oC=T(aC,nC,rC,!1,null,"2843007b",null,null);const iC=oC.exports,uC=D({components:{Avatar:at,RelativeTime:Vr},props:{notification:{type:Object,required:!0},isUnRead:{type:Boolean,required:!0}},setup(s){const{data:e}=Qe(),t=m=>{var _;const d=(_=e.value)==null?void 0:_.users.find(h=>h.id===m);return d?d.image_url:""},a=l(()=>{var m,d,_,h;switch(s.notification.type){case"comment_followed_up_comment":case"mark_followed_up_comment":return(m=s.notification.article)==null?void 0:m.comments.slice(-1)[0];case"mention":return s.notification.comment;case"reply_comment":return s.notification.parent_comment;case"comment_reaction":return{id:((d=s.notification.comment_reaction)==null?void 0:d.parent_comment_id)??((_=s.notification.comment_reaction)==null?void 0:_.comment_id),user_id:(h=s.notification.comment_reaction)==null?void 0:h.user_id,children:[]}}return{children:[]}}),n=l(()=>s.notification.group_invitation),r=l(()=>{var m,d,_;switch(s.notification.type){case"group_invitation":return n.value.user_id;case"reply_comment":return(m=a.value.children)==null?void 0:m.filter(h=>h.id===s.notification.reply_comment_id)[0].user_id;case"theme_invitation":return(d=s.notification.theme_invitation)==null?void 0:d.user_id;default:return(_=a.value)==null?void 0:_.user_id}}),o=l(()=>{var d,_,h,v,f,C,y;if(s.notification.type==="group_invitation")return`/#/groups/${n.value.group_id}`;if(s.notification.type==="theme_invitation")return`/#/themes/${(d=s.notification.theme_invitation)==null?void 0:d.theme_id}`;if(s.notification.type==="first_personal_news")return"/#/personal-news";if(s.notification.type==="update_theme_feed")return`/#/themes/${(_=s.notification.theme)==null?void 0:_.id}`;const m=s.notification.article??((h=s.notification.comment)==null?void 0:h.article)??((v=s.notification.parent_comment)==null?void 0:v.article);if(m){const A=m.comments.slice(-1).pop(),k=((f=s.notification.comment)==null?void 0:f.id)??s.notification.reply_comment_id??((C=s.notification.comment_reaction)==null?void 0:C.comment_id)??(A==null?void 0:A.id);return`/#${Jn(m,k)}`}else if((y=a.value)!=null&&y.id)return`/#/comments/${a.value.id}`;return""}),i=l(()=>t(r.value)),u=l(()=>{switch(s.notification.type){case"comment_followed_up_comment":case"mark_followed_up_comment":return Ec(s.notification);case"mention":return Fc(s.notification);case"group_invitation":return Tc(s.notification);case"reply_comment":return Dc(s.notification);case"comment_reaction":return Bc(s.notification);case"theme_invitation":return Sc(s.notification);case"first_personal_news":return"パーソナルニュースの配信が開始されました。このニュース配信は今後のあなたの行動で徐々に良くなっていきます。今後も情報収集や情報共有を進めて、より良いニュースに出会えるようになりましょう。";case"update_theme_feed":return Ic(s.notification);default:return""}}),c={allowedTags:["a","img","span"],allowedAttributes:{a:["href","target","style","class"],img:["src","class","style"],span:["class"]},allowedSchemesByTag:{img:["data"]}},p=l(()=>Qt(u.value,c));return{imageUrl:i,userId:r,url:o,sanitizedNotificationText:p}}});var cC=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("a",{staticClass:"m-notification-card",class:{"no-link":e.url===""},attrs:{href:e.url}},[e.notification.type==="first_personal_news"?t("div",{staticClass:"check-mark"},[t("sm-icons",{staticClass:"large primary"},[e._v("check-circle-fill")])],1):e.notification.type==="update_theme_feed"?t("div",{staticClass:"check-mark"},[t("sm-icons",{staticClass:"large"},[e._v("sync-gray400")])],1):t("router-link",{attrs:{to:`/users/${e.userId}`}},[t("Avatar",{attrs:{imageUrl:e.imageUrl}})],1),t("div",{staticClass:"spacing-16"}),t("div",[t("div",{staticClass:"notification-text c-text c-text--m",class:{unread:e.isUnRead},domProps:{innerHTML:e._s(e.sanitizedNotificationText)}}),t("div",{staticClass:"notification-time c-text c-text--xs"},[t("RelativeTime",{attrs:{datetime:e.notification.created_at,hideTooltip:!0}})],1)])],1)},lC=[],dC=T(uC,cC,lC,!1,null,"3738eed8",null,null);const mC=dC.exports,_C=D({components:{NotificationCard:mC,SwrScrollingPagination:wt,Header:Se,Content:Ue},setup(){const s=fe(),e=g(0);ne(async()=>{F.sendLastNotificationViewedAt(),s.$emit("clear-notification-count");const a=await F.fetchNotification(1,1);e.value=a.count});const{data:t}=nt();return{pageLimit:10,paginationFunc:yr,dataAccessor:a=>a==null?void 0:a.notification.items,themes:t,unreadCount:e}}});var pC=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"o-notifications"},[t("Header",{attrs:{title:"お知らせ"}}),t("Content",[t("SwrScrollingPagination",{ref:"pagination",attrs:{pageLimit:e.pageLimit,paginationFunc:e.paginationFunc,dataAccessor:e.dataAccessor},scopedSlots:e._u([{key:"default",fn:function({items:a,loaded:n}){return[n&&a.length&&e.themes?t("div",{staticClass:"o-notification-timeline"},e._l(a,function(r,o){return t("NotificationCard",{key:r.id,staticClass:"notification-card",attrs:{notification:r,isUnRead:e.unreadCount>o}})}),1):e._e(),n&&a.length==0?t("div",{staticClass:"o-empty-notification"},[t("div",{staticClass:"o-empty-title c-title c-title--m"},[e._v(" お知らせはありません ")]),t("div",{staticClass:"o-empty-text c-text c-text--m"},[e._v(" コメントで「反応」があったときに通知が届きます。 ")])]):e._e()]}}])})],1)],1)},vC=[],fC=T(_C,pC,vC,!1,null,"ba99910c",null,null);const gC=fC.exports,hC=D({props:{currentStep:{type:Number,required:!0},stepNum:{type:Number,required:!0}}});var yC=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("ul",{staticClass:"stepper",class:{"stepper-mini":e.stepNum<=3}},e._l(e.stepNum,function(a){return t("li",{key:a,class:[e.currentStep>=a?"done":"ready"]},[t("div",{staticClass:"item",attrs:{"data-item":a}})])}),0)},CC=[],bC=T(hC,yC,CC,!1,null,"df002a6c",null,null);const Da=bC.exports,AC=D({components:{StepperProgress:Da},setup(s,e){const t=Te(),a=ie(),{data:n,state:r}=Er(),o=l(()=>{var c;return((c=n.value)==null?void 0:c.job_types)??[]}),i=g(""),u=async c=>{try{await F.updateUserJobType(c),t.push({name:"themeTopicSelect"})}catch(p){throw i.value="予期せぬエラーが発生しました。",p}};return Z(()=>r.value,()=>{var c;r.value===be.SUCCESS&&((c=n.value)==null?void 0:c.job_types.length)===0&&t.push({name:"anewsHome"})}),ne(async()=>{await F.trackPageView({pageName:"onboarding_job_selection",pageUrl:a.fullPath})}),{jobTypes:o,clickJobType:u,errorMessage:i}}});var kC=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",[t("StepperProgress",{attrs:{"current-step":1,"step-num":3}}),t("div",{staticClass:"spacing-12"}),t("div",{staticClass:"c-title c-title--xl"},[e._v("Anewsへようこそ")]),t("div",{staticClass:"spacing-12"}),t("div",{staticClass:"c-text c-text--m"},[e._v(" Anewsはあなたの興味に合ったニュースをAIが配信します。 ")]),t("div",{staticClass:"spacing-32"}),t("div",{staticClass:"job-select"},[t("div",{staticClass:"c-text c-text--m"},[e._v("まずはあなたのお仕事を教えてください。")]),t("div",{staticClass:"spacing-12"}),e._l(e.jobTypes,function(a){return t("div",{key:a.id},[t("div",{staticClass:"job-select-item",on:{click:function(n){return e.clickJobType(a.id)}}},[t("span",{staticClass:"c-text c-text--m"},[e._v(e._s(a.name))]),t("sm-icons",[e._v("angle-right")])],1),t("div",{staticClass:"spacing-12"})])}),e.errorMessage?t("div",{staticClass:"c-formBlock__text c-formBlock__text--error"},[e._v(" "+e._s(e.errorMessage)+" ")]):e._e()],2)],1)},xC=[],wC=T(AC,kC,xC,!1,null,"837aada3",null,null);const EC=wC.exports,FC=D({components:{ThemePerspectiveSelectForm:mo,StepperProgress:Da},setup(){const s=fe(),e=ie(),t=g(""),a=g(void 0),n=r=>{a.value=r,s.$emit("select-perspective",a.value)};return ne(async()=>{await F.trackPageView({pageName:"onboarding_perspective_input",pageUrl:e.fullPath})}),{errorMessage:t,selectPerspective:a,selectedPerspective:n}}});var TC=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",[t("StepperProgress",{attrs:{"current-step":3,"step-num":3}}),t("div",{staticClass:"spacing-12"}),t("ThemePerspectiveSelectForm",{attrs:{"select-perspective":e.selectPerspective},on:{"selected-perspective":e.selectedPerspective}}),e.errorMessage?t("div",{staticClass:"c-formBlock__text c-formBlock__text--error"},[e._v(" "+e._s(e.errorMessage)+" ")]):e._e()],1)},DC=[],BC=T(FC,TC,DC,!1,null,"4dfa6d22",null,null);const SC=BC.exports,IC=D({props:{keyword:{type:String,default:""}},setup(s,e){const t=ls(di(s,"keyword"),Vn),{data:a}=sl(t),n=l(()=>{const i=s.keyword;if(i.trim().length===0)return[];const u=[{id:-1,name:i,query_ja:i,query_en:"",recommendedKeyword:""}];if(!a.value)return u;const c=Object.entries(a.value.similar_keywords);return u.push(...c.map(p=>{const m=`${i} OR ${p[0]}`;return{id:-1,name:m,query_ja:m,query_en:"",recommendedKeyword:p[0]}})),u}),r=ie();return{recommendedCombinations:n,buttonClicked:i=>{var p;e.emit("select-theme-topic",i);const u=Object.keys(((p=a.value)==null?void 0:p.similar_keywords)??{}).indexOf(i.recommendedKeyword)+1,c={pageName:"onboarding_interest_input",pageUrl:r.fullPath,keywords:[i.query_ja],from:"keyword_recommendation",rank:u,topics:[],theme:{},perspectives:[]};F.trackThemeEvent("add_keywords",c)}}}});var MC=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",[e.recommendedCombinations.length>0?t("div",{staticClass:"c-title c-title--m"},[e._v(" おすすめ ")]):e._e(),t("div",{staticClass:"o-recommended-combinations"},e._l(e.recommendedCombinations,function(a){return t("button",{key:a.name,staticClass:"c-btn c-btn--auto c-btnOutline",on:{click:function(n){return e.buttonClicked(a)}}},[e._v(" "+e._s(a.name)+" ")])}),0)])},$C=[],PC=T(IC,MC,$C,!1,null,"a32a958a",null,null);const NC=PC.exports,ds={"invalid-not":"ハイフン(-)と単語の間にスペースが入っており、NOT条件が機能していない箇所があります。","only-not-keywords":"NOT条件単体でのテーマ設定はできません。","only-hyphen":"ハイフン(-)のみでのテーマ設定はできません。","duplicate-keyword":"重複しているキーワード設定があります。","vertical-bar":"バーティカルバー（|）は使用できません。","greater-than":"不等号（>）は使用できません。","less-than":"不等号（<）は使用できません。","unmatched-parenthesis":"()で閉じられていない箇所があります。","unmatched-double-quote":'ダブルクオーテーション（"）で閉じられていない箇所があります。',"creating-and-condition":"AND条件が指定されていない箇所があります。","creating-or-condition":"OR条件が指定されていない箇所があります。","no-space-parenthesis":"()と他のキーワードの間に空白が必要です。","not-condition-on-parenthesis":"()はNOT条件を使用できません。","empty-parenthesis":"クオーテーションを使用する際は、キーワードを囲ってください。"};function LC(s){const e=/[^\s"]+|"([^"]*)"/gi,t=[];let a=[];do a=e.exec(s),a!==null&&t.push(a[1]?a[1]:a[0]);while(a!==null);return t}function UC(s){return s.replace(/（/g,"(").replace(/）/g,")").replace(/“/g,'"').replace(/”/g,'"')}function vo(s){const e=s.toLowerCase().replace(/\s+/g," ").replace(/(^|\s)-"/g,'$1"-'),t=LC(e);return Array.from(new Set(t))}const Es=s=>{const e=[],t=vo(s);t.length>0&&(t.length===1&&t[0]==="-"?e.push("only-hyphen"):t.includes("-")?e.push("invalid-not"):t.filter(r=>!r.startsWith("-")).length===0&&e.push("only-not-keywords"));const a=UC(s);return(r=>{var c,p;let o=0,i=0;const u=r.split('"');for(let m=0;m<u.length;m+=2)o+=((c=u[m].match(/\(/g))==null?void 0:c.length)??0,i+=((p=u[m].match(/\)/g))==null?void 0:p.length)??0;return Math.abs(i-o)})(a)!==0&&e.push("unmatched-parenthesis"),(a.match(/"/g)||[]).length%2!==0&&e.push("unmatched-double-quote"),(a.match(/-\(/g)||[]).length>0&&e.push("not-condition-on-parenthesis"),(a.match(/(?!\(\(*)(?!\S\)\)+)(?!-\()(\S\(\s|\S\(\S|\s\)\S|\S\)\S)/g)||[]).length>0&&e.push("no-space-parenthesis"),t.filter(r=>r===" "||r.match(/(^""?$)|(^''?$)/)).length>0&&e.push("empty-parenthesis"),(s.match(/\|/g)||[]).length>0&&e.push("vertical-bar"),(s.match(/>/g)||[]).length>0&&e.push("greater-than"),(s.match(/</g)||[]).length>0&&e.push("less-than"),t.slice(-1)[0]==="and"&&e.push("creating-and-condition"),t.slice(-1)[0]==="or"&&e.push("creating-or-condition"),e},Ba=s=>{const e=[],t=[];return s.forEach(a=>{const n=vo(a);n.length>0&&t.push(n.sort().join(" "))}),t.length>new Set(t).size&&e.push("duplicate-keyword"),e},RC=s=>[...s.flatMap(Es),...Ba(s)],OC=D({components:{AutocompleteInput:Fa,StepperProgress:Da,ThemeTopicOneSelectForm:_o,ThemeKeywordRecommendSelect:NC},setup(){const s=fe(),e=ie(),t=Te(),a=i=>{s.$emit("select-theme-topic",i),t.push({name:"themePerspectiveSelect"})};ne(async()=>{await F.trackPageView({pageName:"onboarding_interest_input",pageUrl:e.fullPath})});const n=g(""),r=Ft-Yi,o=l(()=>{const u=Es(n.value).map(c=>ds[c]);return n.value.length>r&&u.push(`キーワードは合計で${r}文字以内になるように入力してください。`),u});return{selectThemeTopic:a,trimmedKeyword:n,newKeywordErrors:o}}});var GC=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",[t("StepperProgress",{attrs:{"current-step":2,"step-num":3}}),t("div",{staticClass:"spacing-12"}),t("div",{staticClass:"c-title c-title--xl"},[e._v("あなたの興味を教えてください")]),t("div",{staticClass:"spacing-12"}),t("div",{staticClass:"c-text c-text--m"},[e._v(" 興味や業務に関連するキーワードを入力、またはトピックを指定してください。 ")]),t("div",{staticClass:"spacing-24"}),t("div",{staticClass:"c-title c-title--m"},[e._v("キーワード")]),t("div",[e._l(e.newKeywordErrors,function(a,n){return t("div",{key:n+"_"+a,staticClass:"m-new-keyword-error c-formBlock__text c-formBlock__text--error"},[e._v(" "+e._s(a)+" ")])}),t("AutocompleteInput",{staticClass:"keyword-input autocomplete-input",scopedSlots:e._u([{key:"default",fn:function({value:a,handlers:n}){return[t("input",e._g({staticClass:"c-text c-text--m c-textInput",class:{"c-formInput--error":e.newKeywordErrors.length>0},attrs:{placeholder:"カーボンニュートラル"},domProps:{value:a}},n))]}}]),model:{value:e.trimmedKeyword,callback:function(a){e.trimmedKeyword=typeof a=="string"?a.trim():a},expression:"trimmedKeyword"}})],2),e.trimmedKeyword.length>0&&e.newKeywordErrors.length===0?t("ThemeKeywordRecommendSelect",{staticClass:"keyword-recommend",attrs:{keyword:e.trimmedKeyword},on:{"select-theme-topic":e.selectThemeTopic}}):e._e(),t("ThemeTopicOneSelectForm",{attrs:{filter:e.trimmedKeyword},on:{"select-theme-topic":e.selectThemeTopic}})],1)},qC=[],HC=T(OC,GC,qC,!1,null,"4806160c",null,null);const VC=HC.exports,jC=(s,e,t)=>{const a={news:void 0,research_papers:void 0};if(e.has_personal_news&&e.personal_news_article_counts){const n=s==="all"&&((t==null?void 0:t.enable_foreign_lang_media)??!1),r=e.personal_news_article_counts??{domestic:0,foreign:0},o=n?r.domestic+r.foreign:r[s];a.news=o;const i=e.personal_news_research_paper_counts??{domestic:0,foreign:0},u=n?i.domestic+i.foreign:i[s];a.research_papers=u}return a},fo=(s,e,t)=>{var n,r;if(((n=e.value)==null?void 0:n.enable_technical_literature)&&((r=t.value)!=null&&r.has_personal_news)){const o=jC(s.value,t.value,e.value);return[{name:"ニュース",count:o.news,linkTo:{name:"personalNews"}},{name:"論文",count:o.research_papers,linkTo:{name:"personalResearchPapers"}}]}else return},KC=D({components:{Header:Se,Content:Ue,PersonalNewsCountdown:eo,FeedArticles:us},setup(){const s=se(),e=ie(),{data:t}=xe(),{data:a}=et(),n=l(()=>s.state.feedType.feedType),r=l(()=>fo(n,a,t));return ne(()=>{F.trackPageView({pageName:"personal_news",pageUrl:e.fullPath})}),{userInfo:t,feedType:n,tabs:r}}});var YC=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"personal-news"},[t("Header",{attrs:{title:"パーソナルニュース",detail:"あなた専用のニュースをお届けします",tabs:e.tabs,isOneLine:!0}}),t("Content",[e.userInfo?t("div",{staticClass:"feed-content"},[e.userInfo.has_personal_news?t("div",{staticClass:"articles"},[t("FeedArticles",{attrs:{feed:"personal_news"}})],1):t("div",{staticClass:"no-articles"},[t("PersonalNewsCountdown",{attrs:{actionedArticleCounts:e.userInfo.personal_news_counts??{domestic:0,foreign:0}},on:{openLeftMenu:function(a){return e.$emit("openLeftMenu")}}})],1)]):e._e()])],1)},QC=[],WC=T(KC,YC,QC,!1,null,"23c06f6f",null,null);const zC=WC.exports,JC=D({components:{AdpDocumentCard:Re,BasicEmptyFeed:xt,ThemeEmptyFeed:hs},props:{title:{type:String,required:!0},formattedFeedDate:{type:String},displayFeedType:{type:String,required:!0},themeFeedType:{type:String,required:!0},docType:{type:String,required:!0},adpDocuments:{type:Array,required:!0},initialFeedCount:{type:Number,default:20},maxFeedCount:{type:Number,default:200},theme:{type:Object},enableToEditTheme:{type:Boolean},pageName:{type:String,required:!0},feature:{type:String,required:!0},markSource:{type:String}},setup(s){const{adpDocuments:e}=$e(s),t=g(e.value.length>s.initialFeedCount),a=l(()=>e.value.slice(0,t.value?s.initialFeedCount:s.maxFeedCount)),n=()=>t.value=!1,r=`${Ir[s.docType]}はありませんでした。`;return{isShowAllButtonVisible:t,visibleAdpDocuments:a,loadAllAdpDocuments:n,noFeedMessage:r}}});var XC=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"document-list"},[t("div",{staticClass:"title c-title c-title--xm"},[t("div",{staticClass:"title-text"},[e._v(e._s(e.title))]),e.formattedFeedDate?t("div",{staticClass:"feed-date c-text c-text--m"},[e._v(" "+e._s(e.formattedFeedDate)+" ")]):e._e(),t("div",{staticClass:"feed-count c-text c-text--s"},[e._v(" ・ "+e._s(e.adpDocuments.length)+"件 ")])]),t("div",{staticClass:"divider"}),e._l(e.visibleAdpDocuments,function(a,n){return t("div",{key:a.id,staticClass:"document-card-wrapper"},[t("AdpDocumentCard",{attrs:{width:"100%",adpDocument:a,isRead:a.is_read,themeId:a.theme_id,pageName:e.pageName,feature:e.feature,markSource:e.markSource}}),n!==e.visibleAdpDocuments.length-1?t("div",{staticClass:"divider"}):e._e()],1)}),e.isShowAllButtonVisible?t("div",{staticClass:"view-more-button__wrapper"},[t("div",{staticClass:"view-more-button c-text c-text--m",on:{click:()=>e.loadAllAdpDocuments()}},[e._v(" すべて表示"+e._s(`（${e.adpDocuments.length-20}）`)+" ")])]):e._e(),e.adpDocuments.length===0?[e.theme?t("ThemeEmptyFeed",{attrs:{displayFeedType:e.displayFeedType,themeFeedType:e.themeFeedType,docType:e.docType,theme:e.theme,enableToEditTheme:e.enableToEditTheme}},[e._v(e._s(e.noFeedMessage))]):t("BasicEmptyFeed",[e._v(e._s(e.noFeedMessage))])]:e._e()],2)},ZC=[],eb=T(JC,XC,ZC,!1,null,"77922109",null,null);const tb=eb.exports,sb=D({components:{AdpDocumentList:tb},props:{feedType:{type:String,required:!0},formattedFeedDate:{type:String},domesticPapers:{type:Array,required:!0},domesticPatents:{type:Array,required:!0},foreignPapers:{type:Array,required:!0},theme:{type:Object},enableToEditTheme:{type:Boolean,default:!1}},setup(s){var c,p;const e=s.theme===void 0,t=e?"メディア":"論文ジャーナル",a=e?"personal_research_papers":"theme_technical_literature",n=e?"personal_research_paper_feed":"research_paper_feed",r="patent_feed",o=e?"personal_feed":"theme",i=e||((c=s.theme)==null?void 0:c.is_research_paper_enabled),u=(p=s.theme)==null?void 0:p.is_patent_enabled;return{isPersonalNews:e,researchPaperTitle:t,pageName:a,researchPaperFeature:n,patentFeature:r,markSource:o,showResearchPapers:i,showPatents:u}}});var ab=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"technical-literature-list"},[e.feedType==="all"||e.feedType==="domestic"?[t("AdpDocumentList",{attrs:{title:`国内${e.researchPaperTitle}`,formattedFeedDate:e.formattedFeedDate,displayFeedType:e.feedType,themeFeedType:"domestic",docType:"research_paper",theme:e.theme,enableToEditTheme:e.enableToEditTheme,adpDocuments:e.showResearchPapers?e.domesticPapers:[],initialFeedCount:e.feedType==="all"?20:200,pageName:e.pageName,feature:e.researchPaperFeature,markSource:e.markSource}}),e.isPersonalNews?e._e():t("AdpDocumentList",{attrs:{title:"国内特許",formattedFeedDate:e.formattedFeedDate,displayFeedType:e.feedType,themeFeedType:"domestic",docType:"patent",theme:e.theme,enableToEditTheme:e.enableToEditTheme,adpDocuments:e.showPatents?e.domesticPatents:[],initialFeedCount:e.feedType==="all"?20:200,pageName:e.pageName,feature:e.patentFeature,markSource:e.markSource}})]:e._e(),e.feedType==="all"||e.feedType==="foreign"?[t("AdpDocumentList",{attrs:{title:`海外${e.researchPaperTitle}`,formattedFeedDate:e.formattedFeedDate,displayFeedType:e.feedType,themeFeedType:"foreign",docType:"research_paper",theme:e.theme,enableToEditTheme:e.enableToEditTheme,adpDocuments:e.showResearchPapers?e.foreignPapers:[],initialFeedCount:e.feedType==="all"?20:200,pageName:e.pageName,feature:e.researchPaperFeature,markSource:e.markSource}})]:e._e()],2)},nb=[],rb=T(sb,ab,nb,!1,null,"b4183c4a",null,null);const ob=rb.exports,ib=D({components:{TechnicalLiteratureList:ob},props:{title:{type:String},feedCount:{type:Number},feedDate:{type:String},domesticPapers:{type:Object,default:()=>({items:[],state:be.SUCCESS})},domesticPatents:{type:Object,default:()=>({items:[],state:be.SUCCESS})},foreignPapers:{type:Object,default:()=>({items:[],state:be.SUCCESS})},theme:{type:Object},enableToEditTheme:Boolean},setup(s){const{domesticPapers:e,domesticPatents:t,foreignPapers:a,feedDate:n}=$e(s),r=se(),o=fe(),i=l(()=>r.state.feedType.feedType),u=(v,f)=>v.id===f.id&&v.doc_type===f.doc_type,c=(v,f)=>{const C=v.findIndex(y=>u(y,f));return C>=0&&(v[C].marks=f.marks,v[C].is_read=f.is_read),v},p=v=>{const f=v.doc_type=="patent"?t:v.lang=="en"?a:e;c(f.value.items,v)},m=Fe({article:[],research_paper:[],patent:[]}),d=({id:v,doc_type:f})=>{m[f].push(v)},_=({id:v,doc_type:f})=>{const C=[...m[f]];C.includes(v)&&(m[f]=C.filter(y=>y!==v))};ne(async()=>{o.$on("article-updated",p),o.$on("personal-feed-article-removed",d),o.$on("personal-feed-article-restored",_)}),Be(()=>{o.$off("article-updated",p),o.$off("personal-feed-article-removed",d),o.$off("personal-feed-article-restored",_)});const h=l(()=>[...e.value.items,...t.value.items,...a.value.items].filter(v=>!v.is_new).length>0);return{feedType:i,STATES:be,formattedFeedDate:dr((n==null?void 0:n.value)??""),hasPastPapers:h,removedDocumentIds:m}}});var ub=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"technical-literature-feed"},[t("div",{key:`${e.feedType}-${e.domesticPapers.state}-${e.domesticPatents.state}-${e.foreignPapers.state}`,staticClass:"feed"},[["all","domestic"].includes(e.feedType)&&e.domesticPapers.state===e.STATES.SUCCESS||["all","domestic"].includes(e.feedType)&&e.domesticPatents.state===e.STATES.SUCCESS||["all","foreign"].includes(e.feedType)&&e.foreignPapers.state===e.STATES.SUCCESS?[t("div",{staticClass:"new-papers"},[t("TechnicalLiteratureList",{attrs:{feedType:e.feedType,theme:e.theme,domesticPapers:e.domesticPapers.items.filter(a=>a.is_new&&!e.removedDocumentIds[a.doc_type].includes(a.id)),domesticPatents:e.domesticPatents.items.filter(a=>a.is_new&&!e.removedDocumentIds[a.doc_type].includes(a.id)),foreignPapers:e.foreignPapers.items.filter(a=>a.is_new&&!e.removedDocumentIds[a.doc_type].includes(a.id)),enableToEditTheme:e.enableToEditTheme,formattedFeedDate:e.formattedFeedDate}})],1),t("div",{staticClass:"spacing-16"}),e.hasPastPapers?t("div",{staticClass:"old-papers"},[t("div",{staticClass:"header c-title c-title--xm"},[e._v("過去の配信")]),t("div",{staticClass:"spacing-16"}),t("TechnicalLiteratureList",{attrs:{feedType:e.feedType,theme:e.theme,domesticPapers:e.domesticPapers.items.filter(a=>!a.is_new&&!e.removedDocumentIds[a.doc_type].includes(a.id)),domesticPatents:e.domesticPatents.items.filter(a=>!a.is_new&&!e.removedDocumentIds[a.doc_type].includes(a.id)),foreignPapers:e.foreignPapers.items.filter(a=>!a.is_new&&!e.removedDocumentIds[a.doc_type].includes(a.id)),enableToEditTheme:e.enableToEditTheme}})],1):e._e()]:e._e()],2)])},cb=[],lb=T(ib,ub,cb,!1,null,"f69dc536",null,null);const go=lb.exports,db=D({components:{Header:Se,Content:Ue,ResearchPaperFeed:go},setup(){const s=se(),e=Te(),t=ie(),a=fe(),n=N.getUserId(),{data:r,mutate:o}=xe(),{data:i}=et(),u=l(()=>{var A;const y=((A=r.value)==null?void 0:A.personal_news_research_paper_counts)??{domestic:0,foreign:0};return p.value==="all"?y.domestic+y.foreign:y[p.value]});ne(()=>{F.trackPageView({pageName:"personal_research_papers",pageUrl:t.fullPath}),a.$on("personal-feed-article-removed",()=>o()),a.$on("personal-feed-article-restored",()=>o())}),Be(()=>{a.$off("personal-feed-article-removed",()=>o()),a.$off("personal-feed-article-restored",()=>o())}),Z(()=>r.value,()=>{var y;(y=r.value)!=null&&y.has_personal_news||e.push({name:"personalNews"})});const c=l(()=>{var y;return(y=i.value)==null?void 0:y.enable_technical_literature});Z(()=>i.value,()=>{c.value||e.push({name:"personalNews"})});const p=l(()=>s.state.feedType.feedType),m=l(()=>fo(p,i,r)),{data:d,state:_}=an(p,n??0,"domestic",g(1),50),{data:h,state:v}=an(p,n??0,"foreign",g(1),50),f=l(()=>{var y;return{items:((y=d.value)==null?void 0:y.research_paper_feeds)??[],state:_.value}}),C=l(()=>{var y;return{items:((y=h.value)==null?void 0:y.research_paper_feeds)??[],state:v.value}});return{userInfo:r,feedType:p,STATES:be,tabs:m,feedCount:u,domesticPapers:f,foreignPapers:C}}});var mb=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"personal-news"},[t("Header",{attrs:{title:"パーソナルニュース",detail:"あなた専用のニュースをお届けします",tabs:e.tabs,isOneLine:!0}}),t("Content",[e.userInfo?t("div",{staticClass:"feed-content"},[t("ResearchPaperFeed",{attrs:{feedCount:e.feedCount,feedDate:e.userInfo.personal_news_research_papers_updated_at??void 0,maxFeedCount:50,domesticPapers:e.domesticPapers,foreignPapers:e.foreignPapers}})],1):e._e()])],1)},_b=[],pb=T(db,mb,_b,!1,null,"141314f5",null,null);const vb=pb.exports,fb=D({components:{SearchBar:At},props:{optionName:{type:String,required:!0},options:{type:Array,required:!0},selectedOptions:{type:Array,default:()=>[]},title:{type:String,default:""},searchOption:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},setup(s,e){const{optionName:t}=s,{options:a,selectedOptions:n}=$e(s),r=Fe({items:[]}),o=()=>r.items=[...n.value],i=g(!1),u=g(),c=y=>{const A=(y==null?void 0:y.composedPath())??[];u.value&&(!y||!A.includes(u.value))&&(i.value=!1),o()};ne(async()=>{document.addEventListener("click",c)}),Be(()=>{document.removeEventListener("click",c)});const p=l(()=>s.title!==""?s.title:n.value.length===0||n.value.length===a.value.length?`すべての${t}`:`${n.value.length}${t}`),m=g(""),d=y=>m.value=y,_=l(()=>m.value?a.value.filter(y=>y.name.toLowerCase().includes(m.value.toLowerCase())):a.value),h=(y,A)=>{A?r.items.push(y):r.items=r.items.filter(k=>k!==y)},v=()=>{r.items=a.value.map(y=>y.name)},f=()=>{r.items=[]},C=()=>{e.emit("selectionUpdated",[...r.items]),c()};return Z(()=>n.value,()=>r.items=[...n.value]),Z(i,y=>e.emit(y?"open":"close")),{internalSelectedOptions:r,isSelectionOpen:i,displayTitle:p,filterQuery:m,setFilterQuery:d,filteredOptions:_,toggleOptionSelection:h,selectAll:v,deselectAll:f,confirmSelection:C,multiselectRef:u}}});var gb=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"multi-select"},[t("div",{ref:"multiselectRef",staticClass:"multi-select-box",on:{click:function(a){e.isSelectionOpen=!e.isSelectionOpen}}},[t("div",{staticClass:"c-selectBox c-selectBox--small"},[t("span",{staticClass:"c-selectBox__placeholder c-text--s"},[e._v(" "+e._s(e.displayTitle)+" ")]),t("sm-icons",{staticClass:"c-selectBox__arrow small"},[e._v("angle-down")])],1)]),e.isSelectionOpen?t("div",{staticClass:"option-select dashboard-card",on:{click:function(a){return a.stopPropagation(),(()=>{}).apply(null,arguments)}}},[e._t("detail"),e.searchOption?t("div",{staticClass:"option-search-bar"},[t("SearchBar",{on:{onChangeQuery:e.setFilterQuery}})],1):e._e(),t("div",{staticClass:"option-list"},[e.options.length===0&&e.filterQuery.length===0?t("div",{staticClass:"options-empty c-text c-text--m"},[e._v(" 未設定 ")]):e._e(),e.filteredOptions.length===0&&e.filterQuery.length>0?t("div",{staticClass:"options-empty c-text c-text--m"},[e._v(" 指定した"+e._s(e.optionName)+"は存在しません。 ")]):e._e(),e._l(e.filteredOptions,function(a){return t("div",{key:a.name,staticClass:"option"},[t("sm-checkbox-label",{staticClass:"checkbox-label",attrs:{value:e.internalSelectedOptions.items.includes(a.name),disabled:e.disabled},on:{change:function(n){return e.toggleOptionSelection(a.name,n)}}},[t("span",{class:{empty:a.name===""}},[e._v(" "+e._s(a.name===""?"未記入":a.name)+" ")]),a.count!==void 0?t("span",[e._v(" ("+e._s(a.count)+") ")]):e._e()])],1)})],2),t("div",{staticClass:"option-buttons"},[t("button",{staticClass:"button--borderless",class:{disabled:e.disabled},attrs:{disabled:e.disabled},on:{click:e.selectAll}},[e._v(" すべて選択 ")]),t("button",{staticClass:"button--borderless",class:{disabled:e.disabled},attrs:{disabled:e.disabled},on:{click:e.deselectAll}},[e._v(" 選択解除 ")]),t("button",{staticClass:"button--primary",class:{disabled:e.disabled},attrs:{disabled:e.disabled},on:{click:e.confirmSelection}},[e._v(" 適用 ")])])],2):e._e()])},hb=[],yb=T(fb,gb,hb,!1,null,"22a27e32",null,null);const Cb=yb.exports,bb=D({props:{isSearching:{type:Boolean,required:!0},searchQuery:{type:String},isEntertainmentFilter:{type:Boolean,required:!0},isInitialSearch:{type:Boolean,required:!0},convertedQuery:{type:String},resultCount:{type:Number},selectedDocumentTypeLabels:{type:Array,required:!0}},setup(s){const e=l(()=>!s.isSearching&&s.resultCount&&s.resultCount>0),t=l(()=>s.selectedDocumentTypeLabels.length===0?"ニュース・論文・特許":s.selectedDocumentTypeLabels.join("・"));return{hasResult:e,documentTypeLabel:t}}});var Ab=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"search-result-message c-text c-text--m"},[t("span",[t("strong",[e._v(e._s(e.searchQuery))]),e._v(" を探しています...")]),e.isInitialSearch?e._e():t("span",[t("strong",[e._v(e._s(e.searchQuery))]),e._v(" に一致する"+e._s(e.documentTypeLabel)+"は見つかりませんでした。 ")]),!e.isInitialSearch&&(!e.convertedQuery||e.convertedQuery.length===0)?t("span",[e._v(" 検索ワードを広げて探す準備をしています。 ")]):e._e(),e.convertedQuery&&e.convertedQuery.length>0?t("span",[t("strong",[e._v(e._s(e.convertedQuery))]),e._v(" を探しています... ")]):e._e(),e.hasResult&&e.resultCount?t("span",[t("strong",{attrs:{id:"search-result-count"}},[e._v(e._s(e.resultCount.toLocaleString())+"件")]),e._v("の結果が見つかりました。 ")]):e.isSearching?e._e():t("div",[e.isInitialSearch||e.convertedQuery&&e.convertedQuery.length>0?t("span",[t("strong",[e._v(e._s(e.convertedQuery?e.convertedQuery:e.searchQuery))]),e._v(" に一致する"+e._s(e.documentTypeLabel)+"は見つかりませんでした。... ")]):t("span",[e._v(" 検索ワードを広げることができませんでした。 ")]),t("div",{staticClass:"no-results"},[t("div",{staticClass:"c-text c-text--m"},[t("div",[e._v("以下の対処方法をお試しください。")]),t("div",{staticClass:"spacing-16"}),e._m(0),t("div",{staticClass:"spacing-16"}),t("span",{staticClass:"help"},[e._v("その他、入力方法や仕様につきましてはヘルプページの"),t("a",{staticClass:"link",attrs:{href:"https://anews-stockmark.zendesk.com/hc/ja/articles/360057467693-%E6%A4%9C%E7%B4%A2%E6%A9%9F%E8%83%BD",target:"_blank"}},[t("div",{staticClass:"primary-link"},[e._v("検索機能")]),t("sm-icons",{staticClass:"small primary-icon"},[e._v("external-link")])],1)]),t("span",[e._v("をご覧ください。")])])])])])},kb=[function(){var s=this,e=s._self._c;return s._self._setupProxy,e("ul",[e("li",[s._v("誤字や脱字がないかの確認。")]),e("li",[s._v("別の言い回しに変える。")]),e("li",[s._v("キーワードをスペースで区切る。")]),e("li",[s._v("期間やメディアの指定を広げる。")]),e("li",[s._v("長音「ー」の有無で検索結果が変わる場合があります。")])])}],xb=T(bb,Ab,kb,!1,null,"92365226",null,null);const wb=xb.exports,vn=100,Eb=D({components:{AdpDocumentCard:Re,Header:Se,AdpDocumentCardSkeleton:Yt,SearchResultMessage:wb,MultiSelect:Cb,TagItem:Nt},setup(){const s=se(),e=ie(),t=Te(),a=l(()=>s.state.searchResults.resultCount),n=l(()=>s.state.searchResults.resultArticles),r=l(()=>s.state.searchResults.isLastPage),o=l(()=>s.state.teamInfo.teamInfo),i=l(()=>{var X;return(X=o.value)==null?void 0:X.enable_technical_literature}),u=g(void 0),c=g(void 0),p=g(void 0),m=new Map([["all","期間指定なし"],["1d","24時間以内"],["1w","1週間以内"],["1m","1ヶ月以内"],["6m","6ヶ月以内"],["1y","1年以内"]]),d=g(void 0),_=g(void 0),h=new Map([["recommended_v2","おすすめ順"],["popular","人気順"],["latest","最新順"]]),v=g(void 0),f=g(void 0),C=new Map([["ja","国内メディア"],["en","海外メディア"],["all","すべてのメディア"]]),y=g(!1);let A=new dt(()=>{},1);const k=g(!1),S=g(!0),b=g(!0),U=g(!1),I=g(void 0);mi(()=>{var X;if(u.value=e.query.query,c.value=e.query.period,p.value=c.value,d.value=e.query.sort,_.value=d.value,y.value=((X=e.query.entertainment_filter)==null?void 0:X.toLowerCase())!=="false",e.query.doc_types){let te=[],E=[];_e.forEach(function(L,V){e.query.doc_types.includes(V)&&(te.push(L),E.push(V))}),J.value=te,ee.value=E}else J.value=["ニュース"],ee.value=["article"];K()}),Xe(async()=>{await s.dispatch("searchResults/reset"),A.removeEvent()});const w=l(()=>{var X;return((X=o.value)==null?void 0:X.enable_foreign_lang_media)===void 0}),x=l(()=>({placeholder:m.values().next().value,labels:Array.from(m.values()),values:Array.from(m.keys()),label:m.get(c.value??"")})),B=l(()=>({placeholder:h.values().next().value,labels:Array.from(h.values()),values:Array.from(h.keys()),label:h.get(d.value??"")})),$=l(()=>{var X;return{placeholder:C.values().next().value,labels:Array.from(C.values()),values:Array.from(C.keys()),disabledValues:(X=o.value)!=null&&X.enable_foreign_lang_media?[]:["en","all"],label:C.get(v.value??"")}}),P=()=>{y.value=!y.value,k.value=!0,j()},M=X=>{p.value=X.value,k.value=!0,j()},O=X=>{_.value=X.value,k.value=!0,j()},Y=X=>{f.value=X.value,k.value=!0,j()},W=l(()=>({query:u.value??"",lang:f.value??C.keys().next().value,period:p.value??m.keys().next().value,sort:_.value??h.keys().next().value,result_count:String(a.value),is_entertainment_sites_filtered:y.value})),j=()=>{const X=e.query;X.lang===f.value&&X.period===p.value&&X.sort===_.value&&X.entertainment_filter===y.value.toString()&&X.doc_types===ee.value||t.push({name:"search",query:{query:u.value,lang:f.value,period:p.value,sort:_.value,entertainment_filter:y.value.toString(),doc_types:ee.value}})},K=async()=>{var X,te,E;if(!w.value){const L=(X=o.value)!=null&&X.enable_foreign_lang_media?"all":"ja";v.value=e.query.lang||L,f.value=v.value,f.value!=="ja"&&!((te=o.value)!=null&&te.enable_foreign_lang_media)&&(v.value="ja",Y({name:"",value:"ja"})),(E=o.value)!=null&&E.enable_technical_literature||ce(["ニュース"]),await ye()}};Z(w,K),Z(()=>e.query,async()=>{if(e.name!=="search")return;const X=u.value!==e.query.query;u.value=e.query.query,(X||k.value)&&(b.value=!0,I.value=void 0,await ye())});const ye=async()=>{S.value=!0,await s.dispatch("searchResults/reset"),A.removeEvent();const X=async(te,E)=>{U.value=!0;const L=b.value&&u.value,V=!b.value&&I.value!==void 0;if(L||V){if(await s.dispatch("searchResults/search",{searchData:{query:I.value?I.value:u.value,lang:f.value==="all"?void 0:f.value,period:p.value,sort:_.value||"recommended_v2",entertainment_filter:y.value,original_query:b.value?void 0:u.value,query_keywords:I.value,doc_types:ee.value.length===0?["article","research_paper","patent"]:ee.value},pageLimit:E,page:te}),b.value&&u.value&&!u.value.match(lt)&&a.value===0){b.value=!1;try{const re=await F.getNaturalSentenceQueryKeywords(u.value);I.value=re.query_keywords.join(" "),A=new dt(X,vn)}catch{I.value="",S.value=!1}return}S.value=!1,U.value=!1,r.value&&A.removeEvent()}};A=new dt(X,vn),k.value=!1},H=async()=>{const X=!b.value&&I.value?[I.value]:u.value?[u.value]:[];await F.trackThemeEvent("to_create_theme",{pageName:"search",pageUrl:e.fullPath,from:"search",keywords:X}),t.push({name:"themeCreate",query:{query:X[0]}})},ue=l(()=>i.value?J.value.length!==0:!1),_e=new Map([["article","ニュース"],["research_paper","論文"],["patent","特許"]]),me=l(()=>Array.from(_e.values()).map(X=>({name:X}))),de=l(()=>J.value.length===0?"":`選択中の情報 : ${J.value.length}件`),ee=g([]),J=g([]),ce=X=>{J.value=X,R(),k.value=!0,j()},ke=X=>{const te=J.value.indexOf(X);J.value.splice(te,1),R(),k.value=!0,j()},R=()=>{let X=[];_e.forEach(function(te,E){J.value.includes(te)&&X.push(E)}),ee.value=X},ve=l(()=>"clamp(830px, calc(100vw - 500px), 852px)");return{resultCount:a,resultArticles:n,isLastPage:r,searchQuery:u,isEntertainmentFilter:y,isSearching:S,loading:w,searchPeriodProps:x,resultOrderProps:B,langOptionProps:$,toggleEntertainmentFilter:P,selectSearchPeriod:M,selectResultOrder:O,selectLang:Y,searchData:W,createTheme:H,isInitialSearch:b,convertedQuery:I,showSelectedInformationTypes:ue,enableTechnicalLiterature:i,selectedDocumentTypeLabels:J,selectInformationTypes:me,informationTypesUpdate:ce,documentTypeTitle:de,removeTag:ke,headerContentWidth:ve,isPaginationSearching:U}}});var Fb=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"o-search-result"},[t("Header",{attrs:{contentWidth:e.headerContentWidth},scopedSlots:e._u([{key:"titleMenu",fn:function(){return[t("div",{staticClass:"o-filters"},[t("sm-selectbox",e._b({staticClass:"small",on:{selected:e.selectSearchPeriod}},"sm-selectbox",e.searchPeriodProps,!1)),t("sm-selectbox",e._b({staticClass:"small",on:{selected:e.selectLang}},"sm-selectbox",e.langOptionProps,!1)),t("MultiSelect",{attrs:{optionName:"情報種別",title:e.documentTypeTitle,options:e.selectInformationTypes,selectedOptions:e.selectedDocumentTypeLabels,disabled:!e.enableTechnicalLiterature},on:{selectionUpdated:e.informationTypesUpdate},scopedSlots:e._u([e.enableTechnicalLiterature?null:{key:"detail",fn:function(){return[t("div",{staticClass:"multi-select-detail"},[t("span",{staticClass:"c-text c-text--m"},[e._v("オプション契約者様のみ、ご利用できます。")])])]},proxy:!0}],null,!0)}),t("sm-toggle-button",{staticClass:"m-sm-toggle-button",attrs:{labels:["","エンタメ記事フィルタ"],value:e.isEntertainmentFilter},on:{change:e.toggleEntertainmentFilter}})],1)]},proxy:!0},{key:"button",fn:function(){return[t("button",{staticClass:"o-to-create-theme outlined c-outlineBtn c-btn--auto c-outlineBtn--secondary",attrs:{disabled:e.isSearching||e.resultCount===0},on:{click:e.createTheme}},[e._v(" テーマに設定し新着を受け取る ")])]},proxy:!0}])}),e.loading?e._e():t("div",{staticClass:"o-search"},[e.showSelectedInformationTypes?[t("div",{staticClass:"spacing-24"}),t("div",{staticClass:"selected-information-type-row"},[t("span",{staticClass:"selected-information-type-label c-text c-text--s"},[e._v("選択中の情報")]),e._l(e.selectedDocumentTypeLabels,function(a){return t("TagItem",{key:a,staticClass:"selected-information-type-item",attrs:{name:a,isDelete:!0,showTooltip:!1},on:{deleteTag:function(n){return e.removeTag(a)}}})})],2),t("div",{staticClass:"spacing-24"})]:t("div",{staticClass:"spacing-16"}),t("div",[t("sm-selectbox",e._b({staticClass:"small",on:{selected:e.selectResultOrder}},"sm-selectbox",e.resultOrderProps,!1)),t("SearchResultMessage",{attrs:{isSearching:e.isSearching,searchQuery:e.searchQuery,isEntertainmentFilter:e.isEntertainmentFilter,isInitialSearch:e.isInitialSearch,convertedQuery:e.convertedQuery,resultCount:e.resultCount,selectedDocumentTypeLabels:e.selectedDocumentTypeLabels}})],1),e.isSearching?t("div",{staticClass:"searching"},e._l(Array.from(Array(5)),function(a){return t("AdpDocumentCardSkeleton",{key:a,staticClass:"skeleton-card"})}),1):e._e(),e.resultArticles.length>0?t("div",{staticClass:"o-results"},[e._l(e.resultArticles,function(a,n){return t("div",{key:a.id,staticClass:"o-article-card"},[t("AdpDocumentCard",{attrs:{pageName:"search",markSource:"search",feature:"search",adpDocument:a,rankInWholeFeed:n+1,searchData:e.searchData,width:"100%"}})],1)}),e.isPaginationSearching?t("div",{staticClass:"loading-container"},[t("div",{staticClass:"spacing-16"}),t("sm-loading",{staticClass:"loading"})],1):e.isLastPage?t("div",{staticClass:"o-no-more-results c-text c-text--m"},[e._v(" これ以上、記事はありません ")]):e._e()],2):e._e()],2)],1)},Tb=[],Db=T(Eb,Fb,Tb,!1,null,"07d7bd4f",null,null);const Bb=Db.exports,fn=[{label:"HTML",value:"html"},{label:"テキスト",value:"text"}],Sb=D({components:{Header:Se,Content:Ue,SettingToggleCard:fa},setup(){const s=se(),e=ie(),{data:t}=va(),{data:a}=et(),n=l(()=>{var p;return(p=a.value)==null?void 0:p.enable_technical_literature}),r=p=>{t.value&&(t.value[p]=!t.value[p])},o=async()=>{if(t.value)try{await F.updateUserSettings(t.value,{pageName:"email",pageUrl:e.fullPath}),s.commit("snackbar/addMessages",{message:"設定を更新しました",type:""})}catch(p){throw s.commit("snackbar/addMessages",{message:"設定を更新できませんでした",type:"error"}),p}},i=fn.map(p=>p.label),u=fn.map(p=>p.value);return{userSettings:t,toggleSetting:r,contentTypeLabels:i,contentTypeValues:u,selectContentType:({value:p})=>{t.value&&(t.value.mail_content_type=p)},submit:o,isTechnicalLiteratureEnabled:n}}});var Ib=function(){var e=this,t=e._self._c;return e._self._setupProxy,e.userSettings?t("div",{staticClass:"user-settings"},[t("Header",{attrs:{title:"メール配信"}}),t("Content",[t("div",{staticClass:"settings-card"},[t("div",{staticClass:"c-formBlock"},[t("div",{staticClass:"c-formBlock__label"},[e._v(" Anewsダイジェスト（定期配信メール） ")]),t("div",{staticClass:"spacing-12"}),t("div",{staticClass:"content-type"},[t("div",{staticClass:"spacing-16"}),t("div",[t("div",{staticClass:"c-text c-text--m"},[e._v("配信形式")]),t("div",{staticClass:"spacing-04"}),t("div",{staticClass:"content-type-description c-text c-text--s"},[e._v(" Anewsダイジェストを、HTMLもしくはテキスト形式に変更することができます。 ")]),t("div",{staticClass:"spacing-04"}),t("sm-selectbox",{staticClass:"small content-type-select",attrs:{placeholder:e.userSettings.mail_content_type=="text"?"テキスト":"HTML",labels:e.contentTypeLabels,values:e.contentTypeValues},on:{selected:e.selectContentType}})],1)]),t("SettingToggleCard",{attrs:{title:"新着ニュース",description:"お気に入りしているテーマの最新ニュースを配信します。",enabled:e.userSettings.enabled_theme_favorite_mail,alignToTop:!0},on:{toggle:function(a){return e.toggleSetting("enabled_theme_favorite_mail")}}}),t("SettingToggleCard",{attrs:{title:"先週のハイライト",description:"コメントやマーク、グループマークされたニュースをランキング形式にして配信します。",enabled:e.userSettings.enabled_team_activity_mail,alignToTop:!0},on:{toggle:function(a){return e.toggleSetting("enabled_team_activity_mail")}}}),t("SettingToggleCard",{attrs:{title:"本日の読み逃しニュース",description:"あなたがまだ読んでいないニュースの中から興味に合うニュースを配信します。",enabled:e.userSettings.enabled_overlooked_mail,alignToTop:!0},on:{toggle:function(a){return e.toggleSetting("enabled_overlooked_mail")}}}),e.isTechnicalLiteratureEnabled?t("SettingToggleCard",{attrs:{title:"新着論文",description:"お気に入りしているテーマの最新論文を配信します。",enabled:e.userSettings.enabled_new_research_papers_mail,alignToTop:!0},on:{toggle:function(a){return e.toggleSetting("enabled_new_research_papers_mail")}}}):e._e()],1),t("div",{staticClass:"c-formBlock"},[t("div",{staticClass:"c-formBlock__label"},[e._v("お知らせ通知")]),t("SettingToggleCard",{attrs:{title:"＠メンション",description:"あなたにメンションがあったときに受信します。",enabled:e.userSettings.enabled_mention_notfication_mail,alignToTop:!0},on:{toggle:function(a){return e.toggleSetting("enabled_mention_notfication_mail")}}}),t("SettingToggleCard",{attrs:{title:"返信コメント",description:"あなたのコメントに返信があったときに配信します。",enabled:e.userSettings.enabled_reply_comment_notification_mail,alignToTop:!0},on:{toggle:function(a){return e.toggleSetting("enabled_reply_comment_notification_mail")}}}),t("SettingToggleCard",{attrs:{title:"コメント増加",description:"あなたがコメントした記事にコメントがついたときに配信します。",enabled:e.userSettings.enabled_comment_notification_mail,alignToTop:!0},on:{toggle:function(a){return e.toggleSetting("enabled_comment_notification_mail")}}}),t("SettingToggleCard",{attrs:{title:"マークした記事にコメント",description:"マークした記事に誰かがコメントしたときに配信します。",enabled:e.userSettings.enabled_mark_notification_mail,alignToTop:!0},on:{toggle:function(a){return e.toggleSetting("enabled_mark_notification_mail")}}})],1),t("div",{staticClass:"spacing-12"}),t("button",{staticClass:"c-btn c-btn--small c-btn--AnewsPrimary",on:{click:e.submit}},[e._v(" 保存 ")])])])],1):e._e()},Mb=[],$b=T(Sb,Ib,Mb,!1,null,"5457ffda",null,null);const Pb=$b.exports,Nb=D({components:{Header:Se,Content:Ue,SettingToggleCard:fa},setup(){const s=se(),e=ie(),{data:t}=va();return{userSettings:t,toggleSetting:r=>{t.value&&(t.value[r]=!t.value[r])},submit:async()=>{if(t.value)try{await F.updateUserSettings(t.value,{pageName:"news",pageUrl:e.fullPath}),s.commit("snackbar/addMessages",{message:"設定を更新しました",type:""})}catch(r){throw s.commit("snackbar/addMessages",{message:"設定を更新できませんでした",type:"error"}),r}}}}});var Lb=function(){var e=this,t=e._self._c;return e._self._setupProxy,e.userSettings?t("div",{staticClass:"user-settings"},[t("Header",{attrs:{title:"ニュース配信"}}),t("Content",[t("div",{staticClass:"settings-card"},[t("div",{staticClass:"c-formBlock"},[t("SettingToggleCard",{attrs:{title:"英語記事のタイトル翻訳",description:"海外メディア記事のタイトルが翻訳された形で表示されます。",enabled:e.userSettings.enable_translate_article_title,alignToTop:!0},on:{toggle:function(a){return e.toggleSetting("enable_translate_article_title")}}}),t("SettingToggleCard",{attrs:{title:"要ログイン記事の非表示",description:"ログインの必要な記事が表示されなくなります。",enabled:e.userSettings.enable_hide_login_required_article,alignToTop:!0},on:{toggle:function(a){return e.toggleSetting("enable_hide_login_required_article")}}}),t("SettingToggleCard",{attrs:{title:"パーソナルニュースのエンタメ系ニュースの配信停止",description:"パーソナルニュースにエンタメ系ニュースが配信されなくなります。なお、設定を変更したときの適応は翌日の配信分からになります。",enabled:e.userSettings.enable_personal_news_entertainment_filter,alignToTop:!0},on:{toggle:function(a){return e.toggleSetting("enable_personal_news_entertainment_filter")}}})],1),t("div",{staticClass:"spacing-24"}),t("button",{staticClass:"c-btn c-btn--small c-btn--AnewsPrimary",on:{click:e.submit}},[e._v(" 保存 ")])])])],1):e._e()},Ub=[],Rb=T(Nb,Lb,Ub,!1,null,"c435392d",null,null);const Ob=Rb.exports,Gb=D({components:{Header:Se,Content:Ue,PasswordForm:ia},setup(){const s=se(),e=ie(),{data:t}=xe(),a=g(0),n=g(""),r=g(""),o=g(!1),i=l(()=>n.value!==r.value),u=({password:m,isValid:d})=>{r.value=m,o.value=d},c=l(()=>n.value.length>0&&o.value&&i.value);return{userInfo:t,timesChanged:a,currentPassword:n,isNewPasswordValid:o,isNewPasswordDifferent:i,newPasswordUpdated:u,canSubmit:c,submit:async()=>{try{await F.changePassword(n.value,r.value,{pageName:"password",pageUrl:e.fullPath}),s.commit("snackbar/addMessages",{message:"パスワードを変更しました",type:""}),n.value="",r.value="",a.value+=1}catch{s.commit("snackbar/addMessages",{message:"パスワードを変更できませんでした。現在のパスワードを再入力してください。",type:"error"})}}}}});var qb=function(){var e=this,t=e._self._c;return e._self._setupProxy,e.userInfo?t("div",{staticClass:"user-settings"},[t("Header",{attrs:{title:"パスワード"}}),t("Content",[t("div",{staticClass:"settings-card"},[t("div",{staticClass:"c-formBlock"},[t("div",{staticClass:"c-formBlock__label"},[e._v("現在のパスワード")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.currentPassword,expression:"currentPassword"}],staticClass:"c-textInput",attrs:{type:"password",placeholder:""},domProps:{value:e.currentPassword},on:{input:function(a){a.target.composing||(e.currentPassword=a.target.value)}}}),t("div",{staticClass:"spacing-04"}),t("router-link",{staticClass:"forgot-password c-text c-text--m",attrs:{to:{name:"forgotPassword"}}},[e._v("パスワードを忘れてしまった場合")])],1),t("div",{staticClass:"spacing-12"}),t("div",{staticClass:"c-formBlock"},[t("PasswordForm",{on:{"password-changed":e.newPasswordUpdated}}),e.currentPassword.length>0&&e.isNewPasswordValid&&!e.isNewPasswordDifferent?t("div",{staticClass:"c-formBlock__text c-formBlock__text--error"},[t("div",{staticClass:"c-text--s"},[e._v(" 現在のパスワードと変わらないため、パスワードを変更できません。 ")]),t("div",{staticClass:"c-text--s"},[e._v(" 再度、新しいパスワードを入力してください。 ")])]):e._e()],1),t("div",{staticClass:"spacing-24"}),t("button",{staticClass:"c-btn c-btn--small c-btn--AnewsPrimary",class:{disabled:!e.canSubmit},attrs:{disabled:!e.canSubmit},on:{click:e.submit}},[e._v(" 変更 ")])])])],1):e._e()},Hb=[],Vb=T(Gb,qb,Hb,!1,null,"34ba8270",null,null);const jb=Vb.exports,Kb=D({components:{Header:Se,Content:Ue},setup(){const s=se(),e=ie(),{data:t}=xe(),{data:a}=va(),{data:n}=Pe(),r=g("public"),o=()=>{a.value&&(r.value=a.value.mypage_access_scope==="group"?`group-${a.value.mypage_access_allow_group_id}`:a.value.mypage_access_scope??"public")};ne(()=>{o()}),Z(()=>a.value,()=>{o()});const i=l(()=>{if(!n.value||!a.value)return[];const m=n.value.groups.filter(d=>{var _;return((_=a.value)==null?void 0:_.mypage_access_allow_group_id)===d.id||d.group_type==="specific_user_group"&&d.is_member}).map(d=>({name:d.name,id:`group-${d.id}`}));return[{name:"全体",id:"public"},{name:"自分のみ",id:"personal"}].concat(m)}),u=({value:m})=>{r.value=m},c=l(()=>{var m;return((m=i.value.find(d=>d.id===r.value))==null?void 0:m.name)??""});return{userInfo:t,userSettings:a,groups:n,selectedScope:r,scopes:i,selectScope:u,scopeName:c,submit:async()=>{if(!a.value)return;const[m,d]=r.value.split("-");a.value.mypage_access_scope=m,a.value.mypage_access_allow_group_id=m==="group"?Number(d):void 0;try{await F.updateUserSettings(a.value,{pageName:"profile",pageUrl:e.fullPath}),s.commit("snackbar/addMessages",{message:"設定を更新しました",type:""})}catch(_){throw s.commit("snackbar/addMessages",{message:"設定を更新できませんでした",type:"error"}),_}}}}});var Yb=function(){var e=this,t=e._self._c;return e._self._setupProxy,e.userInfo&&e.userSettings&&e.groups?t("div",{staticClass:"user-settings"},[t("Header",{attrs:{title:"プロフィール"}}),t("Content",[t("div",{staticClass:"settings-card"},[t("div",{staticClass:"c-formBlock"},[t("div",{staticClass:"c-formBlock__label"},[e._v("メールアドレス")]),t("span",{staticClass:"c-formBlock__text"},[e._v(e._s(e.userInfo.email))])]),t("div",{staticClass:"c-formBlock"},[t("div",{staticClass:"c-formBlock__label"},[e._v("名前")]),t("span",{staticClass:"c-formBlock__text"},[e._v(e._s(e.userInfo.user_name))])]),t("div",{staticClass:"c-formBlock"},[t("div",{staticClass:"c-formBlock__label"},[e._v("マークの公開範囲")]),t("span",{staticClass:"c-formBlock__text"},[e._v("自分がマークをした記事の公開範囲を指定することができます。")]),t("sm-selectbox",{key:e.selectedScope,staticClass:"scope-select",attrs:{placeholder:e.scopeName,labels:e.scopes.map(a=>a.name),values:e.scopes.map(a=>a.id),optionsMaxHeight:"240px"},on:{selected:e.selectScope}})],1),t("div",{staticClass:"spacing-24"}),t("button",{staticClass:"c-btn c-btn--small c-btn--AnewsPrimary",on:{click:e.submit}},[e._v(" 保存 ")])])])],1):e._e()},Qb=[],Wb=T(Kb,Yb,Qb,!1,null,"9504ab4b",null,null);const zb=Wb.exports,Jb=D({components:{AdpDocumentCard:Re,Header:Se,Content:Ue,BasicEmptyFeed:xt},setup(){var k;const s=ie(),e=se(),{data:t}=kr(),a=s.query.topicId,n=l(()=>{var S;return((S=t.value)==null?void 0:S.industries)??[]}),r=l(()=>{var S;return(S=n.value)==null?void 0:S.find(b=>b.is_default)}),o=g(N.getIndustryId()?Number(N.getIndustryId()):(k=r.value)==null?void 0:k.id),i=l(()=>{var S;return(S=n.value)==null?void 0:S.find(b=>b.id===o.value)}),{data:u}=Ar(o),c=l(()=>{var U;const S=((U=u.value)==null?void 0:U.industry_articles.slice())??[];let b=1;return S.forEach((I,w)=>{w===0?I.rank=b:S[w-1].topic_id===S[w].topic_id?(b++,I.rank=b):(b=1,I.rank=b)}),S}),p=l(()=>c.value.length),m=l(()=>e.state.feedType.feedType),d=l(()=>{var S;return((S=i.value)==null?void 0:S.topics.filter(b=>b.article_count>0))??[]}),_=l(()=>d.value.map(S=>[S,c.value.filter(b=>b.topic_id===S.id)])),h=l(()=>{var U;const S={value:void 0,label:"未選択"},b=(U=n.value)==null?void 0:U.map(I=>({value:I.id,label:I.name}));return o.value===void 0?[S,...b]:b}),v=(S,b)=>({id:o.value??0,topic:{id:S,rank:b}}),f=({value:S})=>{N.setIndustryId(S),o.value=S},C=g(),y=S=>{var U;const b=(U=C.value)==null?void 0:U.find(I=>Number(I.dataset.topicId)===S);b&&ze(()=>{const w=b.getBoundingClientRect().top+window.pageYOffset-112;window.scrollTo({top:w,behavior:"smooth"})})};Z(()=>n.value,()=>{!N.getIndustryId()&&!o.value&&r.value&&(o.value=r.value.id,N.setIndustryId(o.value))}),ne(async()=>{await F.trackPageView({pageName:"industry_news",pageUrl:s.fullPath}),a&&y(Number(a))});const A=l(()=>m.value==="foreign"?"現在、業界ニュースは海外メディアの対応を行なっておりません。":o.value===void 0?"現在、業界が未選択になっています。":"この業界のニュースはありませんでした。");return{totalArticleCount:p,topicArticles:_,selectIndustry:f,selectOptions:h,topicRefs:C,scrollToTopic:y,feedType:m,topics:d,currentIndustry:i,getIndustryTrackingData:v,noFeedMessage:A}}});var Xb=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"industry-news"},[t("Header",{attrs:{title:"業界ニュース",detail:"業界別におすすめニュースをAIがピックアップしてお届けします",isOneLine:!0}}),t("Content",[t("div",{staticClass:"body"},[t("div",{staticClass:"select-industry"},[t("div",{staticClass:"c-text c-text--m"},[e._v("業界選択")]),t("div",{staticClass:"spacing-08"}),t("sm-selectbox",{key:`options-${e.selectOptions.length}`,staticClass:"small",attrs:{placeholder:e.currentIndustry?e.currentIndustry.name:"未選択",labels:e.selectOptions.map(a=>a.label),values:e.selectOptions.map(a=>a.value)},on:{selected:e.selectIndustry}})],1),t("div",{staticClass:"spacing-16"}),e.currentIndustry&&e.feedType!=="foreign"?t("div",[e.topics.length>0?t("div",{staticClass:"topics"},e._l(e.topics,function(a){return t("div",{key:a.id,staticClass:"topic c-text c-text--m",on:{click:function(n){return e.scrollToTopic(a.id)}}},[e._v(" "+e._s(`${a.name}(${a.article_count})`)+" ")])}),0):e._e(),t("div",{staticClass:"spacing-16"}),e._l(e.topicArticles,function([a,n]){return t("div",{key:`${a.id}`,staticClass:"topic-articles"},[t("div",{ref:"topicRefs",refInFor:!0,staticClass:"topic topic-position",attrs:{"data-topic-id":a.id}},[t("div",{staticClass:"spacing-16"}),t("div",{staticClass:"topic-name"},[t("div",{staticClass:"spacing-08"}),t("div",{staticClass:"c-text c-text--l"},[e._v(" "+e._s(a.name)+" ")])]),t("div",{staticClass:"spacing-04"}),t("div",{staticClass:"pick-up c-text c-text--m"},[e._v(" "+e._s(`「${a.query}」に該当する記事からピックアップ`)+" ")]),t("div",{staticClass:"spacing-12"})]),e._l(n,function(r){return t("div",{key:r.id},[t("div",{staticClass:"divider"}),t("AdpDocumentCard",{key:`${a.id}-${r.id}`,staticClass:"article-card",attrs:{width:"100%",pageName:"industry_news",adpDocument:r,showCommentCount:1,isRead:r.is_read,caseStudyText:r.case_study_text,trendCompanyText:r.trend_company_text,industryData:e.getIndustryTrackingData(r.topic_id,r.rank),feature:"industry_news"}})],1)})],2)})],2):e._e(),e.totalArticleCount===0||e.currentIndustry===void 0||e.feedType==="foreign"?t("div",{staticClass:"o-no-industry-articles"},[t("BasicEmptyFeed",[e._v(e._s(e.noFeedMessage))])],1):e._e()])])],1)},Zb=[],eA=T(Jb,Xb,Zb,!1,null,"082f101e",null,null);const tA=eA.exports,sA=D({props:{text:{type:String,required:!0}},setup(){const s=fe(),e=g(!1),t=()=>{e.value=!1};return ne(()=>{s.$el.addEventListener("click",t)}),Be(()=>{s.$el.removeEventListener("click",t)}),{showTooltip:e}}});var aA=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"question-tooltip"},[t("div",{staticClass:"icon",on:{click:function(a){a.stopPropagation(),e.showTooltip=!e.showTooltip}}},[t("sm-icons",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:{content:e.text,trigger:"manual",autoHide:!1,show:e.showTooltip,offset:8},expression:`{
          content: text,
          trigger: 'manual',
          autoHide: false,
          show: showTooltip,
          offset: 8
        }`,modifiers:{top:!0}}],staticClass:"small"},[e._v("question-circle")])],1)])},nA=[],rA=T(sA,aA,nA,!1,null,"9014ad21",null,null);const ho=rA.exports,gn="feature_articles",oA=D({components:{AdpDocumentCard:Re,Header:Se,Content:Ue,SwrScrollingPagination:wt,RankBadge:wa,QuestionTooltip:ho},setup(){const s=ie(),e=fe(),{data:t}=et(),a=l(()=>{var i;return(i=t.value)==null?void 0:i.industry_id});ne(async()=>{await F.trackPageView({pageName:gn,pageUrl:s.fullPath}),e.$on("article-updated",o)}),Be(()=>{e.$off("article-updated",o)});const n=(i,u)=>i.id===u,r=(i,u)=>{const c=i.findIndex(p=>p.id===u.id);return c>=0&&(i[c].marks=u.marks,i[c].is_read=u.is_read),i},o=i=>{e.$emit("pagination-items-update",u=>n(u,i.id),u=>r(u,i))};return{pageLimit:10,paginationFunc:(i,u)=>br(i,u),dataAccessor:i=>i==null?void 0:i.featured_articles,TOOLTIP_FOR_TEAM_FEATURED_ARTICLES:Ys,industryId:a,PAGE_NAME:gn}}});var iA=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"o-team-activity-feed"},[t("Header",{attrs:{title:"注目記事"},scopedSlots:e._u([{key:"titleMenu",fn:function(){return[t("QuestionTooltip",{staticClass:"icon",attrs:{text:e.TOOLTIP_FOR_TEAM_FEATURED_ARTICLES}})]},proxy:!0}])}),t("Content",[t("div",{staticClass:"o-feed"},[t("SwrScrollingPagination",{ref:"pagination",attrs:{pageLimit:e.pageLimit,paginationFunc:e.paginationFunc,dataAccessor:e.dataAccessor},scopedSlots:e._u([{key:"default",fn:function({items:a,loaded:n}){return[e._l(a,function(r,o){return t("div",{key:r.id,staticClass:"o-article-card"},[t("AdpDocumentCard",{attrs:{pageName:e.PAGE_NAME,adpDocument:r,showCommentCount:1,isRead:r.is_read,feature:"team_feature_articles"}}),o<=4?t("RankBadge",{staticClass:"rank-badge-outer",attrs:{rank:o+1}}):e._e()],1)}),n&&a.length===0?t("div",{staticClass:"o-no-featured-articles"},[t("div",{staticClass:"o-textarea-explanation o-description c-text c-text--m"},[e._v(" マークやコメントがないため注目記事がありません。"),t("br"),e._v(" 気になった記事があればマークやコメントをしていきましょう。 ")]),t("router-link",{attrs:{to:{name:"anewsHome"}}},[t("div",{staticClass:"o-link-to-home o-description c-text c-text--m"},[e._v(" ホームへ移動 ")])])],1):e._e()]}}])})],1)])],1)},uA=[],cA=T(oA,iA,uA,!1,null,"e3099b17",null,null);const lA=cA.exports,Os=10,hn=300,yn=["おすすめ(β)","新着順"],dA=D({components:{SwrScrollingPagination:wt,QuestionTooltip:ho,Header:Se,Content:Ue,AdpDocumentCard:Re,AdpDocumentCardSkeleton:Yt,TagSelect:ys,TagItem:Nt},setup(){const s=se(),e=fe(),t=ie();ne(async()=>{F.trackPageView({pageName:"team_marks",pageUrl:t.fullPath}),document.addEventListener("click",m),e.$on("article-updated",h),i.items=N.getMarkNewsSelectedUserNames()}),Be(()=>{document.removeEventListener("click",m),e.$off("article-updated",h),k==null||k.removeEvent()});const{data:a}=Qe(),{data:n}=zc(),r=l(()=>{var O;return((O=n.value)==null?void 0:O.user_mark_counts.map(Y=>({id:Y.id,name:Y.user_name,count:C.value==="foreign"?Y.count_foreign:Y.count_domestic})))??[]}),o=l(()=>[...r.value].sort((O,Y)=>-1*(O.count-Y.count))),i=Fe({items:[]}),u=O=>{c.value=!1,i.items=O,N.setMarkNewsSelectedUserNames(i.items)},c=g(!1),p=()=>{c.value=!c.value},m=()=>{c.value=!1},d=(O,Y)=>O.id===Y,_=(O,Y)=>{const W=O.findIndex(j=>j.id===Y.id);return W>=0&&(O[W].marks=Y.marks,O[W].is_read=Y.is_read),O},h=O=>{e.$emit("pagination-items-update",Y=>d(Y,O.id),Y=>_(Y,O))},v=O=>{var Y;return((Y=O.marks[0])==null?void 0:Y.theme_id)??void 0},f=O=>{i.items=i.items.filter(Y=>Y!==O),N.setMarkNewsSelectedUserNames(i.items)},C=l(()=>s.state.feedType.feedType),y=l(()=>{var O;return(O=a.value)==null?void 0:O.users.filter(Y=>i.items.includes(Y.user_name)).map(Y=>Y.id)}),A=l(()=>i.items.length>0?`メンバー ${i.items.length}`:"すべてのメンバー");let k;const S=g(Os),b=()=>{k==null||k.removeEvent(),k=new dt((O,Y)=>{S.value=O*Os},hn)},U=g(st.ANDEV_2633_RECOMMENDED_NEW_MARKS?N.getTeamMarkSort()??"recommended":"latest"),I=l(()=>{const O=Ks.indexOf(U.value);return yn[O]}),w=O=>{U.value=O.value,N.setTeamMarkSort(U.value),U.value==="recommended"&&b()};U.value==="recommended"&&b();const x=l(()=>U.value==="recommended"?hn:0),{data:B,state:$}=Kc(x,C),P=l(()=>B.value?B.value.marked_articles.slice(0,S.value):[]),M=l(()=>{const O=$.value;return O===be.PENDING||O===be.VALIDATING});return{pageLimit:Os,paginationFunc:(O,Y)=>xr(O,Y,!0,C.value=="all"?void 0:C.value,y.value),dataAccessor:O=>O==null?void 0:O.marked_articles,getThemeId:v,isOpenUserSelectBox:c,toggleUserSelectBox:p,sortedUserList:o,selectedUserNames:i,handleFilterArticles:u,userSelectBoxText:A,removeSelectedUser:f,feedType:C,sort:U,sortLabels:yn,sortSelectboxPlaceholder:I,TeamMarkSort:Ks,sortSelected:w,recommendedMarks:P,isLoadingRecommendedMarks:M,ANDEV_2633_RECOMMENDED_NEW_MARKS:st.ANDEV_2633_RECOMMENDED_NEW_MARKS}}});var mA=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"mark-news"},[t("Header",{attrs:{title:"新着マークニュース"},scopedSlots:e._u([{key:"titleMenu",fn:function(){return[t("QuestionTooltip",{staticClass:"icon",attrs:{text:"マイページ公開している全ユーザのマークした記事を表示しています。"}})]},proxy:!0}])}),t("Content",[t("div",[t("div",{staticClass:"options"},[t("span",{staticClass:"c-title c-title--m"},[e._v("ニュース")]),e.ANDEV_2633_RECOMMENDED_NEW_MARKS?[t("div",{staticClass:"spacing-16"}),t("sm-selectbox",{staticClass:"small sort-selectbox",attrs:{labels:e.sortLabels,values:e.TeamMarkSort,placeholder:e.sortSelectboxPlaceholder},on:{selected:e.sortSelected}})]:e._e(),t("div",{staticClass:"spacing-16"}),t("div",{staticClass:"user-select",on:{click:function(a){return a.preventDefault(),a.stopPropagation(),(()=>{}).apply(null,arguments)}}},[t("div",{staticClass:"user-selectbox",attrs:{inert:e.sort==="recommended"},on:{click:e.toggleUserSelectBox}},[t("sm-selectbox",{key:e.userSelectBoxText,staticClass:"small",attrs:{placeholder:e.userSelectBoxText}})],1),e.isOpenUserSelectBox?t("TagSelect",{attrs:{tagList:e.sortedUserList,targetTags:e.selectedUserNames.items,isShowCount:!1,emptyFilterMessage:"指定したメンバーは存在しません。"},on:{"filter-articles":e.handleFilterArticles}}):e._e()],1)],2),t("div",{staticClass:"spacing-16"}),t("div",{staticClass:"description c-text c-text--m"},[e.sort==="recommended"?[e._v(" あなたの興味関心に基づき、マークされた記事からおすすめの記事を表示します。 ")]:e.sort==="latest"?[e._v(" マークされた順に記事を表示します。 ")]:e._e()],2),t("div",{staticClass:"spacing-16"}),e.sort==="latest"&&e.selectedUserNames.items.length>0?t("div",[t("div",{staticClass:"selected-users"},[t("span",{staticClass:"c-text c-text--s"},[e._v("選択中のメンバー")]),e._l(e.selectedUserNames.items,function(a){return t("TagItem",{key:a,staticClass:"name",attrs:{name:a,isDelete:!0},on:{deleteTag:e.removeSelectedUser}})})],2),t("div",{staticClass:"spacing-16"})]):e._e(),e.sort==="latest"?t("SwrScrollingPagination",{key:`${[e.feedType,e.selectedUserNames.items]}`,attrs:{pageLimit:e.pageLimit,paginationFunc:e.paginationFunc,dataAccessor:e.dataAccessor},scopedSlots:e._u([{key:"default",fn:function({items:a,loaded:n}){return[n?[e._l(a,function(r){return t("AdpDocumentCard",{key:r.id,staticClass:"article-card",attrs:{adpDocument:r,showCommentCount:1,isRead:r.is_read,actionTypeOfThemeTag:"mark",showThemeTag:!0,themeId:e.getThemeId(r),pageName:"team_marks",feature:"team_marks"}})}),n&&a.length===0?t("div",{staticClass:"no-marked-articles"},[t("div",{staticClass:"c-text c-text--m"},[e._v(" マークされた記事がないため表示できません。 ")])]):e._e()]:t("div",{staticClass:"skeletons"},e._l(5,function(r){return t("AdpDocumentCardSkeleton",{key:r})}),1)]}}],null,!1,751974713)}):e.sort==="recommended"?t("div",[e.isLoadingRecommendedMarks?t("div",{staticClass:"skeletons"},e._l(5,function(a){return t("AdpDocumentCardSkeleton",{key:a})}),1):e.recommendedMarks.length===0?t("div",[t("div",{staticClass:"c-text c-text--m"},[e._v(" マークされた記事がないため表示できません。 ")])]):e._l(e.recommendedMarks,function(a){return t("AdpDocumentCard",{key:a.id,staticClass:"article-card",attrs:{adpDocument:a,showCommentCount:1,isRead:a.is_read,actionTypeOfThemeTag:"mark",showThemeTag:!0,themeId:e.getThemeId(a),pageName:"team_marks",feature:"team_marks"}})})],2):e._e()],1)])],1)},_A=[],pA=T(dA,mA,_A,!1,null,"1513756d",null,null);const vA=pA.exports,fA=D({props:{value:{type:String,default:""},otherKeywords:{type:Array,default:()=>[]},hasSyntaxError:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},emits:{input:s=>!0,remove:s=>!0},setup(s,e){const t=g(),a=g(!1);let n=s.value;const r=l(()=>{const m=Es(s.value);if(s.value){const _=Array.from(new Set(s.otherKeywords));m.push(...Ba([s.value,..._]))}const d=m.map(_=>ds[_]);return s.hasSyntaxError&&d.push("入力内容に誤りがあります。"),d}),o=()=>{s.disabled||(a.value=!0,n=s.value,ze(()=>{var m;(m=t.value)==null||m.focus()}))},i=()=>{c.value||(a.value=!1)},u=()=>{e.emit("input",n),a.value=!1},c=g(!1);return{inputRef:t,isEditing:a,keywordErrors:r,startEditing:o,finishEditing:i,cancelEditing:u,isDuringComposition:c,onInput:m=>{const d=m.target.value;e.emit("input",d)}}}});var gA=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",[e.keywordErrors.length>0?t("div",{staticClass:"o-errors"},e._l(e.keywordErrors,function(a,n){return t("div",{key:n+"_"+a,staticClass:"m-error c-formBlock__text c-formBlock__text--error"},[e._v(" "+e._s(a)+" ")])}),0):e._e(),t("div",{staticClass:"theme-keyword-editable",class:{"not-editing":!e.isEditing,error:e.keywordErrors.length>0,disabled:e.disabled}},[e.isEditing?t("input",{ref:"inputRef",staticClass:"c-text c-text--m c-textInput",class:{"c-formInput--error":e.keywordErrors.length>0},domProps:{value:e.value},on:{input:e.onInput,blur:e.finishEditing,keydown:function(a){return!a.type.indexOf("key")&&e._k(a.keyCode,"enter",13,a.key,"Enter")?null:e.finishEditing.apply(null,arguments)},keyup:function(a){return!a.type.indexOf("key")&&e._k(a.keyCode,"esc",27,a.key,["Esc","Escape"])?null:e.cancelEditing.apply(null,arguments)},compositionstart:function(a){e.isDuringComposition=!0},compositionend:function(a){e.isDuringComposition=!1}}}):[t("div",{directives:[{name:"tooltip",rawName:"v-tooltip",value:e.value,expression:"value"}],staticClass:"text c-text c-text--m",on:{click:e.startEditing}},[e._v(" "+e._s(e.value)+" ")]),e.disabled?e._e():t("sm-icons",{staticClass:"small pencil-icon",on:{click:e.startEditing}},[e._v("pencil")])],e.disabled?e._e():t("sm-icons",{staticClass:"small remove-icon",on:{click:function(a){return e.$emit("remove",a)}}},[e._v("times")])],2)])},hA=[],yA=T(fA,gA,hA,!1,null,"51a09de2",null,null);const CA=yA.exports,bA=D({props:{keywordList:{type:Array,default:()=>[]}},setup(s,e){const t=l(()=>n.value?n.value.filter(m=>!s.keywordList.includes(m)):[]),a=g({}),n=g([]),r=g(!1),o=g(!1);ne(async()=>{await i()});const i=async()=>{r.value=!0,await u(s.keywordList),n.value=Object.keys(a.value).filter(m=>!s.keywordList.includes(m)).slice(0,10),r.value=!1},u=async m=>{o.value=!1;try{const d=await F.fetchKeywordsRecommend(m);a.value=d.similar_keywords,o.value=!!d.error_code}catch(d){if(Je(d))a.value={},o.value=!0;else throw d}},c=m=>{const d=Object.keys(a.value).indexOf(m)+1;e.emit("add-keyword-recommend",m,d)},p=l(()=>Object.keys(a.value).length===0);return Z(()=>s.keywordList,co(()=>{p.value?i():u(s.keywordList)},Vn)),{keywordRecommends:t,updateKeywordRecommend:i,isLoading:r,isError:o,addKeywordRecommend:c,isEmptySimilarKeywordsResponse:p}}});var AA=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"recommend"},[t("div",{staticClass:"title"},[e.keywordRecommends.length>0||e.isError?t("div",{staticClass:"c-title c-title--s"},[e._v(" おすすめのキーワード ")]):e._e(),!e.isEmptySimilarKeywordsResponse&&e.keywordRecommends.length<10?t("div",{staticClass:"new-recommend c-title c-title--s"},[e._v(" 新しい候補があります "),t("button",{staticClass:"update-button c-outlineBtn--auto c-btn--text",on:{click:e.updateKeywordRecommend}},[e._v(" 更新 ")])]):e._e()]),e.isLoading?t("div",{staticClass:"loading"},[t("div",{staticClass:"loader"})]):e.isError?t("div",{staticClass:"error c-text c-text--m"},[e._v(" 取得できませんでした。一時的な問題の可能性があります。"),t("br"),e._v(" 時間をおいて再読み込みしてください。 "),t("button",{staticClass:"c-outlineBtn c-btn c-btn--auto",on:{click:e.updateKeywordRecommend}},[e._v(" 再読み込み ")])]):t("div",[t("div",{staticClass:"recommend-list"},e._l(e.keywordRecommends,function(a){return t("button",{key:a,staticClass:"recommend-item c-btn c-btn--auto c-btnOutline",on:{click:function(n){return e.addKeywordRecommend(a)}}},[e._v(" "+e._s(a)+" ")])}),0)])])},kA=[],xA=T(bA,AA,kA,!1,null,"12a626ca",null,null);const wA=xA.exports,EA=D({props:{isMenuVisible:{type:Boolean,default:!0}},setup(){const s=g(!1),e=()=>{s.value=!0,window.addEventListener("click",t)},t=()=>{s.value=!1,window.removeEventListener("click",t)};return Xe(()=>{window.removeEventListener("click",t)}),{showFooterMenu:e,footerMenuVisible:s}}});var FA=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"fixed-footer",class:{"menu-visible":e.isMenuVisible}},[t("div",{staticClass:"inner"},[t("div",{staticClass:"content"},[e._t("default")],2),e.$slots.popup?t("button",{staticClass:"footer-menu-button",on:{click:function(a){return a.stopPropagation(),e.showFooterMenu.apply(null,arguments)}}},[t("sm-icons",{staticClass:"small"},[e._v("ellipsis-v")])],1):e._e(),t("div",{staticClass:"popup-anchor"},[e.footerMenuVisible?t("div",{staticClass:"popup c-text c-text--m"},[e._t("popup")],2):e._e()])])])},TA=[],DA=T(EA,FA,TA,!1,null,"91ea0d2c",null,null);const BA=DA.exports,SA=D({model:{prop:"selectedItems",event:"update-selected-items"},props:{selectedItems:Array,items:{type:Array,required:!0},maxItems:{type:Number,default:10}},setup(s,e){const{items:t,selectedItems:a}=$e(s),n=fe(),r=Fe({items:(a==null?void 0:a.value)??[]}),o=g(""),i=g(!1),u=()=>i.value=!1;ne(()=>{n.$el.addEventListener("click",u),d.value}),Xe(()=>n.$el.addEventListener("click",u));const c=_=>{var h;o.value="",(h=r.items)==null||h.push(_),u(),e.emit("update-selected-items",r.items)},p=_=>{var h;r.items=(h=r.items)==null?void 0:h.filter(v=>v.id!==_.id),e.emit("update-selected-items",r.items)};function*m(_,h,v){(!v||v>_.length)&&(v=_.length);let f=0,C=0;for(;f<v&&C<_.length;)h(_[C])&&(yield _[C],f++),C++}const d=l(()=>{const h=(r.items??[]).map(f=>f.id);let v=t.value;return o.value.length>0&&(v=[...m(v,f=>f.name.includes(o.value)||f.hostname.includes(o.value),1e3)]),v.slice(0,1e3).filter(f=>!h.includes(f.id))});return{currentSelectedItems:r,itemFilter:o,itemListVisible:i,visibleItems:d,addItem:c,removeItem:p}}});var IA=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"item-select"},[t("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.itemFilter,expression:"itemFilter",modifiers:{trim:!0}}],staticClass:"c-textInput",attrs:{type:"text",placeholder:"メディア名を入力",disabled:e.currentSelectedItems.items.length===e.maxItems},domProps:{value:e.itemFilter},on:{click:function(a){return a.stopPropagation(),a.preventDefault(),(()=>{}).apply(null,arguments)},focus:function(a){e.itemListVisible=!0},input:function(a){a.target.composing||(e.itemFilter=a.target.value.trim())},blur:function(a){return e.$forceUpdate()}}}),e.itemListVisible?t("div",{staticClass:"item-list"},[e._m(0),e.visibleItems.length===0?t("div",{staticClass:"item disabled"},[e._m(1)]):e._l(e.visibleItems,function(a){return t("div",{key:a.id,staticClass:"item",on:{click:function(n){return e.addItem(a)}}},[t("div",{staticClass:"info"},[t("div",{staticClass:"name c-text c-text--m"},[e._v(e._s(a.name))]),t("div",{staticClass:"hostname c-text c-text--xs"},[e._v(e._s(a.hostname))])]),t("div",{staticClass:"count c-text c-text--xs"},[e._v(" "+e._s(Number(a.article_count_ja).toLocaleString())+"件 ")])])})],2):e._e(),e.currentSelectedItems.items.length>0?t("div",{staticClass:"selected-items"},e._l(e.currentSelectedItems.items,function(a){return t("div",{directives:[{name:"tooltip",rawName:"v-tooltip.bottom",value:{content:`${a.name}
${a.hostname}`,delay:{show:300},autoHide:!1},expression:"{\n          content: `${item.name}\\n${item.hostname}`,\n          delay: { show: 300 },\n          autoHide: false\n        }",modifiers:{bottom:!0}}],key:a.id,staticClass:"item"},[t("div",{staticClass:"c-outlineTag c-outlineTag--delete"},[t("div",{staticClass:"name c-text c-text--s"},[e._v(e._s(a.name))]),t("sm-icons",{on:{click:function(n){return e.removeItem(a)}}},[e._v("times")])],1)])}),0):e._e()])},MA=[function(){var s=this,e=s._self._c;return s._self._setupProxy,e("div",{staticClass:"item disabled heading"},[e("div",{staticClass:"c-text c-text--xs"},[s._v("メディア名")]),e("div",{staticClass:"c-text c-text--xs"},[s._v("週間記事数")])])},function(){var s=this,e=s._self._c;return s._self._setupProxy,e("div",{staticClass:"info"},[e("div",{staticClass:"name c-text c-text--m"},[s._v("メディアがありません")])])}],$A=T(SA,IA,MA,!1,null,"f769aa7d",null,null);const PA=$A.exports,NA=D({setup(){return{}}}),LA="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAMeSURBVHgB7ZvNTxNBGMaf/SwboFIE+TAQ0CgJEQ7CBS5ykpN/hH+jJ70YL3CxByUhASMQiJQKUvmIZT9anHcBg2Sj7HRmSjLzuyxs0qT7zDzPO9N9xzpnQGNsaI4RAJrjgoOoeY6fUQyKj96CB89un467pzWUq5sIGzEWRibRF3Tn+rzFE4KVXyGSax8r+i7ueVxatsTKwQ6Wvq3/+d93XLx+9gJ54PrWyQ3NjqMEdKvoObAtC7IJGwmWd9exdlj5637E7udF2LCdxAnqSQP9HT5cW54IJ9EZ3nwtp1cRCJ23NDP2zyL0MEsErgPRkN/fbX1OZ4AohBuXRDgIYxTZVWQufKxuoLy3CdFISy7KhbjZRK/vtZQLNNofdlaxebQPGUiN7nrSRLURceeCaL9nIb12kSWqZyHLBQ+dOXJhrVbBMitxIv2ehZLizdZNOGS5kNwyF5Z2v2BlfxsqULp6oVwIGxe5kGUJGm1KeUp7VShfvpEAVCpv5sKP+inebn2S6vcs1K9fcZELlXqY7iMoF1T5PYu27gZpQ0WU9zba8vBEWwVoXm4pVE/765gfRKA5RgBojhEAmmMEgOYYAaA5RgBojhEAmmMEgOYYAaA5RgBojhEAmmMEgOYYAaA5XAJYClrheOj2A+SFS4CS35aXyv+k4HiYGRhHXriehF5pFxwb3+sRGneg255GfnFsGveDLuSFeyhdZoMHgZ+2vlDTQ7sY6ixhcXyaDQjfo7Q0l1MROvy09eUoVv9+f6pvBPMPn6IVhJiZmqUd20It7RmWbwny+9zwE0z0DqFVhKWZqlwgv796/JxdOyACoXFOlhgMCjiM4rRxWjRjxX4sjE5y+z0L4fWMGr/6Ch6OmRgic2F24BFmBvOXuf8hraBTLtBJkhqbDa1Ygvz+cmwKw10lyEDqiiZwbXiOz50Lov2ehfQl3VUuUKk8SW5viYnSEOZYiRPp9yyUrGkpF3oKbnq9ngvO5Z6CpjkderpinpW4qf5RqMBSfXKUTpzR6jEVxffgsz+oTfb99mp66GmWBZ0sv2dhmaOzmmMEgOZoL8BvjpAwaCxi8/AAAAAASUVORK5CYII=";var UA=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"o-theme-edit-support"},[t("div",{staticClass:"times-icon-row",on:{click:function(a){return e.$emit("hideSupportContent")}}},[t("sm-icons",{staticClass:"times-icon small"},[e._v("times")])],1),t("div",{staticClass:"o-theme-edit-support-detail"},[t("div",[t("span",{staticClass:"c-title c-title--xm"},[e._v("はじめてテーマを作成する方におすすめ")]),t("br"),t("div",{staticClass:"o-create-theme-movie c-text c-text--m"},[t("a",{attrs:{href:"https://anews-stockmark.zendesk.com/hc/ja/articles/4413707816857",target:"_blank"}},[e._v("テーマ作成の動画をみる")]),t("sm-icons",{staticClass:"primary small"},[e._v("external-link")])],1)]),t("img",{attrs:{src:LA}})])])},RA=[],OA=T(NA,UA,RA,!1,null,"2df8eabe",null,null);const GA=OA.exports,qA=D({props:{toggleSwitchItem:{type:Object,required:!0}},setup(s,e){return{toggleSwitch:()=>{e.emit("toggleSwitch")}}}});var HA=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"feed-type-toggle-item",on:{click:e.toggleSwitch}},[t("div",{staticClass:"domestic",class:{active:e.toggleSwitchItem.activeOption==="left"}},[e._v(" "+e._s(e.toggleSwitchItem.leftLabelName)+" ")]),t("div",{staticClass:"foreign",class:{active:e.toggleSwitchItem.activeOption==="right"}},[e._v(" "+e._s(e.toggleSwitchItem.rightLabelName)+" ")])])},VA=[],jA=T(qA,HA,VA,!1,null,"d6e79325",null,null);const KA=jA.exports,YA=D({props:{article:{type:Object,required:!0}},components:{},methods:{formatDate:De},setup({article:s}){const e=g(Kt),t={...s};return{noImage:e,articleCopy:t}}});var QA=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("a",{staticClass:"m-theme-preview-article__content",attrs:{href:e.articleCopy.url,target:"_blank"}},[t("div",{staticClass:"m-article-info"},[t("div",{staticClass:"m-article-info__content"},[t("div",{staticClass:"article-info c-title c-title--s"},[e._v(" "+e._s(e.articleCopy.media_name)+" ")]),t("div",{staticClass:"m-article-title c-list__title c-text c-text--xm"},[e._v(" "+e._s(e.articleCopy.title)+" ")]),t("div",{staticClass:"article-info c-text c-text--s"},[e._v(" "+e._s(e.formatDate(e.articleCopy.published_at))+" ")])]),t("div",{staticClass:"image"},[t("img",{staticClass:"lazyload",attrs:{loading:"lazy",src:e.articleCopy.image_url,"data-src":e.articleCopy.image_url},on:{error:function(a){e.articleCopy.image_url=e.noImage}}})])]),t("div",{staticClass:"hit-keyword"},e._l([...e.articleCopy.hit_keywords,...e.articleCopy.synonym_keywords||[]],function(a){return t("div",{key:a,staticClass:"hit-keyword__tag c-outlineTag c-outlineTag--small"},[e._v(" "+e._s(a)+" ")])}),0)])},WA=[],zA=T(YA,QA,WA,!1,null,"955441b7",null,null);const JA=zA.exports,XA=D({props:{keywords:{type:Array,default:()=>[]},keywordErrors:{type:Array,default:()=>[]},isForeignFeedAvailable:{type:Boolean,default:!1},isForeignMediaEnabled:{type:Boolean,default:!1},isEntertainmentFilterEnabled:{type:Boolean,default:!1},excludedSites:{type:Array,default:()=>[]}},components:{ThemePreviewArticle:JA,AdpDocumentCardSkeleton:Yt,ToggleSwitch:KA},methods:{formatDayOfWeek:dr},setup(s,e){const t=Fe({list:[]}),a=g(0),n=g(!1),r=g(!0),o=g(!1);ne(()=>{i()}),Z(()=>s.isEntertainmentFilterEnabled,()=>{setTimeout(()=>{i()},250)}),Z(()=>s.excludedSites,()=>{setTimeout(()=>{i()},250)}),Z(()=>s.keywords,()=>{setTimeout(()=>{i()},250)});const i=async()=>{o.value=!1;const h=s.keywords.filter(v=>v!=="");if(s.keywords.length===0||s.keywords.length===1&&s.keywords[0]==="")t.list=[],a.value=0,n.value=!1;else if(s.keywordErrors.length>0)t.list=[],a.value=0;else{const v=await F.getThemePreviewArticle(h,50,p.value,s.isEntertainmentFilterEnabled,s.excludedSites.map(f=>f.id));v.hasError&&v.failedKeywords?(e.emit("syntaxErrorKeywords",v.failedKeywords),t.list=[],a.value=0):v.hasError?(e.emit("syntaxErrorKeywords",[]),t.list=[],a.value=0):(e.emit("syntaxErrorKeywords",[]),t.list=v.articles,a.value=v.count??0),n.value=!0}r.value=t.list.length>0,o.value=!0},u=l(()=>{const h=t.list.map(f=>De(f.published_at));return[...new Set(h)]}),c=l(()=>{const h=[];return u.value.forEach(v=>{const f=t.list.filter(C=>De(C.published_at)===v);h.push({date:v,article:f})}),h}),p=g("ja"),m=h=>h==="ja"?"left":"right",d=g({leftLabelName:"国内メディア",rightLabelName:"海外メディア",activeOption:m(p.value)});return{resThemePreview:t,hitCount:a,setPreviewArticles:i,dateList:u,themePreviewArticleList:c,isHit:r,isFetched:o,hasKeywords:n,feedType:p,toggleSwitchProp:d,toggleFeedType:async()=>{p.value=p.value==="ja"?"en":"ja",d.value.activeOption=m(p.value),i()}}}});var ZA=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"o-theme-preview__wrapper",class:{"no-hit":!e.isHit,loading:!e.isFetched}},[t("div",{staticClass:"title c-title c-title--m"},[e._v(" キーワードにヒットする記事 "),t("sm-icons",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:{content:"キーワード設定の参考として表示しています。",autoHide:!1},expression:`{
          content: 'キーワード設定の参考として表示しています。',
          autoHide: false
        }`,modifiers:{top:!0}}],staticClass:"small"},[e._v("question-circle")]),e.hitCount>0?t("span",{staticClass:"theme-preview-hit-count c-text c-text--m"},[e._v(e._s(e.hitCount.toLocaleString())+"件")]):e._e()],1),e.isForeignFeedAvailable?t("ToggleSwitch",{staticClass:"m-feed-switch",attrs:{toggleSwitchItem:e.toggleSwitchProp},on:{toggleSwitch:e.toggleFeedType}}):e._e(),e.isFetched?t("div",{staticClass:"o-theme-preview"},[e.isForeignFeedAvailable&&e.feedType==="en"&&!e.isForeignMediaEnabled?t("div",{staticClass:"o-theme-preview__nohit"},[t("div",{staticClass:"c-text c-text--m"},[e._v(" 「海外メディアの情報を収集する」にチェックが入っていません。チェックを入れることで参考記事を閲覧することができます。 ")])]):e.isHit?t("div",{staticClass:"o-theme-preview__hit"},e._l(e.themePreviewArticleList,function(a){return t("div",{key:a.date,staticClass:"o-theme-preview__content"},[t("div",{staticClass:"m-article-date__content"},[t("div",{staticClass:"m-article-date__text c-text c-text--s"},[e._v(" "+e._s(e.formatDayOfWeek(a.date))+" ")])]),e._l(a.article,function(n){return t("div",{key:n.url,staticClass:"m-theme-preview-article"},[t("ThemePreviewArticle",{attrs:{article:n}})],1)})],2)}),0):e.hasKeywords&&!e.isHit?t("div",{staticClass:"o-theme-preview__nohit"},[t("div",{staticClass:"c-text c-text--m"},[e._v(" 設定しているキーワードに一致する情報は見つかりませんでした。 ")])]):e.hasKeywords?e._e():t("div",{staticClass:"o-theme-preview__nohit"},[t("div",{staticClass:"c-text c-text--m"},[e._v("キーワードが設定されていません。")])])]):t("AdpDocumentCardSkeleton",{staticClass:"m-article-card-skelton",attrs:{loading:!e.isFetched}})],1)},ek=[],tk=T(XA,ZA,ek,!1,null,"136215d1",null,null);const sk=tk.exports,ak=D({components:{AutocompleteInput:Fa,Header:Se,Content:Ue,FixedFooter:BA,SiteSelect:PA,ThemePreview:sk,TextTabItem:cr,ThemeKeywordEditable:CA,ThemeKeywordRecommend:wA,ThemeEditSupport:GA},props:{isMenuVisible:{type:Boolean,default:!0}},methods:{getTabs:Zs,getThemeHeaderDetail:ga,formatTimestamp:Cc},setup(){var ja;const s=ie(),e=Te(),t=se(),a=fe(),n=Ye(),{data:r}=xe(),{data:o}=Pe(),{data:i}=Qe(),{data:u,state:c}=et(),{data:p,state:m,mutate:d}=nt(),{data:_,state:h}=Er(),v=l(()=>t.state.feedType.feedType),f=g(void 0),C=l(()=>{var z;return!X.value&&((z=f.value)!=null&&z.id)?Zs(v.value,f.value,u.value):void 0}),y=["ベーシック","カスタム"],A=g("ベーシック"),k=g(""),S=l(()=>{const z=Es(k.value);if(k.value){const Ce=Array.from(new Set(q.value));z.push(...Ba([k.value,...Ce]))}const pe=z.map(Ce=>ds[Ce]);return k.value.length>0&&k.value.length+P.value.replace(/\n/g,"").length>Ft&&pe.push(`キーワードは合計で${Ft}文字以内になるように入力してください。`),pe}),b=l(()=>k.value!==""&&S.value.length===0),U=()=>{k.value!==""&&(q.value.unshift(k.value),k.value="")},I=z=>{const pe=q.value.slice(),Ce=q.value.splice(z,1);t.commit("snackbar/addMessages",{message:`「${Ce[0]}」を削除しました。`,type:"",showUndo:!0,undoFunc:()=>{q.value=pe}})},w=(z,pe)=>{q.value.splice(z,1,pe)},x=g(Number(s.params.themeId??0)),B=g(""),$=g(""),P=l({get:()=>q.value.join(`
`),set:z=>{z.trim()===""?q.value=[]:q.value=z.split(`
`)}}),M=g(!1),O=l(()=>{var z;return(z=u.value)==null?void 0:z.enable_foreign_lang_media}),Y=l(()=>{var z;return(z=u.value)==null?void 0:z.enable_technical_literature}),W=l(()=>{var z;return(z=u.value)==null?void 0:z.enable_chinese_lang_media}),j=g(((ja=u.value)==null?void 0:ja.enable_foreign_lang_media)??!1),K=g(Y.value??!1),le=g(Y.value??!1),ye=g(!1),H=g(!0),ue=g(!1),_e=g(Ji),me=g(ts),de=g(""),ee=g(),J=[],ce=Fe({items:[]}),ke=Fe({items:[]}),R=Fe({items:[]}),ve=Fe({items:[]}),X=l(()=>s.name==="themeCreate"),te=l(()=>{var z;return((z=o.value)==null?void 0:z.groups)??[]}),E=l(()=>{var z;return((z=i.value)==null?void 0:z.users)??[]}),L=l(()=>{var z;return(z=o.value)==null?void 0:z.groups.find(pe=>{var Ce;return pe.id===((Ce=f.value)==null?void 0:Ce.group_id)})}),V=async()=>{const z=Wi;let pe,Ce=1;do{const He=await F.getSites(!1,Ce,z),tt=He.filter(Ve=>ke.items.includes(Ve.id));tt.length>0&&R.items.push(...tt),pe=He.length,ce.items.push(...He),Ce++}while(pe===z)},re=l(()=>X.value||ya(r.value,f.value,L.value)),Ee=l(()=>{var z;return de.value!==""&&re.value&&Oa.value.length>0&&te.value.length>0&&(X.value||((z=f.value)==null?void 0:z.access_scope))}),Me=l(()=>{var z;return de.value==="public"&&((z=r.value)==null?void 0:z.role)==="admin"}),q=g([]),G=ls(q,Ja),ae=l(()=>B.value.length>Ya),Ae=l(()=>$.value.length>Ki),we=l(()=>P.value.replace(/\n/g,"").length>Ft),Le=l(()=>RC(q.value)),ut=ls(Le,Ja),Xt=l(()=>X.value?"作成":"保存"),Ua=l(()=>`${Xt.value}（フィード更新後のメール通知なし）`),Ut=g(!1),wo=l(()=>{const z=[];return we.value&&z.push(`キーワードは${Ft}文字以内で入力してください。`),z.push(...Le.value.map(pe=>ds[pe])),Le.value.length===0&&ve.items.length>0&&(z.push("以下の入力内容に誤りがあります。"),ve.items.forEach(function(pe){z.push("・"+pe)})),z}),Ra=l(()=>{var z,pe,Ce,He;return((z=r.value)==null?void 0:z.role)==="admin"&&((pe=f.value)==null?void 0:pe.access_scope)==="personal"&&((Ce=r.value)==null?void 0:Ce.id)!==((He=f.value)==null?void 0:He.user_id)}),Oa=l(()=>{var tt,Ve,Ke,_t,We;const z=(((tt=o.value)==null?void 0:tt.groups)??[]).filter(je=>{var ht;return((ht=f.value)==null?void 0:ht.group_id)===je.id||je.group_type==="specific_user_group"&&je.is_member}).map(je=>({name:je.name,id:`group-${je.id}`})),pe=[{name:"自分のみ",id:"personal"}],Ce=[{name:"全体",id:"public"},{name:"自分のみ",id:"personal"}];if(Ra.value){const je=(Ke=(Ve=i.value)==null?void 0:Ve.users.find(ht=>{var pt;return ht.id===((pt=f.value)==null?void 0:pt.user_id)}))==null?void 0:Ke.user_name;Ce.push({name:`${je}のみ`,id:`personal-${(_t=f.value)==null?void 0:_t.user_id}`})}const He=Ce.concat(z);return((We=r.value)==null?void 0:We.role)==="viewer"?pe:He}),Eo=l(()=>B.value&&P.value&&!ae.value&&!Ae.value&&!we.value&&Le.value.length===0),Fo=l(()=>{var pe;const z=((pe=r.value)==null?void 0:pe.email)??"";return z.includes("@stockmark.co.jp")||z.includes("@anews.co.jp")});Xe(()=>{window.removeEventListener("click",qa)}),ne(async()=>{var z,pe;if(ze(()=>{var Ce;return(Ce=ee.value)==null?void 0:Ce.focus()}),window.addEventListener("click",qa),await Do(),Bo(),V(),(z=f.value)!=null&&z.is_chinese&&!((pe=u.value)!=null&&pe.enable_chinese_lang_media)&&e.push({name:"themeFeed"}),typeof s.query.query=="string"){const Ce=s.query.query;B.value=Ce,q.value.push(Ce),e.replace({query:void 0})}}),Z(()=>s.path,()=>{var z;X.value&&(B.value="",$.value="",P.value="",R.items=[],Ts(),Ds(),Bs(),Ss(),H.value=!0,ue.value=!1,de.value=((z=r.value)==null?void 0:z.role)==="viewer"?"personal":"public")}),Z(()=>u.value,()=>{Ts(),Ds(),Bs(),Ss()}),Z(()=>ye.value,()=>{ye.value?(j.value=!0,H.value=!1):(j.value=!1,H.value=!0)}),Z(()=>c.value,()=>{var z;X.value&&(j.value=((z=u.value)==null?void 0:z.enable_foreign_lang_media)??!1)});const To=l(()=>h.value===be.SUCCESS&&_.value&&_.value.job_types.length>0),Do=async()=>{var z,pe;if(x.value){try{f.value=await F.fetchTheme(x.value),ke.items=((z=f.value)==null?void 0:z.site_exclusion_ids)??[]}catch{Ga("指定されたテーマは存在しません");return}if((pe=f.value)!=null&&pe.is_deleted){Ga("指定されたテーマは存在しません");return}B.value=f.value.name,$.value=f.value.description??"",q.value=f.value.keywords,Ts(),Ds(),Bs(),Ss(),H.value=f.value.is_entertainment_sites_filtered,ue.value=f.value.is_initial_theme}},Bo=()=>{var z,pe,Ce;((z=r.value)==null?void 0:z.role)==="viewer"?de.value="personal":((pe=f.value)==null?void 0:pe.access_scope)==="group"?de.value=`group-${f.value.group_id}`:((Ce=f.value)==null?void 0:Ce.access_scope)==="personal"?Ra.value?de.value=`personal-${f.value.user_id}`:de.value="personal":de.value="public"},Ga=z=>{e.push({name:"anewsHome"}),t.commit("snackbar/addMessages",{message:z,type:"error"})},Ts=()=>{var z,pe;j.value=(z=u.value)!=null&&z.enable_foreign_lang_media?((pe=f.value)==null?void 0:pe.is_foreign_media_enabled)??!0:!1},Ds=()=>{var z;K.value=Y.value?((z=f.value)==null?void 0:z.is_research_paper_enabled)??!0:!1},Bs=()=>{var z;le.value=Y.value?((z=f.value)==null?void 0:z.is_patent_enabled)??!0:!1},Ss=()=>{var z,pe,Ce;ye.value=(z=u.value)!=null&&z.enable_foreign_lang_media&&((pe=u.value)!=null&&pe.enable_chinese_lang_media)?((Ce=f.value)==null?void 0:Ce.is_chinese)??!1:!1},qa=()=>{M.value=!1},So=()=>{t.commit("modal/showModal","themeSettingsInfo")},Io=({value:z})=>{de.value=z},Mo=async(z=!1)=>{Ut.value=!0,de.value!=="public"&&(ue.value=!1),X.value?await $o(z):await Po(z),Ut.value=!1},$o=async(z=!1)=>{var He,tt;Is.value=!0,Ge.trackCreateTheme(n,B.value);const[pe,Ce]=de.value.split("-");try{const Ve=await F.createTheme(B.value,$.value,q.value,[],[],j.value||ye.value,K.value,le.value,ye.value,H.value,ue.value,R.items.map(We=>We.id),pe,pe==="group"?Number(Ce):void 0,void 0,z);await t.dispatch("themeList/fetchThemeList"),await d(),await F.addUserTheme(Ve.id),Ve.is_member=!0;const Ke=(He=p.value)==null?void 0:He.themes.find(We=>We.id===Ve.id);Ke!=null&&(Ke.is_member=!0),t.commit("themeList/updateTheme",Ke),a.$emit("theme-updated",(tt=p.value)==null?void 0:tt.themes.find(We=>We.id===Ve.id)),e.push({path:`/themes/${Ve.id}`});const _t=`テーマを作成しました。フィードの内容が更新されたら${z?"お知らせ画面":"お知らせ画面とメール"}で通知します。`;t.commit("snackbar/addMessages",{message:_t,type:""})}catch{t.commit("snackbar/addMessages",{message:"テーマを作成できませんでした",type:"error"})}finally{Is.value=!1}},Po=async(z=!1)=>{var Ke,_t,We;const[pe,Ce]=de.value.split("-"),He={id:x.value,name:B.value,description:$.value,keywords:q.value,is_foreign_media_enabled:j.value,is_research_paper_enabled:K.value,is_patent_enabled:le.value,is_chinese:ye.value,is_entertainment_sites_filtered:H.value,is_initial_theme:ue.value,site_exclusion_ids:R.items.map(je=>je.id),access_scope:pe,group_id:pe==="group"&&Ce?Number(Ce):void 0,user_id:pe==="personal"&&Ce?Number(Ce):void 0},tt=!Ha(q.value,((Ke=f.value)==null?void 0:Ke.keywords)??[])||j.value!==((_t=f.value)==null?void 0:_t.is_foreign_media_enabled)||ye.value!==f.value.is_chinese||H.value!==f.value.is_entertainment_sites_filtered||ue.value!==f.value.is_initial_theme||!Ha(ke.items,R.items.map(je=>je.id)),Ve=async()=>{var ht;try{Ge.trackUpdateTheme(n,B.value),await F.updateTheme(He,{skipEmail:z});const pt=(ht=p.value)==null?void 0:ht.themes.find(Ho=>Ho.id===Number(x.value));pt!==void 0&&f.value!==void 0&&!pt.is_member&&He.access_scope==="personal"&&(F.addUserTheme(x.value),f.value.is_member=!0,pt.is_member=!0,t.commit("themeList/updateTheme",pt))}catch{t.commit("snackbar/addMessages",{message:"テーマの設定を更新できませんでした",type:"error"})}await t.dispatch("themeList/fetchThemeList"),a.$emit("theme-updated",{}),e.push({name:"themeFeed"});let je="設定を更新しました。";tt&&(je+=`フィードの内容が更新されたら${z?"お知らせ画面":"お知らせ画面とメール"}で通知します。`),t.commit("snackbar/addMessages",{message:je,type:""})};if(((We=f.value)==null?void 0:We.access_scope)!=="personal"&&pe==="personal"){const je={headerText:"テーマスコープを変更しますか？",btnText:"変更",confirmationType:"submit",bodyText:"このテーマの公開範囲を自分のみに変更すると、他ユーザーのお気に入りリストからこのテーマが消えてしまいますが、よろしいですか？",action:Ve};t.commit("confirmationModal/showConfirmationModal"),t.commit("confirmationModal/setTextAndAction",je)}else await Ve()},No=z=>{ve.items=z},Ha=(z,pe)=>z.length===pe.length&&z.filter(Ce=>pe.includes(Ce)).length===z.length,Lo=()=>{const pe={headerText:"テーマを削除しますか？",bodyText:`削除したテーマは元に戻すことはできません。
本当にテーマを削除しますか？`,action:async()=>{var Ce;Ge.trackDeleteTheme(n,((Ce=f.value)==null?void 0:Ce.name)??"");try{await F.deleteTheme(x.value)}catch(He){throw t.commit("snackbar/addMessages",{message:"テーマを削除できませんでした",type:"error"}),He}await t.dispatch("themeList/fetchThemeList"),a.$emit("theme-updated",{}),e.push({name:"anewsHome"}),t.commit("snackbar/addMessages",{message:"テーマを削除しました",type:""})}};t.commit("confirmationModal/showConfirmationModal"),t.commit("confirmationModal/setTextAndAction",pe)},Uo=()=>{X.value&&(ye.value=!ye.value)},Ro=()=>{t.commit("modal/showModal","themeTopicSelect")};a.$on("select-theme-topics",async(z,pe)=>{const Ce=Br(z,pe,j.value),He=new Set(Ce),tt=Array.from(new Set(Ce));q.value.forEach(Ke=>He.delete(Ke)),q.value.push(...Array.from(He)),z.forEach(Ke=>{J.some(We=>We.name===Ke.name)||J.push(Ke)});const Ve={pageName:"theme_setting",pageUrl:s.fullPath,keywords:tt,from:"theme_topics",topics:z.map(Ke=>Ke.name),theme:{},perspectives:pe?[pe.question]:[]};x.value!=0&&(Ve.theme={id:x.value}),await F.trackThemeEvent("add_keywords",Ve)});const Oo=async(z,pe)=>{q.value.unshift(z);const Ce={pageName:"theme_setting",pageUrl:s.fullPath,keywords:[z],from:"keyword_recommendation",rank:pe,topics:[],theme:{},perspectives:[]};x.value!=0&&(Ce.theme={id:x.value}),await F.trackThemeEvent("add_keywords",Ce)},Is=g(!1),Va=g(N.getShowThemeSupportContent()),Go=()=>{N.setShowThemeSupportContent(!1),Va.value=N.getShowThemeSupportContent()},qo=l(()=>X.value?'<a class="help-link" href="https://anews-stockmark.zendesk.com/hc/ja/articles/360051832714" target="_blank">テーマ作成のマニュアルを見る</a>':"");return{STATES:be,themeNameRef:ee,themeId:x,userInfo:r,groupList:te,teamUsersList:E,teamInfo:u,tabs:C,themes:p,themeState:m,trimmedThemeName:B,trimmedDescription:$,trimmedKeywords:P,isTooltipKeywordVisible:M,isForeignMediaEnabled:j,isResearchPaperEnabled:K,isPatentEnabled:le,isChinese:ye,isForeignFeedAvailable:O,isTechnicalResearchAvailable:Y,isChineseFeedAvailable:W,isEntertainmentSitesFiltered:H,isInitialTheme:ue,editKeywordsTooltipText:_e,siteLimit:me,sites:ce,selectedSites:R,scopes:Oa,selectedScope:de,keywordList:q,debouncedKeywordList:G,keywordErrors:Le,debouncedKeywordErrors:ut,keywordsErrorMessages:wo,tooLongThemeName:ae,tooLongDescription:Ae,tooLongKeywords:we,isCreate:X,themeInfo:f,hasPermission:re,hasThemeScopeSetting:Ee,hasInitialThemeSetting:Me,enableToUpdate:Eo,submitBtnText:Xt,submitBtnWithoutEmailText:Ua,isStockmarkUser:Fo,showThemeSettingsInfoModal:So,selectScope:Io,saveTheme:Mo,deleteTheme:Lo,setSyntaxErrorKeywords:No,syntaxErrorKeywords:ve,isSaving:Ut,toggleIsChinese:Uo,openThemeTopicSelect:Ro,isJobTypeReady:To,editKeywordsTabs:y,selectedEditKeywordType:A,newKeyword:k,newKeywordErrors:S,canAddNewKeyword:b,addKeywordToList:U,removeKeywordFromList:I,updateKeywordList:w,MAX_THEME_NAME_LENGTH:Ya,isCreatingTheme:Is,addKeywordRecommend:Oo,MAX_KEYWORDS_LENGTH:Ft,tooltipContent:qo,hideSupportContent:Go,showSupportContent:Va}}});var nk=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"o-theme-edit"},[t("Header",{attrs:{title:e.isCreate?"テーマを新しく作成":e.themeInfo?e.themeInfo.name:"",detail:e.isCreate?"":e.themeInfo?e.getThemeHeaderDetail(e.themeInfo,e.groupList,e.teamUsersList):"",icon:e.isCreate?"question-circle-gray600":"hashtag",isIconDirectionReverse:e.isCreate,iconTooltipContent:e.tooltipContent,detailIcon:!e.isCreate&&e.themeInfo&&e.themeInfo.access_scope==="group"?"users":void 0,tabs:e.tabs}}),t("Content",[t("div",{staticClass:"o-theme-edit__wrapper"},[t("div",{key:`theme-${e.themeId}`,staticClass:"edit-content"},[e.showSupportContent&&e.isCreate?t("ThemeEditSupport",{on:{hideSupportContent:e.hideSupportContent}}):e._e(),t("div",{staticClass:"o-theme-edit-form"},[t("div",{staticClass:"o-theme-name"},[t("div",{staticClass:"o-textarea-label c-title c-title--m"},[e._v("テーマ名")]),t("div",{directives:[{name:"show",rawName:"v-show",value:e.tooLongThemeName,expression:"tooLongThemeName"}],staticClass:"m-error c-formBlock__text c-formBlock__text--error"},[e._v(" テーマ名は"+e._s(e.MAX_THEME_NAME_LENGTH)+"文字以内で入力してください。 ")]),t("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.trimmedThemeName,expression:"trimmedThemeName",modifiers:{trim:!0}}],ref:"themeNameRef",staticClass:"o-theme-name-input c-text c-text--m c-textInput",class:{"c-formInput--error":e.tooLongThemeName,"m-normal-text-area":!e.tooLongThemeName},attrs:{disabled:!e.hasPermission},domProps:{value:e.trimmedThemeName},on:{input:function(a){a.target.composing||(e.trimmedThemeName=a.target.value.trim())},blur:function(a){return e.$forceUpdate()}}})]),t("div",{staticClass:"o-theme-description"},[t("div",{staticClass:"o-textarea-label c-title c-title--m"},[e._v("説明")]),t("div",{directives:[{name:"show",rawName:"v-show",value:e.tooLongDescription,expression:"tooLongDescription"}],staticClass:"m-error c-formBlock__text c-formBlock__text--error"},[e._v(" 説明は50文字以内で入力してください。 ")]),t("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.trimmedDescription,expression:"trimmedDescription",modifiers:{trim:!0}}],staticClass:"o-theme-description-input c-text c-text--m c-textInput",class:{"c-formInput--error":e.tooLongDescription,"m-normal-text-area":!e.tooLongDescription},attrs:{disabled:!e.hasPermission},domProps:{value:e.trimmedDescription},on:{input:function(a){a.target.composing||(e.trimmedDescription=a.target.value.trim())},blur:function(a){return e.$forceUpdate()}}})])]),t("div",{staticClass:"o-theme-edit-form"},[e.isChineseFeedAvailable?t("div",{staticClass:"o-theme-feed-type"},[t("div",{staticClass:"o-textarea-label c-title c-title--m"},[e._v(" 配信するメディア ")]),t("div",{staticClass:"feed-types"},[t("span",{key:`default-${e.isChinese}`,staticClass:"radio-label",class:{disabled:!e.isCreate},on:{click:e.toggleIsChinese}},[t("sm-radio",{attrs:{value:!e.isChinese,disabled:!e.isCreate}}),t("span",{staticClass:"c-inputLabel"},[e._v("国内メディア・海外メディア")])],1),t("span",{key:`chinese-${e.isChinese}`,staticClass:"radio-label",class:{disabled:!e.isCreate},on:{click:e.toggleIsChinese}},[t("sm-radio",{attrs:{value:e.isChinese,disabled:!e.isCreate}}),t("span",{staticClass:"c-inputLabel"},[e._v("中国語メディア（β版）")])],1)])]):e._e(),t("div",{staticClass:"o-theme-keyword"},[t("div",{staticClass:"o-theme-edit-keyword-label-wrap"},[t("div",{staticClass:"o-theme-edit-keyword-label c-formBlock__label c-title c-title--m"},[e._v(" キーワード ")]),e.isJobTypeReady&&!e.isChinese&&e.hasPermission?t("div",{staticClass:"o-theme-add-topic-keyword c-text c-text--m",on:{click:e.openThemeTopicSelect}},[e._v(" トピックからキーワードを追加 ")]):e._e()]),e.isChinese?t("div",{staticClass:"o-textarea-explanation c-text c-text--m"},[e._v(" 中国語（簡体字）で入力してください。 ")]):e._e(),t("div",{staticClass:"o-tabs"},e._l(e.editKeywordsTabs,function(a){return t("TextTabItem",{key:a,attrs:{text:a,isSelected:a===e.selectedEditKeywordType},on:{"click-tab":function(n){e.selectedEditKeywordType=a}}})}),1),e.selectedEditKeywordType==="ベーシック"?[e.hasPermission?[t("div",{staticClass:"m-add-new-keyword-label c-title c-title--s"},[e._v(" キーワードを入力して追加 ")]),e._l(e.newKeywordErrors,function(a,n){return t("div",{key:n+"_"+a,staticClass:"m-new-keyword-error c-formBlock__text c-formBlock__text--error"},[e._v(" "+e._s(a)+" ")])}),t("form",{staticClass:"o-new-keyword-form",on:{submit:function(a){return a.preventDefault(),e.addKeywordToList.apply(null,arguments)}}},[t("AutocompleteInput",{staticClass:"new-keyword",on:{select:e.addKeywordToList},scopedSlots:e._u([{key:"default",fn:function({value:a,handlers:n}){return[t("input",e._g({staticClass:"c-text c-text--m c-textInput",class:{"c-formInput--error":e.newKeywordErrors.length>0},attrs:{placeholder:"EV AND 充電"},domProps:{value:a}},n))]}}],null,!1,3533717262),model:{value:e.newKeyword,callback:function(a){e.newKeyword=typeof a=="string"?a.trim():a},expression:"newKeyword"}}),t("button",{staticClass:"button c-btn c-btn--auto c-btn--small c-btn--AnewsPrimary",class:{disabled:!e.canAddNewKeyword},attrs:{disabled:!e.canAddNewKeyword}},[e._v(" 追加 ")])],1)]:e._e(),e.keywordList.length>0?t("div",{staticClass:"c-title c-title--s"},[e._v(" 設定キーワード ")]):e._e(),e.tooLongKeywords?t("div",{staticClass:"m-error c-formBlock__text c-formBlock__text--error"},[e._v(" キーワードは合計で"+e._s(e.MAX_KEYWORDS_LENGTH)+"文字以内になるように入力してください。 ")]):e._e(),t("div",{staticClass:"o-keyword-list"},e._l(e.keywordList,function(a,n){return t("ThemeKeywordEditable",{key:n,attrs:{value:a,otherKeywords:e.keywordList.filter((r,o)=>o!==n),hasSyntaxError:e.syntaxErrorKeywords.items.includes(a),disabled:!e.hasPermission},on:{input:function(r){return e.updateKeywordList(n,r)},remove:function(r){return e.removeKeywordFromList(n)}}})}),1),e.keywordList.length>0&&e.hasPermission?t("ThemeKeywordRecommend",{attrs:{keywordList:e.keywordList},on:{"add-keyword-recommend":e.addKeywordRecommend}}):e._e()]:e._e(),e.selectedEditKeywordType==="カスタム"?[t("div",{staticClass:"m-custom-keywords-label c-title c-title--s"},[e._v(" 検索クエリを入力。クエリごとに改行 ")]),e._l(e.keywordsErrorMessages,function(a){return t("div",{key:a,staticClass:"m-error c-formBlock__text c-formBlock__text--error"},[e._v(" "+e._s(a)+" ")])}),t("textarea",{directives:[{name:"model",rawName:"v-model.trim",value:e.trimmedKeywords,expression:"trimmedKeywords",modifiers:{trim:!0}}],staticClass:"o-theme-keywords-input m-normal-text-area c-text c-text--m c-textInput",class:{"c-formInput--error":e.tooLongKeywords||e.keywordErrors.length>0},attrs:{disabled:!e.hasPermission,placeholder:"EV AND 充電"},domProps:{value:e.trimmedKeywords},on:{input:function(a){a.target.composing||(e.trimmedKeywords=a.target.value.trim())},blur:function(a){return e.$forceUpdate()}}})]:e._e()],2)]),e.hasPermission&&!e.isChinese||e.hasThemeScopeSetting||e.hasInitialThemeSetting?t("div",{staticClass:"o-theme-edit-form"},[e.hasPermission&&!e.isChinese?t("div",{staticClass:"o-theme-settings"},[t("div",{staticClass:"o-theme-edit-foreign-feed"},[t("div",{staticClass:"o-theme-edit-foreign-feed-label c-formBlock__label c-title c-title--m"},[e._v(" フィード設定 "),t("sm-icons",{staticClass:"small",on:{click:e.showThemeSettingsInfoModal}},[e._v("question-circle")])],1)]),t("div",{staticClass:"o-theme-edit-foreign-feed-item"},[t("sm-checkbox-label",{attrs:{value:e.isForeignMediaEnabled,disabled:!e.isForeignFeedAvailable},on:{change:function(a){e.isForeignMediaEnabled=!e.isForeignMediaEnabled}}},[t("span",{class:{"o-disabled-message":!e.isForeignFeedAvailable}},[e._v("海外メディアの情報を収集する"),e.isForeignFeedAvailable?e._e():t("span",{staticClass:"c-text c-text--s"},[e._v("（オプション契約が必要です）")])])])],1),t("div",{staticClass:"o-theme-edit-entertainment-filter-item"},[t("sm-checkbox-label",{attrs:{value:e.isEntertainmentSitesFiltered},on:{change:function(a){e.isEntertainmentSitesFiltered=!e.isEntertainmentSitesFiltered}}},[t("span",[e._v("エンタメ記事を除外する")])])],1),t("div",{staticClass:"theme-technical-literature"},[t("div",{staticClass:"c-formBlock__label"},[t("span",{staticClass:"c-title c-title--m"},[e._v("表示する技術文献")]),e.isTechnicalResearchAvailable?e._e():t("span",{staticClass:"c-text c-text--s disabled"},[e._v("（オプション契約が必要です）")])]),t("div",{staticClass:"options"},[t("sm-checkbox-label",{attrs:{value:e.isResearchPaperEnabled,disabled:!e.isTechnicalResearchAvailable},on:{change:function(a){e.isResearchPaperEnabled=!e.isResearchPaperEnabled}}},[t("span",{class:{disabled:!e.isTechnicalResearchAvailable}},[e._v("論文")])]),t("sm-checkbox-label",{attrs:{value:e.isPatentEnabled,disabled:!e.isTechnicalResearchAvailable},on:{change:function(a){e.isPatentEnabled=!e.isPatentEnabled}}},[t("span",{class:{disabled:!e.isTechnicalResearchAvailable}},[e._v("特許（β）")])])],1)])]):e._e(),e.hasPermission&&!e.isChinese?t("div",{staticClass:"o-theme-sites"},[t("div",{staticClass:"o-textarea-label c-title c-title--m"},[e._v(" 除外メディア ")]),t("div",{staticClass:"o-textarea-explanation c-text c-text--m"},[e._v(" フィードから除外したいメディアを"+e._s(e.siteLimit)+"件まで登録することができます。 ")]),e.sites.items.length>0?t("SiteSelect",{key:`sites-${e.selectedSites.items.length}`,attrs:{items:e.sites.items,maxItems:e.siteLimit},model:{value:e.selectedSites.items,callback:function(a){e.$set(e.selectedSites,"items",a)},expression:"selectedSites.items"}}):e._e()],1):e._e(),e.hasThemeScopeSetting?t("div",{staticClass:"o-theme-scope"},[t("div",{staticClass:"o-textarea-label c-title c-title--m"},[e._v("公開範囲")]),t("sm-selectbox",{key:e.selectedScope,staticClass:"theme-scope-select",attrs:{placeholder:(e.scopes.find(a=>a.id===e.selectedScope)||{name:""}).name,labels:e.scopes.map(a=>a.name),values:e.scopes.map(a=>a.id),optionsMaxHeight:"240px"},on:{selected:e.selectScope}})],1):e._e(),e.hasInitialThemeSetting?t("div",{staticClass:"o-initial-theme"},[t("div",{staticClass:"o-textarea-label c-title c-title--m"},[e._v(" 初期表示設定 ")]),t("div",{staticClass:"o-textarea-explanation c-text c-text--m"},[e._v(" 初期メンバーが追加された時にデフォルトで表示することができます。 ")]),t("div",{staticClass:"o-theme-edit-initial-theme-item"},[t("sm-checkbox-label",{attrs:{value:e.isInitialTheme},on:{change:function(a){e.isInitialTheme=!e.isInitialTheme}}},[t("span",[e._v("有効にする")])])],1)]):e._e()]):e._e()],1),t("div",{staticClass:"spacing-16"}),e.hasPermission&&!e.isChinese?t("ThemePreview",{key:`preview-${e.themeId}`,staticClass:"o-theme-preview",attrs:{keywords:e.debouncedKeywordList,keywordErrors:e.debouncedKeywordErrors,isForeignFeedAvailable:e.isForeignFeedAvailable,isForeignMediaEnabled:e.isForeignMediaEnabled,isEntertainmentFilterEnabled:e.isEntertainmentSitesFiltered,excludedSites:e.selectedSites.items},on:{syntaxErrorKeywords:e.setSyntaxErrorKeywords}}):e._e()],1)]),t("FixedFooter",{attrs:{isMenuVisible:e.isMenuVisible}},[t("div",{staticClass:"o-submit-buttons"},[e.hasPermission?t("button",{staticClass:"o-theme-edit-save c-btn c-btn--auto c-btn--small c-btn--AnewsPrimary",class:{disabled:!e.enableToUpdate||e.isSaving},attrs:{disabled:!e.enableToUpdate||e.isSaving},on:{click:function(a){return e.saveTheme()}}},[e._v(" "+e._s(e.submitBtnText)+" ")]):e._e(),e.hasPermission?t("button",{staticClass:"o-theme-edit-save outlined c-outlineBtn c-btn--auto c-btn--small c-outlineBtn--secondary",class:{disabled:!e.enableToUpdate||e.isSaving},attrs:{disabled:!e.enableToUpdate||e.isSaving},on:{click:function(a){return e.saveTheme(!0)}}},[e._v(" "+e._s(e.submitBtnWithoutEmailText)+" ")]):e._e(),!e.isCreate&&e.hasPermission?t("button",{staticClass:"o-theme-delete outlined c-btn--auto c-btn--small",on:{click:e.deleteTheme}},[t("sm-icons",{staticClass:"small"},[e._v("trash")]),t("span",[e._v("削除")])],1):e._e()])]),e.isCreatingTheme?t("sm-dialog",{staticClass:"auto-height screen-center",scopedSlots:e._u([{key:"header",fn:function(){return[t("div",{staticClass:"o-header c-text c-text--m modal-header"},[e._v("テーマ設定")])]},proxy:!0},{key:"body",fn:function(){return[t("div",{staticClass:"o-body c-text c-text--m modal-body"},[t("div",{staticClass:"c-text c-text--s"},[e._v("テーマを設定しています...")])])]},proxy:!0}],null,!1,1091891665)}):e._e()],1)},rk=[],ok=T(ak,nk,rk,!1,null,"20a90efe",null,null);const Cn=ok.exports,ik=D({props:{},components:{AdpDocumentCard:Re,SwrScrollingPagination:wt,RankBadge:wa},setup(){const s=ie(),e=fe(),t=s.params.themeId;ne(()=>{e.$on("article-updated",r)}),Be(()=>{e.$off("article-updated",r)});const a=(o,i)=>o.id===i,n=(o,i)=>{const u=o.findIndex(c=>c.id===i.id);return u>=0&&(o[u].marks=i.marks,o[u].is_read=i.is_read),o},r=o=>{e.$emit("pagination-items-update",i=>a(i,o.id),i=>n(i,o))};return{pageLimit:10,paginationFunc:(o,i)=>Hc(t,o,i),dataAccessor:o=>o==null?void 0:o.featured_articles,TOOLTIP_FOR_THEME_FEATURED_ARTICLES:Hn}}});var uk=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"o-theme-activity-feed"},[t("div",{staticClass:"o-feed"},[t("SwrScrollingPagination",{ref:"pagination",attrs:{pageLimit:e.pageLimit,paginationFunc:e.paginationFunc,dataAccessor:e.dataAccessor},scopedSlots:e._u([{key:"default",fn:function({items:a,loaded:n}){return[e._l(a,function(r,o){return t("div",{key:r.id,staticClass:"o-article-card"},[t("AdpDocumentCard",{attrs:{width:"100%",pageName:"theme",adpDocument:r,showCommentCount:1,isRead:r.is_read,feature:"theme_feature_articles"}}),o<=4?t("RankBadge",{staticClass:"rank-badge-outer",attrs:{rank:o+1}}):e._e()],1)}),n&&a.length===0?t("div",{staticClass:"o-no-featured-articles"},[t("div",{staticClass:"o-textarea-explanation o-description c-text c-text--m"},[e._v(" マークやコメントがないため注目記事がありません。"),t("br"),e._v(" 気になった記事があればマークやコメントをしていきましょう。 ")]),t("router-link",{attrs:{to:{name:"themeFeed"}}},[t("div",{staticClass:"o-link-to-home o-description c-text c-text--m"},[e._v(" ニュースフィードへ移動 ")])])],1):e._e()]}}])})],1)])},ck=[],lk=T(ik,uk,ck,!1,null,"d3250c04",null,null);const dk=lk.exports,mk=D({props:{theme:{type:Object,required:!0}},components:{ArticleCardSmall:zr},setup({theme:s}){const e=se(),t=fe(),a=l(()=>e.state.feedType.feedType),n=l(()=>s.feed_last_updated_at?oe(s.feed_last_updated_at):oe()),r=l(()=>{var i;if(a.value==="all"){const{data:u}=Ps(s.id,g("domestic"),g(n.value.toDate()),g(1),2),{data:c}=Ps(s.id,g("foreign"),g(n.value.toDate()),g(1),2);return u.value&&c.value?[...u.value.related_feeds,...c.value.related_feeds]:void 0}else{const{data:u}=Ps(s.id,a,g(n.value.toDate()),g(1),3);return((i=u.value)==null?void 0:i.related_feeds)??void 0}});ne(()=>{t.$on("article-updated",o)}),Be(()=>{t.$off("article-updated",o)});const o=i=>{if(!r.value)return;const u=r.value.findIndex(c=>c.id===i.id);return u>=0&&(r.value[u].marks=i.marks,r.value[u].is_read=i.is_read),r};return{feedType:a,articles:r}}});var _k=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"related-news-preview"},[t("div",{staticClass:"title c-title c-title--s"},[e._v("関連ニュース")]),e.articles!==void 0?[e._l(e.articles,function(a){return t("div",{key:a.id,staticClass:"articles"},[t("ArticleCardSmall",{attrs:{article:a,themeId:e.theme.id,feedType:e.feedType,pageName:"theme",feature:"related_feed"}}),t("div",{staticClass:"divider"})],1)}),e.articles.length>0?t("div",{staticClass:"related-news-page-link c-title c-title--s"},[t("router-link",{staticClass:"link",attrs:{to:{name:"themeRelatedNews"}}},[e._v("もっと見る")])],1):e._e()]:e._e(),e.articles&&e.articles.length===0?t("div",{staticClass:"empty-articles"},[e._m(0),t("div",{staticClass:"message c-text c-text--m"},[e._v("配信記事はありません。")]),t("div",{staticClass:"message c-text c-text--m"},[e._v(" 記事を読んだりマークすると、おすすめ記事が配信されます。 ")])]):e._e()],2)},pk=[function(){var s=this,e=s._self._c;return s._self._setupProxy,e("div",{staticClass:"image-wrap"},[e("img",{staticClass:"image",attrs:{src:bs}})])}],vk=T(mk,_k,pk,!1,null,"4739b351",null,null);const bn=vk.exports,fk=D({components:st.ANDEV_2822_REMOVE_THEME_FEATURED_ARTICLES?{RelatedNewsPreview:bn,FeedArticles:us}:{FeaturedArticleList:Jr,RelatedNewsPreview:bn,FeedArticles:us},props:{theme:{type:Object,required:!0}},setup(s){const e=se(),t=l(()=>e.state.userInfo.userInfo),a=l(()=>e.state.feedType.feedType),n=g(null),r=Hn;ne(async()=>{t.value&&(n.value=await F.fetchThemeFeaturedArticles(Number(s.theme.id))),window.addEventListener("scroll",d),window.addEventListener("resize",m),d()}),Xe(()=>{window.removeEventListener("scroll",d),window.removeEventListener("resize",m)}),Z([()=>s.theme,a],async()=>{n.value=await F.fetchThemeFeaturedArticles(Number(s.theme.id))},{deep:!0});const o=g(),i=g();let u=0,c="top";const p=121,m=_=>d(_,!0),d=(_,h=!1)=>{if(!o.value||!i.value)return;const v=Cs(i.value,o.value,u,c,p,0,h);v&&(u=v.windowScrollY,c=v.contentPosition)};return{userInfo:t,feedType:a,featuredArticles:n,tooltipText:r,activityColumn:o,activityContent:i,ANDEV_2822_REMOVE_THEME_FEATURED_ARTICLES:st.ANDEV_2822_REMOVE_THEME_FEATURED_ARTICLES}}});var gk=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"keyword-feed"},[t("div",{key:e.theme.id,staticClass:"m-feed-ready"},[t("FeedArticles",{attrs:{feed:"keyword_feed"}})],1),t("div",{ref:"activityColumn",staticClass:"o-team-activity"},[t("div",{ref:"activityContent",staticClass:"o-team-activity-content"},[e.theme.is_chinese?e._e():t("div",{staticClass:"related-news"},[t("RelatedNewsPreview",{attrs:{theme:e.theme}}),t("div",{staticClass:"spacing-16"})],1),!e.theme.is_chinese&&!e.ANDEV_2822_REMOVE_THEME_FEATURED_ARTICLES?t("div",{staticClass:"featured-articles"},[e.featuredArticles?t("FeaturedArticleList",{attrs:{pageName:"theme",feature:"theme_feature_articles",themeId:e.theme.id,articles:e.featuredArticles.slice(0,8),linkTo:`/themes/${e.theme.id}/featured_articles`,tooltipText:e.tooltipText}}):e._e()],1):e._e()])])])},hk=[],yk=T(fk,gk,hk,!1,null,"e7b3a8e1",null,null);const Ck=yk.exports,Gs={id:0,name:"",description:"",is_deleted:!1,is_favorite:!1,is_chinese:!1,order:0,keyword_feed_count:0,member_count:0,access_scope:"public",created_at:"",updated_at:"",keywords:[],site_exclusion_ids:[],foreign_keyword_feed_count:0,is_foreign_media_enabled:!1,is_research_paper_enabled:!1,is_patent_enabled:!1,is_entertainment_sites_filtered:!1,is_initial_theme:!1,feed_last_updated_at:"",feeds_updated_at:null,keyword_feed_counts:{},related_feed_counts:{domestic:0,foreign:0},featured_article_feed_count:0,research_paper_feed_counts:{domestic:0,foreign:0},patent_feed_counts:{domestic:0,foreign:0},research_paper_feed_last_updated_at:null},bk=D({props:{themeId:{type:[String,Number],default:void 0}},components:{Header:Se,Content:Ue,BasicEmptyFeed:xt},setup(s){const e=se(),t=fe(),a=ie(),n=Te(),r=l(()=>e.state.themeList.themes),o=l(()=>e.state.themeList.hasFetchedThemes),i=l(()=>{var j;return a.params.themeId&&((j=h.value)==null?void 0:j.id)!==Number(a.params.themeId)}),u=l(()=>e.state.userInfo.userInfo),c=l(()=>e.state.groups.groups),p=l(()=>e.state.teamUsers.teamUsers),m=l(()=>e.state.teamInfo.teamInfo),d=l(()=>e.state.feedType.feedType),_=g(!1),h=g(void 0);ne(async()=>{v()}),Z(o,async()=>v()),Z(()=>a.path,()=>{i.value&&v()});const v=async()=>{o.value&&(await f(),await S())},f=async()=>{var j;if(i.value){_.value=!1;try{h.value=await F.fetchTheme(Number(s.themeId)),ze(()=>_.value=!0)}catch(K){if(Je(K)&&((j=K.response)==null?void 0:j.status)===404){C("指定されたテーマは存在しません");return}throw K}}},C=j=>{n.push({name:"anewsHome"}),e.commit("snackbar/addMessages",{message:j,type:"error"})},y=l(()=>{if(!o.value||!h.value)return Gs;if(h.value.is_deleted)return h.value;const j=r.value.find(le=>le.id===Number(s.themeId));return j?{...j,...h.value}:Gs}),A=async j=>{var le;let K;if(j)try{await F.deleteFavoriteTheme(Number(s.themeId)),e.commit("snackbar/addMessages",{message:"お気に入りを解除しました",type:""})}catch(ye){throw e.commit("snackbar/addMessages",{message:"お気に入りの解除に失敗しました",type:"error"}),ye}else try{K=(await F.postFavoriteTheme(Number(s.themeId))).order,e.commit("snackbar/addMessages",{message:"お気に入りに登録しました",type:""}),(le=y.value)!=null&&le.is_member||$(!0)}catch(ye){throw e.commit("snackbar/addMessages",{message:"お気に入りの登録に失敗しました",type:"error"}),ye}k(K)},k=async j=>{if(!y.value)return;y.value.is_favorite=!y.value.is_favorite;const K=e.getters["themeList/activeThemes"].find(le=>le.id===Number(s.themeId));K&&(K.is_favorite=y.value.is_favorite,K.order=j??0,e.commit("themeList/updateTheme",K),t.$emit("theme-updated",K))},S=async()=>{await F.trackPageView({pageName:"theme",pageUrl:a.fullPath,theme:{id:Number(s.themeId)},feedType:d.value})},b=l(()=>{var j,K,le,ye;return!((j=y.value)!=null&&j.is_member)&&(((K=y.value)==null?void 0:K.access_scope)!=="personal"||((le=y.value)==null?void 0:le.user_id)===((ye=u.value)==null?void 0:ye.id))}),U=l(()=>{var j;return((j=h.value)==null?void 0:j.access_scope)==="group"}),I=l(()=>c.value.find(j=>{var K;return j.id===((K=h.value)==null?void 0:K.group_id)})),w=l(()=>{var j;return((j=I.value)==null?void 0:j.is_member)===!0}),x=async j=>{var le;if(!h.value)return;h.value.is_member=j;const K=e.getters["themeList/activeThemes"].find(ye=>ye.id===Number(s.themeId));K&&(K.is_member=h.value.is_member,e.commit("themeList/updateTheme",K),t.$emit("theme-updated",K),await e.dispatch("groups/fetchGroups",(le=u.value)==null?void 0:le.id))},B=g(!1),$=async(j=!1)=>{var K,le;if(B.value=!0,(K=y.value)!=null&&K.is_member)try{if(await F.deleteUserTheme(Number(s.themeId)),await x(!1),y.value.is_favorite&&(await F.deleteFavoriteTheme(Number(s.themeId)),k()),j){B.value=!1;return}await P("remove_theme"),e.commit("snackbar/addMessages",{message:"テーマを解除しました",type:""})}catch(ye){throw e.commit("snackbar/addMessages",{message:"テーマを解除できませんでした",type:"error"}),ye}else try{if(U.value&&!w.value&&((le=h.value)!=null&&le.group_id)&&await F.joinGroup(h.value.group_id),await F.addUserTheme(Number(s.themeId)),await x(!0),j){B.value=!1;return}await P("add_theme"),e.commit("snackbar/addMessages",{message:"テーマを追加しました",type:""})}catch(ye){throw e.commit("snackbar/addMessages",{message:"テーマを追加できませんでした",type:"error"}),ye}B.value=!1},P=async j=>{const K={theme:{id:s.themeId}};await F.trackEvent(j,{pageName:"theme",pageUrl:a.fullPath},void 0,void 0,K)},M=l(()=>{var j;return((j=h.value)==null?void 0:j.access_scope)==="group"&&!w.value?"グループに参加して追加":"追加"}),O=l(()=>{var j,K;return((j=y.value)==null?void 0:j.is_chinese)&&!((K=m.value)!=null&&K.enable_chinese_lang_media)}),Y=l(()=>{var j;if(y.value&&!O.value)return(j=y.value)!=null&&j.id?Zs(d.value,y.value,m.value):void 0}),W=l(()=>{var j,K,le,ye;return y.value?((j=y.value)==null?void 0:j.is_favorite)||((K=y.value)==null?void 0:K.access_scope)!="personal"||((le=y.value)==null?void 0:le.user_id)===((ye=u.value)==null?void 0:ye.id):!1});return{theme:y,themeDetail:h,groups:c,teamUsers:p,getThemeHeaderDetail:ga,toggleFavorite:A,toggleUserTheme:$,isAddButtonVisible:b,addButtonText:M,tabs:Y,showFavorite:W,isUpdatingUserTheme:B,loaded:_,isThemeContentDisabled:O}}});var Ak=function(){var a,n;var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"o-theme-feed"},[t("Header",{attrs:{title:e.theme?e.theme.name:void 0,detail:e.getThemeHeaderDetail(e.theme,e.groups,e.teamUsers),icon:"hashtag",detailIcon:e.theme&&e.theme.access_scope==="group"?"users":void 0,tabs:e.tabs,contentWidth:"904px"},scopedSlots:e._u([{key:"titleMenu",fn:function(){return[e.showFavorite?t("sm-icons",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:{content:e.theme.is_favorite?"お気に入り解除":"お気に入り",delay:{show:300},offset:8},expression:`{
            content: theme.is_favorite ? 'お気に入り解除' : 'お気に入り',
            delay: { show: 300 },
            offset: 8
          }`,modifiers:{top:!0}}],key:e.theme.is_favorite,staticClass:"favorite-theme",class:{"astrategy-primary":e.theme.is_favorite,"anews-primary":!e.theme.is_favorite},on:{click:function(r){return e.toggleFavorite(e.theme.is_favorite)}}},[e._v(e._s(e.theme.is_favorite?"star-fill":"star"))]):e._e()]},proxy:!0},{key:"button",fn:function(){return[t("div",{staticClass:"add-theme-button"},[e.loaded&&e.isAddButtonVisible?t("button",{staticClass:"add-theme c-btn c-btn--small c-btn--AnewsPrimary",attrs:{disabled:e.isUpdatingUserTheme},on:{click:function(r){return r.preventDefault(),(()=>e.toggleUserTheme()).apply(null,arguments)}}},[e._v(" "+e._s(e.addButtonText)+" ")]):e.loaded&&e.theme.is_member?t("button",{staticClass:"add-theme c-btn c-btn--small c-btn",attrs:{disabled:e.isUpdatingUserTheme},on:{click:function(r){return r.preventDefault(),(()=>e.toggleUserTheme()).apply(null,arguments)}}},[e._v(" 解除 ")]):e._e()])]},proxy:!0}])}),t("Content",[t("div",{staticClass:"theme"},[e.loaded&&!e.isThemeContentDisabled?t("div",{key:(a=e.themeDetail)==null?void 0:a.id,staticClass:"o-feed-ready"},[t("div",{ref:"feedBody",staticClass:"o-theme-feed-body"},[t("router-view",{attrs:{theme:e.themeDetail,themeId:(n=e.themeDetail)==null?void 0:n.id}})],1)]):e.isThemeContentDisabled?t("div",[t("BasicEmptyFeed",[e._v("このテーマは中国語メディア専用です。ご利用になるには中国語メディア配信オプションの契約が必要です。")])],1):e._e()])])],1)},kk=[],xk=T(bk,Ak,kk,!1,null,"3403dc81",null,null);const wk=xk.exports,Ek=D({props:{themeSearch:{type:Object,required:!0},trackThemeSearchParams:{type:Object,required:!0},themeSearchIndex:{type:Number,required:!0},pageUrl:{type:String,required:!0}},emits:{updateThemeSearch:s=>!0},setup(s,{emit:e}){const{data:t}=xe(),{data:a}=Qe(),n=l(()=>{var p;return((p=a.value)==null?void 0:p.users.find(m=>{var d;return m.id===((d=s.themeSearch)==null?void 0:d.creator_id)}))??null}),r=l(()=>{let c="";return s.themeSearch.is_member?c="解除":s.themeSearch.group&&!s.themeSearch.group.is_member?c="グループに参加して追加":c="追加",c}),o=l(()=>{var c;return s.themeSearch.is_member||s.themeSearch.access_scope!=="personal"||s.themeSearch.access_scope==="personal"&&s.themeSearch.user_id===((c=t.value)==null?void 0:c.id)}),i=async()=>{s.themeSearch.is_member?(e("updateThemeSearch",{id:s.themeSearch.id,type:"delete"}),await u("remove_theme")):(e("updateThemeSearch",{id:s.themeSearch.id,type:"add"}),await u("add_theme"))},u=async c=>{const p={rank:s.themeSearchIndex+1,theme:{id:s.themeSearch.id},search:s.trackThemeSearchParams};await F.trackEvent(c,{pageName:"theme_search",pageUrl:s.pageUrl},void 0,void 0,p)};return{createUser:n,btnText:r,submit:i,isButtonVisible:o,themeSearchTrackEvent:u}}});var Fk=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("router-link",{attrs:{to:`/themes/${e.themeSearch.id}`,custom:""},scopedSlots:e._u([{key:"default",fn:function({href:a,navigate:n}){return[t("a",{staticClass:"m-theme-search-card",attrs:{href:a},on:{click:r=>{e.themeSearchTrackEvent("view_theme"),n(r)}}},[t("div",{staticClass:"theme-content"},[t("div",{staticClass:"theme-name c-title c-title--m"},[e._v(" # "+e._s(e.themeSearch.name)+" "),e.themeSearch.is_member?t("div",{staticClass:"added"},[t("sm-icons",{staticClass:"xs primary icon"},[e._v("check")]),t("span",{staticClass:"c-text c-text--xs"},[e._v("追加済み")])],1):e._e()]),t("div",{staticClass:"theme-info c-text c-text--s"},[e.themeSearch.access_scope==="public"?t("span",{staticClass:"public"},[e._v(" 全体 ")]):e._e(),e.themeSearch.access_scope==="group"&&e.themeSearch.group?[t("sm-icons",{staticClass:"small group-icon"},[e._v("users-gray600")]),t("router-link",{staticClass:"link",attrs:{to:`/groups/${e.themeSearch.group.id}`}},[e._v(" "+e._s(e.themeSearch.group.name))]),e.themeSearch.group.is_member?e._e():t("span",[e._v("(未参加)")])]:e._e(),e.themeSearch.access_scope==="personal"?t("span",{staticClass:"personal"},[e._v(" 個人 ")]):e._e(),e.themeSearch.description?t("span",{staticClass:"description"},[e._v("・"+e._s(e.themeSearch.description))]):e._e(),e.createUser?[t("span",[e._v("・作成者：")]),t("router-link",{staticClass:"link",attrs:{to:`/users/${e.createUser.id}`}},[e._v(e._s(e.createUser.user_name))])]:e._e()],2)]),e.isButtonVisible?t("button",{staticClass:"theme-button c-btn c-btn--auto c-btn--small",class:{"c-btn--AnewsPrimary":!e.themeSearch.is_member},on:{click:function(r){return r.preventDefault(),r.stopPropagation(),e.submit.apply(null,arguments)}}},[e._v(" "+e._s(e.btnText)+" ")]):e._e()])]}}])})},Tk=[],Dk=T(Ek,Fk,Tk,!1,null,"e9e03619",null,null);const Bk=Dk.exports,Sk=D({components:{ThemeSearchCard:Bk,Header:Se},setup(){const s=se(),e=fe(),t=ie(),a=g(""),n=[{value:"member_count_desc",label:"メンバー数の多い順"},{value:"created_at_desc",label:"新しい順"},{value:"created_at_asc",label:"古い順"},{value:"theme_name_asc",label:"テーマ名（昇順）"},{value:"theme_name_desc",label:"テーマ名（降順）"}],r=[{value:"all",label:"すべてのテーマ"},{value:"added",label:"追加済みのテーマ"},{value:"not_added",label:"未追加のテーマ"},{value:"joined",label:"参加グループのテーマ"},{value:"not_joined",label:"未参加グループのテーマ"}],o=g(n[0]),i=g(r[0]),u=Fe({list:[]}),c=Fe({list:[]}),{data:p}=xe(),m=g(!1);Z(()=>a.value,()=>{A()}),ne(async()=>{const I=await F.fetchThemeList(),w=N.getUserId(),x=await F.fetchGroups(w);S(I,x),A(),await F.trackPageView({pageName:"theme_search",pageUrl:t.path})});const d=()=>{if(a.value==="")return;m.value=!0;const I=a.value.toLowerCase();u.list=u.list.filter(w=>w.name.toLowerCase().includes(I))},_=({value:I})=>{m.value=!0;const w=n.find(x=>x.value===I);w&&(o.value=w),A()},h=(I,w)=>{w==="asc"?u.list.sort((x,B)=>x[I].localeCompare(B[I],"ja")):u.list.sort((x,B)=>-x[I].localeCompare(B[I],"ja"))},v=(I,w)=>{w==="asc"?u.list.sort((x,B)=>x[I]-B[I]):u.list.sort((x,B)=>B[I]-x[I])},f=({value:I})=>{m.value=!0;const w=r.find(x=>x.value===I);w&&(i.value=w),A()},C=()=>{switch(o.value.value){case"member_count_desc":v("member_count","desc");break;case"member_count_asc":v("member_count","asc");break;case"created_at_desc":h("created_at","desc");break;case"created_at_asc":h("created_at","asc");break;case"theme_name_asc":h("name","asc");break;case"theme_name_desc":h("name","desc");break}},y=()=>{switch(i.value.value){case"added":u.list=u.list.filter(I=>I.is_member);break;case"not_added":u.list=u.list.filter(I=>!I.is_member);break;case"joined":u.list=u.list.filter(I=>{if(I.group)return I.group.is_member});break;case"not_joined":u.list=u.list.filter(I=>{if(I.group)return!I.group.is_member});break}},A=()=>{u.list=c.list,d(),C(),y(),U()},k=async I=>{const w=u.list.map(B=>B.id).indexOf(I.id),x=u.list[w];I.type==="add"?(x.is_member=!0,x.group&&!x.group.is_member&&(x.group.is_member=!0,await F.joinGroup(x.group.id)),await F.addUserTheme(x.id)):(x.is_member=!1,await F.deleteUserTheme(x.id)),s.commit("themeList/updateTheme",x),e.$emit("theme-updated",x)},S=(I,w)=>{var x;u.list=I.filter(B=>!B.is_deleted).map(B=>{const $=w.find(P=>P.id===Number(B.group_id));return{...B,group:$}}),((x=p.value)==null?void 0:x.role)!=="admin"&&(u.list=u.list.filter(B=>{var $;return["public","group"].includes(B.access_scope)||B.user_id===(($=p.value)==null?void 0:$.id)})),c.list=u.list},b=l(()=>({query:a.value,by_user:m.value,sort:o.value.label,filter:i.value.label,result_count:u.list.length})),U=async()=>{await F.trackEvent("search_theme",{pageName:"theme_search",pageUrl:t.fullPath},void 0,void 0,b.value)};return{query:a,sortList:n,filterList:r,selectedSort:o,selectedFilter:i,themeSearchList:u,selectSort:_,selectFilter:f,keywordFilter:d,filterThemes:A,updateThemeSearch:k,trackThemeSearchParams:b,pageUrl:t.fullPath}}});var Ik=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"o-theme-search"},[t("Header",{attrs:{title:"テーマ検索",alignLeft:!0}}),t("div",{staticClass:"o-theme-search__content"},[t("div",{staticClass:"o-theme-search__keyword"},[t("button",{staticClass:"m-search-button",on:{click:e.filterThemes}},[t("sm-icons",{staticClass:"small"},[e._v("search")])],1),t("input",{directives:[{name:"model",rawName:"v-model",value:e.query,expression:"query"}],staticClass:"c-textInput",attrs:{type:"text",placeholder:"テーマ名で検索"},domProps:{value:e.query},on:{input:function(a){a.target.composing||(e.query=a.target.value)}}})]),t("div",{staticClass:"spacing-16"}),t("div",{staticClass:"o-theme-search__select"},[t("div",{staticClass:"o-theme-search__counts"},[t("div",{staticClass:"c-title c-title--m"},[e._v(" テーマ"),t("span",{staticClass:"c-text c-text--s count"},[e._v("・"+e._s(e.themeSearchList.list.length)+"件")])])]),t("div",{staticClass:"spacing-16"}),t("sm-selectbox",{staticClass:"small",attrs:{placeholder:e.selectedSort.label,labels:e.sortList.map(a=>a.label),values:e.sortList.map(a=>a.value)},on:{selected:e.selectSort}}),t("div",{staticClass:"spacing-16"}),t("sm-selectbox",{staticClass:"small",attrs:{placeholder:e.selectedFilter.label,labels:e.filterList.map(a=>a.label),values:e.filterList.map(a=>a.value)},on:{selected:e.selectFilter}},[t("div",{staticClass:"spacing-16"})])],1),t("div",{staticClass:"spacing-16"}),e._l(e.themeSearchList.list,function(a,n){return t("div",{key:a.id,staticClass:"o-theme-search__list"},[t("ThemeSearchCard",{attrs:{themeSearch:a,trackThemeSearchParams:e.trackThemeSearchParams,themeSearchIndex:n,pageUrl:e.pageUrl},on:{updateThemeSearch:e.updateThemeSearch}})],1)}),e.themeSearchList.list.length===0?t("div",{staticClass:"o-theme-search__no-search-result"},[t("div",{staticClass:"c-text c-text--m"},[e._v("該当するテーマはありません")])]):e._e()],2)],1)},Mk=[],$k=T(Sk,Ik,Mk,!1,null,"be323c21",null,null);const Pk=$k.exports,Nk=D({components:{ResearchPaperFeed:go},setup(){const s=Te(),e=ie(),t=se(),{data:a}=xe(),n=l(()=>t.state.feedType.feedType),r=l(()=>Number(e.params.themeId)),{data:o}=pa(r.value),i=l(()=>{var b;return(b=o.value)==null?void 0:b.themes}),u=l(()=>{var b;return((b=i.value)==null?void 0:b.is_foreign_media_enabled)??!1}),c=l(()=>{var U;if(n.value==="foreign"&&!u.value)return;const b=((U=i.value)==null?void 0:U.research_paper_feed_counts)??{domestic:0,foreign:0};return n.value==="all"?b.domestic+b.foreign:b[n.value]}),p=()=>{s.push({name:"themeFeed",params:{themeId:String(r.value)}})};Z(()=>i.value,()=>{var b;i.value&&!((b=i.value)!=null&&b.is_research_paper_enabled)&&p()}),ne(async()=>{F.trackPageView({pageName:"theme_technical_literature",pageUrl:e.fullPath,theme:{id:r.value},feedType:n.value})});const m=l(()=>{var b,U,I,w;return((b=a.value)==null?void 0:b.role)!=="viewer"||((U=i.value)==null?void 0:U.access_scope)==="personal"&&((I=i.value)==null?void 0:I.user_id)===((w=a.value)==null?void 0:w.id)}),{data:d,state:_}=sn(n,r.value,"domestic",g(1),200),{data:h,state:v}=Qc(n,r.value,"domestic",g(1),200),{data:f,state:C}=sn(n,r.value,"foreign",g(1),200),y=l(()=>{var b;return{items:((b=d.value)==null?void 0:b.research_paper_feeds)??[],state:_.value}}),A=l(()=>{var b;return{items:((b=h.value)==null?void 0:b.patent_feeds)??[],state:v.value}}),k=l(()=>{var b;return{items:((b=f.value)==null?void 0:b.research_paper_feeds)??[],state:C.value}}),S=l(()=>{var b;return((b=i.value)==null?void 0:b.research_paper_feed_last_updated_at)??void 0});return{theme:i,feedType:n,feedCount:c,isForeignMediaEnabled:u,domesticPapers:y,domesticPatents:A,foreignPapers:k,enableToEditTheme:m,feedDate:S}}});var Lk=function(){var e=this,t=e._self._c;return e._self._setupProxy,e.theme?t("ResearchPaperFeed",{attrs:{title:"関連する論文",feedCount:e.feedCount,feedDate:e.feedDate,domesticPapers:e.domesticPapers,domesticPatents:e.domesticPatents,foreignPapers:e.foreignPapers,theme:e.theme,enableToEditTheme:e.enableToEditTheme}}):e._e()},Uk=[],Rk=T(Nk,Lk,Uk,!1,null,"6c39e00a",null,null);const Ok=Rk.exports,Gk=D({props:{article:{type:Object},comment:{type:Object,required:!0},groupId:{type:Number,required:!0},groupName:{type:String},showGroup:{type:Boolean,default:!1},pageName:{type:String,required:!0},feature:String,expandsAllChild:{type:Boolean,default:!1},childDisplayCount:{type:Number,default:2}},components:{AdpDocumentCard:Re},setup(s,e){const t=ie(),a=se();nt();const{data:n}=xe(),r=g(),o=()=>{var p;return(((p=r.value)==null?void 0:p.trimmedComment)??"").length===0},i=()=>{var p,m;((p=r.value)==null?void 0:p.trimmedComment)!==""?(m=r.value)==null||m.postComment():u()},u=async()=>{var p,m;if(r.value){const d=await F.sendComment({groupId:s.groupId,adpDocument:s.article,themeId:(p=s.comment)==null?void 0:p.theme_id,content:r.value.trimmedComment,mention:r.value.mention,parentCommentId:(m=s.comment)==null?void 0:m.id,trackingBaseData:{pageName:s.pageName,feature:s.feature,pageUrl:t.fullPath}}).catch(_=>{throw a.commit("snackbar/addMessages",{message:"コメントを投稿できませんでした",type:"error"}),_});a.commit("snackbar/addMessages",{message:"コメントを投稿しました",type:"success"}),e.emit("reply",d),r.value.resetTrimmedComment()}},c=g(!1);return{userInfo:n,isReplyTextEmpty:o,postComment:u,callPostComment:i,replyFocused:c,replyRef:r,isTabletUser:zn,host:location.host}}});var qk=function(){var e=this,t=e._self._c;return e._self._setupProxy,e.comment&&e.userInfo?t("div",{staticClass:"group-comment"},[t("AdpDocumentCard",{attrs:{width:"100%",adpDocument:e.article,themeId:e.comment.theme_id,comment:e.comment,showThemeTag:!0,pageName:e.pageName,feature:e.feature}})],1):e._e()},Hk=[],Vk=T(Gk,qk,Hk,!1,null,"9dfe6532",null,null);const jk=Vk.exports;function qt(s,e,t){N.getUserId()!==s&&(t.push({name:"anewsHome"}),e.commit("snackbar/addMessages",{message:"権限がありません",type:"error"}))}function yo(s,e,t,a){return t.mypage_access_scope==="public"?!1:t.mypage_access_scope==="personal"?(s==null?void 0:s.id)!==e.id:!a.filter(n=>n.is_member===!0).map(n=>n.id).includes(t.mypage_access_allow_group_id)}function ms(s,e){if(s.mypage_access_scope==="public")return"・公開範囲：全体";if(s.mypage_access_scope==="personal")return"・公開範囲：自分のみ";{const t=e.filter(a=>a.is_member===!0).find(a=>a.id==s.mypage_access_allow_group_id);return t?`・公開範囲：${t.name}`:""}}const Kk=10,Yk=D({props:{userId:{type:[String,Number]}},components:{Header:Se,Content:Ue,GroupComment:jk},setup(s){const e=se(),t=fe(),a=Te(),n=ie(),{userId:r}=$e(s),o=l(()=>e.state.userActions.userComments),i=l(()=>e.state.userActions.userActionCount),u=l(()=>e.state.userActions.hasFetchedUserActionCount),c=l(()=>e.state.userActions.targetUserInfo),p=l(()=>e.state.userInfo.userInfo),m=l(()=>e.state.groups.groups),d=l(()=>u.value&&i.value.comment===0),_=l(()=>is(p.value));ne(async()=>{t.$on("comment-created",b=>{e.dispatch("userActions/addUserComment",{comment:b})}),t.$on("comment-updated",b=>{e.dispatch("userActions/updateUserComment",{comment:b})}),t.$on("comment-deleted",b=>{e.dispatch("userActions/deleteUserComment",{id:b})}),qt(Number(r==null?void 0:r.value),e,a),await f()});const h=g(null),v=g(void 0),f=async()=>{e.dispatch("userActions/fetchTargetUserInfo",Number(r==null?void 0:r.value)),e.commit("userActions/resetUserComments"),h.value=await F.getUserSettings(Number(r==null?void 0:r.value));const b=async(U,I)=>{await y(Number(r==null?void 0:r.value),U,I)};v.value&&v.value.removeEvent(),v.value=new dt(b,Kk),await A()},C=b=>{var U,I;return(I=(U=m.value)==null?void 0:U.find(w=>w.id===b))==null?void 0:I.name};Z(()=>r==null?void 0:r.value,()=>{qt(Number(r==null?void 0:r.value),e,a),f()}),Xe(()=>{var b;(b=v.value)==null||b.removeEvent(),e.commit("userActions/resetUserComments")});const y=async(b,U,I)=>{const w={limit:I,page:U,reset:!1,userId:b};await e.dispatch("userActions/fetchUserComments",w)},A=async()=>{await F.trackPageView({pageName:"user",pageUrl:n.fullPath})},k=l(()=>!h.value||Xn(c.value)?!1:yo(p.value,c.value,h.value,m.value)),S=l(()=>h.value?ms(h.value,m.value):"");return{userComments:o,userActionCount:i,hasFetchedUserActionCount:u,targetUserInfo:c,userInfo:p,groups:m,hasNoComments:d,tabs:_,getTabs:is,groupName:C,mypageRestricted:k,isMypageAccessScope:S}}}),Qk=""+new URL("state-empty-comment-c34382b7.png",import.meta.url).href;var Wk=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"o-my-activity-feed"},[t("Header",{attrs:{title:e.targetUserInfo.user_name,detail:`${e.targetUserInfo.email} ${e.isMypageAccessScope}`,avatarImageUrl:e.targetUserInfo.image_url,tabs:e.tabs,settingsLink:{name:"userSettings"}}}),t("Content",[e.mypageRestricted?[t("div",{staticClass:"page-content"},[t("div",{staticClass:"restrict-disclosure"},[t("sm-icons",{staticClass:"xlarge"},[e._v("lock")]),e._v(e._s(e.targetUserInfo.user_name)+" さんはページの公開範囲を制限しています。 ")],1)])]:[t("div",{staticClass:"o-feed"},[t("div",{staticClass:"o-caption c-title c-title--m"},[e._v(" コメント"),t("span",{staticClass:"c-text- c-text--s"},[e._v("・"+e._s(e.userActionCount.comment)+" 件")])]),e._l(e.userComments,function(a){return t("div",{key:a.id,staticClass:"o-article-card"},[t("GroupComment",{attrs:{comment:a,article:a.article,groupId:a.group_id,groupName:e.groupName(a.group_id),showGroup:!0,pageName:"user",feature:"my_comments"},on:{reply:function(n){return a.children.push(n)}}})],1)}),e.hasNoComments?t("div",{staticClass:"o-no-user-comments"},[t("div",{staticClass:"o-description c-text c-text--m"},[e._v(" 該当するコメントはありませんでした。 ")]),t("img",{attrs:{src:Qk}})]):e._e()],2)]],2)],1)},zk=[],Jk=T(Yk,Wk,zk,!1,null,"6beb7a7a",null,null);const Xk=Jk.exports,Zk=new Date(2020,5,19),qs=oe().endOf("day").subtract(1,"day").toDate();aa.locale("ja",{formatLocale:_i,yearFormat:"YYYY年",monthFormat:"MMM",monthBeforeYear:!1});const{CalendarPanel:ex}=aa;function An(s){return!isNaN(s)&&s instanceof Date}const tx=D({components:{DatePicker:aa,CalendarPanel:ex},props:{isMultipleSelect:{type:Boolean,default:()=>!0},start:{type:Date,default:()=>oe().startOf("day").startOf("month").subtract(2,"month").toDate()},end:{type:Date,default:()=>qs},disabledUntil:{type:Date,default:()=>Zk},disabledLaterThan:{type:Date,default:()=>qs},date:{type:Date,default:()=>qs}},setup(s,e){const t=g(!1),a=g({start:s.start,end:s.end}),n=g(s.date),r=g(a.value),o=g(a.value),i=(d,_,h)=>s.isMultipleSelect&&!/disabled|active|not-current-month/.test(h)&&_.length===2&&d.getTime()>_[0].getTime()&&d.getTime()<_[1].getTime()?"in-range":"",u=d=>{if(s.isMultipleSelect){const{start:_,end:h}=o.value;An(_)&&!An(h)?(_.getTime()>d.getTime()?o.value={start:d,end:_}:o.value={start:_,end:d},r.value=a.value,a.value=o.value):o.value={start:d,end:new Date(NaN)}}else n.value=d},c=d=>d<s.disabledUntil||d>s.disabledLaterThan,p=()=>{a.value=r.value,o.value=r.value,t.value=!1},m=()=>{r.value=a.value;const d=s.isMultipleSelect?a.value:n.value;e.emit("dates-changed",d),t.value=!1};return Z(()=>t.value,()=>{t.value||p()}),{open:t,currentDate:n,dates:a,calendarPanelDates:o,getClasses:i,handleSelect:u,disabledDate:c,clickCancel:p,clickApply:m,formatDate:De}}});var sx=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"datepicker"},[t("DatePicker",{attrs:{type:"date",range:!0,value:e.isMultipleSelect?[e.dates.start,e.dates.end]:e.currentDate,open:e.open,"prefix-class":"datepicker"},on:{"update:open":function(a){e.open=a},clickoutside:e.clickCancel},scopedSlots:e._u([{key:"input",fn:function(){return[e.isMultipleSelect?t("span",{staticClass:"c-text c-text--m"},[e._v(e._s(e.formatDate(e.dates.start.toISOString()))+" 〜 "+e._s(e.formatDate(e.dates.end.toISOString())))]):t("span",{staticClass:"c-text c-text--m"},[e._v(e._s(e.formatDate(e.currentDate.toISOString())))]),t("sm-icons",{staticClass:"small"},[e._v("angle-down")])]},proxy:!0},{key:"content",fn:function(){return[t("CalendarPanel",{attrs:{value:e.isMultipleSelect?[e.calendarPanelDates.start,e.calendarPanelDates.end]:e.currentDate,"get-classes":e.getClasses,"disabled-date":e.disabledDate},on:{select:e.handleSelect,clickoutside:e.clickCancel}})]},proxy:!0},{key:"footer",fn:function(){return[t("button",{staticClass:"dashboard-button",on:{click:e.clickCancel}},[e._v(" キャンセル ")]),t("button",{staticClass:"dashboard-button--primary",on:{click:e.clickApply}},[e._v(" 適用 ")])]},proxy:!0}])})],1)},ax=[],nx=T(tx,sx,ax,!1,null,null,null,null);const rt=nx.exports,Co=()=>oe().endOf("day").toDate(),kn=["名前","メールアドレス","部署名","タイトル","翻訳タイトル","URL","メディア名","言語","ログイン","配信日","アクション","アクション日時","グループ名","テーマ名","コメントタイプ","コメントID","親コメントID","返信コメント数","コメント内容","タグ","メモ"],rx=s=>{var a;const e=new $n.Workbook;e.creator="Stockmark";const t=e.addWorksheet("アクション履歴",{pageSetup:{fitToPage:!0},views:[{state:"frozen",ySplit:1}]});t.columns=kn.map(n=>({key:n})),t.addRow(kn);for(let n=1;n<=t.columnCount;n++){const r=t.getCell(1,n);r.font={bold:!0}}if(s.length>0){t.addRows(s);for(let n=1;n<=t.rowCount;n++)for(let r=1;r<=t.columnCount;r++){const o=t.getCell(n,r),i=(a=o.value)==null?void 0:a.toString();i!=null&&i.match(/^https?:\/\//)&&(o.value={text:i,hyperlink:i},o.font={color:{argb:"000000FF"},underline:!0})}}return e},bo=async(s,e,t)=>{const a=rx(e),n=t==="excel"?await a.xlsx.writeBuffer():await a.csv.writeBuffer(),r=window.URL.createObjectURL(new Blob([n])),o=document.createElement("a");o.href=r,o.setAttribute("download",s),document.body.appendChild(o),o.click(),o.remove()},Ao=(s,e)=>{var t;if(Je(s)&&((t=s.response)==null?void 0:t.status)===400&&s.response.data.type==="result_too_large"){e.commit("snackbar/addMessages",{message:"エクスポートの上限（1万行）に達しています。お手数ですが、期間を分けてご利用ください。",type:"error"});return}e.commit("snackbar/addMessages",{message:"エラーが発生しました。しばらく時間をおいてお試しください。解消しない場合はサポートまでお問い合わせください。",type:"error"})},ox=["comment","mark"],ix=D({components:{Datepicker:rt,RadioLabel:ws,Header:Se,Content:Ue,LoadableButton:Jt},props:{userId:{type:Number,default:0}},setup(s){const e=Te(),t=ie(),a=se(),n=g(oe().startOf("day").subtract(30,"day").toDate()),r=Co(),o=g(r);ne(()=>{qt(s.userId,a,e)});const i=({start:y,end:A})=>{n.value=y,o.value=A},u={comment:"コメント",mark:"マーク"},c=g([]),p=y=>{c.value.includes(y)?c.value=c.value.filter(A=>A!==y):c.value.push(y),y==="mark"&&c.value.includes("mark")?_.value="all":y==="mark"&&(_.value=void 0)},m=l(()=>c.value.length>0&&!d.value),d=l(()=>a.state.downloadActionData.isDownloadingMyActivity),_=g(void 0),h=y=>{c.value.includes("mark")&&(_.value=y)},v=l(()=>`/users/${s.userId}/action_data?${Ne.stringify({types:c.value,from:oe(n.value).format("YYYY-MM-DD"),to:oe(o.value).format("YYYY-MM-DD"),separate_mark_tags:_.value==="tag",tracking_data:JSON.stringify({page:{name:"users",url:t.fullPath},feature:"my_activity_download",format:f.value})},{arrayFormat:"brackets"})}`),f=g("excel");return{startDate:n,endDate:o,TODAY:r,updateDates:i,types:ox,typeLabels:u,selectedTypes:c,toggleType:p,markFilter:_,setMarkFilter:h,isDownloadEnabled:m,isLoading:d,download:async()=>{if(m.value)try{a.commit("downloadActionData/setIsDownloadingMyActivity",!0);const{data:y}=await Q.get(v.value),A=`action_data_${oe(n.value).format("YYYY-MM-DD")}_${oe(o.value).format("YYYY-MM-DD")}.${f.value==="excel"?"xlsx":"csv"}`;await bo(A,y,f.value)}catch(y){Ao(y,a)}finally{a.commit("downloadActionData/setIsDownloadingMyActivity",!1)}},downloadFormat:f}}});var ux=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"my-activity-download"},[t("Header",{attrs:{title:"エクスポート"}}),t("Content",[t("div",{staticClass:"settings-card"},[t("p",{staticClass:"c-text c-text--m"},[e._v(" どのような記事にアクション（マーク・コメント）をしたのかExcelやCSVで確認することができます。 ")]),t("p",{staticClass:"c-title c-title--m"},[e._v("期間")]),t("p",[t("Datepicker",{staticClass:"datepicker",attrs:{start:e.startDate,end:e.endDate,disabledLaterThan:e.TODAY},on:{"dates-changed":e.updateDates}})],1),t("p",{staticClass:"c-title c-title--m"},[e._v("アクション")]),t("div",{staticClass:"action-types"},[e._l(e.types,function(a){return t("sm-checkbox-label",{key:a,staticClass:"checkbox",attrs:{value:e.selectedTypes.includes(a),"data-testid":"action-checkbox"},on:{change:function(n){return e.toggleType(a)}}},[e._v(" "+e._s(e.typeLabels[a])+" ")])}),t("div",{staticClass:"mark-filter"},[t("RadioLabel",{attrs:{label:"マークされたすべての記事",value:e.markFilter==="all",isDisabled:!e.selectedTypes.includes("mark"),"data-testid":"mark-filter-radio"},on:{toggleValue:function(a){return e.setMarkFilter("all")}}}),t("RadioLabel",{attrs:{label:"タグ付き記事のみ（集計する際はこちらをご利用ください。複数のタグがある場合は行が分割されます）",value:e.markFilter==="tag",isDisabled:!e.selectedTypes.includes("mark"),"data-testid":"mark-filter-radio"},on:{toggleValue:function(a){return e.setMarkFilter("tag")}}})],1)],2),t("p",{staticClass:"c-title c-title--m"},[e._v("ダウンロード形式")]),t("div",{staticClass:"download-format"},[t("RadioLabel",{attrs:{label:"Excel",value:e.downloadFormat==="excel"},on:{toggleValue:function(a){e.downloadFormat="excel"}}}),t("RadioLabel",{attrs:{label:"CSV",value:e.downloadFormat==="csv"},on:{toggleValue:function(a){e.downloadFormat="csv"}}})],1),t("LoadableButton",{staticClass:"dashboard-button--primary",class:{disabled:!e.isDownloadEnabled},attrs:{disabled:!e.isDownloadEnabled,"data-testid":"download-button",isLoading:e.isLoading},on:{click:e.download}},[e._v(" ダウンロード ")])],1)])],1)},cx=[],lx=T(ix,ux,cx,!1,null,"68a662c9",null,null);const dx=lx.exports,Hs=10,mx=160,_x=D({props:{userId:{type:[String,Number]}},components:{Header:Se,Content:Ue,AdpDocumentCard:Re,AdpDocumentInfo:ka,AdpDocumentInfoDefault:ba,TagSelect:ys,AdpDocumentExport:Ca,TagItem:Nt},setup(s){const e=se(),t=fe(),a=ie(),{userId:n}=$e(s),r=l(()=>e.state.userActions.userMarkArticles),o=l(()=>e.state.userActions.userActionCount),i=g(void 0),u=l(()=>e.state.userActions.hasFetchedUserActionCount),c=l(()=>e.state.userInfo.userInfo),p=l(()=>e.state.userActions.targetUserInfo),m=l(()=>e.state.modal.isSharing),d=g(!1),_=g([]),h=g([]),v=g([]),f=g(void 0),C=g(!1),y=l(()=>e.state.userActions.fetchingUserMarkArticles),A=l(()=>e.state.modal.article),k=l(()=>e.state.groups.groups),S=g(null),b=new AbortController,U=g();let I;ne(async()=>{await w();const q=b.signal;document.addEventListener("click",P,{signal:q}),window.addEventListener("scroll",Me,{signal:q}),window.addEventListener("resize",re,{signal:q}),Me(),I==null||I.disconnect(),I=new ResizeObserver(()=>re()),U.value&&I.observe(U.value)});const w=async()=>{e.dispatch("userActions/fetchTargetUserInfo",s.userId),S.value=await F.getUserSettings(Number(s.userId));const q=async(G,ae)=>{await x(Number(s.userId),G,ae)};i.value&&(i.value.removeEvent(),e.commit("userActions/resetUserMarkArticles")),i.value=new dt(q,Hs),h.value=await F.fetchUserArticleTags(Number(s.userId)),await E()},x=async(q,G,ae,Ae=void 0,we=void 0)=>{const Le={limit:ae,page:G,reset:!1,userId:q,memoExists:Ae,tags:we};await e.dispatch("userActions/fetchUserMarkArticles",Le)},B=()=>{d.value=!d.value},$=g(),P=q=>{const G=q.target;$.value&&!$.value.contains(G)&&M()},M=()=>{d.value=!1};Z(r,async()=>{y.value||(h.value=await F.fetchUserArticleTags(Number(s.userId)),C.value=r.value.length===0)}),Z(m,q=>{var G,ae;q&&(e.dispatch("userActions/updateUserMarkArticle",{userId:Number(a.params.userId),themeId:null,articleId:(G=A.value)==null?void 0:G.id,docType:(ae=A.value)==null?void 0:ae.doc_type}),e.commit("modal/setIsSharing",!1))});const O=q=>{const G=q.value;G==="all"?f.value=void 0:G==="memoExists"?f.value=!0:f.value=!1;const ae=async(Ae,we)=>{await x(Number(s.userId),Ae,we,f.value,v.value)};te(),i.value&&(i.value.removeEvent(),e.commit("userActions/resetUserMarkArticles")),i.value=new dt(ae,Hs)},Y=q=>{d.value=!1,v.value=q;const G=async(ae,Ae)=>{await x(Number(s.userId),ae,Ae,f.value,v.value)};i.value&&(i.value.removeEvent(),e.commit("userActions/resetUserMarkArticles")),i.value=new dt(G,Hs)};Xe(()=>{var q;(q=i.value)==null||q.removeEvent(),e.commit("userActions/resetUserMarkArticles"),b.abort(),I==null||I.disconnect()});const W=l(()=>!S.value||Xn(p.value)?!1:yo(c.value,p.value,S.value,k.value)),j=l(()=>!ue.value||!S.value?"":ms(S.value,k.value)),K=l(()=>ue.value?"my_marks":"user_marks"),le=l(()=>ue.value?is(p.value):void 0),ye=l(()=>ue.value?{name:"userSettings"}:void 0),H=l(()=>u.value&&o.value.mark===0),ue=l(()=>{var q;return((q=c.value)==null?void 0:q.id)===Number(s.userId)}),_e=l(()=>{var q;return ue.value||((q=c.value)==null?void 0:q.role)==="admin"}),me=l(()=>{if(_.value.length===1)return _.value[0]}),de=l(()=>`タグ${v.value.length===0?"":` ${v.value.length}`}`),ee=l(()=>h.value.map(q=>({...q,id:q.name}))),J=q=>_.value.map(G=>G.id).includes(q),ce=q=>!_.value.map(G=>G.id).includes(q),ke=(q,G)=>{_.value=xa(q,G,_.value)};Z(r,()=>{_.value=_.value.filter(q=>r.value.find(G=>G.id===q.id))});const R=async(q,G)=>{try{G.shouldUpdateMemo&&(q.memo?await F.updateUserArticleMemo(q.id,q.doc_type,q.memo):await F.deleteUserArticleMemo(q.id,q.doc_type).catch(ae=>{var Ae;if(((Ae=ae.response)==null?void 0:Ae.status)!==404)throw ae})),G.shouldUpdateTags&&await F.updateUserArticleTags(q.id,q.doc_type,q.tags??[]),await F.trackEvent("set_article_option",{pageName:"user",pageUrl:a.fullPath,feature:K.value},q.id,void 0,{tags:q.tags,memo:q.memo}),_.value=_.value.map(ae=>ae.id===q.id?q:ae),t.$emit("article-updated",q),e.commit("snackbar/addMessages",{message:"記事情報を更新しました",type:""})}catch{e.commit("snackbar/addMessages",{message:"記事情報を更新できませんでした",type:"error"})}};Z(()=>n==null?void 0:n.value,()=>w());const ve=q=>q.marks.length===0?0:q.marks[0].theme_id??void 0,X=q=>{Y(v.value.filter(G=>G!==q))};Z(v,()=>{te()});const te=()=>{const q=f.value===!0?"with_memo":f.value===!1?"without_memo":"all";F.trackEvent("mark_filter",{pageName:"user",pageUrl:a.fullPath,feature:K.value},void 0,void 0,{filter:{tags:v.value,memo:q}})},E=async()=>{var Ae;const q=e.state.route.previousRoute,G=q&&(q==null?void 0:q.name)!==null,ae=G&&String((Ae=q==null?void 0:q.params)==null?void 0:Ae.userId)!==String(s.userId);await F.trackPageView({pageName:"user",pageUrl:a==null?void 0:a.fullPath,fromUrl:G?q==null?void 0:q.path:null,fromSnackbarLink:ae?"article_mark":void 0})},L=g(0),V=g("top"),re=q=>{Me(q,!0)},Ee=g(),Me=(q,G=!1)=>{if(!U.value||!Ee.value)return;const ae=Cs(U.value,Ee.value,L.value,V.value,mx,0,G);ae&&(L.value=ae.windowScrollY,V.value=ae.contentPosition)};return{handleTagFilterArticles:Y,articleTags:h,feature:K,isOpenTagMenu:d,isMyProfile:ue,isEmptyArticles:C,targetUserInfo:p,userActionCount:o,handleOpenTagMenu:B,selectedArticles:_,targetTags:v,removeTag:X,userMarkArticles:r,clickArticle:ke,articleSelected:J,articleHovered:ce,themeId:ve,isMypageRestricted:W,handleMemoFilterArticles:O,mypageAccessScope:j,tabs:le,settingsLink:ye,hasNoMarkArticles:H,hasPermission:_e,selectedArticle:me,tagSelectboxName:de,articleTagList:ee,updateArticle:R,tagBox:$,rightContent:U,rightColumn:Ee}}});var px=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"o-my-activity-feed"},[t("Header",{attrs:{title:e.targetUserInfo.user_name,detail:`${e.targetUserInfo.email} ${e.mypageAccessScope}`,avatarImageUrl:e.targetUserInfo.image_url,tabs:e.tabs,settingsLink:e.settingsLink}}),t("Content",[e.isMypageRestricted?[t("div",{staticClass:"page-content"},[t("div",{staticClass:"restrict-disclosure"},[t("sm-icons",{staticClass:"xlarge"},[e._v("lock")]),e._v(e._s(e.targetUserInfo.user_name)+" さんはページの公開範囲を制限しています。 ")],1)])]:[t("div",{staticClass:"page-content"},[t("div",{staticClass:"action-bar"},[t("div",{staticClass:"left-box"},[t("span",{staticClass:"c-title c-title--m"},[e._v("マーク"),t("span",{staticClass:"c-text c-text--s"},[e._v("・"+e._s(e.userActionCount.mark)+" 件")])]),e.isMyProfile?[t("div",{staticClass:"spacing-16"}),t("sm-selectbox",{staticClass:"small",attrs:{labels:["すべての記事","メモした記事","メモしてない記事"],values:["all","memoExists","noMemos"],placeholder:"すべての記事"},on:{selected:e.handleMemoFilterArticles}}),t("div",{staticClass:"spacing-16"}),t("div",{ref:"tagBox",staticClass:"tag-box",on:{click:function(a){return a.preventDefault(),a.stopPropagation(),(()=>{}).apply(null,arguments)}}},[t("div",{staticClass:"tag-selectbox",on:{click:e.handleOpenTagMenu}},[t("sm-selectbox",{key:e.tagSelectboxName,staticClass:"small",attrs:{placeholder:e.tagSelectboxName}})],1),e.isOpenTagMenu?t("TagSelect",{attrs:{tagList:e.articleTagList,targetTags:e.targetTags},on:{"filter-articles":e.handleTagFilterArticles}}):e._e()],1)]:e._e()],2),e.selectedArticles.length>0?t("AdpDocumentExport",{staticClass:"export-button",attrs:{adpDocuments:e.selectedArticles,pageName:"user",isExportEditableInfo:e.isMyProfile}}):e._e()],1),e.targetTags.length>0?t("div",{staticClass:"selected-tags"},[t("span",{staticClass:"c-text c-text--s"},[e._v("選択中のタグ")]),e._l(e.targetTags,function(a){return t("TagItem",{key:a,staticClass:"tag",attrs:{name:a,isDelete:!0},on:{deleteTag:function(n){return e.removeTag(a)}}})})],2):e._e(),t("div",{staticClass:"mark-page-content"},[t("div",{staticClass:"o-feed"},[e.isEmptyArticles&&!e.hasNoMarkArticles?t("div",{staticClass:"articles-empty"},[t("div",{staticClass:"articles-empty-content c-text c-text--m"},[e._v(" お探しの条件に合う記事がありません ")])]):e._e(),e._l(e.userMarkArticles,function(a){return t("div",{key:a.id,staticClass:"o-article-card",on:{click:function(n){return e.clickArticle(n,a)}}},[t("AdpDocumentCard",{attrs:{isSelected:e.articleSelected(a.id),enableHover:e.articleHovered(a.id),pageName:"user",adpDocument:a,feature:e.feature,themeId:e.themeId(a),showThemeTag:!0,showComment:!1,isRead:a.is_read}})],1)}),t("div",{staticClass:"spacing-24"}),e.hasNoMarkArticles?t("div",{staticClass:"o-no-user-marks"},[t("div",{staticClass:"o-description c-text c-text--m"},[e._v(" 該当する記事はありませんでした。 ")]),t("img",{attrs:{src:Wt}})]):e._e()],2),t("div",{staticClass:"spacing-16"}),t("div",{ref:"rightColumn",staticClass:"content-right"},[t("div",{ref:"rightContent",staticClass:"content-right-body"},[e.selectedArticle?t("AdpDocumentInfo",{staticClass:"article-info",attrs:{adpDocument:e.selectedArticle,tagList:e.articleTags,editable:e.isMyProfile},on:{"article-info-updated":e.updateArticle}}):t("AdpDocumentInfoDefault")],1)])])])]],2)],1)},vx=[],fx=T(_x,px,vx,!1,null,"512bb15e",null,null);const gx=fx.exports,hx=D({props:{userId:{type:Number}},components:{Header:Se,Content:Ue,AdpDocumentCard:Re,SwrScrollingPagination:wt},methods:{mypageAccessScope:ms},setup(s){const e=se(),t=fe(),a=Te(),{data:n}=xe(),{data:r}=Pe(),o=l(()=>{var h;return((h=n.value)==null?void 0:h.action_counts.domestic.viewed_articles)??0}),i=l(()=>{var h;return((h=n.value)==null?void 0:h.action_counts.foreign.viewed_articles)??0}),u=l(()=>o.value+i.value),c=l(()=>is(n.value)),p=l(()=>{var h,v;return n.value&&((h=r.value)!=null&&h.groups)?ms(n.value,(v=r.value)==null?void 0:v.groups):""});Z(()=>s.userId,()=>{qt(s.userId,e,a)}),ne(()=>{qt(s.userId,e,a),t.$on("article-updated",_)}),Be(()=>{t.$off("article-updated",_)});const m=(h,v)=>h.id===v,d=(h,v)=>(h.forEach(f=>{f.id===v.id&&(f.article_exclusion_id=v.article_exclusion_id)}),h),_=h=>{t.$emit("pagination-items-update",v=>m(v,h.id),v=>d(v,h))};return{userInfo:n,accessScope:p,pageLimit:10,articleViewCount:u,tabs:c,paginationFunc:(h,v)=>Xc(h,v),dataAccessor:h=>h==null?void 0:h.viewed_articles}}});var yx=function(){var e=this,t=e._self._c;return e._self._setupProxy,e.userInfo?t("div",{staticClass:"o-user-views"},[t("Header",{attrs:{title:e.userInfo.user_name,detail:`${e.userInfo.email} ${e.accessScope}`,avatarImageUrl:e.userInfo.image_url,tabs:e.tabs,settingsLink:{name:"userSettings"}}}),t("Content",[t("div",[t("div",{staticClass:"o-caption c-title c-title--m"},[e._v(" 閲覧 "),t("span",{staticClass:"o-count c-text c-text--s"},[e._v("・"+e._s(e.articleViewCount)+" 件")])]),t("div",{staticClass:"spacing-16"}),t("SwrScrollingPagination",{attrs:{pageLimit:e.pageLimit,paginationFunc:e.paginationFunc,dataAccessor:e.dataAccessor},scopedSlots:e._u([{key:"default",fn:function({items:a,loaded:n}){return[n&&e.articleViewCount>0?t("div",{staticClass:"o-viewed-articles"},e._l(a,function(r){return t("AdpDocumentCard",{key:r.id,staticClass:"o-article",attrs:{adpDocument:r,showComment:!1,articleExclusionId:r.article_exclusion_id,pageName:"user",feature:"my_views"}})}),1):e._e(),n&&e.articleViewCount===0?t("div",{staticClass:"o-no-user-views"},[t("div",{staticClass:"o-description c-text c-text--m"},[e._v(" 該当する記事はありませんでした。 ")]),t("img",{attrs:{src:Wt}})]):e._e()]}}],null,!1,3902178992)})],1)])],1):e._e()},Cx=[],bx=T(hx,yx,Cx,!1,null,"29e7def6",null,null);const Ax=bx.exports,kx=D({components:{Snackbar:Ea},props:{},methods:{integrateWithIntercom:cs},setup(){const{data:s}=xe(),{data:e}=nt(),{data:t}=et(),{data:a}=bt(),n=l(()=>{var v;return(v=a.value)==null?void 0:v.management_contracts}),r=l(()=>{var v;return(((v=n.value)==null?void 0:v.length)??0)>0}),o=ie();ne(()=>{Mt()});const i=Z([s,t,e],([v,f,C])=>{if(!v||!f||!C)return;const y=C.themes.filter(A=>A.is_favorite);cs(v,f,y),i()},{immediate:!0}),u=l(()=>[{id:"home",name:"ホーム",icon:"home",pathPrefix:["team","activity-download"],subitems:[{id:"team-status",name:"全体の利用状況",routeName:"dashboardTeamStatus",disabled:!r.value},{id:"team-activity-download",name:"アクション履歴",routeName:"dashboardTeamActivityDownload"}]},{id:"members",name:"メンバー",icon:"user",pathPrefix:["members"],subitems:[{id:"member-status",name:"メンバーの利用状況",routeName:"dashboardMemberList",disabled:!r.value}]},{id:"groups",name:"組織・グループ",icon:"users",pathPrefix:["groups","org_departments"],subitems:[{id:"group-status",name:"グループの利用状況",routeName:"dashboardGroupList"},{id:"org-department-status",name:"組織の利用状況",routeName:"dashboardOrgDepartmentList"}]}]),c=v=>{let f=!1;return v.some(C=>(f=o.path.startsWith(`/dashboard/${C}`),f)),f},p=l(()=>o.matched[o.matched.length-1].components.header),m=g(!0),d=()=>{_.value&&(m.value=!1),N.setLeftReportMenuIsExpanded(!_.value),_.value=!_.value};let _=g(!0);_.value=N.getLeftReportMenuIsExpanded();const h=l(()=>_.value||m.value);return Mn("menuState",{isMenuVisible:h}),{menuItems:u,hasActiveSubitem:c,isHovering:m,toggleIsFolded:d,hasHeader:p,isMenuVisible:h,isExpanded:_}}});var xx=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"dashboard"},[t("nav",{class:{folded:!e.isMenuVisible,hovering:e.isHovering},on:{mouseenter:()=>e.isHovering=!0,mouseleave:()=>e.isHovering=!1}},[t("div",{staticClass:"title"},[t("sm-icons",[e._v("anews-logo")]),e.isMenuVisible?t("span",{staticClass:"c-title c-title--l"},[e._v("Report")]):e._e()],1),t("ul",{staticClass:"menu-items"},[e._l(e.menuItems,function(a){return t("li",{key:a.id},[t("span",{class:{"menu-item":!0,"router-link-active":e.hasActiveSubitem(a.pathPrefix)}},[t("sm-icons",[e._v(e._s(a.icon))]),e.isMenuVisible?t("span",{staticClass:"c-title c-title--m"},[e._v(e._s(a.name))]):e._e()],1),e.isMenuVisible?t("ul",{staticClass:"submenu-items"},e._l(a.subitems,function(n){return t("li",{key:n.id},[t("router-link",{staticClass:"submenu-item c-text c-text--m",class:{"submenu-disabled":n.disabled},attrs:{to:{name:n.routeName}}},[e._v(" "+e._s(n.name)+" ")])],1)}),0):e._e()])}),t("li",[t("div",{directives:[{name:"tooltip",rawName:"v-tooltip.bottom",value:{content:e.isExpanded?"折りたたむ":"開いたままにする",offset:10,autoHide:!1},expression:`{
              content: !isExpanded ? '開いたままにする' : '折りたたむ',
              offset: 10,
              autoHide: false
            }`,modifiers:{bottom:!0}}],key:String(e.isExpanded),staticClass:"left-menu-arrow c-text c-text--s",class:{"visible-menu":e.isMenuVisible},on:{click:e.toggleIsFolded}},[t("sm-icons",{directives:[{name:"show",rawName:"v-show",value:e.isExpanded,expression:"isExpanded"}],staticClass:"small"},[e._v("chevron-left")]),t("sm-icons",{directives:[{name:"show",rawName:"v-show",value:!e.isExpanded,expression:"!isExpanded"}],staticClass:"small"},[e._v("chevron-right")])],1)])],2)]),t("main",{staticClass:"main"},[t("Snackbar"),e.hasHeader?t("div",{staticClass:"header"},[t("router-view",{attrs:{name:"header"}})],1):e._e(),t("div",{staticClass:"content"},[t("router-view")],1)],1)])},wx=[],Ex=T(kx,xx,wx,!1,null,"9d3d1f8e",null,null);const Fx=Ex.exports,Tx=D({props:{name:{type:String,required:!0},routeName:{type:String}},setup(s){const e=ie();return{route:l(()=>({name:s.routeName,query:e.query}))}}});var Dx=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("router-link",{staticClass:"dashboard-tab c-text c-text--m",attrs:{to:e.route}},[e._v(" "+e._s(e.name)+" ")])},Bx=[],Sx=T(Tx,Dx,Bx,!1,null,"48d4ec23",null,null);const Ix=Sx.exports,Mx=D({components:{Tab:Ix},setup(){const s=ie(),e=s.meta.type;let t="",a="",n="",r,o="";if(e==="dashboard_group"){const{data:u}=Pe();t=l(()=>{var c,p;return((p=(((c=u.value)==null?void 0:c.groups)??[]).find(m=>m.id===Number(s.params.groupId)))==null?void 0:p.name)??""}),a="dashboardGroupStatus",n="dashboardGroupMember",r="groupActivity",o="dashboardGroupList"}else if(e==="dashboard_org_department")t=String(s.query.orgDepartment),a="dashboardOrgDepartmentStatus",n="dashboardOrgDepartmentMember",o="dashboardOrgDepartmentList";else throw Error(`unknown header type: ${e}`);return{title:t,tabs:[{id:"status",name:"概況",routeName:a},{id:"members",name:"メンバー",routeName:n}],headerLinkTo:r,backRouteName:o}}});var $x=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"header__content"},[t("div",{staticClass:"header__title"},[t("router-link",{attrs:{to:{name:e.backRouteName}}},[t("sm-icons",{staticClass:"small"},[e._v("chevron-left")])],1),t("div",{staticClass:"spacing-08"}),t("div",{staticClass:"c-title c-title-l"},[e._v(" "+e._s(e.title)+" ")]),t("div",{staticClass:"spacing-08"}),e.headerLinkTo?t("router-link",{attrs:{to:{name:e.headerLinkTo},target:"_blank"}},[t("sm-icons",{staticClass:"small"},[e._v("external-link")])],1):e._e()],1),t("div",{staticClass:"header__border"}),e._l(e.tabs,function(a){return t("Tab",{key:a.id,attrs:{name:a.name,routeName:a.routeName}})})],2)},Px=[],Nx=T(Mx,$x,Px,!1,null,"cf76e511",null,null);const es=Nx.exports,Lx=D({props:{userId:{type:Number,required:!0}},components:{Avatar:at},setup(s){const{userId:e}=$e(s),{data:t}=xe(e);return{userInfo:t}}});var Ux=function(){var e=this,t=e._self._c;return e._self._setupProxy,e.userInfo?t("div",{staticClass:"member-header"},[t("router-link",{staticClass:"back-button dashboard-button--borderless",attrs:{to:{name:"dashboardMemberList"}}},[t("sm-icons",{staticClass:"small"},[e._v("chevron-left")])],1),t("Avatar",{staticClass:"user-avatar",attrs:{imageUrl:e.userInfo.image_url,size:"m"}}),t("div",{staticClass:"user-info"},[t("div",{staticClass:"username"},[t("span",{staticClass:"c-title c-title--m"},[e._v(e._s(e.userInfo.user_name))])]),t("div",{staticClass:"c-text c-text--xs dashboard-text--secondary"},[e._v(" "+e._s(e.userInfo.email)+" ")])])],1):e._e()},Rx=[],Ox=T(Lx,Ux,Rx,!1,null,"c2a627d0",null,null);const Gx=Ox.exports,xn=[{format:"excel",extension:"xlsx",label:"Excel"},{format:"csv",extension:"csv",label:"CSV"}],qx=D({components:{RadioLabel:ws},props:{fileName:{type:String,required:!0},columns:{type:Array,required:!0},data:{type:Array,required:!0}},setup(s){const{fileName:e,columns:t,data:a}=$e(s),n=g(xn[0]),r=g(!1),o=g(),i=async()=>{const c=new $n.Workbook;c.creator="Stockmark";const p=c.addWorksheet(e.value,{pageSetup:{fitToPage:!0},views:[{state:"frozen",ySplit:1}]}),m=[];if(t.value.forEach((h,v)=>{p.getCell(1,v+1).font={bold:!0},m.push({key:h.name,header:h.name,width:13})}),p.columns=m,a.value.length>0){const h=a.value.map(v=>t.value.map(f=>v[f.id]!==void 0?v[f.id]:""));p.addRows(h)}const d=n.value.format==="excel"?await c.xlsx.writeBuffer():await c.csv.writeBuffer(),_=document.createElement("a");_.href=window.URL.createObjectURL(new Blob([d])),_.setAttribute("download",`${e.value}.${n.value.extension}`),document.body.appendChild(_),_.click(),_.remove()},u=c=>{const p=(c==null?void 0:c.composedPath())??[];o.value!==void 0&&(!c||!p.includes(o.value))&&(r.value=!1)};return ne(()=>{document.addEventListener("click",u)}),Be(()=>{document.removeEventListener("click",u)}),{downloadFormat:n,fileFormats:xn,isOpenPanel:r,createReport:i,openPanelBtnRef:o}}});var Hx=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"dw-wrapper"},[t("button",{ref:"openPanelBtnRef",staticClass:"dw-open-panel-btn dashboard-button",on:{click:function(a){e.isOpenPanel=!e.isOpenPanel}}},[t("sm-icons",{staticClass:"c-btn__icon small"},[e._v("download")]),t("div",{staticClass:"c-btn__text"},[e._v("ダウンロード")]),t("sm-icons",{staticClass:"c-selectBox__arrow small"},[e._v("angle-down")])],1),e.isOpenPanel?t("div",{staticClass:"dw-panel",on:{click:function(a){return a.stopPropagation(),(()=>{}).apply(null,arguments)}}},[t("div",{staticClass:"dw-radio-area"},e._l(e.fileFormats,function(a){return t("RadioLabel",{key:a.format,staticClass:"dw-radio-item",attrs:{label:a.label,value:e.downloadFormat.format===a.format},on:{toggleValue:function(n){e.downloadFormat=a}}})}),1),t("div",{staticClass:"dw-btn-area"},[t("button",{staticClass:"c-btn c-btn--small c-btn--AnewsPrimary dw-download-btn",on:{click:e.createReport}},[e._v(" ダウンロード ")])])]):e._e()])},Vx=[],jx=T(qx,Hx,Vx,!1,null,"ec3cab1a",null,null);const gt=jx.exports,Lt=(s,e)=>Math.round(s/e*1e3)/10,Kx=D({components:{},props:{columns:{type:Array,required:!0},data:{type:Array,required:!0}},setup(s){const{data:e}=$e(s),t=(u,c)=>{const p=c==="asc"?1:-1,m=[...e.value].sort((d,_)=>u=="group"?p*d.group.name.localeCompare(_.group.name):typeof d[u]=="string"&&typeof _[u]=="string"?p*d[u].localeCompare(_[u]):p*(d[u]-_[u]));if(u=="group"){const d=[...m.filter(h=>h.group.group_type==="all_user_group"),...m.filter(h=>h.group.group_type!=="all_user_group")],_=[...m.filter(h=>h.group.group_type!=="all_user_group"),...m.filter(h=>h.group.group_type==="all_user_group")];return c==="asc"?d:_}else return m},a=g(s.columns[0].id),n=g("asc"),r=u=>{u===a.value?n.value=n.value==="asc"?"desc":"asc":(a.value=u,n.value="asc")};return{sortedData:l(()=>t(a.value,n.value)),sortColumn:a,sortOrder:n,setSortColumn:r,calculatePercentage:(u,c)=>Lt(u,c),rowValueAsNumber:(u,c)=>u[c]}}});var Yx=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"data-table"},[t("div",{staticClass:"dashboard-card"},[t("table",{staticClass:"table"},[t("thead",[t("tr",[e._l(e.columns,function(a,n){return[t("th",{key:`${a.id}`,staticClass:"c-text c-text--m",class:`${a.type}`,on:{click:function(r){return e.setSortColumn(a.id)}}},[e._v(" "+e._s(a.name)+" "),e.sortColumn===a.id&&e.sortOrder=="asc"?t("span",{staticClass:"sort-icon"},[e._v("↑")]):e.sortColumn===a.id&&e.sortOrder=="desc"?t("span",{staticClass:"sort-icon"},[e._v("↓")]):t("span",{staticClass:"sort-icon no-sort"})]),n>0&&n<e.columns.length-1?t("th",{key:`${a.id}-gap`,staticClass:"gap"}):e._e()]})],2)]),t("tbody",e._l(e.sortedData,function(a,n){return t("tr",{key:`group-table-row-${n}`},[e._l(e.columns,function(r,o){return[t("td",{key:`call-${n}-${o}`,class:`c-text c-text--m ${typeof a[r.id]}`},[r.id==="group"?t("router-link",{staticClass:"group",attrs:{to:{name:"dashboardGroupStatus",params:{groupId:a.group.id}}}},[e._v(" "+e._s(a.group.name)+" ")]):t("span",{staticClass:"c-text c-text--m"},[e._v(e._s(a[r.id]))]),r.hasPercentage?t("span",{staticClass:"percentage c-text c-text--s"},[e._v("("+e._s(e.calculatePercentage(e.rowValueAsNumber(a,r.id),e.rowValueAsNumber(a,"total_user_count")))+"%) ")]):e._e()],1),o>0&&o<e.columns.length-1?t("td",{key:`${r.id}-gap`,staticClass:"gap"}):e._e()]})],2)}),0)])])])},Qx=[],Wx=T(Kx,Yx,Qx,!1,null,"34e79f26",null,null);const zx=Wx.exports,it=(s,e,t)=>Ne.stringify({from:oe(s.value).format("YYYY-MM-DD"),to:oe(e.value).format("YYYY-MM-DD"),...t&&{contract_ids:t.value}},{arrayFormat:"brackets"}),ko=s=>Ne.stringify({date:oe(s.value).format("YYYY-MM-DD")}),Jx=(s,e,t)=>{const a=N.getTeamId();return he(()=>`/dashboard/teams/${a}/action_summary?${it(s,e,t)}`)},Xx=(s,e,t)=>{const a=N.getTeamId();return he(()=>`/dashboard/teams/${a}?${it(s,e,t)}`)},Zx=(s,e)=>{const t=N.getTeamId();return he(()=>`/dashboard/teams/${t}/users?${it(s,e)}`)},ew=s=>he(()=>`/dashboard/users/${s.value}/summary`),tw=(s,e,t)=>he(()=>`/dashboard/users/${s.value}/collaboration_data?${it(e,t)}`),sw=(s,e,t)=>he(()=>`/dashboard/users/${s.value}?${it(e,t)}`),aw=s=>he(()=>`/dashboard/groups?${ko(s)}`),nw=(s,e,t)=>he(()=>`/dashboard/groups/${s}?${it(e,t)}`),rw=(s,e,t)=>he(()=>`/dashboard/groups/${s}/action_summary?${it(e,t)}`),ow=(s,e,t)=>he(()=>`/dashboard/groups/${s}/users?${it(e,t)}`),iw=s=>{const e=N.getTeamId();return he(()=>`/dashboard/teams/${e}/org_departments?${ko(s)}`)},uw=(s,e,t)=>{const a=N.getTeamId();return he(()=>`/dashboard/teams/${a}/org_departments/action_summary?org_department=${s}&${it(e,t)}`)},cw=(s,e,t)=>{const a=N.getTeamId();return he(()=>`/dashboard/teams/${a}/org_departments/activity?org_department=${s}&${it(e,t)}`)},lw=(s,e,t)=>{const a=N.getTeamId();return he(()=>`/dashboard/teams/${a}/org_departments/users?org_department=${s}&${it(e,t)}`)},dw=D({components:{Datepicker:rt,GroupListTable:zx,DownloadButton:gt},props:{},setup(){const s=g(oe().startOf("day").subtract(1,"day").toDate()),e=u=>{s.value=u},{data:t}=Pe(),{data:a}=aw(s),n=[{id:"group",name:"グループ",hasPercentage:!1,type:"string"},{id:"total_user_count",name:"メンバー",hasPercentage:!1,type:"number"},{id:"heavy_count",name:"ヘビー",hasPercentage:!0,type:"number"},{id:"active_count",name:"アクティブ",hasPercentage:!0,type:"number"},{id:"light_count",name:"ライト",hasPercentage:!0,type:"number"},{id:"dormant_count",name:"休眠",hasPercentage:!0,type:"number"},{id:"inactive_count",name:"未使用",hasPercentage:!0,type:"number"}],r=n.map(u=>u.id==="group"?{...u,id:"groupName"}:u),o=l(()=>{var p;const u=((p=t.value)==null?void 0:p.groups)??[],c=a.value??[];return u.length>0&&c.length>0?c.map(m=>{const d=u.find(_=>_.id===m.group_id);if(d)return{...m,group:d}}).filter(m=>m!==void 0):[]}),i=l(()=>o.value.map(u=>({...u,groupName:u.group.name})));return{updateDate:e,data:o,groups:t,columns:n,dataForDownloadBtn:i,columnsForDownloadBtn:r,featureFlags:st}}});var mw=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"member-status"},[t("div",{staticClass:"header"},[e._m(0),t("div",{staticClass:"filters"},[t("Datepicker",{staticClass:"datepicker",attrs:{isMultipleSelect:!1},on:{"dates-changed":e.updateDate}}),t("DownloadButton",{attrs:{fileName:"グループ",columns:e.columnsForDownloadBtn,data:e.dataForDownloadBtn}})],1)]),t("GroupListTable",{attrs:{columns:e.columns,data:e.data}})],1)},_w=[function(){var s=this,e=s._self._c;return s._self._setupProxy,e("div",{staticClass:"title"},[e("span",{staticClass:"c-title c-title--m"},[s._v("利用状況")])])}],pw=T(dw,mw,_w,!1,null,"7dedadce",null,null);const vw=pw.exports,Sa=(s,e)=>{const t=l(()=>Math.ceil(s.value.length/e.value)),a=g(1);Z(()=>t.value,()=>a.value=1);const n=()=>{a.value>1&&a.value--},r=()=>{a.value<t.value&&a.value++},o=l(()=>{const u=(a.value-1)*e.value,c=Math.min(s.value.length,(a.value-1)*e.value+e.value);return s.value.slice(u,c)}),i=l(()=>{const u=(a.value-1)*e.value+1,c=Math.min(s.value.length,a.value*e.value);return`${u}-${c}/${s.value.length}件`});return{totalPages:t,currentPage:a,previousPage:n,nextPage:r,visibleData:o,pageNumberIndicator:i}},fw=D({components:{Avatar:at},props:{columns:{type:Array,required:!0},data:{type:Array,required:!0},pageSize:{type:Number,default:20},isLoading:{type:Boolean}},setup(s){const{data:e,pageSize:t}=$e(s),a=l(()=>e.value.map(v=>({...v,has_personal_feed:v.has_personal_feed?"あり":"なし",has_mobile_usage:v.has_mobile_usage?"あり":"なし",has_mobile_usage_total:v.has_mobile_usage_total?"あり":"なし"}))),n=(v,f)=>{const C=f==="asc"?1:-1;return[...a.value].sort((y,A)=>{if(v=="user")return C*y.user.user_name.localeCompare(A.user.user_name);if(v=="activity_status")return C*(Object.values(Oe).indexOf(y.activity_status)-Object.values(Oe).indexOf(A.activity_status));if(["created_date","last_accessed_date","last_used_date"].includes(v)){const k=y[v]===""?0:new Date(y[v]).getTime(),S=A[v]===""?0:new Date(A[v]).getTime();return C*(k-S)}else return typeof y[v]=="string"&&typeof A[v]=="string"?C*y[v].localeCompare(A[v]):C*(y[v]-A[v])})},r=g(s.columns[0].id),o=g("asc"),i=v=>{v===r.value?o.value=o.value==="asc"?"desc":"asc":(r.value=v,o.value="asc")},u=l(()=>n(r.value,o.value)),{totalPages:c,currentPage:p,previousPage:m,nextPage:d,visibleData:_,pageNumberIndicator:h}=Sa(u,t);return{currentPage:p,totalPages:c,previousPage:m,nextPage:d,pageNumberIndicator:h,visibleData:_,sortColumn:r,sortOrder:o,setSortColumn:i}}});var gw=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"data-table"},[t("div",{staticClass:"dashboard-card"},[t("table",{staticClass:"table"},[t("thead",[t("tr",e._l(e.columns,function(a){return t("th",{key:`${a.id}`,staticClass:"c-text c-text--s",on:{click:function(n){return e.setSortColumn(a.id)}}},[e._v(" "+e._s(a.name)+" "),e.sortColumn===a.id&&e.sortOrder=="asc"?t("span",{staticClass:"sort-icon"},[e._v("↑")]):e.sortColumn===a.id&&e.sortOrder=="desc"?t("span",{staticClass:"sort-icon"},[e._v("↓")]):t("span",{staticClass:"sort-icon no-sort"})])}),0)]),t("tbody",e._l(e.visibleData,function(a,n){return t("tr",{key:`${e.currentPage}-${n}`},e._l(e.columns,function(r,o){return t("td",{key:`call-${n}-${o}`,class:`c-text c-text--m ${typeof a[r.id]}`},[r.id==="user"?t("router-link",{staticClass:"user-info",attrs:{to:{name:"dashboardMemberDetail",params:{userId:a.user.id}}}},[t("Avatar",{attrs:{imageUrl:a.user.image_url,size:"xs"}}),t("div",{staticClass:"user-detail"},[t("span",{staticClass:"user-name"},[e._v(e._s(a.user.user_name)+" ")]),t("span",{staticClass:"user-email c-text c-text--xs"},[e._v(e._s(a.user.email))])])],1):[e._v(e._s(a[r.id]))]],2)}),0)}),0)]),e.isLoading?t("div",{staticClass:"loading-wrapper"},[t("sm-loading",{staticClass:"loading-indicator"})],1):e._e()]),t("div",{staticClass:"controls"},[t("span",{staticClass:"c-text c-text--s"},[e._v(e._s(e.pageNumberIndicator))]),t("button",{class:{"page-button dashboard-button":!0,disabled:e.currentPage===1},on:{click:e.previousPage}},[t("sm-icons",{staticClass:"small"},[e._v("chevron-left")])],1),t("button",{class:{"page-button dashboard-button":!0,disabled:e.currentPage===e.totalPages},on:{click:e.nextPage}},[t("sm-icons",{staticClass:"small"},[e._v("chevron-right")])],1)])])},hw=[],yw=T(fw,gw,hw,!1,null,"f94666d5",null,null);const Ia=yw.exports,Cw=D({setup(s,e){const t=g("");return{query:t,search:()=>e.emit("search",t.value)}}});var bw=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("form",{staticClass:"m-keyword-search-bar",on:{submit:function(a){return a.preventDefault(),e.search.apply(null,arguments)}}},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.query,expression:"query"}],staticClass:"c-textInput",attrs:{type:"text",placeholder:"検索ワードを入力してください"},domProps:{value:e.query},on:{input:function(a){a.target.composing||(e.query=a.target.value)}}}),t("button",{staticClass:"m-search-button"},[t("sm-icons",[e._v("search-gray600")])],1)])},Aw=[],kw=T(Cw,bw,Aw,!1,null,"0872d95a",null,null);const Ma=kw.exports,mt={admin:"管理者",group_admin:"グループ管理者",editor:"編集者",viewer:"閲覧者"},xw=D({components:{Datepicker:rt,MemberListTable:Ia,DownloadButton:gt,Filters:fs,SearchInput:Ma},props:{},setup(){const s=g(""),e=ie(),t=g(oe().startOf("day").subtract(30,"day").toDate()),a=g(oe().startOf("day").subtract(1,"day").toDate()),n=({start:w,end:x})=>{t.value=w,a.value=x},{data:r,state:o}=jt(),i=Number(e.params.groupId),{data:u,state:c}=ow(i,t,a),p=l(()=>o.value===be.PENDING||o.value===be.VALIDATING||c.value===be.PENDING||c.value===be.VALIDATING),m=[{id:"user",name:"メンバー"},{id:"activity_status",name:"属性"},{id:"org_department",name:"組織"},{id:"groups",name:"グループ"},{id:"login_in_days_count",name:"ログイン日数"},{id:"article_view_count",name:"閲覧（Anews）"},{id:"article_view_via_mail_count",name:"閲覧（メール）"},{id:"article_view_via_ms_teams_count",name:"閲覧（MS Teams）"},{id:"mark_count",name:"マーク"},{id:"group_mark_count",name:"グループマーク"},{id:"comment_count",name:"コメント"},{id:"comment_reply_count",name:"返信コメント"},{id:"tag_article_count",name:"タグ"},{id:"memo_article_count",name:"メモ"},{id:"reaction_comment_count",name:"リアクション"},{id:"days_from_first_access_count",name:"利用経過日数"}],d=l(()=>{var B;const w=((B=r.value)==null?void 0:B.users)??[],x=u.value??[];return w.length>0&&x.length>0?x.map($=>{const P=w.find(M=>M.id===$.user_id);if(P)return{...$,user:P,org_department:P.org_department,groups:P.groups.length,contract_name:"",activity_status:Oe[$.activity_status],role:mt[P.role],created_date:De(P.created_at),last_accessed_date:De($.last_accessed_date),last_used_date:De($.last_used_date)}}).filter($=>$!==void 0).sort(($,P)=>$.user.user_name.localeCompare(P.user.user_name)):[]}),_=w=>{const x=w.reduce((B,$)=>(B[$]=(B[$]??0)+1,B),{});return Object.entries(x).map(([B,$])=>({name:B,count:$}))},h=l(()=>_(d.value.map(w=>w.activity_status))),v=l(()=>_(d.value.map(w=>w.org_department))),f=l(()=>_(d.value.map(w=>w.user.groups).flat())),C=l(()=>_(d.value.map(w=>mt[w.user.role]))),y=g([{label:"権限",options:C.value,selectedOptions:[]},{label:"属性",options:h.value,selectedOptions:[]},{label:"組織",options:v.value,selectedOptions:[]}]);Z(()=>[C.value,h.value,v.value],()=>{y.value[0].options=C.value,y.value[1].options=h.value,y.value[2].options=v.value});const A=()=>{k.roles=y.value[0].selectedOptions,k.activityStatus=y.value[1].selectedOptions,k.orgDepartments=y.value[2].selectedOptions},k=Fe({activityStatus:[],orgDepartments:[],roles:[]}),S=l(()=>d.value.filter(w=>{let x=!0;return k.activityStatus.length>0&&(x=x&&k.activityStatus.includes(w.activity_status)),k.orgDepartments.length>0&&(x=x&&k.orgDepartments.includes(w.org_department)),k.roles.length>0&&(x=x&&k.roles.some(B=>mt[w.user.role]==B)),s.value.length>0&&(x=x&&(w.user.user_name.indexOf(s.value)>-1||w.user.email.indexOf(s.value)>-1)),x})),b=[...m.slice(0,1),{id:"email",name:"メールアドレス"},...m.slice(1)],U=l(()=>S.value.map(w=>({...w,user:w.user.user_name,email:w.user.email})));return{startDate:t,endDate:a,updateDates:n,activityStatusOptions:h,orgDepartments:v,groups:f,filters:k,columns:m,filteredData:S,columnsForDownloadBtn:b,dataForDownloadBtn:U,searchFilters:y,applyFilter:A,search:w=>s.value=w,isLoadingTableData:p}}});var ww=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"member-status"},[t("div",{staticClass:"header"},[t("div",{staticClass:"header-search"},[t("div",{staticClass:"title c-title c-title--m"},[e._v("メンバー")]),t("div",{staticClass:"spacing-32"}),t("div",{staticClass:"spacing-32"}),t("search-input",{staticClass:"search-input",on:{search:e.search}})],1),t("div",{staticClass:"spacing-16"}),t("div",{staticClass:"filters"},[t("Filters",{on:{input:e.applyFilter},model:{value:e.searchFilters,callback:function(a){e.searchFilters=a},expression:"searchFilters"}}),t("Datepicker",{staticClass:"datepicker",attrs:{start:e.startDate,end:e.endDate},on:{"dates-changed":e.updateDates}}),t("DownloadButton",{attrs:{fileName:"メンバー",columns:e.columnsForDownloadBtn,data:e.dataForDownloadBtn}})],1)]),t("MemberListTable",{attrs:{columns:e.columns,data:e.filteredData,isLoading:e.isLoadingTableData}})],1)},Ew=[],Fw=T(xw,ww,Ew,!1,null,"5b006a56",null,null);const Tw=Fw.exports,Dw=D({props:{data:{type:Array,required:!0}},setup(){return{format:e=>e>1e3?`${Math.round(e/100)/10}k`:e.toString()}}});var Bw=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"summary"},e._l(e.data,function(a){return t("div",{key:a.name,staticClass:"item"},[t("span",{staticClass:"value c-title c-title--l"},[e._v(e._s(e.format(a.value)))]),t("span",{staticClass:"name c-text c-text--s"},[e._v(e._s(a.name))])])}),0)},Sw=[],Iw=T(Dw,Bw,Sw,!1,null,"5548d6ca",null,null);const Fs=Iw.exports,Mw=D({props:{chartFunction:{type:Function,required:!0},id:{type:String,required:!0},data:{type:Array,required:!0},options:{type:Object,required:!0},minWidth:{type:Number,required:!0},maxWidth:{type:Number,required:!0}},setup(s){const{chartFunction:e,minWidth:t,maxWidth:a}=s,{id:n,data:r,options:o}=$e(s),i=g(null),u=()=>{qe.nextTick(()=>{var m,d,_,h,v;(d=(m=i.value)==null?void 0:m.querySelector(`#${n.value} svg`))==null||d.remove(),(h=(_=i.value)==null?void 0:_.querySelector(`#${n.value} div.dashboard-chart-tooltip`))==null||h.remove();const p=Math.max(Math.min(((v=i.value)==null?void 0:v.clientWidth)??0,a),t);e(n.value,r.value,{...o.value,width:p})})};Z(()=>r.value,()=>u(),{deep:!0}),ne(()=>{u(),window.addEventListener("resize",u)}),Be(()=>{window.removeEventListener("resize",u)}),Sn(()=>{u()});const c=Bn("menuState");return Z(()=>c==null?void 0:c.isMenuVisible.value,()=>u()),{chartContainer:i}}});var $w=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{ref:"chartContainer",staticClass:"chart",attrs:{id:e.id}})},Pw=[],Nw=T(Mw,$w,Pw,!1,null,"4412f3fc",null,null);const xo=Nw.exports;function Lw(s,e,{name:t,value:a,total:n,width:r=200,height:o=300,innerRadius:i,colors:u=Ct}){i=i??Math.min(r,o)*.4;const c=Math.min(r,o)*.5,p=js(e,t),m=js(e,a),d=pi(p.length).filter(y=>!isNaN(m[y])),_=new Pn(p);u===void 0&&(u=vi[_.size]),u===void 0&&(u=fi(y=>gi(y*.8+.1),_.size));const h=Nn(_,u),v=hi().padAngle(0).sort(null).value(y=>m[y])(d),f=yi().innerRadius(i).outerRadius(c),C=sa(`#${s}`).append("svg").attr("width",r).attr("height",o).attr("style","max-width: 100%; height: auto; height: intrinsic;");C.append("g").attr("stroke","none").attr("stroke-width",0).attr("stroke-linejoin","round").attr("transform",`translate(${r/2}, ${o/2})`).selectAll("path").data(v).join("path").attr("fill",y=>h(p[y.data])).attr("d",f),Dr(s,C.selectAll("path"),y=>{const A=y.value,k=Lt(A,n);return`${p[y.index]}<br/>${A}（${k}%）`})}const Uw=D({components:{ResizingSvgContainer:xo},props:{labels:{type:Object,required:!0},data:{type:Object,required:!0},total:{type:Number,required:!0}},setup(s){const{labels:e,data:t,total:a}=$e(s),n=g(`donut-chart-${Math.floor(Math.random()*500)}`),r=l(()=>Object.keys(e.value).map(i=>({name:e.value[i],value:t.value[i]}))),o=(i,u)=>i[u];return{id:n,DonutChart:Lw,chartData:r,options:{name:i=>i.name,value:i=>i.value,total:t.value.total_user_count,height:240,names:r.value.map(i=>i.name),colors:Ct},colors:Ct,calculatePercentage:i=>Lt(i,a.value),getData:o}}});var Rw=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"chart"},[t("ResizingSvgContainer",{attrs:{id:e.id,chartFunction:e.DonutChart,data:e.chartData,options:e.options,minWidth:200,maxWidth:240}}),t("div",{staticClass:"labels"},e._l(Object.keys(e.labels),function(a,n){return t("div",{key:a,staticClass:"label"},[t("svg",{attrs:{width:"12",height:"12",viewBox:"0 0 100 100",xmlns:"http://www.w3.org/2000/svg"}},[t("circle",{attrs:{cx:"50",cy:"50",r:"50",fill:e.colors[n]}})]),t("span",{staticClass:"label-text c-text c-text--s"},[e._v(" "+e._s(e.labels[a])+" ")]),t("span",{staticClass:"c-title c-title--xm"},[e._v(" "+e._s(e.getData(e.data,a))+" "),t("span",{staticClass:"percentage c-text c-text--s"},[e._v(" ("+e._s(e.calculatePercentage(e.getData(e.data,a)))+"%) ")])])])}),0)],1)},Ow=[],Gw=T(Uw,Rw,Ow,!1,null,"c9a20805",null,null);const $a=Gw.exports;function qw(s,e,{x:t,totalKey:a,labels:n,width:r=600,height:o=400,marginTop:i=10,marginRight:u=0,marginBottom:c=40,marginLeft:p=40,yFormat:m="%",colors:d=Ct}){const _=js(e,t),h=new Pn(_),v=Object.keys(n),f=.3,C=60,y=Math.max(Math.round((r-(e.length+1)*(C+C*f))/2)-2,4),A=y,k=[p+y,r-u-A],S=[o-c,i],b=Fi,I=Ci().keys(v).order(bi).offset(Ai)(e).map(W=>W.map((j,K)=>({y1:j[0],y2:j[1],index:K,key:W.key}))),w=ki(I.flat().map(W=>[W.y1,W.y2]).flat()),x=xi(h,k).paddingInner(f),B=b(w,S),$=Nn(v,d),P=wi(x).tickPadding(6).tickSize(0);e.length>=14&&P.tickValues(_.filter((W,j)=>(j+(7-(_.length-1)%7))%7===0));const M=Ei(B).ticks(o/60,m).tickPadding(6).tickSize(0),O=sa(`#${s}`).append("svg").attr("height",o).attr("viewBox",[0,0,r,o]).attr("style","max-width: 100%; height: auto; height: intrinsic;");O.append("g").attr("transform",`translate(${p},0)`).attr("class","c-text c-text--s").call(M).call(W=>W.select(".domain").remove()).call(W=>W.selectAll(".tick line").clone().attr("x2",r-p-u).attr("stroke-opacity",.1)),O.append("g").selectAll("g").data(I).join("g").selectAll("rect").data(W=>W).join("rect").attr("fill",({key:W})=>$(W)).attr("x",({index:W})=>x(_[W])).attr("y",({y1:W,y2:j})=>Math.min(B(W),B(j))).attr("height",({y1:W,y2:j})=>Math.abs(B(W)-B(j))).attr("width",x.bandwidth()),Dr(s,O.selectAll("rect"),W=>{const j=e[W.index][W.key],K=Lt(j,e[W.index][a]);return`${_[W.index]}<br/>${n[W.key]}<br/>${j}（${K}%）`});const Y=O.append("g").attr("transform",`translate(0, ${B(0)})`).attr("class","c-text c-text--s").call(P);e.length>=12&&Y.selectAll("text").style("text-anchor","end").attr("dx","0").attr("dy",".5em").attr("transform","rotate(-25)"),Y.call(W=>W.select(".domain").remove())}const Hw=D({components:{ResizingSvgContainer:xo},props:{labels:{type:Object,required:!0},data:{type:Array,required:!0}},setup(s){const{labels:e,data:t}=$e(s),a=l(()=>`stacked-bar-chart-${t.value[0].date}-${t.value[t.value.length-1].date}`.replaceAll("/","-")),n=340;return{id:a,StackedBarChart:qw,chartData:t,height:n,options:{x:r=>r.date,totalKey:"total_user_count",labels:e.value,height:n,colors:Ct},colors:Ct}}});var Vw=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{ref:"chartContainer",staticClass:"chart"},[t("ResizingSvgContainer",{style:`height: ${e.height}px`,attrs:{id:e.id,chartFunction:e.StackedBarChart,data:e.chartData,options:e.options,minWidth:200,maxWidth:1e3}}),t("div",{staticClass:"labels"},e._l(Object.keys(e.labels),function(a,n){return t("div",{key:a,staticClass:"label"},[t("svg",{attrs:{width:"12",height:"12",viewBox:"0 0 100 100",xmlns:"http://www.w3.org/2000/svg"}},[t("circle",{attrs:{cx:"50",cy:"50",r:"50",fill:e.colors[n]}})]),t("span",{staticClass:"label-text c-text c-text--s"},[e._v(" "+e._s(e.labels[a])+" ")])])}),0)],1)},jw=[],Kw=T(Hw,Vw,jw,!1,null,"440df8cc",null,null);const Pa=Kw.exports,Yw=D({components:{DownloadButton:gt},props:{data:{type:Array,required:!0},pageSize:{type:Number,default:10}},setup(s){const{data:e,pageSize:t}=$e(s),a=[{id:"date",name:"日付",hasPercentage:!1},{id:"total_user_count",name:"メンバー",hasPercentage:!1},...Object.keys(Oe).map(_=>({id:`${_}_count`,name:Oe[_],hasPercentage:!0}))],n="total_user_count",r=l(()=>a.map(_=>_.hasPercentage?[_,{id:`${_.id}_pc`,name:`${_.name}率`}]:_).flat()),o=l(()=>e.value.map(_=>({..._,...Object.fromEntries(a.filter(h=>h.hasPercentage).map(h=>[`${h.id}_pc`,Lt(_[h.id],_[n])]))}))),{totalPages:i,currentPage:u,previousPage:c,nextPage:p,visibleData:m,pageNumberIndicator:d}=Sa(o,t);return{columns:a,currentPage:u,totalPages:i,previousPage:c,nextPage:p,pageNumberIndicator:d,visibleDataWithPercentages:m,columnsWithPercentages:r,dataWithPercentages:o,featureFlags:st}}});var Qw=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"data-table"},[t("div",{staticClass:"download-button-container"},[t("DownloadButton",{attrs:{fileName:"利用ユーザー推移",columns:e.columnsWithPercentages,data:e.dataWithPercentages}})],1),t("div",{staticClass:"dashboard-card"},[t("table",{staticClass:"table"},[t("thead",[t("tr",[e._l(e.columns,function(a,n){return[t("th",{key:`${a.id}`,staticClass:"c-text c-text--s"},[e._v(" "+e._s(a.name)+" ")]),n<e.columns.length-1?t("th",{key:`${a.id}-gap`,staticClass:"gap"}):e._e()]})],2)]),t("tbody",e._l(e.visibleDataWithPercentages,function(a,n){return t("tr",{key:`${e.currentPage}-${n}`},[e._l(e.columns,function(r,o){return[t("td",{key:`call-${n}-${o}`,class:`${typeof a[r.id]}`},[t("div",[t("span",{staticClass:"c-text c-text--m"},[e._v(e._s(a[r.id]))]),r.hasPercentage?t("span",{staticClass:"percentage c-text c-text--s"},[e._v("("+e._s(a[`${r.id}_pc`])+"%)")]):e._e()])]),o<e.columns.length-1?t("td",{key:`${r.id}-gap`,staticClass:"gap"}):e._e()]})],2)}),0)])]),t("div",{staticClass:"controls"},[t("span",{staticClass:"c-text c-text--s"},[e._v(e._s(e.pageNumberIndicator))]),t("button",{class:{"page-button dashboard-button":!0,disabled:e.currentPage===1},on:{click:e.previousPage}},[t("sm-icons",{staticClass:"small"},[e._v("chevron-left")])],1),t("button",{class:{"page-button dashboard-button":!0,disabled:e.currentPage===e.totalPages},on:{click:e.nextPage}},[t("sm-icons",{staticClass:"small"},[e._v("chevron-right")])],1)])])},Ww=[],zw=T(Yw,Qw,Ww,!1,null,"7c67edf1",null,null);const Na=zw.exports,Jw=D({components:{ActionSummary:Fs,Datepicker:rt,DonutChart:$a,StackedBarChart:Pa,TeamUserActivityStatusTable:Na},props:{},setup(){const s=ie(),e=g(oe().startOf("day").subtract(30,"day").toDate()),t=g(oe().startOf("day").subtract(1,"day").toDate()),a=({start:p,end:m})=>{e.value=p,t.value=m},n=Number(s.params.groupId),{data:r}=rw(n,e,t),o=l(()=>{if(!r.value)return;const p=r.value,m=Object.values(p).reduce((d,_)=>d+=_,0);return[{name:"閲覧",value:p.article_view_count},{name:"マーク",value:p.mark_count},{name:"コメント",value:p.comment_count},{name:"グループマーク",value:p.group_mark_count},{name:"アクション総数",value:m}]}),{data:i}=nw(n,e,t),u=l(()=>(i.value??[]).map(p=>(p.date=De(p.date),p))),c=Object.keys(Oe).reduce((p,m)=>({...p,[`${m}_count`]:Oe[m]}),{});return{startDate:e,endDate:t,updateDates:a,actionSummaryData:o,chartLabels:c,tableData:u}}});var Xw=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"team-status"},[e._m(0),t("Datepicker",{staticClass:"datepicker",attrs:{start:e.startDate,end:e.endDate},on:{"dates-changed":e.updateDates}}),e.actionSummaryData?t("ActionSummary",{staticClass:"summary dashboard-card",attrs:{data:e.actionSummaryData}}):e._e(),e.tableData.length>0?t("DonutChart",{staticClass:"activity-status dashboard-card",attrs:{labels:e.chartLabels,data:e.tableData[e.tableData.length-1],total:e.tableData[e.tableData.length-1].total_user_count}}):e._e(),e.tableData.length>0?t("StackedBarChart",{staticClass:"monthly-activity-status dashboard-card",attrs:{labels:e.chartLabels,data:e.tableData}}):e._e(),e.tableData.length>0?t("TeamUserActivityStatusTable",{staticClass:"activity-table",attrs:{data:[...e.tableData].reverse()}}):e._e()],1)},Zw=[function(){var s=this,e=s._self._c;return s._self._setupProxy,e("div",{staticClass:"title"},[e("span",{staticClass:"c-title c-title--m"},[s._v("利用状況")])])}],eE=T(Jw,Xw,Zw,!1,null,"04a3562c",null,null);const tE=eE.exports,sE=[{id:"article_view_count",name:"閲覧（Anews）"},{id:"article_view_via_mail_count",name:"閲覧（メール）"},{id:"article_view_via_ms_teams_count",name:"閲覧（MS Teams）"},{id:"mark_count",name:"マーク"},{id:"group_mark_count",name:"グループマーク"},{id:"comment_count",name:"コメント"},{id:"comment_reply_count",name:"返信コメント"},{id:"tag_article_count",name:"タグ"},{id:"memo_article_count",name:"メモ"},{id:"reaction_comment_count",name:"リアクション"}],aE=[{id:"date",name:"日付"},{id:"activity_status",name:"属性"},{id:"access_count",name:"アクセス数"},...sE],nE=(s,e)=>Object.values({favorites:{labelFunc:a=>`テーマを${a}個お気に入りする`,checkFunc:a=>(s.favorite_theme_count??0)>=a,levels:[5,10,15,20,50,100]},views:{labelFunc:a=>`記事を${a}件閲覧する（メール経由閲覧も含む）`,checkFunc:a=>(s.article_view_count??0)>=a,levels:[50,100,150,200,500,1e3]},marks:{labelFunc:a=>`記事を${a}件マークする`,checkFunc:a=>(s.mark_count??0)>=a,levels:[10,20,50,100,150,200,500]},comments:{labelFunc:a=>`${a}件コメントする`,checkFunc:a=>(s.comment_count??0)>=a,levels:[10,20,50,100,150,200,500]},group_marks:{labelFunc:a=>`記事を${a}件グループマークする`,checkFunc:a=>(s.group_mark_count??0)>=a,levels:[10,20,50,100,150,200,500]},comment_reactions:{labelFunc:a=>`コメントに${a}件リアクションする`,checkFunc:a=>(s.reaction_comment_count??0)>=a,levels:[10,20,50,100,150,200,500]},created_themes:{labelFunc:a=>`テーマを${a}個作成する`,checkFunc:a=>(s.created_theme_count??0)>=a,levels:[5,10,20,30,40,50]},groups:{labelFunc:a=>`${a}個のグループに参加する`,checkFunc:a=>(e.length??0)>=a,levels:[5,10,15,20,50,100]}}).map(a=>a.levels.map(n=>({label:a.labelFunc(n),value:a.checkFunc(n)}))).flat(),rE=D({components:{DownloadButton:gt,Datepicker:rt},props:{userId:{type:Number,required:!0},userName:{type:String,required:!0},pageSize:{type:Number,default:10}},setup(s){const{userId:e,pageSize:t}=$e(s),a=g(oe().startOf("day").subtract(30,"day").toDate()),n=g(oe().startOf("day").subtract(1,"day").toDate()),r=({start:h,end:v})=>{a.value=h,n.value=v},{data:o}=sw(e,a,n),i=l(()=>(o.value??[]).reverse().map(h=>(h.date=De(h.date),h.activity_status=Oe[h.activity_status],h))),{totalPages:u,currentPage:c,previousPage:p,nextPage:m,visibleData:d,pageNumberIndicator:_}=Sa(i,t);return{startDate:a,endDate:n,updateDates:r,columns:aE,data:i,currentPage:c,totalPages:u,previousPage:p,nextPage:m,pageNumberIndicator:_,visibleData:d,featureFlags:st}}});var oE=function(){var e=this,t=e._self._c;return e._self._setupProxy,e.data?t("div",{staticClass:"data-table"},[t("div",{staticClass:"header"},[t("span",{staticClass:"c-title c-title--m"},[e._v("利用状況推移")]),t("div",{staticClass:"download-button-container"},[t("Datepicker",{staticClass:"datepicker",attrs:{start:e.startDate,end:e.endDate},on:{"dates-changed":e.updateDates}}),t("DownloadButton",{attrs:{fileName:`利用状況推移_${e.userName}`,columns:e.columns,data:e.data}})],1)]),t("div",{staticClass:"dashboard-card"},[t("table",{staticClass:"table"},[t("thead",[t("tr",[e._l(e.columns,function(a,n){return[t("th",{key:`${a.id}`,staticClass:"c-text c-text--s"},[e._v(" "+e._s(a.name)+" ")]),n<e.columns.length-1?t("th",{key:`${a.id}-gap`,staticClass:"gap"}):e._e()]})],2)]),t("tbody",e._l(e.visibleData,function(a,n){return t("tr",{key:`${e.currentPage}-${n}`},[e._l(e.columns,function(r,o){return[t("td",{key:`call-${n}-${o}`,class:`c-text c-text--m ${typeof a[r.id]}`},[e._v(" "+e._s(a[r.id])+" ")]),o<e.columns.length-1?t("td",{key:`${r.id}-${n}-gap`,staticClass:"gap"}):e._e()]})],2)}),0)])]),t("div",{staticClass:"controls"},[t("span",{staticClass:"c-text c-text--s"},[e._v(e._s(e.pageNumberIndicator))]),t("button",{class:{"page-button dashboard-button":!0,disabled:e.currentPage===1},on:{click:e.previousPage}},[t("sm-icons",{staticClass:"small"},[e._v("chevron-left")])],1),t("button",{class:{"page-button dashboard-button":!0,disabled:e.currentPage===e.totalPages},on:{click:e.nextPage}},[t("sm-icons",{staticClass:"small"},[e._v("chevron-right")])],1)])]):e._e()},iE=[],uE=T(rE,oE,iE,!1,null,"4fa7a3ad",null,null);const cE=uE.exports,lE=D({components:{Avatar:at},props:{title:{type:String,required:!0},users:{type:Array,required:!0}},setup(){const{data:s}=Qe();return{getUsername:a=>{var n,r;return((r=(n=s.value)==null?void 0:n.users.find(o=>o.id===a))==null?void 0:r.user_name)??""},getUserImageUrl:a=>{var n,r;return((r=(n=s.value)==null?void 0:n.users.find(o=>o.id===a))==null?void 0:r.image_url)??""}}}});var dE=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"dashboard-card"},[t("div",{staticClass:"header"},[t("span",{staticClass:"c-title c-title--m"},[e._v(e._s(e.title))]),t("span",{staticClass:"c-text c-text--s"},[e._v(e._s(e.users.length)+"人")])]),t("div",{staticClass:"items"},[e._l(e.users,function(a){return t("div",{key:a.id,staticClass:"item c-text c-text--m"},[t("div",{staticClass:"user-item"},[t("Avatar",{attrs:{imageUrl:e.getUserImageUrl(a.id),size:"xs"}}),e._v(" "+e._s(e.getUsername(a.id))+" ")],1),t("span",{staticClass:"count"},[e._v(e._s(a.count)+"件")])])}),e.users.length===0?t("span",{staticClass:"c-text c-text--m dashboard-text--secondary"},[e._v(" データがありません。 ")]):e._e()],2)])},mE=[],_E=T(lE,dE,mE,!1,null,"508ddc90",null,null);const pE=_E.exports,vE=D({components:{Avatar:at,ActionSummary:Fs,DownloadButton:gt,Datepicker:rt,MemberDetailTable:cE,UserListCard:pE},props:{userId:{type:Number,required:!0}},setup(s){const{userId:e}=$e(s),{data:t}=xe(e),{data:a}=Qe(),{data:n}=Pe(),{data:r}=ew(e),o=l(()=>{var C,y,A,k;return[{name:"閲覧",value:((C=r.value)==null?void 0:C.article_view_count)??0},{name:"マーク",value:((y=r.value)==null?void 0:y.mark_count)??0},{name:"コメント",value:((A=r.value)==null?void 0:A.comment_count)??0},{name:"グループマーク",value:((k=r.value)==null?void 0:k.group_mark_count)??0}]}),i=l(()=>{var C;return((C=r.value)==null?void 0:C.groups)??[]}),u=l(()=>r.value&&i.value?nE(r.value,i.value):[]),c=g(oe().startOf("day").subtract(30,"day").toDate()),p=g(oe().startOf("day").subtract(1,"day").toDate()),m=({start:C,end:y})=>{c.value=C,p.value=y},{data:d}=tw(e,c,p),_=C=>{var y,A;return((A=(y=n.value)==null?void 0:y.groups.find(k=>k.id===C))==null?void 0:A.name)??""},h=C=>{var y,A;return((A=(y=a.value)==null?void 0:y.users.find(k=>k.id===C))==null?void 0:A.user_name)??""},v=l(()=>{var C,y,A,k;return[{id:"group_name",name:"共有したグループ名"},{id:"group_count",name:"共有したグループ件数"},{id:"replied_to_user",name:`${(C=t.value)==null?void 0:C.user_name}さんが返信したメンバー`},{id:"replied_to_count",name:`${(y=t.value)==null?void 0:y.user_name}さんが返信した件数`},{id:"reply_recieved_user",name:`${(A=t.value)==null?void 0:A.user_name}さんに返信したメンバー`},{id:"reply_recieved_count",name:`${(k=t.value)==null?void 0:k.user_name}さんに返信した件数`}]}),f=l(()=>{var y,A,k;const C=Math.max(((y=d.value)==null?void 0:y.marked_and_commented_groups.length)??0,((A=d.value)==null?void 0:A.replied_to_users.length)??0,((k=d.value)==null?void 0:k.recieved_reply_users.length)??0);return Array.from(Array(C)).map((S,b)=>{var U,I,w,x,B,$,P,M,O,Y,W,j;return{group_name:_(((I=(U=d.value)==null?void 0:U.marked_and_commented_groups[b])==null?void 0:I.id)??-1),group_count:(x=(w=d.value)==null?void 0:w.marked_and_commented_groups[b])==null?void 0:x.count,replied_to_user:h((($=(B=d.value)==null?void 0:B.replied_to_users[b])==null?void 0:$.id)??-1),replied_to_count:(M=(P=d.value)==null?void 0:P.replied_to_users[b])==null?void 0:M.count,reply_recieved_user:h(((Y=(O=d.value)==null?void 0:O.recieved_reply_users[b])==null?void 0:Y.id)??-1),reply_recieved_count:(j=(W=d.value)==null?void 0:W.recieved_reply_users[b])==null?void 0:j.count}})});return{userInfo:t,userActivitySummary:r,actions:o,joinedGroups:i,activityProgress:u,collaborationDataStartDate:c,collaborationDataEndDate:p,updateCollaborationDates:m,collaborationData:d,getGroupName:_,collaborationCsvColumns:v,collaborationCsvData:f,featureFlags:st}}});var fE=function(){var e=this,t=e._self._c;return e._self._setupProxy,e.userInfo&&e.userActivitySummary&&e.collaborationData?t("div",{staticClass:"member-detail"},[t("div",{staticClass:"dashboard-card user-info"},[t("div",{staticClass:"user-detail"},[t("Avatar",{attrs:{imageUrl:e.userInfo.image_url}}),t("span",{staticClass:"c-title c-title--m"},[e._v(e._s(e.userInfo.user_name))]),t("span",{staticClass:"c-text c-text--xs"},[e._v(e._s(e.userInfo.org_department))]),t("span",{staticClass:"c-text c-text--xs dashboard-text--secondary"},[e._v(" "+e._s(e.userActivitySummary.first_access_date)+" ")])],1),t("ActionSummary",{staticClass:"action-summary",attrs:{data:e.actions}})],1),t("div",{staticClass:"dashboard-card user-groups"},[t("div",{staticClass:"item-header"},[t("span",{staticClass:"c-title c-title--m"},[e._v("参加グループ")]),t("span",{staticClass:"c-text c-text--s"},[e._v(e._s(e.joinedGroups.length)+"件")])]),t("div",{staticClass:"items"},e._l(e.joinedGroups,function(a){return t("div",{key:a.id,staticClass:"item c-text c-text--m"},[e._v(" "+e._s(a.name)+" ")])}),0)]),t("div",{staticClass:"dashboard-card user-activity-progress"},[t("div",{staticClass:"item-header"},[t("span",{staticClass:"c-title c-title--m"},[e._v("利用進捗")]),t("span",{staticClass:"c-text c-text--s"},[t("span",{staticClass:"c-titles c-title--m"},[e._v(e._s(e.activityProgress.filter(a=>a.value).length))]),e._v(" /"+e._s(e.activityProgress.length))])]),t("div",{staticClass:"items"},[e._l(e.activityProgress.filter(a=>a.value),function(a){return t("div",{key:a.label,staticClass:"item c-text c-text--m"},[t("sm-icons",{staticClass:"icon small primary"},[e._v("check")]),e._v(" "+e._s(a.label)+" ")],1)}),e._l(e.activityProgress.filter(a=>!a.value),function(a){return t("div",{key:a.label,staticClass:"item no-icon c-text c-text--m dashboard-text--secondary"},[e._v(" "+e._s(a.label)+" ")])})],2)]),t("div",{staticClass:"collaboration-data-header"},[t("span",{staticClass:"title c-title c-title--m"},[e._v("コラボレーション実績")]),t("div",{staticClass:"collaboration-data-controls"},[t("Datepicker",{staticClass:"collaboration-datepicker",attrs:{start:e.collaborationDataStartDate,end:e.collaborationDataEndDate},on:{"dates-changed":e.updateCollaborationDates}}),t("DownloadButton",{attrs:{fileName:`コラボレーション実績_${e.userInfo.user_name}`,columns:e.collaborationCsvColumns,data:e.collaborationCsvData}})],1)]),t("div",{staticClass:"dashboard-card group-activity"},[t("div",{staticClass:"item-header"},[t("span",{staticClass:"c-title c-title--m"},[e._v("共有したグループ")]),t("span",{staticClass:"c-text c-text--s"},[e._v(e._s(e.collaborationData.marked_and_commented_groups.length)+"件")])]),t("div",{staticClass:"items"},[e._l(e.collaborationData.marked_and_commented_groups,function(a){return t("div",{key:a.id,staticClass:"item item-with-count c-text c-text--m"},[e._v(" "+e._s(e.getGroupName(a.id))+" "),t("span",{staticClass:"count"},[e._v(e._s(a.count)+"件")])])}),e.collaborationData.marked_and_commented_groups.length===0?t("span",{staticClass:"c-text c-text--m dashboard-text--secondary"},[e._v(" データがありません。 ")]):e._e()],2)]),t("UserListCard",{staticClass:"replied-to-users",attrs:{title:`${e.userInfo.user_name}さんが返信したメンバー`,users:e.collaborationData.replied_to_users}}),t("UserListCard",{staticClass:"recieved-reply-users",attrs:{title:`${e.userInfo.user_name}さんに返信したメンバー`,users:e.collaborationData.recieved_reply_users}}),t("div",{staticClass:"data-table"},[t("MemberDetailTable",{attrs:{userId:e.userId,userName:e.userInfo.user_name}})],1)],1):e._e()},gE=[],hE=T(vE,fE,gE,!1,null,"c3c6d5df",null,null);const yE=hE.exports,CE=D({components:{DownloadButton:gt,Datepicker:rt,MemberListTable:Ia,Filters:fs,SearchInput:Ma},props:{},setup(){const s=g(""),e=g(oe().startOf("day").subtract(30,"day").toDate()),t=g(oe().startOf("day").subtract(1,"day").toDate()),a=({start:B,end:$})=>{e.value=B,t.value=$},{data:n}=bt(),r=l(()=>{var B;return(B=n.value)==null?void 0:B.management_contracts}),o=B=>{var $,P;return B?((P=($=r.value)==null?void 0:$.find(M=>M.product_contract_id===B))==null?void 0:P.contract_name)??"":"未設定"},{data:i,state:u}=jt(),{data:c,state:p}=Zx(e,t),m=l(()=>u.value===be.PENDING||u.value===be.VALIDATING||p.value===be.PENDING||p.value===be.VALIDATING),d=[{id:"user",name:"名前"},{id:"contract_name",name:"契約"},{id:"role",name:"権限"},{id:"org_department",name:"組織"},{id:"created_date",name:"登録日"},{id:"theme_count",name:"テーマ"},{id:"favorite_theme_count",name:"お気に入りテーマ"},{id:"group_count",name:"グループ"},{id:"activity_status",name:"属性"},{id:"login_in_days_count",name:"ログイン日数"},{id:"last_accessed_date",name:"最終ログイン日"},{id:"used_days_count",name:"利用日数"},{id:"last_used_date",name:"最終利用日"},{id:"has_personal_feed",name:"パーソナルニュースの配信"},{id:"has_mobile_usage",name:"モバイルアプリの利用（期間）"},{id:"has_mobile_usage_total",name:"モバイルアプリの利用（累計）"},{id:"total_article_view_count",name:"閲覧（全体）"},{id:"article_view_count",name:"閲覧（Anews）"},{id:"article_view_via_mail_count",name:"閲覧（メール）"},{id:"article_view_via_ms_teams_count",name:"閲覧（MS Teams）"},{id:"mark_count",name:"マーク"},{id:"group_mark_count",name:"グループマーク"},{id:"comment_count",name:"コメント"},{id:"comment_reaction_count",name:"リアクション"},{id:"search_query_count",name:"検索キーワード数"},{id:"article_share_count",name:"外部リンク共有数"}],_=l(()=>{var P;const B=((P=i.value)==null?void 0:P.users)??[],$=c.value??[];return B.length>0&&$.length>0?$.map(M=>{const O=B.find(Y=>Y.id===M.user_id);if(O)return{...M,user:O,org_department:O.org_department,groups:O.groups.length,activity_status:O.is_deleted?"削除済み":Oe[M.activity_status],role:mt[O.role],contract_name:o(O.product_contract_id),created_date:De(O.created_at),last_accessed_date:De(M.last_accessed_date),last_used_date:De(M.last_used_date)}}).filter(M=>M!==void 0).sort((M,O)=>M.user.user_name.localeCompare(O.user.user_name)):[]}),h=B=>{const $=B.reduce((P,M)=>(P[M]=(P[M]??0)+1,P),{});return Object.entries($).map(([P,M])=>({name:P,count:M}))},v=l(()=>h(_.value.map(B=>B.activity_status))),f=l(()=>h(_.value.map(B=>B.org_department))),C=l(()=>h(_.value.map(B=>B.user.groups).flat())),y=l(()=>h(_.value.map(B=>mt[B.user.role]))),A=l(()=>h(_.value.map(B=>B.contract_name))),k=g([{label:"契約",options:A.value,selectedOptions:[]},{label:"権限",options:y.value,selectedOptions:[]},{label:"属性",options:v.value,selectedOptions:[]},{label:"組織",options:f.value,selectedOptions:[]},{label:"グループ",options:C.value,selectedOptions:[]}]);Z(()=>[y.value,v.value,f.value,A.value],()=>{k.value[0].options=A.value,k.value[1].options=y.value,k.value[2].options=v.value,k.value[3].options=f.value,k.value[4].options=C.value});const S=()=>{b.contractNames=k.value[0].selectedOptions,b.roles=k.value[1].selectedOptions,b.activityStatus=k.value[2].selectedOptions,b.orgDepartments=k.value[3].selectedOptions,b.groups=k.value[4].selectedOptions},b=Fe({activityStatus:[],orgDepartments:[],groups:[],roles:[],contractNames:[]}),U=l(()=>_.value.filter(B=>{let $=!0;return b.activityStatus.length>0&&($=$&&b.activityStatus.includes(B.activity_status)),b.orgDepartments.length>0&&($=$&&b.orgDepartments.includes(B.org_department)),b.groups.length>0&&($=$&&b.groups.filter(P=>B.user.groups.includes(P)).length>0),b.roles.length>0&&($=$&&b.roles.some(P=>mt[B.user.role]===P)),b.contractNames.length>0&&($=$&&b.contractNames.some(P=>o(B.user.product_contract_id)===P)),s.value.length>0&&($=$&&(B.user.user_name.indexOf(s.value)>-1||B.user.email.indexOf(s.value)>-1)),$})),I=[...d.slice(0,1),{id:"email",name:"メールアドレス"},...d.slice(1)],w=l(()=>U.value.map(B=>({...B,user:B.user.user_name,email:B.user.email})));return{startDate:e,endDate:t,updateDates:a,activityStatusOptions:v,orgDepartments:f,groups:C,filters:b,columns:d,filteredData:U,columnsForDownloadBtn:I,dataForDownloadBtn:w,searchFilters:k,applyFilter:S,search:B=>s.value=B,isLoadingTableData:m}}});var bE=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"member-status"},[t("div",{staticClass:"header"},[t("div",{staticClass:"header-search"},[t("div",{staticClass:"title c-title c-title--m"},[e._v("メンバー")]),t("div",{staticClass:"spacing-32"}),t("div",{staticClass:"spacing-32"}),t("search-input",{staticClass:"search-input",on:{search:e.search}})],1),t("div",{staticClass:"spacing-16"}),t("div",{staticClass:"filters"},[t("Filters",{on:{input:e.applyFilter},model:{value:e.searchFilters,callback:function(a){e.searchFilters=a},expression:"searchFilters"}}),t("Datepicker",{staticClass:"datepicker",attrs:{start:e.startDate,end:e.endDate},on:{"dates-changed":e.updateDates}}),t("DownloadButton",{attrs:{fileName:"メンバー",columns:e.columnsForDownloadBtn,data:e.dataForDownloadBtn}})],1)]),t("MemberListTable",{attrs:{columns:e.columns,data:e.filteredData,isLoading:e.isLoadingTableData}})],1)},AE=[],kE=T(CE,bE,AE,!1,null,"866d326d",null,null);const xE=kE.exports,wE=D({components:{},props:{columns:{type:Array,required:!0},data:{type:Array,required:!0}},setup(s){const{data:e}=$e(s),t=(i,u)=>{const c=u==="asc"?1:-1;return[...e.value].sort((m,d)=>typeof m[i]=="string"&&typeof d[i]=="string"?c*m[i].localeCompare(d[i]):c*(m[i]-d[i]))},a=g(s.columns[0].id),n=g("asc"),r=i=>{i===a.value?n.value=n.value==="asc"?"desc":"asc":(a.value=i,n.value="asc")};return{sortedData:l(()=>t(a.value,n.value)),sortColumn:a,sortOrder:n,setSortColumn:r,calculatePercentage:Lt}}});var EE=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"data-table"},[t("div",{staticClass:"dashboard-card"},[t("table",{staticClass:"table"},[t("thead",[t("tr",[e._l(e.columns,function(a,n){return[t("th",{key:`${a.id}`,staticClass:"c-text c-text--m",class:`${a.type}`,on:{click:function(r){return e.setSortColumn(a.id)}}},[e._v(" "+e._s(a.name)+" "),e.sortColumn===a.id&&e.sortOrder=="asc"?t("span",{staticClass:"sort-icon"},[e._v("↑")]):e.sortColumn===a.id&&e.sortOrder=="desc"?t("span",{staticClass:"sort-icon"},[e._v("↓")]):t("span",{staticClass:"sort-icon no-sort"})]),n>0&&n<e.columns.length-1?t("th",{key:`${a.id}-gap`,staticClass:"gap"}):e._e()]})],2)]),t("tbody",e._l(e.sortedData,function(a,n){return t("tr",{key:`org-department-table-row-${n}`},[e._l(e.columns,function(r,o){return[t("td",{key:`call-${n}-${o}`,class:`c-text c-text--m ${typeof a[r.id]}`},[r.id==="org_department"?t("router-link",{staticClass:"org-department",attrs:{to:{name:"dashboardOrgDepartmentStatus",query:{orgDepartment:a[r.id]}}}},[e._v(" "+e._s(a[r.id])+" ")]):t("span",{staticClass:"c-text c-text--m"},[e._v(e._s(a[r.id]))]),r.hasPercentage?t("span",{staticClass:"percentage c-text c-text--s"},[e._v("("+e._s(e.calculatePercentage(Number(a[r.id]),Number(a.total_user_count)))+"%) ")]):e._e()],1),o>0&&o<e.columns.length-1?t("td",{key:`${r.id}-gap`,staticClass:"gap"}):e._e()]})],2)}),0)])])])},FE=[],TE=T(wE,EE,FE,!1,null,"a8f0954f",null,null);const DE=TE.exports,BE=D({components:{Datepicker:rt,DownloadButton:gt,OrgDepartmentListTable:DE},props:{},setup(){const s=g(oe().startOf("day").subtract(1,"day").toDate()),e=r=>{s.value=r},{data:t}=iw(s),a=[{id:"org_department",name:"組織",hasPercentage:!1,type:"string"},{id:"total_user_count",name:"メンバー",hasPercentage:!1,type:"number"},{id:"heavy_count",name:"ヘビー",hasPercentage:!0,type:"number"},{id:"active_count",name:"アクティブ",hasPercentage:!0,type:"number"},{id:"light_count",name:"ライト",hasPercentage:!0,type:"number"},{id:"dormant_count",name:"休眠",hasPercentage:!0,type:"number"},{id:"inactive_count",name:"未使用",hasPercentage:!0,type:"number"}],n=l(()=>{const r=t.value??[];return r.length>0?r.filter(o=>o!==void 0):[]});return{updateDate:e,data:n,columns:a,featureFlags:st}}});var SE=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"member-status"},[t("div",{staticClass:"header"},[e._m(0),t("div",{staticClass:"filters"},[t("Datepicker",{staticClass:"datepicker",attrs:{isMultipleSelect:!1},on:{"dates-changed":e.updateDate}}),t("DownloadButton",{attrs:{fileName:"組織",columns:e.columns,data:e.data}})],1)]),t("OrgDepartmentListTable",{attrs:{columns:e.columns,data:e.data}})],1)},IE=[function(){var s=this,e=s._self._c;return s._self._setupProxy,e("div",{staticClass:"title"},[e("span",{staticClass:"c-title c-title--m"},[s._v("利用状況")])])}],ME=T(BE,SE,IE,!1,null,"96032a83",null,null);const $E=ME.exports,PE=D({components:{DownloadButton:gt,Datepicker:rt,MemberListTable:Ia,Filters:fs,SearchInput:Ma},props:{},setup(){const s=g(""),e=ie(),t=g(oe().startOf("day").subtract(30,"day").toDate()),a=g(oe().startOf("day").subtract(1,"day").toDate()),n=({start:w,end:x})=>{t.value=w,a.value=x},{data:r,state:o}=jt(),i=String(e.query.orgDepartment),{data:u,state:c}=lw(i,t,a),p=l(()=>o.value===be.PENDING||o.value===be.VALIDATING||c.value===be.PENDING||c.value===be.VALIDATING),m=[{id:"user",name:"メンバー"},{id:"activity_status",name:"属性"},{id:"groups",name:"グループ"},{id:"login_in_days_count",name:"ログイン日数"},{id:"article_view_count",name:"閲覧（Anews）"},{id:"article_view_via_mail_count",name:"閲覧（メール）"},{id:"article_view_via_ms_teams_count",name:"閲覧（MS Teams）"},{id:"mark_count",name:"マーク"},{id:"group_mark_count",name:"グループマーク"},{id:"comment_count",name:"コメント"},{id:"comment_reply_count",name:"返信コメント"},{id:"tag_article_count",name:"タグ"},{id:"memo_article_count",name:"メモ"},{id:"reaction_comment_count",name:"リアクション"},{id:"days_from_first_access_count",name:"利用経過日数"}],d=l(()=>{var B;const w=((B=r.value)==null?void 0:B.users)??[],x=u.value??[];return w.length>0&&x.length>0?x.map($=>{const P=w.find(M=>M.id===$.user_id);if(P)return{...$,user:P,org_department:P.org_department,groups:P.groups.length,activity_status:Oe[$.activity_status],role:mt[P.role],contract_name:"",created_date:De(P.created_at),last_accessed_date:De($.last_accessed_date),last_used_date:De($.last_used_date)}}).filter($=>$!==void 0).sort(($,P)=>$.user.user_name.localeCompare(P.user.user_name)):[]}),_=w=>{const x=w.reduce((B,$)=>(B[$]=(B[$]??0)+1,B),{});return Object.entries(x).map(([B,$])=>({name:B,count:$}))},h=l(()=>_(d.value.map(w=>w.activity_status))),v=l(()=>_(d.value.map(w=>w.org_department))),f=l(()=>_(d.value.map(w=>w.user.groups).flat())),C=l(()=>_(d.value.map(w=>mt[w.user.role]))),y=g([{label:"権限",options:C.value,selectedOptions:[]},{label:"属性",options:h.value,selectedOptions:[]},{label:"グループ",options:f.value,selectedOptions:[]}]);Z(()=>[C.value,h.value,v.value],()=>{y.value[0].options=C.value,y.value[1].options=h.value,y.value[2].options=f.value});const A=()=>{k.roles=y.value[0].selectedOptions,k.activityStatus=y.value[1].selectedOptions,k.groups=y.value[2].selectedOptions},k=Fe({activityStatus:[],groups:[],roles:[]}),S=l(()=>d.value.filter(w=>{let x=!0;return k.activityStatus.length>0&&(x=x&&k.activityStatus.includes(w.activity_status)),k.groups.length>0&&(x=x&&k.groups.filter(B=>w.user.groups.includes(B)).length>0),k.roles.length>0&&(x=x&&k.roles.some(B=>mt[w.user.role]===B)),s.value.length>0&&(x=x&&(w.user.user_name.indexOf(s.value)>-1||w.user.email.indexOf(s.value)>-1)),x})),b=[...m.slice(0,1),{id:"email",name:"メールアドレス"},...m.slice(1)],U=l(()=>S.value.map(w=>({...w,user:w.user.user_name,email:w.user.email})));return{startDate:t,endDate:a,updateDates:n,activityStatusOptions:h,orgDepartments:v,groups:f,filters:k,columns:m,filteredData:S,columnsForDownloadBtn:b,dataForDownloadBtn:U,searchFilters:y,applyFilter:A,search:w=>s.value=w,isLoadingTableData:p}}});var NE=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"member-status"},[t("div",{staticClass:"header"},[t("div",{staticClass:"header-search"},[t("div",{staticClass:"title c-title c-title--m"},[e._v("メンバー")]),t("div",{staticClass:"spacing-32"}),t("div",{staticClass:"spacing-32"}),t("search-input",{staticClass:"search-input",on:{search:e.search}})],1),t("div",{staticClass:"spacing-16"}),t("div",{staticClass:"filters"},[t("Filters",{on:{input:e.applyFilter},model:{value:e.searchFilters,callback:function(a){e.searchFilters=a},expression:"searchFilters"}}),t("Datepicker",{staticClass:"datepicker",attrs:{start:e.startDate,end:e.endDate},on:{"dates-changed":e.updateDates}}),t("DownloadButton",{attrs:{fileName:"メンバー",columns:e.columnsForDownloadBtn,data:e.dataForDownloadBtn}})],1)]),t("MemberListTable",{attrs:{columns:e.columns,data:e.filteredData,isLoading:e.isLoadingTableData}})],1)},LE=[],UE=T(PE,NE,LE,!1,null,"10008161",null,null);const RE=UE.exports,OE=D({components:{ActionSummary:Fs,Datepicker:rt,DonutChart:$a,StackedBarChart:Pa,TeamUserActivityStatusTable:Na},props:{},setup(){const s=ie(),e=g(oe().startOf("day").subtract(30,"day").toDate()),t=g(oe().startOf("day").subtract(1,"day").toDate()),a=({start:p,end:m})=>{e.value=p,t.value=m},n=String(s.query.orgDepartment),{data:r}=uw(n,e,t),o=l(()=>{if(!r.value)return;const p=r.value,m=Object.values(p).reduce((d,_)=>d+=_,0);return[{name:"閲覧",value:p.article_view_count},{name:"マーク",value:p.mark_count},{name:"コメント",value:p.comment_count},{name:"グループマーク",value:p.group_mark_count},{name:"アクション総数",value:m}]}),{data:i}=cw(n,e,t),u=l(()=>(i.value??[]).map(p=>(p.date=De(p.date),p))),c=Object.keys(Oe).reduce((p,m)=>({...p,[`${m}_count`]:Oe[m]}),{});return{startDate:e,endDate:t,updateDates:a,actionSummaryData:o,chartLabels:c,tableData:u}}});var GE=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"team-status"},[e._m(0),t("Datepicker",{staticClass:"datepicker",attrs:{start:e.startDate,end:e.endDate},on:{"dates-changed":e.updateDates}}),e.actionSummaryData?t("ActionSummary",{staticClass:"summary dashboard-card",attrs:{data:e.actionSummaryData}}):e._e(),e.tableData.length>0?t("DonutChart",{staticClass:"activity-status dashboard-card",attrs:{labels:e.chartLabels,data:e.tableData[e.tableData.length-1],total:e.tableData[e.tableData.length-1].total_user_count}}):e._e(),e.tableData.length>0?t("StackedBarChart",{staticClass:"monthly-activity-status dashboard-card",attrs:{labels:e.chartLabels,data:e.tableData}}):e._e(),e.tableData.length>0?t("TeamUserActivityStatusTable",{staticClass:"activity-table",attrs:{data:[...e.tableData].reverse()}}):e._e()],1)},qE=[function(){var s=this,e=s._self._c;return s._self._setupProxy,e("div",{staticClass:"title"},[e("span",{staticClass:"c-title c-title--m"},[s._v("利用状況")])])}],HE=T(OE,GE,qE,!1,null,"a881f979",null,null);const VE=HE.exports,jE=D({components:{Datepicker:rt,RadioLabel:ws,LoadableButton:Jt},props:{},setup(){const s=ie(),e=se(),t=N.getTeamId(),a=g(oe().startOf("day").subtract(30,"day").toDate()),n=Co(),r=g(n),o=({start:f,end:C})=>{a.value=f,r.value=C},i={comment:"コメント",mark:"マーク",group_mark:"グループマーク"},u=Fe({items:[]}),c=f=>{u.items.includes(f)?u.items=u.items.filter(C=>C!=f):u.items.push(f),f==="group_mark"&&u.items.includes("group_mark")?d.value="all":f==="group_mark"&&(d.value=void 0)},p=l(()=>u.items.length>0&&!m.value),m=l(()=>e.state.downloadActionData.isDownloadingTeamActivity),d=g(void 0),_=l(()=>`/dashboard/teams/${t}/action_data?${Ne.stringify({types:u.items,from:oe(a.value).format("YYYY-MM-DD"),to:oe(r.value).format("YYYY-MM-DD"),separate_group_mark_tags:d.value=="tag",tracking_data:JSON.stringify({page:{name:"team_activity_download",url:s.fullPath},feature:"team_activity_download",format:h.value})},{arrayFormat:"brackets"})}`),h=g("excel");return{startDate:a,endDate:r,TODAY:n,updateDates:o,types:i,selectedTypes:u,toggleType:c,groupMarkFilter:d,isDownloadEnabled:p,isLoading:m,download:async()=>{if(p.value)try{e.commit("downloadActionData/setIsDownloadingTeamActivity",!0);const{data:f}=await Q.get(_.value),C=`action_data_${oe(a.value).format("YYYY-MM-DD")}_${oe(r.value).format("YYYY-MM-DD")}.${h.value==="excel"?"xlsx":"csv"}`;await bo(C,f,h.value)}catch(f){Ao(f,e)}finally{e.commit("downloadActionData/setIsDownloadingTeamActivity",!1)}},downloadFormat:h}}});var KE=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"team-activity-download dashboard-card"},[t("p",{staticClass:"c-text c-text--m"},[e._v(" どのような記事に誰がアクション（マークやグループマーク、コメント）をしたのかExcelやCSVで確認することができます。 ")]),t("p",{staticClass:"c-title c-title--m"},[e._v("期間")]),t("p",[t("Datepicker",{staticClass:"datepicker",attrs:{start:e.startDate,end:e.endDate,disabledLaterThan:e.TODAY},on:{"dates-changed":e.updateDates}})],1),t("p",{staticClass:"c-title c-title--m"},[e._v("アクション")]),t("div",{staticClass:"action-types"},[e._l(Object.entries(e.types),function([a,n]){return t("sm-checkbox-label",{key:a,staticClass:"checkbox",attrs:{value:e.selectedTypes.items.includes(a)},on:{change:()=>e.toggleType(a)}},[e._v(" "+e._s(n)+" ")])}),t("div",{staticClass:"group-mark-filter"},[t("RadioLabel",{attrs:{label:"グループマークされたすべての記事",value:e.groupMarkFilter==="all",isDisabled:!e.selectedTypes.items.includes("group_mark")},on:{toggleValue:function(a){e.selectedTypes.items.includes("group_mark")&&(e.groupMarkFilter="all")}}}),t("RadioLabel",{attrs:{label:"タグ付き記事のみ（集計する際はこちらをご利用ください。複数のタグがある場合は行が分割されます）",value:e.groupMarkFilter==="tag",isDisabled:!e.selectedTypes.items.includes("group_mark")},on:{toggleValue:function(a){e.selectedTypes.items.includes("group_mark")&&(e.groupMarkFilter="tag")}}})],1)],2),t("p",{staticClass:"c-title c-title--m"},[e._v("ダウンロード形式")]),t("div",{staticClass:"download-format"},[t("RadioLabel",{attrs:{label:"Excel",value:e.downloadFormat==="excel"},on:{toggleValue:function(a){e.downloadFormat="excel"}}}),t("RadioLabel",{attrs:{label:"CSV",value:e.downloadFormat==="csv"},on:{toggleValue:function(a){e.downloadFormat="csv"}}})],1),t("LoadableButton",{staticClass:"dashboard-button--primary",class:{disabled:!e.isDownloadEnabled},attrs:{disabled:!e.isDownloadEnabled,isLoading:e.isLoading},on:{click:e.download}},[e._v(" ダウンロード ")])],1)},YE=[],QE=T(jE,KE,YE,!1,null,"2adccb43",null,null);const WE=QE.exports,zE=D({components:{ActionSummary:Fs,Datepicker:rt,DonutChart:$a,StackedBarChart:Pa,TeamUserActivityStatusTable:Na,MultiSelect:Tr},props:{},setup(){const s=Te(),{data:e}=bt(),t=l(()=>{var f;return(f=e.value)==null?void 0:f.management_contracts}),a=l(()=>t.value?t.value.map(f=>({name:f.contract_name})):[]),n=g([]);Z(()=>t.value,f=>{f!=null&&(f==null?void 0:f.length)>0||s.push({name:"dashboardTeamActivityDownload"})});const r=l(()=>t.value?(n.value.length>0?t.value.filter(C=>n.value.includes(C.contract_name)):t.value).map(C=>C.id):[]),o=g(oe().startOf("day").subtract(30,"day").toDate()),i=g(oe().startOf("day").subtract(1,"day").toDate()),u=({start:f,end:C})=>{o.value=f,i.value=C},{data:c,mutate:p}=Jx(o,i,r),m=f=>{n.value=f,p()},d=l(()=>{if(!c.value)return;const f=c.value,C=Object.values(f).reduce((y,A)=>y+=A,0);return[{name:"閲覧",value:f.article_view_count},{name:"マーク",value:f.mark_count},{name:"コメント",value:f.comment_count},{name:"グループマーク",value:f.group_mark_count},{name:"アクション総数",value:C}]}),{data:_}=Xx(o,i,r),h=l(()=>(_.value??[]).map(f=>(f.date=De(f.date),f))),v=Object.keys(Oe).reduce((f,C)=>({...f,[`${C}_count`]:Oe[C]}),{});return{startDate:o,endDate:i,updateDates:u,actionSummaryData:d,chartLabels:v,tableData:h,selectContracts:a,selectedContractNames:n,contractSelectionUpdate:m}}});var JE=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"team-status"},[e._m(0),t("div",{staticClass:"filters"},[t("MultiSelect",{attrs:{optionName:"契約",options:e.selectContracts,selectedOptions:e.selectedContractNames},on:{selectionUpdated:e.contractSelectionUpdate}}),t("div",{staticClass:"spacing-16"}),t("Datepicker",{attrs:{start:e.startDate,end:e.endDate},on:{"dates-changed":e.updateDates}})],1),e.actionSummaryData?t("ActionSummary",{staticClass:"summary dashboard-card",attrs:{data:e.actionSummaryData}}):e._e(),e.tableData.length>0?t("DonutChart",{staticClass:"activity-status dashboard-card",attrs:{labels:e.chartLabels,data:e.tableData[e.tableData.length-1],total:e.tableData[e.tableData.length-1].total_user_count}}):e._e(),e.tableData.length>0?t("StackedBarChart",{staticClass:"monthly-activity-status dashboard-card",attrs:{labels:e.chartLabels,data:e.tableData}}):e._e(),e.tableData.length>0?t("TeamUserActivityStatusTable",{staticClass:"activity-table",attrs:{data:[...e.tableData].reverse()}}):e._e()],1)},XE=[function(){var s=this,e=s._self._c;return s._self._setupProxy,e("div",{staticClass:"title"},[e("span",{staticClass:"c-title c-title--m"},[s._v("利用状況")])])}],ZE=T(zE,JE,XE,!1,null,"3360b6dd",null,null);const eF=ZE.exports,wn=s=>({userId:Number(s.params.userId)}),tF=[{name:"dashboardTeamStatus",path:"team",meta:{title:"全体利用状況"},component:eF},{name:"dashboardTeamActivityDownload",path:"activity-download",meta:{title:"アクション履歴"},component:WE},{name:"dashboardMemberDetail",path:"members/:userId",meta:{title:"メンバー利用状況"},props:{default:wn,header:wn},components:{default:yE,header:Gx}},{name:"dashboardMemberList",path:"members",meta:{title:"メンバー利用状況"},component:xE},{name:"dashboardGroupList",path:"groups",meta:{title:"グループ利用状況"},component:vw},{name:"dashboardGroupStatus",path:"groups/:groupId",meta:{title:"グループ利用状況",type:"dashboard_group"},components:{default:tE,header:es}},{name:"dashboardGroupMember",path:"groups/:groupId/member",meta:{title:"グループ利用状況",type:"dashboard_group"},components:{default:Tw,header:es}},{name:"dashboardOrgDepartmentList",path:"org_departments",meta:{title:"組織利用状況"},component:$E},{name:"dashboardOrgDepartmentStatus",path:"org_departments/overview",meta:{title:"組織利用状況",type:"dashboard_org_department"},components:{default:VE,header:es}},{name:"dashboardOrgDepartmentMember",path:"org_departments/member",meta:{title:"組織利用状況",type:"dashboard_org_department"},components:{default:RE,header:es}}],sF={name:"dashboardHome",path:"/dashboard",redirect:{name:"dashboardTeamStatus"},component:Fx,children:tF};qe.use(ps);const aF=[sF,{name:"labs",path:"/labs",component:lf,meta:{title:"調査AIエージェント | Stockmark Labs",type:"labs"},children:[{path:"/labs/reports",component:ug,meta:{title:"調査AIエージェント | Stockmark Labs",type:"labs"},name:"selectTemplate"},{path:"/labs/reports/setting",component:vf,meta:{title:"調査AIエージェント | Stockmark Labs",type:"labs"},name:"reportSetting"},{path:"/labs/reports/templates/todayNews",meta:{title:"調査AIエージェント | Stockmark Labs",type:"labs"},component:Xf,name:"todayNewsTemplate"},{path:"/labs/reports/templates/caseStudy",meta:{title:"調査AIエージェント | Stockmark Labs",type:"labs"},component:Yf,name:"caseStudyTemplate"},{path:"/labs/reports/:reportId",meta:{title:"調査AIエージェント | Stockmark Labs",type:"labs"},component:qf,name:"savedReport",props:!0}]},{path:"/",component:Jy,children:[{path:"/",component:P0,name:"anewsHome",meta:{title:"ホーム",type:"home"}},{path:"/admin/members",component:nd,name:"members",meta:{title:"メンバー管理",type:"admin"}},{path:"/admin/environment_settings",component:Sl,name:"environmentSettings",meta:{title:"環境設定",type:"admin"}},{path:"/admin/contracts",component:ul,name:"contracts",meta:{title:"契約管理",type:"admin"}},{path:"/admin/contracts/:contractId/members",component:_l,name:"contractMembers",meta:{title:"契約管理",type:"admin"}},{path:"/admin/themes",component:pd,name:"themeAdmin",meta:{title:"テーマ管理",type:"admin"}},{path:"/admin/groups",component:Ol,name:"groupAdmin",meta:{title:"グループ管理",type:"admin"}},{path:"/admin/themes/:themeId/members",component:Ed,name:"themeAdminMembers",meta:{title:"テーマ管理",type:"admin"},props:!0},{path:"/themes/:themeId/edit",component:Cn,name:"themeEdit",meta:{title:"テーマ",type:"theme"},props:!0},{path:"/themes/create",component:Cn,name:"themeCreate",meta:{title:"テーマ作成",type:"themeCreate"},props:!0},{path:"/themes/search",component:Pk,name:"themeSearch",meta:{title:"テーマ検索",type:"themeSearch"},props:!0},{path:"/themes/:themeId",component:wk,props:s=>({themeId:s.params.themeId}),children:[{path:"foreign_feed",redirect:{name:"themeFeed"},meta:{title:"テーマ",type:"theme"}},{path:"related_news",component:us,name:"themeRelatedNews",meta:{title:"テーマ",type:"theme"},props:()=>({feed:"related_feed",hasViewMoreButton:!1})},{path:"featured_articles",component:dk,name:"themeFeaturedArticles",meta:{title:"テーマ",type:"theme"}},{path:"",component:Ck,name:"themeFeed",meta:{title:"テーマ",type:"theme"}},{path:"technical_literature",component:Ok,name:"themeTechnicalLiterature",meta:{title:"テーマ",type:"theme"}},{path:"research_papers",name:"themeResearchPapers",redirect:{name:"themeTechnicalLiterature"},meta:{title:"テーマ",type:"theme"}}]},{path:"/personal-news",component:zC,name:"personalNews",meta:{title:"パーソナルニュース",type:"personalNews"}},{path:"/personal-research-papers",component:vb,name:"personalResearchPapers",meta:{title:"パーソナル論文",type:"personalNews"}},{path:"/groups",component:Cv,name:"groupList",meta:{title:"グループ検索",type:"group"},props:!0},{path:"/groups/:groupId",component:Bp,name:"groupActivity",meta:{title:"グループ",type:"group"},props:!0},{path:"/groups/:groupId/comments",component:Vp,name:"groupDetail",meta:{title:"グループ",type:"group"},props:!0},{path:"/groups/:groupId/marks",component:sv,name:"groupMarks",meta:{title:"グループ",type:"group"},props:!0},{path:"/articles/:id",component:on,name:"articlePage",meta:{title:"記事詳細",type:"article"},props:s=>({id:s.params.id,doc_type:"article"})},{path:"/research_papers/:id",component:on,name:"researchPaperPage",meta:{title:"論文詳細",type:"article"},props:s=>({id:s.params.id,doc_type:"research_paper"})},{path:"/comments/:commentId",component:k_,name:"groupComment",meta:{title:"グループ",type:"group"},props:!0},{path:"/groups/:groupId/edit",component:Wp,name:"groupEdit",meta:{title:"グループ",type:"group"},props:!0},{path:"/groups/:groupId/members",component:lv,name:"groupMembers",meta:{title:"グループ",type:"group"},props:!0},{path:"/users/:userId",name:"userProfile",meta:{title:"",type:"user"},redirect:"/users/:userId/marks"},{path:"/users/:userId/marks",component:gx,name:"userMarks",meta:{title:"",type:"user"},props:!0},{path:"/users/:userId/views",component:Ax,name:"userViews",meta:{title:"",type:"user"},props:s=>({userId:Number(s.params.userId)})},{path:"/users/:userId/comments",component:Xk,name:"userComments",meta:{title:"",type:"user"},props:!0},{path:"/users/:userId/export",component:dx,name:"userExport",meta:{title:"",type:"user"},props:s=>({userId:Number(s.params.userId)})},{path:"/settings/profile",component:zb,name:"userSettingsProfile",meta:{title:"プロフィール設定",type:"userSettings"}},{path:"/settings/news",component:Ob,name:"userSettingsNews",meta:{title:"ニュース配信設定",type:"userSettings"}},{path:"/settings/email",component:Pb,name:"userSettingsEmail",meta:{title:"メール配信設定",type:"userSettings"}},{path:"/settings/password",component:jb,name:"userSettingsPassword",meta:{title:"パスワード設定",type:"userSettings"}},{path:"/settings",name:"userSettings",redirect:{name:"userSettingsProfile"},meta:{title:"プロフィール設定",type:"userSettings"}},{path:"/team/marks",component:vA,name:"teamMarks",meta:{title:"新着マークニュース",type:"teamMarks"}},{path:"/team/featured_articles",component:lA,name:"teamFeaturedArticles",meta:{title:"注目記事",type:"team"}},{path:"/team/industry_news",component:tA,name:"industryNews",meta:{title:"業界ニュース",type:"industryNews"}},{path:"/notifications",component:gC,name:"notifications",meta:{title:"お知らせ",type:"notifications"}},{path:"/search",component:Bb,name:"search",meta:{title:"検索結果",type:"search"}}]},{path:"/account",component:io,children:[{path:"login",component:ir,name:"login",meta:{title:"ログイン",type:"account"}},{path:"forgot_password",component:rr,name:"forgotPassword",meta:{title:"パスワードを忘れてしまった場合",type:"account"}},{path:"new_password",component:ur,name:"newPassword",meta:{title:"パスワード設定",type:"account"},props:!0},{path:"confirmForgotPassword",component:nr,name:"confirmForgotPassword",meta:{title:"新しいパスワードを設定",type:"account"},props:!0}]},{path:"/onboarding",component:iC,children:[{path:"job_select",component:EC,name:"jobSelect",meta:{title:"職種選択",type:"onboarding"}},{path:"theme_topic_select",component:VC,name:"themeTopicSelect",meta:{title:"興味選択",type:"onboarding"}},{path:"theme_perspective_select",component:SC,name:"themePerspectiveSelect",meta:{title:"組み合わせ条件選択",type:"onboarding"}}]},{path:"/redirect",meta:"redirect",beforeEnter:async s=>{const e=localStorage.getItem("redirectSendViewParams");if(e!==null){localStorage.removeItem("redirectSendViewParams");try{const t=JSON.parse(e);await F.sendView(t)}catch(t){Vs(t,"warning")}}typeof s.query.url=="string"&&(location.href=s.query.url)}},{path:"/mobile_app_download",meta:"mobile_app_download",beforeEnter(){location.href="/api/v1/mobile_app/store_redirect"}},{path:"*",redirect:"/"}],Et=new ps({routes:aF,scrollBehavior(s,e,t){return s.path===e.path?t:{x:0,y:0}}});Et.beforeEach(async(s,e,t)=>{if(Rt.commit("route/setPreviousRoute",e),Kn(s)){t({name:"login",query:{redirect:s.fullPath}});return}if(s.name==="login"&&N.isActive()){t({name:"anewsHome"});return}t()});const En="Anews";Et.afterEach(s=>{if(s.meta.type==="user"){const t=N.getUserId()===Number(s.params.userId)?"マイページ":"ユーザーページ";s.meta.title=t}const e=s.meta.title?`${s.meta.title} | ${En}`:En;document.title=e});const nF=s=>{const e=N.getTeamIdAsString();return{page_title:s.name,page_path:s.path,page_location:window.location.href,team_id:e}},rF={config:{id:Ge.getTrackingId()??""},pageTrackerTemplate:nF};qe.use(Ln,rF,Et);qe.use(Ti,{id:"GTM-5VWK2LK",vueRouter:Et});const Fn=()=>{new qe({router:Et,store:Rt,render:s=>s(qi),created:function(){Ge.config(this.$gtag)}}).$mount("#app")};const oF=D({components:{PasswordInput:oa},setup(){const s=g(!1),e=g(""),t=g(""),a=g(""),n=g(!0),r=g(!1),o=g(!1),i=g(!1),u=g();ne(()=>{var f;(f=u.value)==null||f.focus()});const c=Te(),p=ie(),m=se(),d=Ye(),_=async(f,C)=>{i.value=!0,a.value="";let y;try{y=await F.signin(f,C)}catch(A){throw a.value="予期せぬエラーが発生しました。",i.value=!1,A}if(y.type==="success")await ua(c,p,m,d,y.user_id,y.team_id);else if(y.type==="new_password_required")c.push({name:"newPassword",params:{mailAddress:f},query:{session:y.session}});else if(y.type==="incorrect_email_or_password")a.value="メールアドレスもしくはパスワードが間違っています。";else if(y.type==="invalid_team")a.value="チームが利用停止状態なので、ご利用できません。";else if(y.type==="initial_password_has_expired")a.value=`初期パスワードの有効期限が切れています。
管理者に問い合わせてください。`;else if(y.type==="password_attempts_exceeded")a.value=`連続でログインに失敗したため、一時的にログインをロックしました。
しばらく時間を置いてから、ログインをお試しください。`;else throw a.value="予期せぬエラーが発生しました。","any error";i.value=!1},h=()=>{r.value=!1,o.value=!1,e.value==""&&(r.value=!0),t.value==""&&(o.value=!0),!r.value&&!o.value&&_(e.value,t.value).catch(f=>console.log(f))},v=l(()=>e.value&&t.value&&!i.value);return{signedIn:s,loginid:e,password:t,errorMessage:a,onEye:n,hasErrorMail:r,hasErrorPassword:o,loginPage:u,submit:h,isEnableToPost:v}}});var iF=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"mobile-login"},[t("div",{staticClass:"p-account-header"},[e.$route.meta.type==="account"?t("img",{staticClass:"p-anews-logo",attrs:{src:Bt}}):e._e()]),t("div",{staticClass:"o-login"},[e.signedIn?e._e():t("form",{staticClass:"o-signin-form"},[t("div",{staticClass:"c-title--l"},[e._v("ログイン")]),t("div",{staticClass:"spacing-24"}),t("div",{staticClass:"c-formBlock"},[t("div",{staticClass:"c-formBlock__label"},[e._v("メールアドレス")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.loginid,expression:"loginid"}],staticClass:"c-textInput",attrs:{name:"email",type:"email",autocomplete:"email",placeholder:""},domProps:{value:e.loginid},on:{input:function(a){a.target.composing||(e.loginid=a.target.value)}}})]),t("div",{staticClass:"spacing-12"}),t("div",{staticClass:"c-formBlock"},[t("div",{staticClass:"c-formBlock__label"},[e._v("パスワード")]),t("PasswordInput",{model:{value:e.password,callback:function(a){e.password=a},expression:"password"}})],1),e.errorMessage?t("div",{staticClass:"c-formBlock__text c-formBlock__text--error"},[t("div",{staticClass:"spacing-16"}),t("div",{staticClass:"o-error-message m-error c-text--s"},[e._v(" "+e._s(e.errorMessage)+" ")]),t("div",{staticClass:"spacing-16"})]):t("div",{staticClass:"spacing-32"}),t("button",{staticClass:"c-btn c-btn--AnewsPrimary o-submit-btn",class:{disabled:!e.isEnableToPost},attrs:{disabled:!e.isEnableToPost},on:{click:function(a){return a.preventDefault(),e.submit.apply(null,arguments)}}},[e._v(" ログイン ")])])])])},uF=[],cF=T(oF,iF,uF,!1,null,"07821b63",null,null);const lF=cF.exports,dF=D({components:{AdpDocumentAllianceMedia:Sr},props:{id:{type:String,required:!0},doc_type:{type:String,required:!0}},setup({id:s,doc_type:e}){const{data:t}=et(),{data:a}=Cr(s,e);return{adpDocument:a,teamInfo:t}}});var mF=function(){var e=this,t=e._self._c;return e._self._setupProxy,e.adpDocument?t("div",{staticClass:"document-container"},[t("div",{staticClass:"document-content"},[t("AdpDocumentAllianceMedia",{attrs:{adpDocument:e.adpDocument,teamInfo:e.teamInfo}})],1)]):e._e()},_F=[],pF=T(dF,mF,_F,!1,null,"a2efe7de",null,null);const vF=pF.exports,fF=D({setup(){return{iosUrl:On,androidUrl:Gn}}}),gF=""+new URL("app-logo-0205717d.svg",import.meta.url).href;var hF=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"main"},[e._m(0),t("div",{staticClass:"main-body"},[t("div",{staticClass:"title c-title c-title--l"},[e._v("アプリでもっと手軽に！")]),e._m(1),t("img",{staticClass:"app-logo",attrs:{src:gF}}),t("div",{staticClass:"download-buttons"},[t("a",{staticClass:"download-button ios",attrs:{href:e.iosUrl,target:"_blank"}},[t("img",{attrs:{src:Xr}})]),t("a",{staticClass:"download-button android",attrs:{href:e.androidUrl,target:"_blank"}},[t("img",{attrs:{src:Zr}})])])]),e._m(2)])},yF=[function(){var s=this,e=s._self._c;return s._self._setupProxy,e("div",{staticClass:"main-header"},[e("div",[e("img",{staticClass:"anews-logo",attrs:{src:Bt}})])])},function(){var s=this,e=s._self._c;return s._self._setupProxy,e("div",{staticClass:"subtitle"},[e("span",[s._v("アプリのダウンロードすると")]),e("span",[s._v("Anewsをモバイル利用できます。")])])},function(){var s=this,e=s._self._c;return s._self._setupProxy,e("div",{staticClass:"main-footer"},[e("div",{staticClass:"main-footer-content"},[e("a",{attrs:{href:"https://stockmark.co.jp/",target:"_blank"}},[e("img",{staticClass:"logo-stockmark",attrs:{src:oo}})]),e("div",{staticClass:"footer-links"},[e("a",{staticClass:"about-company c-title c-title--m",attrs:{href:"https://stockmark.co.jp/company/",target:"_blank"}},[s._v("会社概要")]),e("a",{staticClass:"about-anews c-title c-title--m",attrs:{href:"https://stockmark.co.jp/product/anews/",target:"_blank"}},[s._v("Anewsについて")])])])])}],CF=T(fF,hF,yF,!1,null,"9654818c",null,null);const bF=CF.exports;qe.use(ps);const AF=[{path:"/account",component:io,redirect:"/",children:[{path:"login",component:ir,name:"login",meta:"account"},{path:"forgot_password",component:rr,name:"forgotPassword",meta:"account"},{path:"new_password/:mailAddress",component:ur,name:"newPassword",meta:"account",props:!0},{path:"confirmForgotPassword/:mailAddress",component:nr,name:"confirmForgotPassword",meta:"account",props:!0}]},{path:"/",component:bF},{path:"/mobile_app_download",meta:"mobile_app_download",beforeEnter(){location.href="/api/v1/mobile_app/store_redirect"}},{path:"/articles/:id",component:vF,name:"articlePage",meta:{title:"記事詳細",type:"article"},props:s=>({id:s.params.id,doc_type:"article"})},{path:"mobile_login",component:lF,name:"mobileLogin",meta:{title:"ログイン",type:"account"}},{path:"*",redirect:"/"}],La=new ps({routes:AF,scrollBehavior(s,e,t){return t||{x:0,y:0}}});La.beforeEach(async(s,e,t)=>{if(Kn(s)){t({name:"mobileLogin",query:{redirect:s.fullPath}});return}t()});qe.use(Ln,{config:{id:Ge.getTrackingId()}},La);const kF={userInfo:void 0},xF={namespaced:!0,state:{userInfo:void 0},mutations:{setUserInfo(s,e){s.userInfo=e}}};qe.use(_s);const wF={userActions:Object.assign({},ra),userInfo:Object.assign({},kF)},EF=new _s.Store({modules:{userInfo:xF,userActions:Zn},mutations:{resetState(s){Object.keys(s).forEach(e=>{Object.assign(s[e],wF[e])})}}}),FF=D({});var TF=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",[t("router-view")],1)},DF=[],BF=T(FF,TF,DF,!1,null,"30bf9042",null,null);const SF=BF.exports;qe.use(Di,{disableClick:!1,tapTolerance:10,touchHoldTolerance:400,swipeTolerance:30,longTapTimeInterval:400});const IF=()=>{new qe({router:La,store:EF,render:s=>s(SF),created:function(){this.$router.afterEach((s,e)=>{qe.nextTick().then(()=>{const t=N.getTeamIdAsString();this.$gtag.event("page_view",{page_title:s.name,page_path:s.path,page_location:window.location.href,team_id:t})})}),Ge.config(this.$gtag)}}).$mount("#app")};function MF(){oe.extend(Bi),oe.extend(Si,{thresholds:[{l:"s",r:59,d:"second"},{l:"m",r:1},{l:"mm",r:59,d:"minute"},{l:"h",r:1},{l:"hh",r:23,d:"hour"},{l:"d",r:1},{l:"dd",r:29,d:"day"},{l:"M",r:1},{l:"MM",r:11,d:"month"},{l:"y"},{l:"yy",d:"year"}],rounding:Math.floor}),oe.locale("ja")}MF();qe.config.errorHandler=tm;Ii({dsn:"https://1e3586ee5ba7467b8034412f19e9c66e@o338584.ingest.sentry.io/1873285",Vue:qe,attachProps:!0,logErrors:!0,environment:"production",replaysSessionSampleRate:.1,replaysOnErrorSampleRate:1,tracesSampleRate:.2,integrations:[new Mi,new $i],denyUrls:[/cdn-edge\.karte\.io/i,/static\.karte\.io/i],enabled:!/localhost|127\.0\.0\.1/.test(window.location.host)});qe.config.productionTip=!1;qe.use(Pi);Un.options.defaultPlacement="bottom";qe.directive("tooltip",Un);qe.component("VPopover",Ni);qe.prototype.$featureFlags=st;Vt()||document.body.insertAdjacentHTML("afterend",Li);var Tn;zn()?((Tn=document.querySelector("meta[name='viewport']"))==null||Tn.setAttribute("content","width=1024,initial-scale=0.7,user-scalable=0"),Fn()):Vt()?IF():Fn();
